var ire=Object.defineProperty;var ore=(t,e,n)=>e in t?ire(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Vt=(t,e,n)=>ore(t,typeof e!="symbol"?e+"":e,n);function b8(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var u$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function v8(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var W_={exports:{}},fx={},G_={exports:{}},fn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _L;function are(){if(_L)return fn;_L=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),d=Symbol.iterator;function h(ee){return ee===null||typeof ee!="object"?null:(ee=d&&ee[d]||ee["@@iterator"],typeof ee=="function"?ee:null)}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function x(ee,de,ge){this.props=ee,this.context=de,this.refs=g,this.updater=ge||f}x.prototype.isReactComponent={},x.prototype.setState=function(ee,de){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,de,"setState")},x.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function w(){}w.prototype=x.prototype;function b(ee,de,ge){this.props=ee,this.context=de,this.refs=g,this.updater=ge||f}var S=b.prototype=new w;S.constructor=b,m(S,x.prototype),S.isPureReactComponent=!0;var C=Array.isArray,T=Object.prototype.hasOwnProperty,D={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function I(ee,de,ge){var Z,we={},Ee=null,Le=null;if(de!=null)for(Z in de.ref!==void 0&&(Le=de.ref),de.key!==void 0&&(Ee=""+de.key),de)T.call(de,Z)&&!P.hasOwnProperty(Z)&&(we[Z]=de[Z]);var De=arguments.length-2;if(De===1)we.children=ge;else if(1<De){for(var Be=Array(De),se=0;se<De;se++)Be[se]=arguments[se+2];we.children=Be}if(ee&&ee.defaultProps)for(Z in De=ee.defaultProps,De)we[Z]===void 0&&(we[Z]=De[Z]);return{$$typeof:t,type:ee,key:Ee,ref:Le,props:we,_owner:D.current}}function E(ee,de){return{$$typeof:t,type:ee.type,key:de,ref:ee.ref,props:ee.props,_owner:ee._owner}}function M(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function O(ee){var de={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(ge){return de[ge]})}var j=/\/+/g;function R(ee,de){return typeof ee=="object"&&ee!==null&&ee.key!=null?O(""+ee.key):de.toString(36)}function z(ee,de,ge,Z,we){var Ee=typeof ee;(Ee==="undefined"||Ee==="boolean")&&(ee=null);var Le=!1;if(ee===null)Le=!0;else switch(Ee){case"string":case"number":Le=!0;break;case"object":switch(ee.$$typeof){case t:case e:Le=!0}}if(Le)return Le=ee,we=we(Le),ee=Z===""?"."+R(Le,0):Z,C(we)?(ge="",ee!=null&&(ge=ee.replace(j,"$&/")+"/"),z(we,de,ge,"",function(se){return se})):we!=null&&(M(we)&&(we=E(we,ge+(!we.key||Le&&Le.key===we.key?"":(""+we.key).replace(j,"$&/")+"/")+ee)),de.push(we)),1;if(Le=0,Z=Z===""?".":Z+":",C(ee))for(var De=0;De<ee.length;De++){Ee=ee[De];var Be=Z+R(Ee,De);Le+=z(Ee,de,ge,Be,we)}else if(Be=h(ee),typeof Be=="function")for(ee=Be.call(ee),De=0;!(Ee=ee.next()).done;)Ee=Ee.value,Be=Z+R(Ee,De++),Le+=z(Ee,de,ge,Be,we);else if(Ee==="object")throw de=String(ee),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.");return Le}function B(ee,de,ge){if(ee==null)return ee;var Z=[],we=0;return z(ee,Z,"","",function(Ee){return de.call(ge,Ee,we++)}),Z}function V(ee){if(ee._status===-1){var de=ee._result;de=de(),de.then(function(ge){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=ge)},function(ge){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=ge)}),ee._status===-1&&(ee._status=0,ee._result=de)}if(ee._status===1)return ee._result.default;throw ee._result}var H={current:null},K={transition:null},ne={ReactCurrentDispatcher:H,ReactCurrentBatchConfig:K,ReactCurrentOwner:D};function fe(){throw Error("act(...) is not supported in production builds of React.")}return fn.Children={map:B,forEach:function(ee,de,ge){B(ee,function(){de.apply(this,arguments)},ge)},count:function(ee){var de=0;return B(ee,function(){de++}),de},toArray:function(ee){return B(ee,function(de){return de})||[]},only:function(ee){if(!M(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},fn.Component=x,fn.Fragment=n,fn.Profiler=s,fn.PureComponent=b,fn.StrictMode=r,fn.Suspense=l,fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,fn.act=fe,fn.cloneElement=function(ee,de,ge){if(ee==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ee+".");var Z=m({},ee.props),we=ee.key,Ee=ee.ref,Le=ee._owner;if(de!=null){if(de.ref!==void 0&&(Ee=de.ref,Le=D.current),de.key!==void 0&&(we=""+de.key),ee.type&&ee.type.defaultProps)var De=ee.type.defaultProps;for(Be in de)T.call(de,Be)&&!P.hasOwnProperty(Be)&&(Z[Be]=de[Be]===void 0&&De!==void 0?De[Be]:de[Be])}var Be=arguments.length-2;if(Be===1)Z.children=ge;else if(1<Be){De=Array(Be);for(var se=0;se<Be;se++)De[se]=arguments[se+2];Z.children=De}return{$$typeof:t,type:ee.type,key:we,ref:Ee,props:Z,_owner:Le}},fn.createContext=function(ee){return ee={$$typeof:o,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ee.Provider={$$typeof:i,_context:ee},ee.Consumer=ee},fn.createElement=I,fn.createFactory=function(ee){var de=I.bind(null,ee);return de.type=ee,de},fn.createRef=function(){return{current:null}},fn.forwardRef=function(ee){return{$$typeof:a,render:ee}},fn.isValidElement=M,fn.lazy=function(ee){return{$$typeof:c,_payload:{_status:-1,_result:ee},_init:V}},fn.memo=function(ee,de){return{$$typeof:u,type:ee,compare:de===void 0?null:de}},fn.startTransition=function(ee){var de=K.transition;K.transition={};try{ee()}finally{K.transition=de}},fn.unstable_act=fe,fn.useCallback=function(ee,de){return H.current.useCallback(ee,de)},fn.useContext=function(ee){return H.current.useContext(ee)},fn.useDebugValue=function(){},fn.useDeferredValue=function(ee){return H.current.useDeferredValue(ee)},fn.useEffect=function(ee,de){return H.current.useEffect(ee,de)},fn.useId=function(){return H.current.useId()},fn.useImperativeHandle=function(ee,de,ge){return H.current.useImperativeHandle(ee,de,ge)},fn.useInsertionEffect=function(ee,de){return H.current.useInsertionEffect(ee,de)},fn.useLayoutEffect=function(ee,de){return H.current.useLayoutEffect(ee,de)},fn.useMemo=function(ee,de){return H.current.useMemo(ee,de)},fn.useReducer=function(ee,de,ge){return H.current.useReducer(ee,de,ge)},fn.useRef=function(ee){return H.current.useRef(ee)},fn.useState=function(ee){return H.current.useState(ee)},fn.useSyncExternalStore=function(ee,de,ge){return H.current.useSyncExternalStore(ee,de,ge)},fn.useTransition=function(){return H.current.useTransition()},fn.version="18.3.1",fn}var AL;function dN(){return AL||(AL=1,G_.exports=are()),G_.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $L;function lre(){if($L)return fx;$L=1;var t=dN(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var c,d={},h=null,f=null;u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),l.ref!==void 0&&(f=l.ref);for(c in l)r.call(l,c)&&!i.hasOwnProperty(c)&&(d[c]=l[c]);if(a&&a.defaultProps)for(c in l=a.defaultProps,l)d[c]===void 0&&(d[c]=l[c]);return{$$typeof:e,type:a,key:h,ref:f,props:d,_owner:s.current}}return fx.Fragment=n,fx.jsx=o,fx.jsxs=o,fx}var RL;function ure(){return RL||(RL=1,W_.exports=lre()),W_.exports}var he=ure(),W=dN();const En=Dp(W),UC=b8({__proto__:null,default:En},[W]);var S2={},H_={exports:{}},Ji={},Y_={exports:{}},K_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ML;function cre(){return ML||(ML=1,function(t){function e(K,ne){var fe=K.length;K.push(ne);e:for(;0<fe;){var ee=fe-1>>>1,de=K[ee];if(0<s(de,ne))K[ee]=ne,K[fe]=de,fe=ee;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var ne=K[0],fe=K.pop();if(fe!==ne){K[0]=fe;e:for(var ee=0,de=K.length,ge=de>>>1;ee<ge;){var Z=2*(ee+1)-1,we=K[Z],Ee=Z+1,Le=K[Ee];if(0>s(we,fe))Ee<de&&0>s(Le,we)?(K[ee]=Le,K[Ee]=fe,ee=Ee):(K[ee]=we,K[Z]=fe,ee=Z);else if(Ee<de&&0>s(Le,fe))K[ee]=Le,K[Ee]=fe,ee=Ee;else break e}}return ne}function s(K,ne){var fe=K.sortIndex-ne.sortIndex;return fe!==0?fe:K.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,d=null,h=3,f=!1,m=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(K){for(var ne=n(u);ne!==null;){if(ne.callback===null)r(u);else if(ne.startTime<=K)r(u),ne.sortIndex=ne.expirationTime,e(l,ne);else break;ne=n(u)}}function C(K){if(g=!1,S(K),!m)if(n(l)!==null)m=!0,V(T);else{var ne=n(u);ne!==null&&H(C,ne.startTime-K)}}function T(K,ne){m=!1,g&&(g=!1,w(I),I=-1),f=!0;var fe=h;try{for(S(ne),d=n(l);d!==null&&(!(d.expirationTime>ne)||K&&!O());){var ee=d.callback;if(typeof ee=="function"){d.callback=null,h=d.priorityLevel;var de=ee(d.expirationTime<=ne);ne=t.unstable_now(),typeof de=="function"?d.callback=de:d===n(l)&&r(l),S(ne)}else r(l);d=n(l)}if(d!==null)var ge=!0;else{var Z=n(u);Z!==null&&H(C,Z.startTime-ne),ge=!1}return ge}finally{d=null,h=fe,f=!1}}var D=!1,P=null,I=-1,E=5,M=-1;function O(){return!(t.unstable_now()-M<E)}function j(){if(P!==null){var K=t.unstable_now();M=K;var ne=!0;try{ne=P(!0,K)}finally{ne?R():(D=!1,P=null)}}else D=!1}var R;if(typeof b=="function")R=function(){b(j)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,B=z.port2;z.port1.onmessage=j,R=function(){B.postMessage(null)}}else R=function(){x(j,0)};function V(K){P=K,D||(D=!0,R())}function H(K,ne){I=x(function(){K(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,V(T))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(K){switch(h){case 1:case 2:case 3:var ne=3;break;default:ne=h}var fe=h;h=ne;try{return K()}finally{h=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,ne){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var fe=h;h=K;try{return ne()}finally{h=fe}},t.unstable_scheduleCallback=function(K,ne,fe){var ee=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ee+fe:ee):fe=ee,K){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=fe+de,K={id:c++,callback:ne,priorityLevel:K,startTime:fe,expirationTime:de,sortIndex:-1},fe>ee?(K.sortIndex=fe,e(u,K),n(l)===null&&K===n(u)&&(g?(w(I),I=-1):g=!0,H(C,fe-ee))):(K.sortIndex=de,e(l,K),m||f||(m=!0,V(T))),K},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(K){var ne=h;return function(){var fe=h;h=ne;try{return K.apply(this,arguments)}finally{h=fe}}}}(K_)),K_}var DL;function dre(){return DL||(DL=1,Y_.exports=cre()),Y_.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OL;function hre(){if(OL)return Ji;OL=1;var t=dN(),e=dre();function n(p){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+p,v=1;v<arguments.length;v++)y+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(p,y){o(p,y),o(p+"Capture",y)}function o(p,y){for(s[p]=y,p=0;p<y.length;p++)r.add(y[p])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},d={};function h(p){return l.call(d,p)?!0:l.call(c,p)?!1:u.test(p)?d[p]=!0:(c[p]=!0,!1)}function f(p,y,v,A){if(v!==null&&v.type===0)return!1;switch(typeof y){case"function":case"symbol":return!0;case"boolean":return A?!1:v!==null?!v.acceptsBooleans:(p=p.toLowerCase().slice(0,5),p!=="data-"&&p!=="aria-");default:return!1}}function m(p,y,v,A){if(y===null||typeof y>"u"||f(p,y,v,A))return!0;if(A)return!1;if(v!==null)switch(v.type){case 3:return!y;case 4:return y===!1;case 5:return isNaN(y);case 6:return isNaN(y)||1>y}return!1}function g(p,y,v,A,F,Y,ue){this.acceptsBooleans=y===2||y===3||y===4,this.attributeName=A,this.attributeNamespace=F,this.mustUseProperty=v,this.propertyName=p,this.type=y,this.sanitizeURL=Y,this.removeEmptyString=ue}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(p){x[p]=new g(p,0,!1,p,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(p){var y=p[0];x[y]=new g(y,1,!1,p[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(p){x[p]=new g(p,2,!1,p.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(p){x[p]=new g(p,2,!1,p,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(p){x[p]=new g(p,3,!1,p.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(p){x[p]=new g(p,3,!0,p,null,!1,!1)}),["capture","download"].forEach(function(p){x[p]=new g(p,4,!1,p,null,!1,!1)}),["cols","rows","size","span"].forEach(function(p){x[p]=new g(p,6,!1,p,null,!1,!1)}),["rowSpan","start"].forEach(function(p){x[p]=new g(p,5,!1,p.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function b(p){return p[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(p){var y=p.replace(w,b);x[y]=new g(y,1,!1,p,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(p){var y=p.replace(w,b);x[y]=new g(y,1,!1,p,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(p){var y=p.replace(w,b);x[y]=new g(y,1,!1,p,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(p){x[p]=new g(p,1,!1,p.toLowerCase(),null,!1,!1)}),x.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(p){x[p]=new g(p,1,!1,p.toLowerCase(),null,!0,!0)});function S(p,y,v,A){var F=x.hasOwnProperty(y)?x[y]:null;(F!==null?F.type!==0:A||!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(m(y,v,F,A)&&(v=null),A||F===null?h(y)&&(v===null?p.removeAttribute(y):p.setAttribute(y,""+v)):F.mustUseProperty?p[F.propertyName]=v===null?F.type===3?!1:"":v:(y=F.attributeName,A=F.attributeNamespace,v===null?p.removeAttribute(y):(F=F.type,v=F===3||F===4&&v===!0?"":""+v,A?p.setAttributeNS(A,y,v):p.setAttribute(y,v))))}var C=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),D=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),O=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),K=Symbol.iterator;function ne(p){return p===null||typeof p!="object"?null:(p=K&&p[K]||p["@@iterator"],typeof p=="function"?p:null)}var fe=Object.assign,ee;function de(p){if(ee===void 0)try{throw Error()}catch(v){var y=v.stack.trim().match(/\n( *(at )?)/);ee=y&&y[1]||""}return`
`+ee+p}var ge=!1;function Z(p,y){if(!p||ge)return"";ge=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch(Xe){var A=Xe}Reflect.construct(p,[],y)}else{try{y.call()}catch(Xe){A=Xe}p.call(y.prototype)}else{try{throw Error()}catch(Xe){A=Xe}p()}}catch(Xe){if(Xe&&A&&typeof Xe.stack=="string"){for(var F=Xe.stack.split(`
`),Y=A.stack.split(`
`),ue=F.length-1,Te=Y.length-1;1<=ue&&0<=Te&&F[ue]!==Y[Te];)Te--;for(;1<=ue&&0<=Te;ue--,Te--)if(F[ue]!==Y[Te]){if(ue!==1||Te!==1)do if(ue--,Te--,0>Te||F[ue]!==Y[Te]){var Oe=`
`+F[ue].replace(" at new "," at ");return p.displayName&&Oe.includes("<anonymous>")&&(Oe=Oe.replace("<anonymous>",p.displayName)),Oe}while(1<=ue&&0<=Te);break}}}finally{ge=!1,Error.prepareStackTrace=v}return(p=p?p.displayName||p.name:"")?de(p):""}function we(p){switch(p.tag){case 5:return de(p.type);case 16:return de("Lazy");case 13:return de("Suspense");case 19:return de("SuspenseList");case 0:case 2:case 15:return p=Z(p.type,!1),p;case 11:return p=Z(p.type.render,!1),p;case 1:return p=Z(p.type,!0),p;default:return""}}function Ee(p){if(p==null)return null;if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case P:return"Fragment";case D:return"Portal";case E:return"Profiler";case I:return"StrictMode";case R:return"Suspense";case z:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case O:return(p.displayName||"Context")+".Consumer";case M:return(p._context.displayName||"Context")+".Provider";case j:var y=p.render;return p=p.displayName,p||(p=y.displayName||y.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case B:return y=p.displayName||null,y!==null?y:Ee(p.type)||"Memo";case V:y=p._payload,p=p._init;try{return Ee(p(y))}catch{}}return null}function Le(p){var y=p.type;switch(p.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return p=y.render,p=p.displayName||p.name||"",y.displayName||(p!==""?"ForwardRef("+p+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ee(y);case 8:return y===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function De(p){switch(typeof p){case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function Be(p){var y=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function se(p){var y=Be(p)?"checked":"value",v=Object.getOwnPropertyDescriptor(p.constructor.prototype,y),A=""+p[y];if(!p.hasOwnProperty(y)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var F=v.get,Y=v.set;return Object.defineProperty(p,y,{configurable:!0,get:function(){return F.call(this)},set:function(ue){A=""+ue,Y.call(this,ue)}}),Object.defineProperty(p,y,{enumerable:v.enumerable}),{getValue:function(){return A},setValue:function(ue){A=""+ue},stopTracking:function(){p._valueTracker=null,delete p[y]}}}}function le(p){p._valueTracker||(p._valueTracker=se(p))}function ye(p){if(!p)return!1;var y=p._valueTracker;if(!y)return!0;var v=y.getValue(),A="";return p&&(A=Be(p)?p.checked?"true":"false":p.value),p=A,p!==v?(y.setValue(p),!0):!1}function ve(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}function xe(p,y){var v=y.checked;return fe({},y,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:v??p._wrapperState.initialChecked})}function Ie(p,y){var v=y.defaultValue==null?"":y.defaultValue,A=y.checked!=null?y.checked:y.defaultChecked;v=De(y.value!=null?y.value:v),p._wrapperState={initialChecked:A,initialValue:v,controlled:y.type==="checkbox"||y.type==="radio"?y.checked!=null:y.value!=null}}function te(p,y){y=y.checked,y!=null&&S(p,"checked",y,!1)}function L(p,y){te(p,y);var v=De(y.value),A=y.type;if(v!=null)A==="number"?(v===0&&p.value===""||p.value!=v)&&(p.value=""+v):p.value!==""+v&&(p.value=""+v);else if(A==="submit"||A==="reset"){p.removeAttribute("value");return}y.hasOwnProperty("value")?re(p,y.type,v):y.hasOwnProperty("defaultValue")&&re(p,y.type,De(y.defaultValue)),y.checked==null&&y.defaultChecked!=null&&(p.defaultChecked=!!y.defaultChecked)}function U(p,y,v){if(y.hasOwnProperty("value")||y.hasOwnProperty("defaultValue")){var A=y.type;if(!(A!=="submit"&&A!=="reset"||y.value!==void 0&&y.value!==null))return;y=""+p._wrapperState.initialValue,v||y===p.value||(p.value=y),p.defaultValue=y}v=p.name,v!==""&&(p.name=""),p.defaultChecked=!!p._wrapperState.initialChecked,v!==""&&(p.name=v)}function re(p,y,v){(y!=="number"||ve(p.ownerDocument)!==p)&&(v==null?p.defaultValue=""+p._wrapperState.initialValue:p.defaultValue!==""+v&&(p.defaultValue=""+v))}var q=Array.isArray;function ie(p,y,v,A){if(p=p.options,y){y={};for(var F=0;F<v.length;F++)y["$"+v[F]]=!0;for(v=0;v<p.length;v++)F=y.hasOwnProperty("$"+p[v].value),p[v].selected!==F&&(p[v].selected=F),F&&A&&(p[v].defaultSelected=!0)}else{for(v=""+De(v),y=null,F=0;F<p.length;F++){if(p[F].value===v){p[F].selected=!0,A&&(p[F].defaultSelected=!0);return}y!==null||p[F].disabled||(y=p[F])}y!==null&&(y.selected=!0)}}function me(p,y){if(y.dangerouslySetInnerHTML!=null)throw Error(n(91));return fe({},y,{value:void 0,defaultValue:void 0,children:""+p._wrapperState.initialValue})}function je(p,y){var v=y.value;if(v==null){if(v=y.children,y=y.defaultValue,v!=null){if(y!=null)throw Error(n(92));if(q(v)){if(1<v.length)throw Error(n(93));v=v[0]}y=v}y==null&&(y=""),v=y}p._wrapperState={initialValue:De(v)}}function He(p,y){var v=De(y.value),A=De(y.defaultValue);v!=null&&(v=""+v,v!==p.value&&(p.value=v),y.defaultValue==null&&p.defaultValue!==v&&(p.defaultValue=v)),A!=null&&(p.defaultValue=""+A)}function Ge(p){var y=p.textContent;y===p._wrapperState.initialValue&&y!==""&&y!==null&&(p.value=y)}function Je(p){switch(p){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function N(p,y){return p==null||p==="http://www.w3.org/1999/xhtml"?Je(y):p==="http://www.w3.org/2000/svg"&&y==="foreignObject"?"http://www.w3.org/1999/xhtml":p}var k,$=function(p){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(y,v,A,F){MSApp.execUnsafeLocalFunction(function(){return p(y,v,A,F)})}:p}(function(p,y){if(p.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in p)p.innerHTML=y;else{for(k=k||document.createElement("div"),k.innerHTML="<svg>"+y.valueOf().toString()+"</svg>",y=k.firstChild;p.firstChild;)p.removeChild(p.firstChild);for(;y.firstChild;)p.appendChild(y.firstChild)}});function J(p,y){if(y){var v=p.firstChild;if(v&&v===p.lastChild&&v.nodeType===3){v.nodeValue=y;return}}p.textContent=y}var ce={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},be=["Webkit","ms","Moz","O"];Object.keys(ce).forEach(function(p){be.forEach(function(y){y=y+p.charAt(0).toUpperCase()+p.substring(1),ce[y]=ce[p]})});function Ne(p,y,v){return y==null||typeof y=="boolean"||y===""?"":v||typeof y!="number"||y===0||ce.hasOwnProperty(p)&&ce[p]?(""+y).trim():y+"px"}function at(p,y){p=p.style;for(var v in y)if(y.hasOwnProperty(v)){var A=v.indexOf("--")===0,F=Ne(v,y[v],A);v==="float"&&(v="cssFloat"),A?p.setProperty(v,F):p[v]=F}}var St=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mt(p,y){if(y){if(St[p]&&(y.children!=null||y.dangerouslySetInnerHTML!=null))throw Error(n(137,p));if(y.dangerouslySetInnerHTML!=null){if(y.children!=null)throw Error(n(60));if(typeof y.dangerouslySetInnerHTML!="object"||!("__html"in y.dangerouslySetInnerHTML))throw Error(n(61))}if(y.style!=null&&typeof y.style!="object")throw Error(n(62))}}function dt(p,y){if(p.indexOf("-")===-1)return typeof y.is=="string";switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=null;function hn(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var No=null,ko=null,To=null;function Pl(p){if(p=Qy(p)){if(typeof No!="function")throw Error(n(280));var y=p.stateNode;y&&(y=Fv(y),No(p.stateNode,p.type,y))}}function Lu(p){ko?To?To.push(p):To=[p]:ko=p}function us(){if(ko){var p=ko,y=To;if(To=ko=null,Pl(p),y)for(p=0;p<y.length;p++)Pl(y[p])}}function Bh(p,y){return p(y)}function sm(){}var zu=!1;function Bc(p,y,v){if(zu)return p(y,v);zu=!0;try{return Bh(p,y,v)}finally{zu=!1,(ko!==null||To!==null)&&(sm(),us())}}function Xn(p,y){var v=p.stateNode;if(v===null)return null;var A=Fv(v);if(A===null)return null;v=A[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(p=p.type,A=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!A;break e;default:p=!1}if(p)return null;if(v&&typeof v!="function")throw Error(n(231,y,typeof v));return v}var ja=!1;if(a)try{var Uc={};Object.defineProperty(Uc,"passive",{get:function(){ja=!0}}),window.addEventListener("test",Uc,Uc),window.removeEventListener("test",Uc,Uc)}catch{ja=!1}function Jo(p,y,v,A,F,Y,ue,Te,Oe){var Xe=Array.prototype.slice.call(arguments,3);try{y.apply(v,Xe)}catch(nt){this.onError(nt)}}var Ci=!1,Bu=null,Bn=!1,Ys=null,Zn={onError:function(p){Ci=!0,Bu=p}};function Oy(p,y,v,A,F,Y,ue,Te,Oe){Ci=!1,Bu=null,Jo.apply(Zn,arguments)}function Vc(p,y,v,A,F,Y,ue,Te,Oe){if(Oy.apply(this,arguments),Ci){if(Ci){var Xe=Bu;Ci=!1,Bu=null}else throw Error(n(198));Bn||(Bn=!0,Ys=Xe)}}function Eo(p){var y=p,v=p;if(p.alternate)for(;y.return;)y=y.return;else{p=y;do y=p,(y.flags&4098)!==0&&(v=y.return),p=y.return;while(p)}return y.tag===3?v:null}function Uu(p){if(p.tag===13){var y=p.memoizedState;if(y===null&&(p=p.alternate,p!==null&&(y=p.memoizedState)),y!==null)return y.dehydrated}return null}function Fl(p){if(Eo(p)!==p)throw Error(n(188))}function im(p){var y=p.alternate;if(!y){if(y=Eo(p),y===null)throw Error(n(188));return y!==p?null:p}for(var v=p,A=y;;){var F=v.return;if(F===null)break;var Y=F.alternate;if(Y===null){if(A=F.return,A!==null){v=A;continue}break}if(F.child===Y.child){for(Y=F.child;Y;){if(Y===v)return Fl(F),p;if(Y===A)return Fl(F),y;Y=Y.sibling}throw Error(n(188))}if(v.return!==A.return)v=F,A=Y;else{for(var ue=!1,Te=F.child;Te;){if(Te===v){ue=!0,v=F,A=Y;break}if(Te===A){ue=!0,A=F,v=Y;break}Te=Te.sibling}if(!ue){for(Te=Y.child;Te;){if(Te===v){ue=!0,v=Y,A=F;break}if(Te===A){ue=!0,A=Y,v=F;break}Te=Te.sibling}if(!ue)throw Error(n(189))}}if(v.alternate!==A)throw Error(n(190))}if(v.tag!==3)throw Error(n(188));return v.stateNode.current===v?p:y}function jc(p){return p=im(p),p!==null?Wc(p):null}function Wc(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){var y=Wc(p);if(y!==null)return y;p=p.sibling}return null}var Cn=e.unstable_scheduleCallback,Ks=e.unstable_cancelCallback,Gi=e.unstable_shouldYield,Re=e.unstable_requestPaint,Dt=e.unstable_now,an=e.unstable_getCurrentPriorityLevel,en=e.unstable_ImmediatePriority,Wa=e.unstable_UserBlockingPriority,Dr=e.unstable_NormalPriority,Py=e.unstable_LowPriority,Uh=e.unstable_IdlePriority,Ii=null,Ni=null;function dE(p){if(Ni&&typeof Ni.onCommitFiberRoot=="function")try{Ni.onCommitFiberRoot(Ii,p,void 0,(p.current.flags&128)===128)}catch{}}var Hi=Math.clz32?Math.clz32:fE,Fy=Math.log,hE=Math.LN2;function fE(p){return p>>>=0,p===0?32:31-(Fy(p)/hE|0)|0}var Vh=64,jh=4194304;function Gc(p){switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return p&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return p}}function Wh(p,y){var v=p.pendingLanes;if(v===0)return 0;var A=0,F=p.suspendedLanes,Y=p.pingedLanes,ue=v&268435455;if(ue!==0){var Te=ue&~F;Te!==0?A=Gc(Te):(Y&=ue,Y!==0&&(A=Gc(Y)))}else ue=v&~F,ue!==0?A=Gc(ue):Y!==0&&(A=Gc(Y));if(A===0)return 0;if(y!==0&&y!==A&&(y&F)===0&&(F=A&-A,Y=y&-y,F>=Y||F===16&&(Y&4194240)!==0))return y;if((A&4)!==0&&(A|=v&16),y=p.entangledLanes,y!==0)for(p=p.entanglements,y&=A;0<y;)v=31-Hi(y),F=1<<v,A|=p[v],y&=~F;return A}function qs(p,y){switch(p){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gv(p,y){for(var v=p.suspendedLanes,A=p.pingedLanes,F=p.expirationTimes,Y=p.pendingLanes;0<Y;){var ue=31-Hi(Y),Te=1<<ue,Oe=F[ue];Oe===-1?((Te&v)===0||(Te&A)!==0)&&(F[ue]=qs(Te,y)):Oe<=y&&(p.expiredLanes|=Te),Y&=~Te}}function om(p){return p=p.pendingLanes&-1073741825,p!==0?p:p&1073741824?1073741824:0}function Gh(){var p=Vh;return Vh<<=1,(Vh&4194240)===0&&(Vh=64),p}function am(p){for(var y=[],v=0;31>v;v++)y.push(p);return y}function Hc(p,y,v){p.pendingLanes|=y,y!==536870912&&(p.suspendedLanes=0,p.pingedLanes=0),p=p.eventTimes,y=31-Hi(y),p[y]=v}function pE(p,y){var v=p.pendingLanes&~y;p.pendingLanes=y,p.suspendedLanes=0,p.pingedLanes=0,p.expiredLanes&=y,p.mutableReadLanes&=y,p.entangledLanes&=y,y=p.entanglements;var A=p.eventTimes;for(p=p.expirationTimes;0<v;){var F=31-Hi(v),Y=1<<F;y[F]=0,A[F]=-1,p[F]=-1,v&=~Y}}function Ly(p,y){var v=p.entangledLanes|=y;for(p=p.entanglements;v;){var A=31-Hi(v),F=1<<A;F&y|p[A]&y&&(p[A]|=y),v&=~F}}var kn=0;function zy(p){return p&=-p,1<p?4<p?(p&268435455)!==0?16:536870912:4:1}var Hh,lm,By,Yc,yv,Uy=!1,um=[],Ll=null,ea=null,Yi=null,Yh=new Map,Kh=new Map,zl=[],mE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cm(p,y){switch(p){case"focusin":case"focusout":Ll=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":Yi=null;break;case"pointerover":case"pointerout":Yh.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kh.delete(y.pointerId)}}function Kc(p,y,v,A,F,Y){return p===null||p.nativeEvent!==Y?(p={blockedOn:y,domEventName:v,eventSystemFlags:A,nativeEvent:Y,targetContainers:[F]},y!==null&&(y=Qy(y),y!==null&&lm(y)),p):(p.eventSystemFlags|=A,y=p.targetContainers,F!==null&&y.indexOf(F)===-1&&y.push(F),p)}function xv(p,y,v,A,F){switch(y){case"focusin":return Ll=Kc(Ll,p,y,v,A,F),!0;case"dragenter":return ea=Kc(ea,p,y,v,A,F),!0;case"mouseover":return Yi=Kc(Yi,p,y,v,A,F),!0;case"pointerover":var Y=F.pointerId;return Yh.set(Y,Kc(Yh.get(Y)||null,p,y,v,A,F)),!0;case"gotpointercapture":return Y=F.pointerId,Kh.set(Y,Kc(Kh.get(Y)||null,p,y,v,A,F)),!0}return!1}function qc(p){var y=tf(p.target);if(y!==null){var v=Eo(y);if(v!==null){if(y=v.tag,y===13){if(y=Uu(v),y!==null){p.blockedOn=y,yv(p.priority,function(){By(v)});return}}else if(y===3&&v.stateNode.current.memoizedState.isDehydrated){p.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}p.blockedOn=null}function Xs(p){if(p.blockedOn!==null)return!1;for(var y=p.targetContainers;0<y.length;){var v=Vy(p.domEventName,p.eventSystemFlags,y[0],p.nativeEvent);if(v===null){v=p.nativeEvent;var A=new v.constructor(v.type,v);_t=A,v.target.dispatchEvent(A),_t=null}else return y=Qy(v),y!==null&&lm(y),p.blockedOn=v,!1;y.shift()}return!0}function wv(p,y,v){Xs(p)&&v.delete(y)}function gE(){Uy=!1,Ll!==null&&Xs(Ll)&&(Ll=null),ea!==null&&Xs(ea)&&(ea=null),Yi!==null&&Xs(Yi)&&(Yi=null),Yh.forEach(wv),Kh.forEach(wv)}function Xc(p,y){p.blockedOn===y&&(p.blockedOn=null,Uy||(Uy=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,gE)))}function Zc(p){function y(F){return Xc(F,p)}if(0<um.length){Xc(um[0],p);for(var v=1;v<um.length;v++){var A=um[v];A.blockedOn===p&&(A.blockedOn=null)}}for(Ll!==null&&Xc(Ll,p),ea!==null&&Xc(ea,p),Yi!==null&&Xc(Yi,p),Yh.forEach(y),Kh.forEach(y),v=0;v<zl.length;v++)A=zl[v],A.blockedOn===p&&(A.blockedOn=null);for(;0<zl.length&&(v=zl[0],v.blockedOn===null);)qc(v),v.blockedOn===null&&zl.shift()}var Bl=C.ReactCurrentBatchConfig,Qc=!0;function Jc(p,y,v,A){var F=kn,Y=Bl.transition;Bl.transition=null;try{kn=1,qh(p,y,v,A)}finally{kn=F,Bl.transition=Y}}function bv(p,y,v,A){var F=kn,Y=Bl.transition;Bl.transition=null;try{kn=4,qh(p,y,v,A)}finally{kn=F,Bl.transition=Y}}function qh(p,y,v,A){if(Qc){var F=Vy(p,y,v,A);if(F===null)DE(p,y,A,dm,v),cm(p,A);else if(xv(F,p,y,v,A))A.stopPropagation();else if(cm(p,A),y&4&&-1<mE.indexOf(p)){for(;F!==null;){var Y=Qy(F);if(Y!==null&&Hh(Y),Y=Vy(p,y,v,A),Y===null&&DE(p,y,A,dm,v),Y===F)break;F=Y}F!==null&&A.stopPropagation()}else DE(p,y,A,null,v)}}var dm=null;function Vy(p,y,v,A){if(dm=null,p=hn(A),p=tf(p),p!==null)if(y=Eo(p),y===null)p=null;else if(v=y.tag,v===13){if(p=Uu(y),p!==null)return p;p=null}else if(v===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;p=null}else y!==p&&(p=null);return dm=p,null}function ed(p){switch(p){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(an()){case en:return 1;case Wa:return 4;case Dr:case Py:return 16;case Uh:return 536870912;default:return 16}default:return 16}}var Ga=null,hm=null,fm=null;function vv(){if(fm)return fm;var p,y=hm,v=y.length,A,F="value"in Ga?Ga.value:Ga.textContent,Y=F.length;for(p=0;p<v&&y[p]===F[p];p++);var ue=v-p;for(A=1;A<=ue&&y[v-A]===F[Y-A];A++);return fm=F.slice(p,1<A?1-A:void 0)}function Vu(p){var y=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&y===13&&(p=13)):p=y,p===10&&(p=13),32<=p||p===13?p:0}function Xh(){return!0}function Sv(){return!1}function Zs(p){function y(v,A,F,Y,ue){this._reactName=v,this._targetInst=F,this.type=A,this.nativeEvent=Y,this.target=ue,this.currentTarget=null;for(var Te in p)p.hasOwnProperty(Te)&&(v=p[Te],this[Te]=v?v(Y):Y[Te]);return this.isDefaultPrevented=(Y.defaultPrevented!=null?Y.defaultPrevented:Y.returnValue===!1)?Xh:Sv,this.isPropagationStopped=Sv,this}return fe(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=Xh)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=Xh)},persist:function(){},isPersistent:Xh}),y}var td={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jy=Zs(td),ju=fe({},td,{view:0,detail:0}),Wy=Zs(ju),pm,Gy,Zh,mm=fe({},ju,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:G,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==Zh&&(Zh&&p.type==="mousemove"?(pm=p.screenX-Zh.screenX,Gy=p.screenY-Zh.screenY):Gy=pm=0,Zh=p),pm)},movementY:function(p){return"movementY"in p?p.movementY:Gy}}),Cv=Zs(mm),Iv=fe({},mm,{dataTransfer:0}),yE=Zs(Iv),xE=fe({},ju,{relatedTarget:0}),Qh=Zs(xE),wE=fe({},td,{animationName:0,elapsedTime:0,pseudoElement:0}),bE=Zs(wE),vE=fe({},td,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),gm=Zs(vE),SE=fe({},td,{data:0}),Nv=Zs(SE),CE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _(p){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(p):(p=Tv[p])?!!y[p]:!1}function G(){return _}var Q=fe({},ju,{key:function(p){if(p.key){var y=CE[p.key]||p.key;if(y!=="Unidentified")return y}return p.type==="keypress"?(p=Vu(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?kv[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:G,charCode:function(p){return p.type==="keypress"?Vu(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?Vu(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),oe=Zs(Q),Se=fe({},mm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ke=Zs(Se),Ce=fe({},ju,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:G}),Fe=Zs(Ce),qe=fe({},td,{propertyName:0,elapsedTime:0,pseudoElement:0}),rt=Zs(qe),ft=fe({},mm,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),Ht=Zs(ft),Ft=[9,13,27,32],gt=a&&"CompositionEvent"in window,Ut=null;a&&"documentMode"in document&&(Ut=document.documentMode);var on=a&&"TextEvent"in window&&!Ut,Un=a&&(!gt||Ut&&8<Ut&&11>=Ut),Mn=" ",Gr=!1;function ki(p,y){switch(p){case"keyup":return Ft.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ds(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var cn=!1;function cs(p,y){switch(p){case"compositionend":return Ds(y);case"keypress":return y.which!==32?null:(Gr=!0,Mn);case"textInput":return p=y.data,p===Mn&&Gr?null:p;default:return null}}function Ul(p,y){if(cn)return p==="compositionend"||!gt&&ki(p,y)?(p=vv(),fm=hm=Ga=null,cn=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return Un&&y.locale!=="ko"?null:y.data;default:return null}}var IE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ev(p){var y=p&&p.nodeName&&p.nodeName.toLowerCase();return y==="input"?!!IE[p.type]:y==="textarea"}function _v(p,y,v,A){Lu(A),y=Dv(y,"onChange"),0<y.length&&(v=new jy("onChange","change",null,v,A),p.push({event:v,listeners:y}))}var Jh=null,ef=null;function ym(p){G4(p,0)}function Av(p){var y=Sm(p);if(ye(y))return p}function one(p,y){if(p==="change")return y}var E4=!1;if(a){var NE;if(a){var kE="oninput"in document;if(!kE){var _4=document.createElement("div");_4.setAttribute("oninput","return;"),kE=typeof _4.oninput=="function"}NE=kE}else NE=!1;E4=NE&&(!document.documentMode||9<document.documentMode)}function A4(){Jh&&(Jh.detachEvent("onpropertychange",$4),ef=Jh=null)}function $4(p){if(p.propertyName==="value"&&Av(ef)){var y=[];_v(y,ef,p,hn(p)),Bc(ym,y)}}function ane(p,y,v){p==="focusin"?(A4(),Jh=y,ef=v,Jh.attachEvent("onpropertychange",$4)):p==="focusout"&&A4()}function lne(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Av(ef)}function une(p,y){if(p==="click")return Av(y)}function cne(p,y){if(p==="input"||p==="change")return Av(y)}function dne(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var Ha=typeof Object.is=="function"?Object.is:dne;function Hy(p,y){if(Ha(p,y))return!0;if(typeof p!="object"||p===null||typeof y!="object"||y===null)return!1;var v=Object.keys(p),A=Object.keys(y);if(v.length!==A.length)return!1;for(A=0;A<v.length;A++){var F=v[A];if(!l.call(y,F)||!Ha(p[F],y[F]))return!1}return!0}function R4(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function M4(p,y){var v=R4(p);p=0;for(var A;v;){if(v.nodeType===3){if(A=p+v.textContent.length,p<=y&&A>=y)return{node:v,offset:y-p};p=A}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=R4(v)}}function D4(p,y){return p&&y?p===y?!0:p&&p.nodeType===3?!1:y&&y.nodeType===3?D4(p,y.parentNode):"contains"in p?p.contains(y):p.compareDocumentPosition?!!(p.compareDocumentPosition(y)&16):!1:!1}function O4(){for(var p=window,y=ve();y instanceof p.HTMLIFrameElement;){try{var v=typeof y.contentWindow.location.href=="string"}catch{v=!1}if(v)p=y.contentWindow;else break;y=ve(p.document)}return y}function TE(p){var y=p&&p.nodeName&&p.nodeName.toLowerCase();return y&&(y==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||y==="textarea"||p.contentEditable==="true")}function hne(p){var y=O4(),v=p.focusedElem,A=p.selectionRange;if(y!==v&&v&&v.ownerDocument&&D4(v.ownerDocument.documentElement,v)){if(A!==null&&TE(v)){if(y=A.start,p=A.end,p===void 0&&(p=y),"selectionStart"in v)v.selectionStart=y,v.selectionEnd=Math.min(p,v.value.length);else if(p=(y=v.ownerDocument||document)&&y.defaultView||window,p.getSelection){p=p.getSelection();var F=v.textContent.length,Y=Math.min(A.start,F);A=A.end===void 0?Y:Math.min(A.end,F),!p.extend&&Y>A&&(F=A,A=Y,Y=F),F=M4(v,Y);var ue=M4(v,A);F&&ue&&(p.rangeCount!==1||p.anchorNode!==F.node||p.anchorOffset!==F.offset||p.focusNode!==ue.node||p.focusOffset!==ue.offset)&&(y=y.createRange(),y.setStart(F.node,F.offset),p.removeAllRanges(),Y>A?(p.addRange(y),p.extend(ue.node,ue.offset)):(y.setEnd(ue.node,ue.offset),p.addRange(y)))}}for(y=[],p=v;p=p.parentNode;)p.nodeType===1&&y.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<y.length;v++)p=y[v],p.element.scrollLeft=p.left,p.element.scrollTop=p.top}}var fne=a&&"documentMode"in document&&11>=document.documentMode,xm=null,EE=null,Yy=null,_E=!1;function P4(p,y,v){var A=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;_E||xm==null||xm!==ve(A)||(A=xm,"selectionStart"in A&&TE(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),Yy&&Hy(Yy,A)||(Yy=A,A=Dv(EE,"onSelect"),0<A.length&&(y=new jy("onSelect","select",null,y,v),p.push({event:y,listeners:A}),y.target=xm)))}function $v(p,y){var v={};return v[p.toLowerCase()]=y.toLowerCase(),v["Webkit"+p]="webkit"+y,v["Moz"+p]="moz"+y,v}var wm={animationend:$v("Animation","AnimationEnd"),animationiteration:$v("Animation","AnimationIteration"),animationstart:$v("Animation","AnimationStart"),transitionend:$v("Transition","TransitionEnd")},AE={},F4={};a&&(F4=document.createElement("div").style,"AnimationEvent"in window||(delete wm.animationend.animation,delete wm.animationiteration.animation,delete wm.animationstart.animation),"TransitionEvent"in window||delete wm.transitionend.transition);function Rv(p){if(AE[p])return AE[p];if(!wm[p])return p;var y=wm[p],v;for(v in y)if(y.hasOwnProperty(v)&&v in F4)return AE[p]=y[v];return p}var L4=Rv("animationend"),z4=Rv("animationiteration"),B4=Rv("animationstart"),U4=Rv("transitionend"),V4=new Map,j4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function nd(p,y){V4.set(p,y),i(y,[p])}for(var $E=0;$E<j4.length;$E++){var RE=j4[$E],pne=RE.toLowerCase(),mne=RE[0].toUpperCase()+RE.slice(1);nd(pne,"on"+mne)}nd(L4,"onAnimationEnd"),nd(z4,"onAnimationIteration"),nd(B4,"onAnimationStart"),nd("dblclick","onDoubleClick"),nd("focusin","onFocus"),nd("focusout","onBlur"),nd(U4,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ky="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gne=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ky));function W4(p,y,v){var A=p.type||"unknown-event";p.currentTarget=v,Vc(A,y,void 0,p),p.currentTarget=null}function G4(p,y){y=(y&4)!==0;for(var v=0;v<p.length;v++){var A=p[v],F=A.event;A=A.listeners;e:{var Y=void 0;if(y)for(var ue=A.length-1;0<=ue;ue--){var Te=A[ue],Oe=Te.instance,Xe=Te.currentTarget;if(Te=Te.listener,Oe!==Y&&F.isPropagationStopped())break e;W4(F,Te,Xe),Y=Oe}else for(ue=0;ue<A.length;ue++){if(Te=A[ue],Oe=Te.instance,Xe=Te.currentTarget,Te=Te.listener,Oe!==Y&&F.isPropagationStopped())break e;W4(F,Te,Xe),Y=Oe}}}if(Bn)throw p=Ys,Bn=!1,Ys=null,p}function nr(p,y){var v=y[BE];v===void 0&&(v=y[BE]=new Set);var A=p+"__bubble";v.has(A)||(H4(y,p,2,!1),v.add(A))}function ME(p,y,v){var A=0;y&&(A|=4),H4(v,p,A,y)}var Mv="_reactListening"+Math.random().toString(36).slice(2);function qy(p){if(!p[Mv]){p[Mv]=!0,r.forEach(function(v){v!=="selectionchange"&&(gne.has(v)||ME(v,!1,p),ME(v,!0,p))});var y=p.nodeType===9?p:p.ownerDocument;y===null||y[Mv]||(y[Mv]=!0,ME("selectionchange",!1,y))}}function H4(p,y,v,A){switch(ed(y)){case 1:var F=Jc;break;case 4:F=bv;break;default:F=qh}v=F.bind(null,y,v,p),F=void 0,!ja||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(F=!0),A?F!==void 0?p.addEventListener(y,v,{capture:!0,passive:F}):p.addEventListener(y,v,!0):F!==void 0?p.addEventListener(y,v,{passive:F}):p.addEventListener(y,v,!1)}function DE(p,y,v,A,F){var Y=A;if((y&1)===0&&(y&2)===0&&A!==null)e:for(;;){if(A===null)return;var ue=A.tag;if(ue===3||ue===4){var Te=A.stateNode.containerInfo;if(Te===F||Te.nodeType===8&&Te.parentNode===F)break;if(ue===4)for(ue=A.return;ue!==null;){var Oe=ue.tag;if((Oe===3||Oe===4)&&(Oe=ue.stateNode.containerInfo,Oe===F||Oe.nodeType===8&&Oe.parentNode===F))return;ue=ue.return}for(;Te!==null;){if(ue=tf(Te),ue===null)return;if(Oe=ue.tag,Oe===5||Oe===6){A=Y=ue;continue e}Te=Te.parentNode}}A=A.return}Bc(function(){var Xe=Y,nt=hn(v),st=[];e:{var tt=V4.get(p);if(tt!==void 0){var vt=jy,Tt=p;switch(p){case"keypress":if(Vu(v)===0)break e;case"keydown":case"keyup":vt=oe;break;case"focusin":Tt="focus",vt=Qh;break;case"focusout":Tt="blur",vt=Qh;break;case"beforeblur":case"afterblur":vt=Qh;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=Cv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=yE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=Fe;break;case L4:case z4:case B4:vt=bE;break;case U4:vt=rt;break;case"scroll":vt=Wy;break;case"wheel":vt=Ht;break;case"copy":case"cut":case"paste":vt=gm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=ke}var Rt=(y&4)!==0,Or=!Rt&&p==="scroll",Ye=Rt?tt!==null?tt+"Capture":null:tt;Rt=[];for(var ze=Xe,Ke;ze!==null;){Ke=ze;var it=Ke.stateNode;if(Ke.tag===5&&it!==null&&(Ke=it,Ye!==null&&(it=Xn(ze,Ye),it!=null&&Rt.push(Xy(ze,it,Ke)))),Or)break;ze=ze.return}0<Rt.length&&(tt=new vt(tt,Tt,null,v,nt),st.push({event:tt,listeners:Rt}))}}if((y&7)===0){e:{if(tt=p==="mouseover"||p==="pointerover",vt=p==="mouseout"||p==="pointerout",tt&&v!==_t&&(Tt=v.relatedTarget||v.fromElement)&&(tf(Tt)||Tt[Wu]))break e;if((vt||tt)&&(tt=nt.window===nt?nt:(tt=nt.ownerDocument)?tt.defaultView||tt.parentWindow:window,vt?(Tt=v.relatedTarget||v.toElement,vt=Xe,Tt=Tt?tf(Tt):null,Tt!==null&&(Or=Eo(Tt),Tt!==Or||Tt.tag!==5&&Tt.tag!==6)&&(Tt=null)):(vt=null,Tt=Xe),vt!==Tt)){if(Rt=Cv,it="onMouseLeave",Ye="onMouseEnter",ze="mouse",(p==="pointerout"||p==="pointerover")&&(Rt=ke,it="onPointerLeave",Ye="onPointerEnter",ze="pointer"),Or=vt==null?tt:Sm(vt),Ke=Tt==null?tt:Sm(Tt),tt=new Rt(it,ze+"leave",vt,v,nt),tt.target=Or,tt.relatedTarget=Ke,it=null,tf(nt)===Xe&&(Rt=new Rt(Ye,ze+"enter",Tt,v,nt),Rt.target=Ke,Rt.relatedTarget=Or,it=Rt),Or=it,vt&&Tt)t:{for(Rt=vt,Ye=Tt,ze=0,Ke=Rt;Ke;Ke=bm(Ke))ze++;for(Ke=0,it=Ye;it;it=bm(it))Ke++;for(;0<ze-Ke;)Rt=bm(Rt),ze--;for(;0<Ke-ze;)Ye=bm(Ye),Ke--;for(;ze--;){if(Rt===Ye||Ye!==null&&Rt===Ye.alternate)break t;Rt=bm(Rt),Ye=bm(Ye)}Rt=null}else Rt=null;vt!==null&&Y4(st,tt,vt,Rt,!1),Tt!==null&&Or!==null&&Y4(st,Or,Tt,Rt,!0)}}e:{if(tt=Xe?Sm(Xe):window,vt=tt.nodeName&&tt.nodeName.toLowerCase(),vt==="select"||vt==="input"&&tt.type==="file")var Pt=one;else if(Ev(tt))if(E4)Pt=cne;else{Pt=lne;var Wt=ane}else(vt=tt.nodeName)&&vt.toLowerCase()==="input"&&(tt.type==="checkbox"||tt.type==="radio")&&(Pt=une);if(Pt&&(Pt=Pt(p,Xe))){_v(st,Pt,v,nt);break e}Wt&&Wt(p,tt,Xe),p==="focusout"&&(Wt=tt._wrapperState)&&Wt.controlled&&tt.type==="number"&&re(tt,"number",tt.value)}switch(Wt=Xe?Sm(Xe):window,p){case"focusin":(Ev(Wt)||Wt.contentEditable==="true")&&(xm=Wt,EE=Xe,Yy=null);break;case"focusout":Yy=EE=xm=null;break;case"mousedown":_E=!0;break;case"contextmenu":case"mouseup":case"dragend":_E=!1,P4(st,v,nt);break;case"selectionchange":if(fne)break;case"keydown":case"keyup":P4(st,v,nt)}var Gt;if(gt)e:{switch(p){case"compositionstart":var Qt="onCompositionStart";break e;case"compositionend":Qt="onCompositionEnd";break e;case"compositionupdate":Qt="onCompositionUpdate";break e}Qt=void 0}else cn?ki(p,v)&&(Qt="onCompositionEnd"):p==="keydown"&&v.keyCode===229&&(Qt="onCompositionStart");Qt&&(Un&&v.locale!=="ko"&&(cn||Qt!=="onCompositionStart"?Qt==="onCompositionEnd"&&cn&&(Gt=vv()):(Ga=nt,hm="value"in Ga?Ga.value:Ga.textContent,cn=!0)),Wt=Dv(Xe,Qt),0<Wt.length&&(Qt=new Nv(Qt,p,null,v,nt),st.push({event:Qt,listeners:Wt}),Gt?Qt.data=Gt:(Gt=Ds(v),Gt!==null&&(Qt.data=Gt)))),(Gt=on?cs(p,v):Ul(p,v))&&(Xe=Dv(Xe,"onBeforeInput"),0<Xe.length&&(nt=new Nv("onBeforeInput","beforeinput",null,v,nt),st.push({event:nt,listeners:Xe}),nt.data=Gt))}G4(st,y)})}function Xy(p,y,v){return{instance:p,listener:y,currentTarget:v}}function Dv(p,y){for(var v=y+"Capture",A=[];p!==null;){var F=p,Y=F.stateNode;F.tag===5&&Y!==null&&(F=Y,Y=Xn(p,v),Y!=null&&A.unshift(Xy(p,Y,F)),Y=Xn(p,y),Y!=null&&A.push(Xy(p,Y,F))),p=p.return}return A}function bm(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5);return p||null}function Y4(p,y,v,A,F){for(var Y=y._reactName,ue=[];v!==null&&v!==A;){var Te=v,Oe=Te.alternate,Xe=Te.stateNode;if(Oe!==null&&Oe===A)break;Te.tag===5&&Xe!==null&&(Te=Xe,F?(Oe=Xn(v,Y),Oe!=null&&ue.unshift(Xy(v,Oe,Te))):F||(Oe=Xn(v,Y),Oe!=null&&ue.push(Xy(v,Oe,Te)))),v=v.return}ue.length!==0&&p.push({event:y,listeners:ue})}var yne=/\r\n?/g,xne=/\u0000|\uFFFD/g;function K4(p){return(typeof p=="string"?p:""+p).replace(yne,`
`).replace(xne,"")}function Ov(p,y,v){if(y=K4(y),K4(p)!==y&&v)throw Error(n(425))}function Pv(){}var OE=null,PE=null;function FE(p,y){return p==="textarea"||p==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var LE=typeof setTimeout=="function"?setTimeout:void 0,wne=typeof clearTimeout=="function"?clearTimeout:void 0,q4=typeof Promise=="function"?Promise:void 0,bne=typeof queueMicrotask=="function"?queueMicrotask:typeof q4<"u"?function(p){return q4.resolve(null).then(p).catch(vne)}:LE;function vne(p){setTimeout(function(){throw p})}function zE(p,y){var v=y,A=0;do{var F=v.nextSibling;if(p.removeChild(v),F&&F.nodeType===8)if(v=F.data,v==="/$"){if(A===0){p.removeChild(F),Zc(y);return}A--}else v!=="$"&&v!=="$?"&&v!=="$!"||A++;v=F}while(v);Zc(y)}function rd(p){for(;p!=null;p=p.nextSibling){var y=p.nodeType;if(y===1||y===3)break;if(y===8){if(y=p.data,y==="$"||y==="$!"||y==="$?")break;if(y==="/$")return null}}return p}function X4(p){p=p.previousSibling;for(var y=0;p;){if(p.nodeType===8){var v=p.data;if(v==="$"||v==="$!"||v==="$?"){if(y===0)return p;y--}else v==="/$"&&y++}p=p.previousSibling}return null}var vm=Math.random().toString(36).slice(2),Vl="__reactFiber$"+vm,Zy="__reactProps$"+vm,Wu="__reactContainer$"+vm,BE="__reactEvents$"+vm,Sne="__reactListeners$"+vm,Cne="__reactHandles$"+vm;function tf(p){var y=p[Vl];if(y)return y;for(var v=p.parentNode;v;){if(y=v[Wu]||v[Vl]){if(v=y.alternate,y.child!==null||v!==null&&v.child!==null)for(p=X4(p);p!==null;){if(v=p[Vl])return v;p=X4(p)}return y}p=v,v=p.parentNode}return null}function Qy(p){return p=p[Vl]||p[Wu],!p||p.tag!==5&&p.tag!==6&&p.tag!==13&&p.tag!==3?null:p}function Sm(p){if(p.tag===5||p.tag===6)return p.stateNode;throw Error(n(33))}function Fv(p){return p[Zy]||null}var UE=[],Cm=-1;function sd(p){return{current:p}}function rr(p){0>Cm||(p.current=UE[Cm],UE[Cm]=null,Cm--)}function Qn(p,y){Cm++,UE[Cm]=p.current,p.current=y}var id={},Qs=sd(id),Ki=sd(!1),nf=id;function Im(p,y){var v=p.type.contextTypes;if(!v)return id;var A=p.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===y)return A.__reactInternalMemoizedMaskedChildContext;var F={},Y;for(Y in v)F[Y]=y[Y];return A&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=y,p.__reactInternalMemoizedMaskedChildContext=F),F}function qi(p){return p=p.childContextTypes,p!=null}function Lv(){rr(Ki),rr(Qs)}function Z4(p,y,v){if(Qs.current!==id)throw Error(n(168));Qn(Qs,y),Qn(Ki,v)}function Q4(p,y,v){var A=p.stateNode;if(y=y.childContextTypes,typeof A.getChildContext!="function")return v;A=A.getChildContext();for(var F in A)if(!(F in y))throw Error(n(108,Le(p)||"Unknown",F));return fe({},v,A)}function zv(p){return p=(p=p.stateNode)&&p.__reactInternalMemoizedMergedChildContext||id,nf=Qs.current,Qn(Qs,p),Qn(Ki,Ki.current),!0}function J4(p,y,v){var A=p.stateNode;if(!A)throw Error(n(169));v?(p=Q4(p,y,nf),A.__reactInternalMemoizedMergedChildContext=p,rr(Ki),rr(Qs),Qn(Qs,p)):rr(Ki),Qn(Ki,v)}var Gu=null,Bv=!1,VE=!1;function eF(p){Gu===null?Gu=[p]:Gu.push(p)}function Ine(p){Bv=!0,eF(p)}function od(){if(!VE&&Gu!==null){VE=!0;var p=0,y=kn;try{var v=Gu;for(kn=1;p<v.length;p++){var A=v[p];do A=A(!0);while(A!==null)}Gu=null,Bv=!1}catch(F){throw Gu!==null&&(Gu=Gu.slice(p+1)),Cn(en,od),F}finally{kn=y,VE=!1}}return null}var Nm=[],km=0,Uv=null,Vv=0,ta=[],na=0,rf=null,Hu=1,Yu="";function sf(p,y){Nm[km++]=Vv,Nm[km++]=Uv,Uv=p,Vv=y}function tF(p,y,v){ta[na++]=Hu,ta[na++]=Yu,ta[na++]=rf,rf=p;var A=Hu;p=Yu;var F=32-Hi(A)-1;A&=~(1<<F),v+=1;var Y=32-Hi(y)+F;if(30<Y){var ue=F-F%5;Y=(A&(1<<ue)-1).toString(32),A>>=ue,F-=ue,Hu=1<<32-Hi(y)+F|v<<F|A,Yu=Y+p}else Hu=1<<Y|v<<F|A,Yu=p}function jE(p){p.return!==null&&(sf(p,1),tF(p,1,0))}function WE(p){for(;p===Uv;)Uv=Nm[--km],Nm[km]=null,Vv=Nm[--km],Nm[km]=null;for(;p===rf;)rf=ta[--na],ta[na]=null,Yu=ta[--na],ta[na]=null,Hu=ta[--na],ta[na]=null}var _o=null,Ao=null,ur=!1,Ya=null;function nF(p,y){var v=oa(5,null,null,0);v.elementType="DELETED",v.stateNode=y,v.return=p,y=p.deletions,y===null?(p.deletions=[v],p.flags|=16):y.push(v)}function rF(p,y){switch(p.tag){case 5:var v=p.type;return y=y.nodeType!==1||v.toLowerCase()!==y.nodeName.toLowerCase()?null:y,y!==null?(p.stateNode=y,_o=p,Ao=rd(y.firstChild),!0):!1;case 6:return y=p.pendingProps===""||y.nodeType!==3?null:y,y!==null?(p.stateNode=y,_o=p,Ao=null,!0):!1;case 13:return y=y.nodeType!==8?null:y,y!==null?(v=rf!==null?{id:Hu,overflow:Yu}:null,p.memoizedState={dehydrated:y,treeContext:v,retryLane:1073741824},v=oa(18,null,null,0),v.stateNode=y,v.return=p,p.child=v,_o=p,Ao=null,!0):!1;default:return!1}}function GE(p){return(p.mode&1)!==0&&(p.flags&128)===0}function HE(p){if(ur){var y=Ao;if(y){var v=y;if(!rF(p,y)){if(GE(p))throw Error(n(418));y=rd(v.nextSibling);var A=_o;y&&rF(p,y)?nF(A,v):(p.flags=p.flags&-4097|2,ur=!1,_o=p)}}else{if(GE(p))throw Error(n(418));p.flags=p.flags&-4097|2,ur=!1,_o=p}}}function sF(p){for(p=p.return;p!==null&&p.tag!==5&&p.tag!==3&&p.tag!==13;)p=p.return;_o=p}function jv(p){if(p!==_o)return!1;if(!ur)return sF(p),ur=!0,!1;var y;if((y=p.tag!==3)&&!(y=p.tag!==5)&&(y=p.type,y=y!=="head"&&y!=="body"&&!FE(p.type,p.memoizedProps)),y&&(y=Ao)){if(GE(p))throw iF(),Error(n(418));for(;y;)nF(p,y),y=rd(y.nextSibling)}if(sF(p),p.tag===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));e:{for(p=p.nextSibling,y=0;p;){if(p.nodeType===8){var v=p.data;if(v==="/$"){if(y===0){Ao=rd(p.nextSibling);break e}y--}else v!=="$"&&v!=="$!"&&v!=="$?"||y++}p=p.nextSibling}Ao=null}}else Ao=_o?rd(p.stateNode.nextSibling):null;return!0}function iF(){for(var p=Ao;p;)p=rd(p.nextSibling)}function Tm(){Ao=_o=null,ur=!1}function YE(p){Ya===null?Ya=[p]:Ya.push(p)}var Nne=C.ReactCurrentBatchConfig;function Jy(p,y,v){if(p=v.ref,p!==null&&typeof p!="function"&&typeof p!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(n(309));var A=v.stateNode}if(!A)throw Error(n(147,p));var F=A,Y=""+p;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===Y?y.ref:(y=function(ue){var Te=F.refs;ue===null?delete Te[Y]:Te[Y]=ue},y._stringRef=Y,y)}if(typeof p!="string")throw Error(n(284));if(!v._owner)throw Error(n(290,p))}return p}function Wv(p,y){throw p=Object.prototype.toString.call(y),Error(n(31,p==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":p))}function oF(p){var y=p._init;return y(p._payload)}function aF(p){function y(Ye,ze){if(p){var Ke=Ye.deletions;Ke===null?(Ye.deletions=[ze],Ye.flags|=16):Ke.push(ze)}}function v(Ye,ze){if(!p)return null;for(;ze!==null;)y(Ye,ze),ze=ze.sibling;return null}function A(Ye,ze){for(Ye=new Map;ze!==null;)ze.key!==null?Ye.set(ze.key,ze):Ye.set(ze.index,ze),ze=ze.sibling;return Ye}function F(Ye,ze){return Ye=pd(Ye,ze),Ye.index=0,Ye.sibling=null,Ye}function Y(Ye,ze,Ke){return Ye.index=Ke,p?(Ke=Ye.alternate,Ke!==null?(Ke=Ke.index,Ke<ze?(Ye.flags|=2,ze):Ke):(Ye.flags|=2,ze)):(Ye.flags|=1048576,ze)}function ue(Ye){return p&&Ye.alternate===null&&(Ye.flags|=2),Ye}function Te(Ye,ze,Ke,it){return ze===null||ze.tag!==6?(ze=L_(Ke,Ye.mode,it),ze.return=Ye,ze):(ze=F(ze,Ke),ze.return=Ye,ze)}function Oe(Ye,ze,Ke,it){var Pt=Ke.type;return Pt===P?nt(Ye,ze,Ke.props.children,it,Ke.key):ze!==null&&(ze.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===V&&oF(Pt)===ze.type)?(it=F(ze,Ke.props),it.ref=Jy(Ye,ze,Ke),it.return=Ye,it):(it=p2(Ke.type,Ke.key,Ke.props,null,Ye.mode,it),it.ref=Jy(Ye,ze,Ke),it.return=Ye,it)}function Xe(Ye,ze,Ke,it){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==Ke.containerInfo||ze.stateNode.implementation!==Ke.implementation?(ze=z_(Ke,Ye.mode,it),ze.return=Ye,ze):(ze=F(ze,Ke.children||[]),ze.return=Ye,ze)}function nt(Ye,ze,Ke,it,Pt){return ze===null||ze.tag!==7?(ze=ff(Ke,Ye.mode,it,Pt),ze.return=Ye,ze):(ze=F(ze,Ke),ze.return=Ye,ze)}function st(Ye,ze,Ke){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ze=L_(""+ze,Ye.mode,Ke),ze.return=Ye,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case T:return Ke=p2(ze.type,ze.key,ze.props,null,Ye.mode,Ke),Ke.ref=Jy(Ye,null,ze),Ke.return=Ye,Ke;case D:return ze=z_(ze,Ye.mode,Ke),ze.return=Ye,ze;case V:var it=ze._init;return st(Ye,it(ze._payload),Ke)}if(q(ze)||ne(ze))return ze=ff(ze,Ye.mode,Ke,null),ze.return=Ye,ze;Wv(Ye,ze)}return null}function tt(Ye,ze,Ke,it){var Pt=ze!==null?ze.key:null;if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number")return Pt!==null?null:Te(Ye,ze,""+Ke,it);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case T:return Ke.key===Pt?Oe(Ye,ze,Ke,it):null;case D:return Ke.key===Pt?Xe(Ye,ze,Ke,it):null;case V:return Pt=Ke._init,tt(Ye,ze,Pt(Ke._payload),it)}if(q(Ke)||ne(Ke))return Pt!==null?null:nt(Ye,ze,Ke,it,null);Wv(Ye,Ke)}return null}function vt(Ye,ze,Ke,it,Pt){if(typeof it=="string"&&it!==""||typeof it=="number")return Ye=Ye.get(Ke)||null,Te(ze,Ye,""+it,Pt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case T:return Ye=Ye.get(it.key===null?Ke:it.key)||null,Oe(ze,Ye,it,Pt);case D:return Ye=Ye.get(it.key===null?Ke:it.key)||null,Xe(ze,Ye,it,Pt);case V:var Wt=it._init;return vt(Ye,ze,Ke,Wt(it._payload),Pt)}if(q(it)||ne(it))return Ye=Ye.get(Ke)||null,nt(ze,Ye,it,Pt,null);Wv(ze,it)}return null}function Tt(Ye,ze,Ke,it){for(var Pt=null,Wt=null,Gt=ze,Qt=ze=0,Cs=null;Gt!==null&&Qt<Ke.length;Qt++){Gt.index>Qt?(Cs=Gt,Gt=null):Cs=Gt.sibling;var Tn=tt(Ye,Gt,Ke[Qt],it);if(Tn===null){Gt===null&&(Gt=Cs);break}p&&Gt&&Tn.alternate===null&&y(Ye,Gt),ze=Y(Tn,ze,Qt),Wt===null?Pt=Tn:Wt.sibling=Tn,Wt=Tn,Gt=Cs}if(Qt===Ke.length)return v(Ye,Gt),ur&&sf(Ye,Qt),Pt;if(Gt===null){for(;Qt<Ke.length;Qt++)Gt=st(Ye,Ke[Qt],it),Gt!==null&&(ze=Y(Gt,ze,Qt),Wt===null?Pt=Gt:Wt.sibling=Gt,Wt=Gt);return ur&&sf(Ye,Qt),Pt}for(Gt=A(Ye,Gt);Qt<Ke.length;Qt++)Cs=vt(Gt,Ye,Qt,Ke[Qt],it),Cs!==null&&(p&&Cs.alternate!==null&&Gt.delete(Cs.key===null?Qt:Cs.key),ze=Y(Cs,ze,Qt),Wt===null?Pt=Cs:Wt.sibling=Cs,Wt=Cs);return p&&Gt.forEach(function(md){return y(Ye,md)}),ur&&sf(Ye,Qt),Pt}function Rt(Ye,ze,Ke,it){var Pt=ne(Ke);if(typeof Pt!="function")throw Error(n(150));if(Ke=Pt.call(Ke),Ke==null)throw Error(n(151));for(var Wt=Pt=null,Gt=ze,Qt=ze=0,Cs=null,Tn=Ke.next();Gt!==null&&!Tn.done;Qt++,Tn=Ke.next()){Gt.index>Qt?(Cs=Gt,Gt=null):Cs=Gt.sibling;var md=tt(Ye,Gt,Tn.value,it);if(md===null){Gt===null&&(Gt=Cs);break}p&&Gt&&md.alternate===null&&y(Ye,Gt),ze=Y(md,ze,Qt),Wt===null?Pt=md:Wt.sibling=md,Wt=md,Gt=Cs}if(Tn.done)return v(Ye,Gt),ur&&sf(Ye,Qt),Pt;if(Gt===null){for(;!Tn.done;Qt++,Tn=Ke.next())Tn=st(Ye,Tn.value,it),Tn!==null&&(ze=Y(Tn,ze,Qt),Wt===null?Pt=Tn:Wt.sibling=Tn,Wt=Tn);return ur&&sf(Ye,Qt),Pt}for(Gt=A(Ye,Gt);!Tn.done;Qt++,Tn=Ke.next())Tn=vt(Gt,Ye,Qt,Tn.value,it),Tn!==null&&(p&&Tn.alternate!==null&&Gt.delete(Tn.key===null?Qt:Tn.key),ze=Y(Tn,ze,Qt),Wt===null?Pt=Tn:Wt.sibling=Tn,Wt=Tn);return p&&Gt.forEach(function(sre){return y(Ye,sre)}),ur&&sf(Ye,Qt),Pt}function Or(Ye,ze,Ke,it){if(typeof Ke=="object"&&Ke!==null&&Ke.type===P&&Ke.key===null&&(Ke=Ke.props.children),typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case T:e:{for(var Pt=Ke.key,Wt=ze;Wt!==null;){if(Wt.key===Pt){if(Pt=Ke.type,Pt===P){if(Wt.tag===7){v(Ye,Wt.sibling),ze=F(Wt,Ke.props.children),ze.return=Ye,Ye=ze;break e}}else if(Wt.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===V&&oF(Pt)===Wt.type){v(Ye,Wt.sibling),ze=F(Wt,Ke.props),ze.ref=Jy(Ye,Wt,Ke),ze.return=Ye,Ye=ze;break e}v(Ye,Wt);break}else y(Ye,Wt);Wt=Wt.sibling}Ke.type===P?(ze=ff(Ke.props.children,Ye.mode,it,Ke.key),ze.return=Ye,Ye=ze):(it=p2(Ke.type,Ke.key,Ke.props,null,Ye.mode,it),it.ref=Jy(Ye,ze,Ke),it.return=Ye,Ye=it)}return ue(Ye);case D:e:{for(Wt=Ke.key;ze!==null;){if(ze.key===Wt)if(ze.tag===4&&ze.stateNode.containerInfo===Ke.containerInfo&&ze.stateNode.implementation===Ke.implementation){v(Ye,ze.sibling),ze=F(ze,Ke.children||[]),ze.return=Ye,Ye=ze;break e}else{v(Ye,ze);break}else y(Ye,ze);ze=ze.sibling}ze=z_(Ke,Ye.mode,it),ze.return=Ye,Ye=ze}return ue(Ye);case V:return Wt=Ke._init,Or(Ye,ze,Wt(Ke._payload),it)}if(q(Ke))return Tt(Ye,ze,Ke,it);if(ne(Ke))return Rt(Ye,ze,Ke,it);Wv(Ye,Ke)}return typeof Ke=="string"&&Ke!==""||typeof Ke=="number"?(Ke=""+Ke,ze!==null&&ze.tag===6?(v(Ye,ze.sibling),ze=F(ze,Ke),ze.return=Ye,Ye=ze):(v(Ye,ze),ze=L_(Ke,Ye.mode,it),ze.return=Ye,Ye=ze),ue(Ye)):v(Ye,ze)}return Or}var Em=aF(!0),lF=aF(!1),Gv=sd(null),Hv=null,_m=null,KE=null;function qE(){KE=_m=Hv=null}function XE(p){var y=Gv.current;rr(Gv),p._currentValue=y}function ZE(p,y,v){for(;p!==null;){var A=p.alternate;if((p.childLanes&y)!==y?(p.childLanes|=y,A!==null&&(A.childLanes|=y)):A!==null&&(A.childLanes&y)!==y&&(A.childLanes|=y),p===v)break;p=p.return}}function Am(p,y){Hv=p,KE=_m=null,p=p.dependencies,p!==null&&p.firstContext!==null&&((p.lanes&y)!==0&&(Xi=!0),p.firstContext=null)}function ra(p){var y=p._currentValue;if(KE!==p)if(p={context:p,memoizedValue:y,next:null},_m===null){if(Hv===null)throw Error(n(308));_m=p,Hv.dependencies={lanes:0,firstContext:p}}else _m=_m.next=p;return y}var of=null;function QE(p){of===null?of=[p]:of.push(p)}function uF(p,y,v,A){var F=y.interleaved;return F===null?(v.next=v,QE(y)):(v.next=F.next,F.next=v),y.interleaved=v,Ku(p,A)}function Ku(p,y){p.lanes|=y;var v=p.alternate;for(v!==null&&(v.lanes|=y),v=p,p=p.return;p!==null;)p.childLanes|=y,v=p.alternate,v!==null&&(v.childLanes|=y),v=p,p=p.return;return v.tag===3?v.stateNode:null}var ad=!1;function JE(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cF(p,y){p=p.updateQueue,y.updateQueue===p&&(y.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,effects:p.effects})}function qu(p,y){return{eventTime:p,lane:y,tag:0,payload:null,callback:null,next:null}}function ld(p,y,v){var A=p.updateQueue;if(A===null)return null;if(A=A.shared,(In&2)!==0){var F=A.pending;return F===null?y.next=y:(y.next=F.next,F.next=y),A.pending=y,Ku(p,v)}return F=A.interleaved,F===null?(y.next=y,QE(A)):(y.next=F.next,F.next=y),A.interleaved=y,Ku(p,v)}function Yv(p,y,v){if(y=y.updateQueue,y!==null&&(y=y.shared,(v&4194240)!==0)){var A=y.lanes;A&=p.pendingLanes,v|=A,y.lanes=v,Ly(p,v)}}function dF(p,y){var v=p.updateQueue,A=p.alternate;if(A!==null&&(A=A.updateQueue,v===A)){var F=null,Y=null;if(v=v.firstBaseUpdate,v!==null){do{var ue={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};Y===null?F=Y=ue:Y=Y.next=ue,v=v.next}while(v!==null);Y===null?F=Y=y:Y=Y.next=y}else F=Y=y;v={baseState:A.baseState,firstBaseUpdate:F,lastBaseUpdate:Y,shared:A.shared,effects:A.effects},p.updateQueue=v;return}p=v.lastBaseUpdate,p===null?v.firstBaseUpdate=y:p.next=y,v.lastBaseUpdate=y}function Kv(p,y,v,A){var F=p.updateQueue;ad=!1;var Y=F.firstBaseUpdate,ue=F.lastBaseUpdate,Te=F.shared.pending;if(Te!==null){F.shared.pending=null;var Oe=Te,Xe=Oe.next;Oe.next=null,ue===null?Y=Xe:ue.next=Xe,ue=Oe;var nt=p.alternate;nt!==null&&(nt=nt.updateQueue,Te=nt.lastBaseUpdate,Te!==ue&&(Te===null?nt.firstBaseUpdate=Xe:Te.next=Xe,nt.lastBaseUpdate=Oe))}if(Y!==null){var st=F.baseState;ue=0,nt=Xe=Oe=null,Te=Y;do{var tt=Te.lane,vt=Te.eventTime;if((A&tt)===tt){nt!==null&&(nt=nt.next={eventTime:vt,lane:0,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null});e:{var Tt=p,Rt=Te;switch(tt=y,vt=v,Rt.tag){case 1:if(Tt=Rt.payload,typeof Tt=="function"){st=Tt.call(vt,st,tt);break e}st=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Rt.payload,tt=typeof Tt=="function"?Tt.call(vt,st,tt):Tt,tt==null)break e;st=fe({},st,tt);break e;case 2:ad=!0}}Te.callback!==null&&Te.lane!==0&&(p.flags|=64,tt=F.effects,tt===null?F.effects=[Te]:tt.push(Te))}else vt={eventTime:vt,lane:tt,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null},nt===null?(Xe=nt=vt,Oe=st):nt=nt.next=vt,ue|=tt;if(Te=Te.next,Te===null){if(Te=F.shared.pending,Te===null)break;tt=Te,Te=tt.next,tt.next=null,F.lastBaseUpdate=tt,F.shared.pending=null}}while(!0);if(nt===null&&(Oe=st),F.baseState=Oe,F.firstBaseUpdate=Xe,F.lastBaseUpdate=nt,y=F.shared.interleaved,y!==null){F=y;do ue|=F.lane,F=F.next;while(F!==y)}else Y===null&&(F.shared.lanes=0);uf|=ue,p.lanes=ue,p.memoizedState=st}}function hF(p,y,v){if(p=y.effects,y.effects=null,p!==null)for(y=0;y<p.length;y++){var A=p[y],F=A.callback;if(F!==null){if(A.callback=null,A=v,typeof F!="function")throw Error(n(191,F));F.call(A)}}}var ex={},jl=sd(ex),tx=sd(ex),nx=sd(ex);function af(p){if(p===ex)throw Error(n(174));return p}function e_(p,y){switch(Qn(nx,y),Qn(tx,p),Qn(jl,ex),p=y.nodeType,p){case 9:case 11:y=(y=y.documentElement)?y.namespaceURI:N(null,"");break;default:p=p===8?y.parentNode:y,y=p.namespaceURI||null,p=p.tagName,y=N(y,p)}rr(jl),Qn(jl,y)}function $m(){rr(jl),rr(tx),rr(nx)}function fF(p){af(nx.current);var y=af(jl.current),v=N(y,p.type);y!==v&&(Qn(tx,p),Qn(jl,v))}function t_(p){tx.current===p&&(rr(jl),rr(tx))}var mr=sd(0);function qv(p){for(var y=p;y!==null;){if(y.tag===13){var v=y.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var n_=[];function r_(){for(var p=0;p<n_.length;p++)n_[p]._workInProgressVersionPrimary=null;n_.length=0}var Xv=C.ReactCurrentDispatcher,s_=C.ReactCurrentBatchConfig,lf=0,gr=null,ds=null,vs=null,Zv=!1,rx=!1,sx=0,kne=0;function Js(){throw Error(n(321))}function i_(p,y){if(y===null)return!1;for(var v=0;v<y.length&&v<p.length;v++)if(!Ha(p[v],y[v]))return!1;return!0}function o_(p,y,v,A,F,Y){if(lf=Y,gr=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,Xv.current=p===null||p.memoizedState===null?Ane:$ne,p=v(A,F),rx){Y=0;do{if(rx=!1,sx=0,25<=Y)throw Error(n(301));Y+=1,vs=ds=null,y.updateQueue=null,Xv.current=Rne,p=v(A,F)}while(rx)}if(Xv.current=e2,y=ds!==null&&ds.next!==null,lf=0,vs=ds=gr=null,Zv=!1,y)throw Error(n(300));return p}function a_(){var p=sx!==0;return sx=0,p}function Wl(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vs===null?gr.memoizedState=vs=p:vs=vs.next=p,vs}function sa(){if(ds===null){var p=gr.alternate;p=p!==null?p.memoizedState:null}else p=ds.next;var y=vs===null?gr.memoizedState:vs.next;if(y!==null)vs=y,ds=p;else{if(p===null)throw Error(n(310));ds=p,p={memoizedState:ds.memoizedState,baseState:ds.baseState,baseQueue:ds.baseQueue,queue:ds.queue,next:null},vs===null?gr.memoizedState=vs=p:vs=vs.next=p}return vs}function ix(p,y){return typeof y=="function"?y(p):y}function l_(p){var y=sa(),v=y.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=p;var A=ds,F=A.baseQueue,Y=v.pending;if(Y!==null){if(F!==null){var ue=F.next;F.next=Y.next,Y.next=ue}A.baseQueue=F=Y,v.pending=null}if(F!==null){Y=F.next,A=A.baseState;var Te=ue=null,Oe=null,Xe=Y;do{var nt=Xe.lane;if((lf&nt)===nt)Oe!==null&&(Oe=Oe.next={lane:0,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null}),A=Xe.hasEagerState?Xe.eagerState:p(A,Xe.action);else{var st={lane:nt,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null};Oe===null?(Te=Oe=st,ue=A):Oe=Oe.next=st,gr.lanes|=nt,uf|=nt}Xe=Xe.next}while(Xe!==null&&Xe!==Y);Oe===null?ue=A:Oe.next=Te,Ha(A,y.memoizedState)||(Xi=!0),y.memoizedState=A,y.baseState=ue,y.baseQueue=Oe,v.lastRenderedState=A}if(p=v.interleaved,p!==null){F=p;do Y=F.lane,gr.lanes|=Y,uf|=Y,F=F.next;while(F!==p)}else F===null&&(v.lanes=0);return[y.memoizedState,v.dispatch]}function u_(p){var y=sa(),v=y.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=p;var A=v.dispatch,F=v.pending,Y=y.memoizedState;if(F!==null){v.pending=null;var ue=F=F.next;do Y=p(Y,ue.action),ue=ue.next;while(ue!==F);Ha(Y,y.memoizedState)||(Xi=!0),y.memoizedState=Y,y.baseQueue===null&&(y.baseState=Y),v.lastRenderedState=Y}return[Y,A]}function pF(){}function mF(p,y){var v=gr,A=sa(),F=y(),Y=!Ha(A.memoizedState,F);if(Y&&(A.memoizedState=F,Xi=!0),A=A.queue,c_(xF.bind(null,v,A,p),[p]),A.getSnapshot!==y||Y||vs!==null&&vs.memoizedState.tag&1){if(v.flags|=2048,ox(9,yF.bind(null,v,A,F,y),void 0,null),Ss===null)throw Error(n(349));(lf&30)!==0||gF(v,y,F)}return F}function gF(p,y,v){p.flags|=16384,p={getSnapshot:y,value:v},y=gr.updateQueue,y===null?(y={lastEffect:null,stores:null},gr.updateQueue=y,y.stores=[p]):(v=y.stores,v===null?y.stores=[p]:v.push(p))}function yF(p,y,v,A){y.value=v,y.getSnapshot=A,wF(y)&&bF(p)}function xF(p,y,v){return v(function(){wF(y)&&bF(p)})}function wF(p){var y=p.getSnapshot;p=p.value;try{var v=y();return!Ha(p,v)}catch{return!0}}function bF(p){var y=Ku(p,1);y!==null&&Za(y,p,1,-1)}function vF(p){var y=Wl();return typeof p=="function"&&(p=p()),y.memoizedState=y.baseState=p,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ix,lastRenderedState:p},y.queue=p,p=p.dispatch=_ne.bind(null,gr,p),[y.memoizedState,p]}function ox(p,y,v,A){return p={tag:p,create:y,destroy:v,deps:A,next:null},y=gr.updateQueue,y===null?(y={lastEffect:null,stores:null},gr.updateQueue=y,y.lastEffect=p.next=p):(v=y.lastEffect,v===null?y.lastEffect=p.next=p:(A=v.next,v.next=p,p.next=A,y.lastEffect=p)),p}function SF(){return sa().memoizedState}function Qv(p,y,v,A){var F=Wl();gr.flags|=p,F.memoizedState=ox(1|y,v,void 0,A===void 0?null:A)}function Jv(p,y,v,A){var F=sa();A=A===void 0?null:A;var Y=void 0;if(ds!==null){var ue=ds.memoizedState;if(Y=ue.destroy,A!==null&&i_(A,ue.deps)){F.memoizedState=ox(y,v,Y,A);return}}gr.flags|=p,F.memoizedState=ox(1|y,v,Y,A)}function CF(p,y){return Qv(8390656,8,p,y)}function c_(p,y){return Jv(2048,8,p,y)}function IF(p,y){return Jv(4,2,p,y)}function NF(p,y){return Jv(4,4,p,y)}function kF(p,y){if(typeof y=="function")return p=p(),y(p),function(){y(null)};if(y!=null)return p=p(),y.current=p,function(){y.current=null}}function TF(p,y,v){return v=v!=null?v.concat([p]):null,Jv(4,4,kF.bind(null,y,p),v)}function d_(){}function EF(p,y){var v=sa();y=y===void 0?null:y;var A=v.memoizedState;return A!==null&&y!==null&&i_(y,A[1])?A[0]:(v.memoizedState=[p,y],p)}function _F(p,y){var v=sa();y=y===void 0?null:y;var A=v.memoizedState;return A!==null&&y!==null&&i_(y,A[1])?A[0]:(p=p(),v.memoizedState=[p,y],p)}function AF(p,y,v){return(lf&21)===0?(p.baseState&&(p.baseState=!1,Xi=!0),p.memoizedState=v):(Ha(v,y)||(v=Gh(),gr.lanes|=v,uf|=v,p.baseState=!0),y)}function Tne(p,y){var v=kn;kn=v!==0&&4>v?v:4,p(!0);var A=s_.transition;s_.transition={};try{p(!1),y()}finally{kn=v,s_.transition=A}}function $F(){return sa().memoizedState}function Ene(p,y,v){var A=hd(p);if(v={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null},RF(p))MF(y,v);else if(v=uF(p,y,v,A),v!==null){var F=Ei();Za(v,p,A,F),DF(v,y,A)}}function _ne(p,y,v){var A=hd(p),F={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null};if(RF(p))MF(y,F);else{var Y=p.alternate;if(p.lanes===0&&(Y===null||Y.lanes===0)&&(Y=y.lastRenderedReducer,Y!==null))try{var ue=y.lastRenderedState,Te=Y(ue,v);if(F.hasEagerState=!0,F.eagerState=Te,Ha(Te,ue)){var Oe=y.interleaved;Oe===null?(F.next=F,QE(y)):(F.next=Oe.next,Oe.next=F),y.interleaved=F;return}}catch{}finally{}v=uF(p,y,F,A),v!==null&&(F=Ei(),Za(v,p,A,F),DF(v,y,A))}}function RF(p){var y=p.alternate;return p===gr||y!==null&&y===gr}function MF(p,y){rx=Zv=!0;var v=p.pending;v===null?y.next=y:(y.next=v.next,v.next=y),p.pending=y}function DF(p,y,v){if((v&4194240)!==0){var A=y.lanes;A&=p.pendingLanes,v|=A,y.lanes=v,Ly(p,v)}}var e2={readContext:ra,useCallback:Js,useContext:Js,useEffect:Js,useImperativeHandle:Js,useInsertionEffect:Js,useLayoutEffect:Js,useMemo:Js,useReducer:Js,useRef:Js,useState:Js,useDebugValue:Js,useDeferredValue:Js,useTransition:Js,useMutableSource:Js,useSyncExternalStore:Js,useId:Js,unstable_isNewReconciler:!1},Ane={readContext:ra,useCallback:function(p,y){return Wl().memoizedState=[p,y===void 0?null:y],p},useContext:ra,useEffect:CF,useImperativeHandle:function(p,y,v){return v=v!=null?v.concat([p]):null,Qv(4194308,4,kF.bind(null,y,p),v)},useLayoutEffect:function(p,y){return Qv(4194308,4,p,y)},useInsertionEffect:function(p,y){return Qv(4,2,p,y)},useMemo:function(p,y){var v=Wl();return y=y===void 0?null:y,p=p(),v.memoizedState=[p,y],p},useReducer:function(p,y,v){var A=Wl();return y=v!==void 0?v(y):y,A.memoizedState=A.baseState=y,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:y},A.queue=p,p=p.dispatch=Ene.bind(null,gr,p),[A.memoizedState,p]},useRef:function(p){var y=Wl();return p={current:p},y.memoizedState=p},useState:vF,useDebugValue:d_,useDeferredValue:function(p){return Wl().memoizedState=p},useTransition:function(){var p=vF(!1),y=p[0];return p=Tne.bind(null,p[1]),Wl().memoizedState=p,[y,p]},useMutableSource:function(){},useSyncExternalStore:function(p,y,v){var A=gr,F=Wl();if(ur){if(v===void 0)throw Error(n(407));v=v()}else{if(v=y(),Ss===null)throw Error(n(349));(lf&30)!==0||gF(A,y,v)}F.memoizedState=v;var Y={value:v,getSnapshot:y};return F.queue=Y,CF(xF.bind(null,A,Y,p),[p]),A.flags|=2048,ox(9,yF.bind(null,A,Y,v,y),void 0,null),v},useId:function(){var p=Wl(),y=Ss.identifierPrefix;if(ur){var v=Yu,A=Hu;v=(A&~(1<<32-Hi(A)-1)).toString(32)+v,y=":"+y+"R"+v,v=sx++,0<v&&(y+="H"+v.toString(32)),y+=":"}else v=kne++,y=":"+y+"r"+v.toString(32)+":";return p.memoizedState=y},unstable_isNewReconciler:!1},$ne={readContext:ra,useCallback:EF,useContext:ra,useEffect:c_,useImperativeHandle:TF,useInsertionEffect:IF,useLayoutEffect:NF,useMemo:_F,useReducer:l_,useRef:SF,useState:function(){return l_(ix)},useDebugValue:d_,useDeferredValue:function(p){var y=sa();return AF(y,ds.memoizedState,p)},useTransition:function(){var p=l_(ix)[0],y=sa().memoizedState;return[p,y]},useMutableSource:pF,useSyncExternalStore:mF,useId:$F,unstable_isNewReconciler:!1},Rne={readContext:ra,useCallback:EF,useContext:ra,useEffect:c_,useImperativeHandle:TF,useInsertionEffect:IF,useLayoutEffect:NF,useMemo:_F,useReducer:u_,useRef:SF,useState:function(){return u_(ix)},useDebugValue:d_,useDeferredValue:function(p){var y=sa();return ds===null?y.memoizedState=p:AF(y,ds.memoizedState,p)},useTransition:function(){var p=u_(ix)[0],y=sa().memoizedState;return[p,y]},useMutableSource:pF,useSyncExternalStore:mF,useId:$F,unstable_isNewReconciler:!1};function Ka(p,y){if(p&&p.defaultProps){y=fe({},y),p=p.defaultProps;for(var v in p)y[v]===void 0&&(y[v]=p[v]);return y}return y}function h_(p,y,v,A){y=p.memoizedState,v=v(A,y),v=v==null?y:fe({},y,v),p.memoizedState=v,p.lanes===0&&(p.updateQueue.baseState=v)}var t2={isMounted:function(p){return(p=p._reactInternals)?Eo(p)===p:!1},enqueueSetState:function(p,y,v){p=p._reactInternals;var A=Ei(),F=hd(p),Y=qu(A,F);Y.payload=y,v!=null&&(Y.callback=v),y=ld(p,Y,F),y!==null&&(Za(y,p,F,A),Yv(y,p,F))},enqueueReplaceState:function(p,y,v){p=p._reactInternals;var A=Ei(),F=hd(p),Y=qu(A,F);Y.tag=1,Y.payload=y,v!=null&&(Y.callback=v),y=ld(p,Y,F),y!==null&&(Za(y,p,F,A),Yv(y,p,F))},enqueueForceUpdate:function(p,y){p=p._reactInternals;var v=Ei(),A=hd(p),F=qu(v,A);F.tag=2,y!=null&&(F.callback=y),y=ld(p,F,A),y!==null&&(Za(y,p,A,v),Yv(y,p,A))}};function OF(p,y,v,A,F,Y,ue){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(A,Y,ue):y.prototype&&y.prototype.isPureReactComponent?!Hy(v,A)||!Hy(F,Y):!0}function PF(p,y,v){var A=!1,F=id,Y=y.contextType;return typeof Y=="object"&&Y!==null?Y=ra(Y):(F=qi(y)?nf:Qs.current,A=y.contextTypes,Y=(A=A!=null)?Im(p,F):id),y=new y(v,Y),p.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=t2,p.stateNode=y,y._reactInternals=p,A&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=F,p.__reactInternalMemoizedMaskedChildContext=Y),y}function FF(p,y,v,A){p=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(v,A),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(v,A),y.state!==p&&t2.enqueueReplaceState(y,y.state,null)}function f_(p,y,v,A){var F=p.stateNode;F.props=v,F.state=p.memoizedState,F.refs={},JE(p);var Y=y.contextType;typeof Y=="object"&&Y!==null?F.context=ra(Y):(Y=qi(y)?nf:Qs.current,F.context=Im(p,Y)),F.state=p.memoizedState,Y=y.getDerivedStateFromProps,typeof Y=="function"&&(h_(p,y,Y,v),F.state=p.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(y=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),y!==F.state&&t2.enqueueReplaceState(F,F.state,null),Kv(p,v,F,A),F.state=p.memoizedState),typeof F.componentDidMount=="function"&&(p.flags|=4194308)}function Rm(p,y){try{var v="",A=y;do v+=we(A),A=A.return;while(A);var F=v}catch(Y){F=`
Error generating stack: `+Y.message+`
`+Y.stack}return{value:p,source:y,stack:F,digest:null}}function p_(p,y,v){return{value:p,source:null,stack:v??null,digest:y??null}}function m_(p,y){try{console.error(y.value)}catch(v){setTimeout(function(){throw v})}}var Mne=typeof WeakMap=="function"?WeakMap:Map;function LF(p,y,v){v=qu(-1,v),v.tag=3,v.payload={element:null};var A=y.value;return v.callback=function(){l2||(l2=!0,A_=A),m_(p,y)},v}function zF(p,y,v){v=qu(-1,v),v.tag=3;var A=p.type.getDerivedStateFromError;if(typeof A=="function"){var F=y.value;v.payload=function(){return A(F)},v.callback=function(){m_(p,y)}}var Y=p.stateNode;return Y!==null&&typeof Y.componentDidCatch=="function"&&(v.callback=function(){m_(p,y),typeof A!="function"&&(cd===null?cd=new Set([this]):cd.add(this));var ue=y.stack;this.componentDidCatch(y.value,{componentStack:ue!==null?ue:""})}),v}function BF(p,y,v){var A=p.pingCache;if(A===null){A=p.pingCache=new Mne;var F=new Set;A.set(y,F)}else F=A.get(y),F===void 0&&(F=new Set,A.set(y,F));F.has(v)||(F.add(v),p=Yne.bind(null,p,y,v),y.then(p,p))}function UF(p){do{var y;if((y=p.tag===13)&&(y=p.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return p;p=p.return}while(p!==null);return null}function VF(p,y,v,A,F){return(p.mode&1)===0?(p===y?p.flags|=65536:(p.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(y=qu(-1,1),y.tag=2,ld(v,y,1))),v.lanes|=1),p):(p.flags|=65536,p.lanes=F,p)}var Dne=C.ReactCurrentOwner,Xi=!1;function Ti(p,y,v,A){y.child=p===null?lF(y,null,v,A):Em(y,p.child,v,A)}function jF(p,y,v,A,F){v=v.render;var Y=y.ref;return Am(y,F),A=o_(p,y,v,A,Y,F),v=a_(),p!==null&&!Xi?(y.updateQueue=p.updateQueue,y.flags&=-2053,p.lanes&=~F,Xu(p,y,F)):(ur&&v&&jE(y),y.flags|=1,Ti(p,y,A,F),y.child)}function WF(p,y,v,A,F){if(p===null){var Y=v.type;return typeof Y=="function"&&!F_(Y)&&Y.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(y.tag=15,y.type=Y,GF(p,y,Y,A,F)):(p=p2(v.type,null,A,y,y.mode,F),p.ref=y.ref,p.return=y,y.child=p)}if(Y=p.child,(p.lanes&F)===0){var ue=Y.memoizedProps;if(v=v.compare,v=v!==null?v:Hy,v(ue,A)&&p.ref===y.ref)return Xu(p,y,F)}return y.flags|=1,p=pd(Y,A),p.ref=y.ref,p.return=y,y.child=p}function GF(p,y,v,A,F){if(p!==null){var Y=p.memoizedProps;if(Hy(Y,A)&&p.ref===y.ref)if(Xi=!1,y.pendingProps=A=Y,(p.lanes&F)!==0)(p.flags&131072)!==0&&(Xi=!0);else return y.lanes=p.lanes,Xu(p,y,F)}return g_(p,y,v,A,F)}function HF(p,y,v){var A=y.pendingProps,F=A.children,Y=p!==null?p.memoizedState:null;if(A.mode==="hidden")if((y.mode&1)===0)y.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qn(Dm,$o),$o|=v;else{if((v&1073741824)===0)return p=Y!==null?Y.baseLanes|v:v,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:p,cachePool:null,transitions:null},y.updateQueue=null,Qn(Dm,$o),$o|=p,null;y.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=Y!==null?Y.baseLanes:v,Qn(Dm,$o),$o|=A}else Y!==null?(A=Y.baseLanes|v,y.memoizedState=null):A=v,Qn(Dm,$o),$o|=A;return Ti(p,y,F,v),y.child}function YF(p,y){var v=y.ref;(p===null&&v!==null||p!==null&&p.ref!==v)&&(y.flags|=512,y.flags|=2097152)}function g_(p,y,v,A,F){var Y=qi(v)?nf:Qs.current;return Y=Im(y,Y),Am(y,F),v=o_(p,y,v,A,Y,F),A=a_(),p!==null&&!Xi?(y.updateQueue=p.updateQueue,y.flags&=-2053,p.lanes&=~F,Xu(p,y,F)):(ur&&A&&jE(y),y.flags|=1,Ti(p,y,v,F),y.child)}function KF(p,y,v,A,F){if(qi(v)){var Y=!0;zv(y)}else Y=!1;if(Am(y,F),y.stateNode===null)r2(p,y),PF(y,v,A),f_(y,v,A,F),A=!0;else if(p===null){var ue=y.stateNode,Te=y.memoizedProps;ue.props=Te;var Oe=ue.context,Xe=v.contextType;typeof Xe=="object"&&Xe!==null?Xe=ra(Xe):(Xe=qi(v)?nf:Qs.current,Xe=Im(y,Xe));var nt=v.getDerivedStateFromProps,st=typeof nt=="function"||typeof ue.getSnapshotBeforeUpdate=="function";st||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(Te!==A||Oe!==Xe)&&FF(y,ue,A,Xe),ad=!1;var tt=y.memoizedState;ue.state=tt,Kv(y,A,ue,F),Oe=y.memoizedState,Te!==A||tt!==Oe||Ki.current||ad?(typeof nt=="function"&&(h_(y,v,nt,A),Oe=y.memoizedState),(Te=ad||OF(y,v,Te,A,tt,Oe,Xe))?(st||typeof ue.UNSAFE_componentWillMount!="function"&&typeof ue.componentWillMount!="function"||(typeof ue.componentWillMount=="function"&&ue.componentWillMount(),typeof ue.UNSAFE_componentWillMount=="function"&&ue.UNSAFE_componentWillMount()),typeof ue.componentDidMount=="function"&&(y.flags|=4194308)):(typeof ue.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=A,y.memoizedState=Oe),ue.props=A,ue.state=Oe,ue.context=Xe,A=Te):(typeof ue.componentDidMount=="function"&&(y.flags|=4194308),A=!1)}else{ue=y.stateNode,cF(p,y),Te=y.memoizedProps,Xe=y.type===y.elementType?Te:Ka(y.type,Te),ue.props=Xe,st=y.pendingProps,tt=ue.context,Oe=v.contextType,typeof Oe=="object"&&Oe!==null?Oe=ra(Oe):(Oe=qi(v)?nf:Qs.current,Oe=Im(y,Oe));var vt=v.getDerivedStateFromProps;(nt=typeof vt=="function"||typeof ue.getSnapshotBeforeUpdate=="function")||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(Te!==st||tt!==Oe)&&FF(y,ue,A,Oe),ad=!1,tt=y.memoizedState,ue.state=tt,Kv(y,A,ue,F);var Tt=y.memoizedState;Te!==st||tt!==Tt||Ki.current||ad?(typeof vt=="function"&&(h_(y,v,vt,A),Tt=y.memoizedState),(Xe=ad||OF(y,v,Xe,A,tt,Tt,Oe)||!1)?(nt||typeof ue.UNSAFE_componentWillUpdate!="function"&&typeof ue.componentWillUpdate!="function"||(typeof ue.componentWillUpdate=="function"&&ue.componentWillUpdate(A,Tt,Oe),typeof ue.UNSAFE_componentWillUpdate=="function"&&ue.UNSAFE_componentWillUpdate(A,Tt,Oe)),typeof ue.componentDidUpdate=="function"&&(y.flags|=4),typeof ue.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof ue.componentDidUpdate!="function"||Te===p.memoizedProps&&tt===p.memoizedState||(y.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||Te===p.memoizedProps&&tt===p.memoizedState||(y.flags|=1024),y.memoizedProps=A,y.memoizedState=Tt),ue.props=A,ue.state=Tt,ue.context=Oe,A=Xe):(typeof ue.componentDidUpdate!="function"||Te===p.memoizedProps&&tt===p.memoizedState||(y.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||Te===p.memoizedProps&&tt===p.memoizedState||(y.flags|=1024),A=!1)}return y_(p,y,v,A,Y,F)}function y_(p,y,v,A,F,Y){YF(p,y);var ue=(y.flags&128)!==0;if(!A&&!ue)return F&&J4(y,v,!1),Xu(p,y,Y);A=y.stateNode,Dne.current=y;var Te=ue&&typeof v.getDerivedStateFromError!="function"?null:A.render();return y.flags|=1,p!==null&&ue?(y.child=Em(y,p.child,null,Y),y.child=Em(y,null,Te,Y)):Ti(p,y,Te,Y),y.memoizedState=A.state,F&&J4(y,v,!0),y.child}function qF(p){var y=p.stateNode;y.pendingContext?Z4(p,y.pendingContext,y.pendingContext!==y.context):y.context&&Z4(p,y.context,!1),e_(p,y.containerInfo)}function XF(p,y,v,A,F){return Tm(),YE(F),y.flags|=256,Ti(p,y,v,A),y.child}var x_={dehydrated:null,treeContext:null,retryLane:0};function w_(p){return{baseLanes:p,cachePool:null,transitions:null}}function ZF(p,y,v){var A=y.pendingProps,F=mr.current,Y=!1,ue=(y.flags&128)!==0,Te;if((Te=ue)||(Te=p!==null&&p.memoizedState===null?!1:(F&2)!==0),Te?(Y=!0,y.flags&=-129):(p===null||p.memoizedState!==null)&&(F|=1),Qn(mr,F&1),p===null)return HE(y),p=y.memoizedState,p!==null&&(p=p.dehydrated,p!==null)?((y.mode&1)===0?y.lanes=1:p.data==="$!"?y.lanes=8:y.lanes=1073741824,null):(ue=A.children,p=A.fallback,Y?(A=y.mode,Y=y.child,ue={mode:"hidden",children:ue},(A&1)===0&&Y!==null?(Y.childLanes=0,Y.pendingProps=ue):Y=m2(ue,A,0,null),p=ff(p,A,v,null),Y.return=y,p.return=y,Y.sibling=p,y.child=Y,y.child.memoizedState=w_(v),y.memoizedState=x_,p):b_(y,ue));if(F=p.memoizedState,F!==null&&(Te=F.dehydrated,Te!==null))return One(p,y,ue,A,Te,F,v);if(Y){Y=A.fallback,ue=y.mode,F=p.child,Te=F.sibling;var Oe={mode:"hidden",children:A.children};return(ue&1)===0&&y.child!==F?(A=y.child,A.childLanes=0,A.pendingProps=Oe,y.deletions=null):(A=pd(F,Oe),A.subtreeFlags=F.subtreeFlags&14680064),Te!==null?Y=pd(Te,Y):(Y=ff(Y,ue,v,null),Y.flags|=2),Y.return=y,A.return=y,A.sibling=Y,y.child=A,A=Y,Y=y.child,ue=p.child.memoizedState,ue=ue===null?w_(v):{baseLanes:ue.baseLanes|v,cachePool:null,transitions:ue.transitions},Y.memoizedState=ue,Y.childLanes=p.childLanes&~v,y.memoizedState=x_,A}return Y=p.child,p=Y.sibling,A=pd(Y,{mode:"visible",children:A.children}),(y.mode&1)===0&&(A.lanes=v),A.return=y,A.sibling=null,p!==null&&(v=y.deletions,v===null?(y.deletions=[p],y.flags|=16):v.push(p)),y.child=A,y.memoizedState=null,A}function b_(p,y){return y=m2({mode:"visible",children:y},p.mode,0,null),y.return=p,p.child=y}function n2(p,y,v,A){return A!==null&&YE(A),Em(y,p.child,null,v),p=b_(y,y.pendingProps.children),p.flags|=2,y.memoizedState=null,p}function One(p,y,v,A,F,Y,ue){if(v)return y.flags&256?(y.flags&=-257,A=p_(Error(n(422))),n2(p,y,ue,A)):y.memoizedState!==null?(y.child=p.child,y.flags|=128,null):(Y=A.fallback,F=y.mode,A=m2({mode:"visible",children:A.children},F,0,null),Y=ff(Y,F,ue,null),Y.flags|=2,A.return=y,Y.return=y,A.sibling=Y,y.child=A,(y.mode&1)!==0&&Em(y,p.child,null,ue),y.child.memoizedState=w_(ue),y.memoizedState=x_,Y);if((y.mode&1)===0)return n2(p,y,ue,null);if(F.data==="$!"){if(A=F.nextSibling&&F.nextSibling.dataset,A)var Te=A.dgst;return A=Te,Y=Error(n(419)),A=p_(Y,A,void 0),n2(p,y,ue,A)}if(Te=(ue&p.childLanes)!==0,Xi||Te){if(A=Ss,A!==null){switch(ue&-ue){case 4:F=2;break;case 16:F=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:F=32;break;case 536870912:F=268435456;break;default:F=0}F=(F&(A.suspendedLanes|ue))!==0?0:F,F!==0&&F!==Y.retryLane&&(Y.retryLane=F,Ku(p,F),Za(A,p,F,-1))}return P_(),A=p_(Error(n(421))),n2(p,y,ue,A)}return F.data==="$?"?(y.flags|=128,y.child=p.child,y=Kne.bind(null,p),F._reactRetry=y,null):(p=Y.treeContext,Ao=rd(F.nextSibling),_o=y,ur=!0,Ya=null,p!==null&&(ta[na++]=Hu,ta[na++]=Yu,ta[na++]=rf,Hu=p.id,Yu=p.overflow,rf=y),y=b_(y,A.children),y.flags|=4096,y)}function QF(p,y,v){p.lanes|=y;var A=p.alternate;A!==null&&(A.lanes|=y),ZE(p.return,y,v)}function v_(p,y,v,A,F){var Y=p.memoizedState;Y===null?p.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:A,tail:v,tailMode:F}:(Y.isBackwards=y,Y.rendering=null,Y.renderingStartTime=0,Y.last=A,Y.tail=v,Y.tailMode=F)}function JF(p,y,v){var A=y.pendingProps,F=A.revealOrder,Y=A.tail;if(Ti(p,y,A.children,v),A=mr.current,(A&2)!==0)A=A&1|2,y.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=y.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&QF(p,v,y);else if(p.tag===19)QF(p,v,y);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===y)break e;for(;p.sibling===null;){if(p.return===null||p.return===y)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}A&=1}if(Qn(mr,A),(y.mode&1)===0)y.memoizedState=null;else switch(F){case"forwards":for(v=y.child,F=null;v!==null;)p=v.alternate,p!==null&&qv(p)===null&&(F=v),v=v.sibling;v=F,v===null?(F=y.child,y.child=null):(F=v.sibling,v.sibling=null),v_(y,!1,F,v,Y);break;case"backwards":for(v=null,F=y.child,y.child=null;F!==null;){if(p=F.alternate,p!==null&&qv(p)===null){y.child=F;break}p=F.sibling,F.sibling=v,v=F,F=p}v_(y,!0,v,null,Y);break;case"together":v_(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function r2(p,y){(y.mode&1)===0&&p!==null&&(p.alternate=null,y.alternate=null,y.flags|=2)}function Xu(p,y,v){if(p!==null&&(y.dependencies=p.dependencies),uf|=y.lanes,(v&y.childLanes)===0)return null;if(p!==null&&y.child!==p.child)throw Error(n(153));if(y.child!==null){for(p=y.child,v=pd(p,p.pendingProps),y.child=v,v.return=y;p.sibling!==null;)p=p.sibling,v=v.sibling=pd(p,p.pendingProps),v.return=y;v.sibling=null}return y.child}function Pne(p,y,v){switch(y.tag){case 3:qF(y),Tm();break;case 5:fF(y);break;case 1:qi(y.type)&&zv(y);break;case 4:e_(y,y.stateNode.containerInfo);break;case 10:var A=y.type._context,F=y.memoizedProps.value;Qn(Gv,A._currentValue),A._currentValue=F;break;case 13:if(A=y.memoizedState,A!==null)return A.dehydrated!==null?(Qn(mr,mr.current&1),y.flags|=128,null):(v&y.child.childLanes)!==0?ZF(p,y,v):(Qn(mr,mr.current&1),p=Xu(p,y,v),p!==null?p.sibling:null);Qn(mr,mr.current&1);break;case 19:if(A=(v&y.childLanes)!==0,(p.flags&128)!==0){if(A)return JF(p,y,v);y.flags|=128}if(F=y.memoizedState,F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),Qn(mr,mr.current),A)break;return null;case 22:case 23:return y.lanes=0,HF(p,y,v)}return Xu(p,y,v)}var eL,S_,tL,nL;eL=function(p,y){for(var v=y.child;v!==null;){if(v.tag===5||v.tag===6)p.appendChild(v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===y)break;for(;v.sibling===null;){if(v.return===null||v.return===y)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},S_=function(){},tL=function(p,y,v,A){var F=p.memoizedProps;if(F!==A){p=y.stateNode,af(jl.current);var Y=null;switch(v){case"input":F=xe(p,F),A=xe(p,A),Y=[];break;case"select":F=fe({},F,{value:void 0}),A=fe({},A,{value:void 0}),Y=[];break;case"textarea":F=me(p,F),A=me(p,A),Y=[];break;default:typeof F.onClick!="function"&&typeof A.onClick=="function"&&(p.onclick=Pv)}mt(v,A);var ue;v=null;for(Xe in F)if(!A.hasOwnProperty(Xe)&&F.hasOwnProperty(Xe)&&F[Xe]!=null)if(Xe==="style"){var Te=F[Xe];for(ue in Te)Te.hasOwnProperty(ue)&&(v||(v={}),v[ue]="")}else Xe!=="dangerouslySetInnerHTML"&&Xe!=="children"&&Xe!=="suppressContentEditableWarning"&&Xe!=="suppressHydrationWarning"&&Xe!=="autoFocus"&&(s.hasOwnProperty(Xe)?Y||(Y=[]):(Y=Y||[]).push(Xe,null));for(Xe in A){var Oe=A[Xe];if(Te=F!=null?F[Xe]:void 0,A.hasOwnProperty(Xe)&&Oe!==Te&&(Oe!=null||Te!=null))if(Xe==="style")if(Te){for(ue in Te)!Te.hasOwnProperty(ue)||Oe&&Oe.hasOwnProperty(ue)||(v||(v={}),v[ue]="");for(ue in Oe)Oe.hasOwnProperty(ue)&&Te[ue]!==Oe[ue]&&(v||(v={}),v[ue]=Oe[ue])}else v||(Y||(Y=[]),Y.push(Xe,v)),v=Oe;else Xe==="dangerouslySetInnerHTML"?(Oe=Oe?Oe.__html:void 0,Te=Te?Te.__html:void 0,Oe!=null&&Te!==Oe&&(Y=Y||[]).push(Xe,Oe)):Xe==="children"?typeof Oe!="string"&&typeof Oe!="number"||(Y=Y||[]).push(Xe,""+Oe):Xe!=="suppressContentEditableWarning"&&Xe!=="suppressHydrationWarning"&&(s.hasOwnProperty(Xe)?(Oe!=null&&Xe==="onScroll"&&nr("scroll",p),Y||Te===Oe||(Y=[])):(Y=Y||[]).push(Xe,Oe))}v&&(Y=Y||[]).push("style",v);var Xe=Y;(y.updateQueue=Xe)&&(y.flags|=4)}},nL=function(p,y,v,A){v!==A&&(y.flags|=4)};function ax(p,y){if(!ur)switch(p.tailMode){case"hidden":y=p.tail;for(var v=null;y!==null;)y.alternate!==null&&(v=y),y=y.sibling;v===null?p.tail=null:v.sibling=null;break;case"collapsed":v=p.tail;for(var A=null;v!==null;)v.alternate!==null&&(A=v),v=v.sibling;A===null?y||p.tail===null?p.tail=null:p.tail.sibling=null:A.sibling=null}}function ei(p){var y=p.alternate!==null&&p.alternate.child===p.child,v=0,A=0;if(y)for(var F=p.child;F!==null;)v|=F.lanes|F.childLanes,A|=F.subtreeFlags&14680064,A|=F.flags&14680064,F.return=p,F=F.sibling;else for(F=p.child;F!==null;)v|=F.lanes|F.childLanes,A|=F.subtreeFlags,A|=F.flags,F.return=p,F=F.sibling;return p.subtreeFlags|=A,p.childLanes=v,y}function Fne(p,y,v){var A=y.pendingProps;switch(WE(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ei(y),null;case 1:return qi(y.type)&&Lv(),ei(y),null;case 3:return A=y.stateNode,$m(),rr(Ki),rr(Qs),r_(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(p===null||p.child===null)&&(jv(y)?y.flags|=4:p===null||p.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,Ya!==null&&(M_(Ya),Ya=null))),S_(p,y),ei(y),null;case 5:t_(y);var F=af(nx.current);if(v=y.type,p!==null&&y.stateNode!=null)tL(p,y,v,A,F),p.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!A){if(y.stateNode===null)throw Error(n(166));return ei(y),null}if(p=af(jl.current),jv(y)){A=y.stateNode,v=y.type;var Y=y.memoizedProps;switch(A[Vl]=y,A[Zy]=Y,p=(y.mode&1)!==0,v){case"dialog":nr("cancel",A),nr("close",A);break;case"iframe":case"object":case"embed":nr("load",A);break;case"video":case"audio":for(F=0;F<Ky.length;F++)nr(Ky[F],A);break;case"source":nr("error",A);break;case"img":case"image":case"link":nr("error",A),nr("load",A);break;case"details":nr("toggle",A);break;case"input":Ie(A,Y),nr("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!Y.multiple},nr("invalid",A);break;case"textarea":je(A,Y),nr("invalid",A)}mt(v,Y),F=null;for(var ue in Y)if(Y.hasOwnProperty(ue)){var Te=Y[ue];ue==="children"?typeof Te=="string"?A.textContent!==Te&&(Y.suppressHydrationWarning!==!0&&Ov(A.textContent,Te,p),F=["children",Te]):typeof Te=="number"&&A.textContent!==""+Te&&(Y.suppressHydrationWarning!==!0&&Ov(A.textContent,Te,p),F=["children",""+Te]):s.hasOwnProperty(ue)&&Te!=null&&ue==="onScroll"&&nr("scroll",A)}switch(v){case"input":le(A),U(A,Y,!0);break;case"textarea":le(A),Ge(A);break;case"select":case"option":break;default:typeof Y.onClick=="function"&&(A.onclick=Pv)}A=F,y.updateQueue=A,A!==null&&(y.flags|=4)}else{ue=F.nodeType===9?F:F.ownerDocument,p==="http://www.w3.org/1999/xhtml"&&(p=Je(v)),p==="http://www.w3.org/1999/xhtml"?v==="script"?(p=ue.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild)):typeof A.is=="string"?p=ue.createElement(v,{is:A.is}):(p=ue.createElement(v),v==="select"&&(ue=p,A.multiple?ue.multiple=!0:A.size&&(ue.size=A.size))):p=ue.createElementNS(p,v),p[Vl]=y,p[Zy]=A,eL(p,y,!1,!1),y.stateNode=p;e:{switch(ue=dt(v,A),v){case"dialog":nr("cancel",p),nr("close",p),F=A;break;case"iframe":case"object":case"embed":nr("load",p),F=A;break;case"video":case"audio":for(F=0;F<Ky.length;F++)nr(Ky[F],p);F=A;break;case"source":nr("error",p),F=A;break;case"img":case"image":case"link":nr("error",p),nr("load",p),F=A;break;case"details":nr("toggle",p),F=A;break;case"input":Ie(p,A),F=xe(p,A),nr("invalid",p);break;case"option":F=A;break;case"select":p._wrapperState={wasMultiple:!!A.multiple},F=fe({},A,{value:void 0}),nr("invalid",p);break;case"textarea":je(p,A),F=me(p,A),nr("invalid",p);break;default:F=A}mt(v,F),Te=F;for(Y in Te)if(Te.hasOwnProperty(Y)){var Oe=Te[Y];Y==="style"?at(p,Oe):Y==="dangerouslySetInnerHTML"?(Oe=Oe?Oe.__html:void 0,Oe!=null&&$(p,Oe)):Y==="children"?typeof Oe=="string"?(v!=="textarea"||Oe!=="")&&J(p,Oe):typeof Oe=="number"&&J(p,""+Oe):Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&Y!=="autoFocus"&&(s.hasOwnProperty(Y)?Oe!=null&&Y==="onScroll"&&nr("scroll",p):Oe!=null&&S(p,Y,Oe,ue))}switch(v){case"input":le(p),U(p,A,!1);break;case"textarea":le(p),Ge(p);break;case"option":A.value!=null&&p.setAttribute("value",""+De(A.value));break;case"select":p.multiple=!!A.multiple,Y=A.value,Y!=null?ie(p,!!A.multiple,Y,!1):A.defaultValue!=null&&ie(p,!!A.multiple,A.defaultValue,!0);break;default:typeof F.onClick=="function"&&(p.onclick=Pv)}switch(v){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(y.flags|=4)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return ei(y),null;case 6:if(p&&y.stateNode!=null)nL(p,y,p.memoizedProps,A);else{if(typeof A!="string"&&y.stateNode===null)throw Error(n(166));if(v=af(nx.current),af(jl.current),jv(y)){if(A=y.stateNode,v=y.memoizedProps,A[Vl]=y,(Y=A.nodeValue!==v)&&(p=_o,p!==null))switch(p.tag){case 3:Ov(A.nodeValue,v,(p.mode&1)!==0);break;case 5:p.memoizedProps.suppressHydrationWarning!==!0&&Ov(A.nodeValue,v,(p.mode&1)!==0)}Y&&(y.flags|=4)}else A=(v.nodeType===9?v:v.ownerDocument).createTextNode(A),A[Vl]=y,y.stateNode=A}return ei(y),null;case 13:if(rr(mr),A=y.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(ur&&Ao!==null&&(y.mode&1)!==0&&(y.flags&128)===0)iF(),Tm(),y.flags|=98560,Y=!1;else if(Y=jv(y),A!==null&&A.dehydrated!==null){if(p===null){if(!Y)throw Error(n(318));if(Y=y.memoizedState,Y=Y!==null?Y.dehydrated:null,!Y)throw Error(n(317));Y[Vl]=y}else Tm(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;ei(y),Y=!1}else Ya!==null&&(M_(Ya),Ya=null),Y=!0;if(!Y)return y.flags&65536?y:null}return(y.flags&128)!==0?(y.lanes=v,y):(A=A!==null,A!==(p!==null&&p.memoizedState!==null)&&A&&(y.child.flags|=8192,(y.mode&1)!==0&&(p===null||(mr.current&1)!==0?hs===0&&(hs=3):P_())),y.updateQueue!==null&&(y.flags|=4),ei(y),null);case 4:return $m(),S_(p,y),p===null&&qy(y.stateNode.containerInfo),ei(y),null;case 10:return XE(y.type._context),ei(y),null;case 17:return qi(y.type)&&Lv(),ei(y),null;case 19:if(rr(mr),Y=y.memoizedState,Y===null)return ei(y),null;if(A=(y.flags&128)!==0,ue=Y.rendering,ue===null)if(A)ax(Y,!1);else{if(hs!==0||p!==null&&(p.flags&128)!==0)for(p=y.child;p!==null;){if(ue=qv(p),ue!==null){for(y.flags|=128,ax(Y,!1),A=ue.updateQueue,A!==null&&(y.updateQueue=A,y.flags|=4),y.subtreeFlags=0,A=v,v=y.child;v!==null;)Y=v,p=A,Y.flags&=14680066,ue=Y.alternate,ue===null?(Y.childLanes=0,Y.lanes=p,Y.child=null,Y.subtreeFlags=0,Y.memoizedProps=null,Y.memoizedState=null,Y.updateQueue=null,Y.dependencies=null,Y.stateNode=null):(Y.childLanes=ue.childLanes,Y.lanes=ue.lanes,Y.child=ue.child,Y.subtreeFlags=0,Y.deletions=null,Y.memoizedProps=ue.memoizedProps,Y.memoizedState=ue.memoizedState,Y.updateQueue=ue.updateQueue,Y.type=ue.type,p=ue.dependencies,Y.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext}),v=v.sibling;return Qn(mr,mr.current&1|2),y.child}p=p.sibling}Y.tail!==null&&Dt()>Om&&(y.flags|=128,A=!0,ax(Y,!1),y.lanes=4194304)}else{if(!A)if(p=qv(ue),p!==null){if(y.flags|=128,A=!0,v=p.updateQueue,v!==null&&(y.updateQueue=v,y.flags|=4),ax(Y,!0),Y.tail===null&&Y.tailMode==="hidden"&&!ue.alternate&&!ur)return ei(y),null}else 2*Dt()-Y.renderingStartTime>Om&&v!==1073741824&&(y.flags|=128,A=!0,ax(Y,!1),y.lanes=4194304);Y.isBackwards?(ue.sibling=y.child,y.child=ue):(v=Y.last,v!==null?v.sibling=ue:y.child=ue,Y.last=ue)}return Y.tail!==null?(y=Y.tail,Y.rendering=y,Y.tail=y.sibling,Y.renderingStartTime=Dt(),y.sibling=null,v=mr.current,Qn(mr,A?v&1|2:v&1),y):(ei(y),null);case 22:case 23:return O_(),A=y.memoizedState!==null,p!==null&&p.memoizedState!==null!==A&&(y.flags|=8192),A&&(y.mode&1)!==0?($o&1073741824)!==0&&(ei(y),y.subtreeFlags&6&&(y.flags|=8192)):ei(y),null;case 24:return null;case 25:return null}throw Error(n(156,y.tag))}function Lne(p,y){switch(WE(y),y.tag){case 1:return qi(y.type)&&Lv(),p=y.flags,p&65536?(y.flags=p&-65537|128,y):null;case 3:return $m(),rr(Ki),rr(Qs),r_(),p=y.flags,(p&65536)!==0&&(p&128)===0?(y.flags=p&-65537|128,y):null;case 5:return t_(y),null;case 13:if(rr(mr),p=y.memoizedState,p!==null&&p.dehydrated!==null){if(y.alternate===null)throw Error(n(340));Tm()}return p=y.flags,p&65536?(y.flags=p&-65537|128,y):null;case 19:return rr(mr),null;case 4:return $m(),null;case 10:return XE(y.type._context),null;case 22:case 23:return O_(),null;case 24:return null;default:return null}}var s2=!1,ti=!1,zne=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function Mm(p,y){var v=p.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(A){Ir(p,y,A)}else v.current=null}function C_(p,y,v){try{v()}catch(A){Ir(p,y,A)}}var rL=!1;function Bne(p,y){if(OE=Qc,p=O4(),TE(p)){if("selectionStart"in p)var v={start:p.selectionStart,end:p.selectionEnd};else e:{v=(v=p.ownerDocument)&&v.defaultView||window;var A=v.getSelection&&v.getSelection();if(A&&A.rangeCount!==0){v=A.anchorNode;var F=A.anchorOffset,Y=A.focusNode;A=A.focusOffset;try{v.nodeType,Y.nodeType}catch{v=null;break e}var ue=0,Te=-1,Oe=-1,Xe=0,nt=0,st=p,tt=null;t:for(;;){for(var vt;st!==v||F!==0&&st.nodeType!==3||(Te=ue+F),st!==Y||A!==0&&st.nodeType!==3||(Oe=ue+A),st.nodeType===3&&(ue+=st.nodeValue.length),(vt=st.firstChild)!==null;)tt=st,st=vt;for(;;){if(st===p)break t;if(tt===v&&++Xe===F&&(Te=ue),tt===Y&&++nt===A&&(Oe=ue),(vt=st.nextSibling)!==null)break;st=tt,tt=st.parentNode}st=vt}v=Te===-1||Oe===-1?null:{start:Te,end:Oe}}else v=null}v=v||{start:0,end:0}}else v=null;for(PE={focusedElem:p,selectionRange:v},Qc=!1,Ct=y;Ct!==null;)if(y=Ct,p=y.child,(y.subtreeFlags&1028)!==0&&p!==null)p.return=y,Ct=p;else for(;Ct!==null;){y=Ct;try{var Tt=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(Tt!==null){var Rt=Tt.memoizedProps,Or=Tt.memoizedState,Ye=y.stateNode,ze=Ye.getSnapshotBeforeUpdate(y.elementType===y.type?Rt:Ka(y.type,Rt),Or);Ye.__reactInternalSnapshotBeforeUpdate=ze}break;case 3:var Ke=y.stateNode.containerInfo;Ke.nodeType===1?Ke.textContent="":Ke.nodeType===9&&Ke.documentElement&&Ke.removeChild(Ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(it){Ir(y,y.return,it)}if(p=y.sibling,p!==null){p.return=y.return,Ct=p;break}Ct=y.return}return Tt=rL,rL=!1,Tt}function lx(p,y,v){var A=y.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var F=A=A.next;do{if((F.tag&p)===p){var Y=F.destroy;F.destroy=void 0,Y!==void 0&&C_(y,v,Y)}F=F.next}while(F!==A)}}function i2(p,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var v=y=y.next;do{if((v.tag&p)===p){var A=v.create;v.destroy=A()}v=v.next}while(v!==y)}}function I_(p){var y=p.ref;if(y!==null){var v=p.stateNode;switch(p.tag){case 5:p=v;break;default:p=v}typeof y=="function"?y(p):y.current=p}}function sL(p){var y=p.alternate;y!==null&&(p.alternate=null,sL(y)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(y=p.stateNode,y!==null&&(delete y[Vl],delete y[Zy],delete y[BE],delete y[Sne],delete y[Cne])),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function iL(p){return p.tag===5||p.tag===3||p.tag===4}function oL(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||iL(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function N_(p,y,v){var A=p.tag;if(A===5||A===6)p=p.stateNode,y?v.nodeType===8?v.parentNode.insertBefore(p,y):v.insertBefore(p,y):(v.nodeType===8?(y=v.parentNode,y.insertBefore(p,v)):(y=v,y.appendChild(p)),v=v._reactRootContainer,v!=null||y.onclick!==null||(y.onclick=Pv));else if(A!==4&&(p=p.child,p!==null))for(N_(p,y,v),p=p.sibling;p!==null;)N_(p,y,v),p=p.sibling}function k_(p,y,v){var A=p.tag;if(A===5||A===6)p=p.stateNode,y?v.insertBefore(p,y):v.appendChild(p);else if(A!==4&&(p=p.child,p!==null))for(k_(p,y,v),p=p.sibling;p!==null;)k_(p,y,v),p=p.sibling}var Os=null,qa=!1;function ud(p,y,v){for(v=v.child;v!==null;)aL(p,y,v),v=v.sibling}function aL(p,y,v){if(Ni&&typeof Ni.onCommitFiberUnmount=="function")try{Ni.onCommitFiberUnmount(Ii,v)}catch{}switch(v.tag){case 5:ti||Mm(v,y);case 6:var A=Os,F=qa;Os=null,ud(p,y,v),Os=A,qa=F,Os!==null&&(qa?(p=Os,v=v.stateNode,p.nodeType===8?p.parentNode.removeChild(v):p.removeChild(v)):Os.removeChild(v.stateNode));break;case 18:Os!==null&&(qa?(p=Os,v=v.stateNode,p.nodeType===8?zE(p.parentNode,v):p.nodeType===1&&zE(p,v),Zc(p)):zE(Os,v.stateNode));break;case 4:A=Os,F=qa,Os=v.stateNode.containerInfo,qa=!0,ud(p,y,v),Os=A,qa=F;break;case 0:case 11:case 14:case 15:if(!ti&&(A=v.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){F=A=A.next;do{var Y=F,ue=Y.destroy;Y=Y.tag,ue!==void 0&&((Y&2)!==0||(Y&4)!==0)&&C_(v,y,ue),F=F.next}while(F!==A)}ud(p,y,v);break;case 1:if(!ti&&(Mm(v,y),A=v.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=v.memoizedProps,A.state=v.memoizedState,A.componentWillUnmount()}catch(Te){Ir(v,y,Te)}ud(p,y,v);break;case 21:ud(p,y,v);break;case 22:v.mode&1?(ti=(A=ti)||v.memoizedState!==null,ud(p,y,v),ti=A):ud(p,y,v);break;default:ud(p,y,v)}}function lL(p){var y=p.updateQueue;if(y!==null){p.updateQueue=null;var v=p.stateNode;v===null&&(v=p.stateNode=new zne),y.forEach(function(A){var F=qne.bind(null,p,A);v.has(A)||(v.add(A),A.then(F,F))})}}function Xa(p,y){var v=y.deletions;if(v!==null)for(var A=0;A<v.length;A++){var F=v[A];try{var Y=p,ue=y,Te=ue;e:for(;Te!==null;){switch(Te.tag){case 5:Os=Te.stateNode,qa=!1;break e;case 3:Os=Te.stateNode.containerInfo,qa=!0;break e;case 4:Os=Te.stateNode.containerInfo,qa=!0;break e}Te=Te.return}if(Os===null)throw Error(n(160));aL(Y,ue,F),Os=null,qa=!1;var Oe=F.alternate;Oe!==null&&(Oe.return=null),F.return=null}catch(Xe){Ir(F,y,Xe)}}if(y.subtreeFlags&12854)for(y=y.child;y!==null;)uL(y,p),y=y.sibling}function uL(p,y){var v=p.alternate,A=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:if(Xa(y,p),Gl(p),A&4){try{lx(3,p,p.return),i2(3,p)}catch(Rt){Ir(p,p.return,Rt)}try{lx(5,p,p.return)}catch(Rt){Ir(p,p.return,Rt)}}break;case 1:Xa(y,p),Gl(p),A&512&&v!==null&&Mm(v,v.return);break;case 5:if(Xa(y,p),Gl(p),A&512&&v!==null&&Mm(v,v.return),p.flags&32){var F=p.stateNode;try{J(F,"")}catch(Rt){Ir(p,p.return,Rt)}}if(A&4&&(F=p.stateNode,F!=null)){var Y=p.memoizedProps,ue=v!==null?v.memoizedProps:Y,Te=p.type,Oe=p.updateQueue;if(p.updateQueue=null,Oe!==null)try{Te==="input"&&Y.type==="radio"&&Y.name!=null&&te(F,Y),dt(Te,ue);var Xe=dt(Te,Y);for(ue=0;ue<Oe.length;ue+=2){var nt=Oe[ue],st=Oe[ue+1];nt==="style"?at(F,st):nt==="dangerouslySetInnerHTML"?$(F,st):nt==="children"?J(F,st):S(F,nt,st,Xe)}switch(Te){case"input":L(F,Y);break;case"textarea":He(F,Y);break;case"select":var tt=F._wrapperState.wasMultiple;F._wrapperState.wasMultiple=!!Y.multiple;var vt=Y.value;vt!=null?ie(F,!!Y.multiple,vt,!1):tt!==!!Y.multiple&&(Y.defaultValue!=null?ie(F,!!Y.multiple,Y.defaultValue,!0):ie(F,!!Y.multiple,Y.multiple?[]:"",!1))}F[Zy]=Y}catch(Rt){Ir(p,p.return,Rt)}}break;case 6:if(Xa(y,p),Gl(p),A&4){if(p.stateNode===null)throw Error(n(162));F=p.stateNode,Y=p.memoizedProps;try{F.nodeValue=Y}catch(Rt){Ir(p,p.return,Rt)}}break;case 3:if(Xa(y,p),Gl(p),A&4&&v!==null&&v.memoizedState.isDehydrated)try{Zc(y.containerInfo)}catch(Rt){Ir(p,p.return,Rt)}break;case 4:Xa(y,p),Gl(p);break;case 13:Xa(y,p),Gl(p),F=p.child,F.flags&8192&&(Y=F.memoizedState!==null,F.stateNode.isHidden=Y,!Y||F.alternate!==null&&F.alternate.memoizedState!==null||(__=Dt())),A&4&&lL(p);break;case 22:if(nt=v!==null&&v.memoizedState!==null,p.mode&1?(ti=(Xe=ti)||nt,Xa(y,p),ti=Xe):Xa(y,p),Gl(p),A&8192){if(Xe=p.memoizedState!==null,(p.stateNode.isHidden=Xe)&&!nt&&(p.mode&1)!==0)for(Ct=p,nt=p.child;nt!==null;){for(st=Ct=nt;Ct!==null;){switch(tt=Ct,vt=tt.child,tt.tag){case 0:case 11:case 14:case 15:lx(4,tt,tt.return);break;case 1:Mm(tt,tt.return);var Tt=tt.stateNode;if(typeof Tt.componentWillUnmount=="function"){A=tt,v=tt.return;try{y=A,Tt.props=y.memoizedProps,Tt.state=y.memoizedState,Tt.componentWillUnmount()}catch(Rt){Ir(A,v,Rt)}}break;case 5:Mm(tt,tt.return);break;case 22:if(tt.memoizedState!==null){hL(st);continue}}vt!==null?(vt.return=tt,Ct=vt):hL(st)}nt=nt.sibling}e:for(nt=null,st=p;;){if(st.tag===5){if(nt===null){nt=st;try{F=st.stateNode,Xe?(Y=F.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none"):(Te=st.stateNode,Oe=st.memoizedProps.style,ue=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null,Te.style.display=Ne("display",ue))}catch(Rt){Ir(p,p.return,Rt)}}}else if(st.tag===6){if(nt===null)try{st.stateNode.nodeValue=Xe?"":st.memoizedProps}catch(Rt){Ir(p,p.return,Rt)}}else if((st.tag!==22&&st.tag!==23||st.memoizedState===null||st===p)&&st.child!==null){st.child.return=st,st=st.child;continue}if(st===p)break e;for(;st.sibling===null;){if(st.return===null||st.return===p)break e;nt===st&&(nt=null),st=st.return}nt===st&&(nt=null),st.sibling.return=st.return,st=st.sibling}}break;case 19:Xa(y,p),Gl(p),A&4&&lL(p);break;case 21:break;default:Xa(y,p),Gl(p)}}function Gl(p){var y=p.flags;if(y&2){try{e:{for(var v=p.return;v!==null;){if(iL(v)){var A=v;break e}v=v.return}throw Error(n(160))}switch(A.tag){case 5:var F=A.stateNode;A.flags&32&&(J(F,""),A.flags&=-33);var Y=oL(p);k_(p,Y,F);break;case 3:case 4:var ue=A.stateNode.containerInfo,Te=oL(p);N_(p,Te,ue);break;default:throw Error(n(161))}}catch(Oe){Ir(p,p.return,Oe)}p.flags&=-3}y&4096&&(p.flags&=-4097)}function Une(p,y,v){Ct=p,cL(p)}function cL(p,y,v){for(var A=(p.mode&1)!==0;Ct!==null;){var F=Ct,Y=F.child;if(F.tag===22&&A){var ue=F.memoizedState!==null||s2;if(!ue){var Te=F.alternate,Oe=Te!==null&&Te.memoizedState!==null||ti;Te=s2;var Xe=ti;if(s2=ue,(ti=Oe)&&!Xe)for(Ct=F;Ct!==null;)ue=Ct,Oe=ue.child,ue.tag===22&&ue.memoizedState!==null?fL(F):Oe!==null?(Oe.return=ue,Ct=Oe):fL(F);for(;Y!==null;)Ct=Y,cL(Y),Y=Y.sibling;Ct=F,s2=Te,ti=Xe}dL(p)}else(F.subtreeFlags&8772)!==0&&Y!==null?(Y.return=F,Ct=Y):dL(p)}}function dL(p){for(;Ct!==null;){var y=Ct;if((y.flags&8772)!==0){var v=y.alternate;try{if((y.flags&8772)!==0)switch(y.tag){case 0:case 11:case 15:ti||i2(5,y);break;case 1:var A=y.stateNode;if(y.flags&4&&!ti)if(v===null)A.componentDidMount();else{var F=y.elementType===y.type?v.memoizedProps:Ka(y.type,v.memoizedProps);A.componentDidUpdate(F,v.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var Y=y.updateQueue;Y!==null&&hF(y,Y,A);break;case 3:var ue=y.updateQueue;if(ue!==null){if(v=null,y.child!==null)switch(y.child.tag){case 5:v=y.child.stateNode;break;case 1:v=y.child.stateNode}hF(y,ue,v)}break;case 5:var Te=y.stateNode;if(v===null&&y.flags&4){v=Te;var Oe=y.memoizedProps;switch(y.type){case"button":case"input":case"select":case"textarea":Oe.autoFocus&&v.focus();break;case"img":Oe.src&&(v.src=Oe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(y.memoizedState===null){var Xe=y.alternate;if(Xe!==null){var nt=Xe.memoizedState;if(nt!==null){var st=nt.dehydrated;st!==null&&Zc(st)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ti||y.flags&512&&I_(y)}catch(tt){Ir(y,y.return,tt)}}if(y===p){Ct=null;break}if(v=y.sibling,v!==null){v.return=y.return,Ct=v;break}Ct=y.return}}function hL(p){for(;Ct!==null;){var y=Ct;if(y===p){Ct=null;break}var v=y.sibling;if(v!==null){v.return=y.return,Ct=v;break}Ct=y.return}}function fL(p){for(;Ct!==null;){var y=Ct;try{switch(y.tag){case 0:case 11:case 15:var v=y.return;try{i2(4,y)}catch(Oe){Ir(y,v,Oe)}break;case 1:var A=y.stateNode;if(typeof A.componentDidMount=="function"){var F=y.return;try{A.componentDidMount()}catch(Oe){Ir(y,F,Oe)}}var Y=y.return;try{I_(y)}catch(Oe){Ir(y,Y,Oe)}break;case 5:var ue=y.return;try{I_(y)}catch(Oe){Ir(y,ue,Oe)}}}catch(Oe){Ir(y,y.return,Oe)}if(y===p){Ct=null;break}var Te=y.sibling;if(Te!==null){Te.return=y.return,Ct=Te;break}Ct=y.return}}var Vne=Math.ceil,o2=C.ReactCurrentDispatcher,T_=C.ReactCurrentOwner,ia=C.ReactCurrentBatchConfig,In=0,Ss=null,Hr=null,Ps=0,$o=0,Dm=sd(0),hs=0,ux=null,uf=0,a2=0,E_=0,cx=null,Zi=null,__=0,Om=1/0,Zu=null,l2=!1,A_=null,cd=null,u2=!1,dd=null,c2=0,dx=0,$_=null,d2=-1,h2=0;function Ei(){return(In&6)!==0?Dt():d2!==-1?d2:d2=Dt()}function hd(p){return(p.mode&1)===0?1:(In&2)!==0&&Ps!==0?Ps&-Ps:Nne.transition!==null?(h2===0&&(h2=Gh()),h2):(p=kn,p!==0||(p=window.event,p=p===void 0?16:ed(p.type)),p)}function Za(p,y,v,A){if(50<dx)throw dx=0,$_=null,Error(n(185));Hc(p,v,A),((In&2)===0||p!==Ss)&&(p===Ss&&((In&2)===0&&(a2|=v),hs===4&&fd(p,Ps)),Qi(p,A),v===1&&In===0&&(y.mode&1)===0&&(Om=Dt()+500,Bv&&od()))}function Qi(p,y){var v=p.callbackNode;gv(p,y);var A=Wh(p,p===Ss?Ps:0);if(A===0)v!==null&&Ks(v),p.callbackNode=null,p.callbackPriority=0;else if(y=A&-A,p.callbackPriority!==y){if(v!=null&&Ks(v),y===1)p.tag===0?Ine(mL.bind(null,p)):eF(mL.bind(null,p)),bne(function(){(In&6)===0&&od()}),v=null;else{switch(zy(A)){case 1:v=en;break;case 4:v=Wa;break;case 16:v=Dr;break;case 536870912:v=Uh;break;default:v=Dr}v=CL(v,pL.bind(null,p))}p.callbackPriority=y,p.callbackNode=v}}function pL(p,y){if(d2=-1,h2=0,(In&6)!==0)throw Error(n(327));var v=p.callbackNode;if(Pm()&&p.callbackNode!==v)return null;var A=Wh(p,p===Ss?Ps:0);if(A===0)return null;if((A&30)!==0||(A&p.expiredLanes)!==0||y)y=f2(p,A);else{y=A;var F=In;In|=2;var Y=yL();(Ss!==p||Ps!==y)&&(Zu=null,Om=Dt()+500,df(p,y));do try{Gne();break}catch(Te){gL(p,Te)}while(!0);qE(),o2.current=Y,In=F,Hr!==null?y=0:(Ss=null,Ps=0,y=hs)}if(y!==0){if(y===2&&(F=om(p),F!==0&&(A=F,y=R_(p,F))),y===1)throw v=ux,df(p,0),fd(p,A),Qi(p,Dt()),v;if(y===6)fd(p,A);else{if(F=p.current.alternate,(A&30)===0&&!jne(F)&&(y=f2(p,A),y===2&&(Y=om(p),Y!==0&&(A=Y,y=R_(p,Y))),y===1))throw v=ux,df(p,0),fd(p,A),Qi(p,Dt()),v;switch(p.finishedWork=F,p.finishedLanes=A,y){case 0:case 1:throw Error(n(345));case 2:hf(p,Zi,Zu);break;case 3:if(fd(p,A),(A&130023424)===A&&(y=__+500-Dt(),10<y)){if(Wh(p,0)!==0)break;if(F=p.suspendedLanes,(F&A)!==A){Ei(),p.pingedLanes|=p.suspendedLanes&F;break}p.timeoutHandle=LE(hf.bind(null,p,Zi,Zu),y);break}hf(p,Zi,Zu);break;case 4:if(fd(p,A),(A&4194240)===A)break;for(y=p.eventTimes,F=-1;0<A;){var ue=31-Hi(A);Y=1<<ue,ue=y[ue],ue>F&&(F=ue),A&=~Y}if(A=F,A=Dt()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*Vne(A/1960))-A,10<A){p.timeoutHandle=LE(hf.bind(null,p,Zi,Zu),A);break}hf(p,Zi,Zu);break;case 5:hf(p,Zi,Zu);break;default:throw Error(n(329))}}}return Qi(p,Dt()),p.callbackNode===v?pL.bind(null,p):null}function R_(p,y){var v=cx;return p.current.memoizedState.isDehydrated&&(df(p,y).flags|=256),p=f2(p,y),p!==2&&(y=Zi,Zi=v,y!==null&&M_(y)),p}function M_(p){Zi===null?Zi=p:Zi.push.apply(Zi,p)}function jne(p){for(var y=p;;){if(y.flags&16384){var v=y.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var A=0;A<v.length;A++){var F=v[A],Y=F.getSnapshot;F=F.value;try{if(!Ha(Y(),F))return!1}catch{return!1}}}if(v=y.child,y.subtreeFlags&16384&&v!==null)v.return=y,y=v;else{if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function fd(p,y){for(y&=~E_,y&=~a2,p.suspendedLanes|=y,p.pingedLanes&=~y,p=p.expirationTimes;0<y;){var v=31-Hi(y),A=1<<v;p[v]=-1,y&=~A}}function mL(p){if((In&6)!==0)throw Error(n(327));Pm();var y=Wh(p,0);if((y&1)===0)return Qi(p,Dt()),null;var v=f2(p,y);if(p.tag!==0&&v===2){var A=om(p);A!==0&&(y=A,v=R_(p,A))}if(v===1)throw v=ux,df(p,0),fd(p,y),Qi(p,Dt()),v;if(v===6)throw Error(n(345));return p.finishedWork=p.current.alternate,p.finishedLanes=y,hf(p,Zi,Zu),Qi(p,Dt()),null}function D_(p,y){var v=In;In|=1;try{return p(y)}finally{In=v,In===0&&(Om=Dt()+500,Bv&&od())}}function cf(p){dd!==null&&dd.tag===0&&(In&6)===0&&Pm();var y=In;In|=1;var v=ia.transition,A=kn;try{if(ia.transition=null,kn=1,p)return p()}finally{kn=A,ia.transition=v,In=y,(In&6)===0&&od()}}function O_(){$o=Dm.current,rr(Dm)}function df(p,y){p.finishedWork=null,p.finishedLanes=0;var v=p.timeoutHandle;if(v!==-1&&(p.timeoutHandle=-1,wne(v)),Hr!==null)for(v=Hr.return;v!==null;){var A=v;switch(WE(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&Lv();break;case 3:$m(),rr(Ki),rr(Qs),r_();break;case 5:t_(A);break;case 4:$m();break;case 13:rr(mr);break;case 19:rr(mr);break;case 10:XE(A.type._context);break;case 22:case 23:O_()}v=v.return}if(Ss=p,Hr=p=pd(p.current,null),Ps=$o=y,hs=0,ux=null,E_=a2=uf=0,Zi=cx=null,of!==null){for(y=0;y<of.length;y++)if(v=of[y],A=v.interleaved,A!==null){v.interleaved=null;var F=A.next,Y=v.pending;if(Y!==null){var ue=Y.next;Y.next=F,A.next=ue}v.pending=A}of=null}return p}function gL(p,y){do{var v=Hr;try{if(qE(),Xv.current=e2,Zv){for(var A=gr.memoizedState;A!==null;){var F=A.queue;F!==null&&(F.pending=null),A=A.next}Zv=!1}if(lf=0,vs=ds=gr=null,rx=!1,sx=0,T_.current=null,v===null||v.return===null){hs=1,ux=y,Hr=null;break}e:{var Y=p,ue=v.return,Te=v,Oe=y;if(y=Ps,Te.flags|=32768,Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var Xe=Oe,nt=Te,st=nt.tag;if((nt.mode&1)===0&&(st===0||st===11||st===15)){var tt=nt.alternate;tt?(nt.updateQueue=tt.updateQueue,nt.memoizedState=tt.memoizedState,nt.lanes=tt.lanes):(nt.updateQueue=null,nt.memoizedState=null)}var vt=UF(ue);if(vt!==null){vt.flags&=-257,VF(vt,ue,Te,Y,y),vt.mode&1&&BF(Y,Xe,y),y=vt,Oe=Xe;var Tt=y.updateQueue;if(Tt===null){var Rt=new Set;Rt.add(Oe),y.updateQueue=Rt}else Tt.add(Oe);break e}else{if((y&1)===0){BF(Y,Xe,y),P_();break e}Oe=Error(n(426))}}else if(ur&&Te.mode&1){var Or=UF(ue);if(Or!==null){(Or.flags&65536)===0&&(Or.flags|=256),VF(Or,ue,Te,Y,y),YE(Rm(Oe,Te));break e}}Y=Oe=Rm(Oe,Te),hs!==4&&(hs=2),cx===null?cx=[Y]:cx.push(Y),Y=ue;do{switch(Y.tag){case 3:Y.flags|=65536,y&=-y,Y.lanes|=y;var Ye=LF(Y,Oe,y);dF(Y,Ye);break e;case 1:Te=Oe;var ze=Y.type,Ke=Y.stateNode;if((Y.flags&128)===0&&(typeof ze.getDerivedStateFromError=="function"||Ke!==null&&typeof Ke.componentDidCatch=="function"&&(cd===null||!cd.has(Ke)))){Y.flags|=65536,y&=-y,Y.lanes|=y;var it=zF(Y,Te,y);dF(Y,it);break e}}Y=Y.return}while(Y!==null)}wL(v)}catch(Pt){y=Pt,Hr===v&&v!==null&&(Hr=v=v.return);continue}break}while(!0)}function yL(){var p=o2.current;return o2.current=e2,p===null?e2:p}function P_(){(hs===0||hs===3||hs===2)&&(hs=4),Ss===null||(uf&268435455)===0&&(a2&268435455)===0||fd(Ss,Ps)}function f2(p,y){var v=In;In|=2;var A=yL();(Ss!==p||Ps!==y)&&(Zu=null,df(p,y));do try{Wne();break}catch(F){gL(p,F)}while(!0);if(qE(),In=v,o2.current=A,Hr!==null)throw Error(n(261));return Ss=null,Ps=0,hs}function Wne(){for(;Hr!==null;)xL(Hr)}function Gne(){for(;Hr!==null&&!Gi();)xL(Hr)}function xL(p){var y=SL(p.alternate,p,$o);p.memoizedProps=p.pendingProps,y===null?wL(p):Hr=y,T_.current=null}function wL(p){var y=p;do{var v=y.alternate;if(p=y.return,(y.flags&32768)===0){if(v=Fne(v,y,$o),v!==null){Hr=v;return}}else{if(v=Lne(v,y),v!==null){v.flags&=32767,Hr=v;return}if(p!==null)p.flags|=32768,p.subtreeFlags=0,p.deletions=null;else{hs=6,Hr=null;return}}if(y=y.sibling,y!==null){Hr=y;return}Hr=y=p}while(y!==null);hs===0&&(hs=5)}function hf(p,y,v){var A=kn,F=ia.transition;try{ia.transition=null,kn=1,Hne(p,y,v,A)}finally{ia.transition=F,kn=A}return null}function Hne(p,y,v,A){do Pm();while(dd!==null);if((In&6)!==0)throw Error(n(327));v=p.finishedWork;var F=p.finishedLanes;if(v===null)return null;if(p.finishedWork=null,p.finishedLanes=0,v===p.current)throw Error(n(177));p.callbackNode=null,p.callbackPriority=0;var Y=v.lanes|v.childLanes;if(pE(p,Y),p===Ss&&(Hr=Ss=null,Ps=0),(v.subtreeFlags&2064)===0&&(v.flags&2064)===0||u2||(u2=!0,CL(Dr,function(){return Pm(),null})),Y=(v.flags&15990)!==0,(v.subtreeFlags&15990)!==0||Y){Y=ia.transition,ia.transition=null;var ue=kn;kn=1;var Te=In;In|=4,T_.current=null,Bne(p,v),uL(v,p),hne(PE),Qc=!!OE,PE=OE=null,p.current=v,Une(v),Re(),In=Te,kn=ue,ia.transition=Y}else p.current=v;if(u2&&(u2=!1,dd=p,c2=F),Y=p.pendingLanes,Y===0&&(cd=null),dE(v.stateNode),Qi(p,Dt()),y!==null)for(A=p.onRecoverableError,v=0;v<y.length;v++)F=y[v],A(F.value,{componentStack:F.stack,digest:F.digest});if(l2)throw l2=!1,p=A_,A_=null,p;return(c2&1)!==0&&p.tag!==0&&Pm(),Y=p.pendingLanes,(Y&1)!==0?p===$_?dx++:(dx=0,$_=p):dx=0,od(),null}function Pm(){if(dd!==null){var p=zy(c2),y=ia.transition,v=kn;try{if(ia.transition=null,kn=16>p?16:p,dd===null)var A=!1;else{if(p=dd,dd=null,c2=0,(In&6)!==0)throw Error(n(331));var F=In;for(In|=4,Ct=p.current;Ct!==null;){var Y=Ct,ue=Y.child;if((Ct.flags&16)!==0){var Te=Y.deletions;if(Te!==null){for(var Oe=0;Oe<Te.length;Oe++){var Xe=Te[Oe];for(Ct=Xe;Ct!==null;){var nt=Ct;switch(nt.tag){case 0:case 11:case 15:lx(8,nt,Y)}var st=nt.child;if(st!==null)st.return=nt,Ct=st;else for(;Ct!==null;){nt=Ct;var tt=nt.sibling,vt=nt.return;if(sL(nt),nt===Xe){Ct=null;break}if(tt!==null){tt.return=vt,Ct=tt;break}Ct=vt}}}var Tt=Y.alternate;if(Tt!==null){var Rt=Tt.child;if(Rt!==null){Tt.child=null;do{var Or=Rt.sibling;Rt.sibling=null,Rt=Or}while(Rt!==null)}}Ct=Y}}if((Y.subtreeFlags&2064)!==0&&ue!==null)ue.return=Y,Ct=ue;else e:for(;Ct!==null;){if(Y=Ct,(Y.flags&2048)!==0)switch(Y.tag){case 0:case 11:case 15:lx(9,Y,Y.return)}var Ye=Y.sibling;if(Ye!==null){Ye.return=Y.return,Ct=Ye;break e}Ct=Y.return}}var ze=p.current;for(Ct=ze;Ct!==null;){ue=Ct;var Ke=ue.child;if((ue.subtreeFlags&2064)!==0&&Ke!==null)Ke.return=ue,Ct=Ke;else e:for(ue=ze;Ct!==null;){if(Te=Ct,(Te.flags&2048)!==0)try{switch(Te.tag){case 0:case 11:case 15:i2(9,Te)}}catch(Pt){Ir(Te,Te.return,Pt)}if(Te===ue){Ct=null;break e}var it=Te.sibling;if(it!==null){it.return=Te.return,Ct=it;break e}Ct=Te.return}}if(In=F,od(),Ni&&typeof Ni.onPostCommitFiberRoot=="function")try{Ni.onPostCommitFiberRoot(Ii,p)}catch{}A=!0}return A}finally{kn=v,ia.transition=y}}return!1}function bL(p,y,v){y=Rm(v,y),y=LF(p,y,1),p=ld(p,y,1),y=Ei(),p!==null&&(Hc(p,1,y),Qi(p,y))}function Ir(p,y,v){if(p.tag===3)bL(p,p,v);else for(;y!==null;){if(y.tag===3){bL(y,p,v);break}else if(y.tag===1){var A=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(cd===null||!cd.has(A))){p=Rm(v,p),p=zF(y,p,1),y=ld(y,p,1),p=Ei(),y!==null&&(Hc(y,1,p),Qi(y,p));break}}y=y.return}}function Yne(p,y,v){var A=p.pingCache;A!==null&&A.delete(y),y=Ei(),p.pingedLanes|=p.suspendedLanes&v,Ss===p&&(Ps&v)===v&&(hs===4||hs===3&&(Ps&130023424)===Ps&&500>Dt()-__?df(p,0):E_|=v),Qi(p,y)}function vL(p,y){y===0&&((p.mode&1)===0?y=1:(y=jh,jh<<=1,(jh&130023424)===0&&(jh=4194304)));var v=Ei();p=Ku(p,y),p!==null&&(Hc(p,y,v),Qi(p,v))}function Kne(p){var y=p.memoizedState,v=0;y!==null&&(v=y.retryLane),vL(p,v)}function qne(p,y){var v=0;switch(p.tag){case 13:var A=p.stateNode,F=p.memoizedState;F!==null&&(v=F.retryLane);break;case 19:A=p.stateNode;break;default:throw Error(n(314))}A!==null&&A.delete(y),vL(p,v)}var SL;SL=function(p,y,v){if(p!==null)if(p.memoizedProps!==y.pendingProps||Ki.current)Xi=!0;else{if((p.lanes&v)===0&&(y.flags&128)===0)return Xi=!1,Pne(p,y,v);Xi=(p.flags&131072)!==0}else Xi=!1,ur&&(y.flags&1048576)!==0&&tF(y,Vv,y.index);switch(y.lanes=0,y.tag){case 2:var A=y.type;r2(p,y),p=y.pendingProps;var F=Im(y,Qs.current);Am(y,v),F=o_(null,y,A,p,F,v);var Y=a_();return y.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,qi(A)?(Y=!0,zv(y)):Y=!1,y.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,JE(y),F.updater=t2,y.stateNode=F,F._reactInternals=y,f_(y,A,p,v),y=y_(null,y,A,!0,Y,v)):(y.tag=0,ur&&Y&&jE(y),Ti(null,y,F,v),y=y.child),y;case 16:A=y.elementType;e:{switch(r2(p,y),p=y.pendingProps,F=A._init,A=F(A._payload),y.type=A,F=y.tag=Zne(A),p=Ka(A,p),F){case 0:y=g_(null,y,A,p,v);break e;case 1:y=KF(null,y,A,p,v);break e;case 11:y=jF(null,y,A,p,v);break e;case 14:y=WF(null,y,A,Ka(A.type,p),v);break e}throw Error(n(306,A,""))}return y;case 0:return A=y.type,F=y.pendingProps,F=y.elementType===A?F:Ka(A,F),g_(p,y,A,F,v);case 1:return A=y.type,F=y.pendingProps,F=y.elementType===A?F:Ka(A,F),KF(p,y,A,F,v);case 3:e:{if(qF(y),p===null)throw Error(n(387));A=y.pendingProps,Y=y.memoizedState,F=Y.element,cF(p,y),Kv(y,A,null,v);var ue=y.memoizedState;if(A=ue.element,Y.isDehydrated)if(Y={element:A,isDehydrated:!1,cache:ue.cache,pendingSuspenseBoundaries:ue.pendingSuspenseBoundaries,transitions:ue.transitions},y.updateQueue.baseState=Y,y.memoizedState=Y,y.flags&256){F=Rm(Error(n(423)),y),y=XF(p,y,A,v,F);break e}else if(A!==F){F=Rm(Error(n(424)),y),y=XF(p,y,A,v,F);break e}else for(Ao=rd(y.stateNode.containerInfo.firstChild),_o=y,ur=!0,Ya=null,v=lF(y,null,A,v),y.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(Tm(),A===F){y=Xu(p,y,v);break e}Ti(p,y,A,v)}y=y.child}return y;case 5:return fF(y),p===null&&HE(y),A=y.type,F=y.pendingProps,Y=p!==null?p.memoizedProps:null,ue=F.children,FE(A,F)?ue=null:Y!==null&&FE(A,Y)&&(y.flags|=32),YF(p,y),Ti(p,y,ue,v),y.child;case 6:return p===null&&HE(y),null;case 13:return ZF(p,y,v);case 4:return e_(y,y.stateNode.containerInfo),A=y.pendingProps,p===null?y.child=Em(y,null,A,v):Ti(p,y,A,v),y.child;case 11:return A=y.type,F=y.pendingProps,F=y.elementType===A?F:Ka(A,F),jF(p,y,A,F,v);case 7:return Ti(p,y,y.pendingProps,v),y.child;case 8:return Ti(p,y,y.pendingProps.children,v),y.child;case 12:return Ti(p,y,y.pendingProps.children,v),y.child;case 10:e:{if(A=y.type._context,F=y.pendingProps,Y=y.memoizedProps,ue=F.value,Qn(Gv,A._currentValue),A._currentValue=ue,Y!==null)if(Ha(Y.value,ue)){if(Y.children===F.children&&!Ki.current){y=Xu(p,y,v);break e}}else for(Y=y.child,Y!==null&&(Y.return=y);Y!==null;){var Te=Y.dependencies;if(Te!==null){ue=Y.child;for(var Oe=Te.firstContext;Oe!==null;){if(Oe.context===A){if(Y.tag===1){Oe=qu(-1,v&-v),Oe.tag=2;var Xe=Y.updateQueue;if(Xe!==null){Xe=Xe.shared;var nt=Xe.pending;nt===null?Oe.next=Oe:(Oe.next=nt.next,nt.next=Oe),Xe.pending=Oe}}Y.lanes|=v,Oe=Y.alternate,Oe!==null&&(Oe.lanes|=v),ZE(Y.return,v,y),Te.lanes|=v;break}Oe=Oe.next}}else if(Y.tag===10)ue=Y.type===y.type?null:Y.child;else if(Y.tag===18){if(ue=Y.return,ue===null)throw Error(n(341));ue.lanes|=v,Te=ue.alternate,Te!==null&&(Te.lanes|=v),ZE(ue,v,y),ue=Y.sibling}else ue=Y.child;if(ue!==null)ue.return=Y;else for(ue=Y;ue!==null;){if(ue===y){ue=null;break}if(Y=ue.sibling,Y!==null){Y.return=ue.return,ue=Y;break}ue=ue.return}Y=ue}Ti(p,y,F.children,v),y=y.child}return y;case 9:return F=y.type,A=y.pendingProps.children,Am(y,v),F=ra(F),A=A(F),y.flags|=1,Ti(p,y,A,v),y.child;case 14:return A=y.type,F=Ka(A,y.pendingProps),F=Ka(A.type,F),WF(p,y,A,F,v);case 15:return GF(p,y,y.type,y.pendingProps,v);case 17:return A=y.type,F=y.pendingProps,F=y.elementType===A?F:Ka(A,F),r2(p,y),y.tag=1,qi(A)?(p=!0,zv(y)):p=!1,Am(y,v),PF(y,A,F),f_(y,A,F,v),y_(null,y,A,!0,p,v);case 19:return JF(p,y,v);case 22:return HF(p,y,v)}throw Error(n(156,y.tag))};function CL(p,y){return Cn(p,y)}function Xne(p,y,v,A){this.tag=p,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oa(p,y,v,A){return new Xne(p,y,v,A)}function F_(p){return p=p.prototype,!(!p||!p.isReactComponent)}function Zne(p){if(typeof p=="function")return F_(p)?1:0;if(p!=null){if(p=p.$$typeof,p===j)return 11;if(p===B)return 14}return 2}function pd(p,y){var v=p.alternate;return v===null?(v=oa(p.tag,y,p.key,p.mode),v.elementType=p.elementType,v.type=p.type,v.stateNode=p.stateNode,v.alternate=p,p.alternate=v):(v.pendingProps=y,v.type=p.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=p.flags&14680064,v.childLanes=p.childLanes,v.lanes=p.lanes,v.child=p.child,v.memoizedProps=p.memoizedProps,v.memoizedState=p.memoizedState,v.updateQueue=p.updateQueue,y=p.dependencies,v.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},v.sibling=p.sibling,v.index=p.index,v.ref=p.ref,v}function p2(p,y,v,A,F,Y){var ue=2;if(A=p,typeof p=="function")F_(p)&&(ue=1);else if(typeof p=="string")ue=5;else e:switch(p){case P:return ff(v.children,F,Y,y);case I:ue=8,F|=8;break;case E:return p=oa(12,v,y,F|2),p.elementType=E,p.lanes=Y,p;case R:return p=oa(13,v,y,F),p.elementType=R,p.lanes=Y,p;case z:return p=oa(19,v,y,F),p.elementType=z,p.lanes=Y,p;case H:return m2(v,F,Y,y);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case M:ue=10;break e;case O:ue=9;break e;case j:ue=11;break e;case B:ue=14;break e;case V:ue=16,A=null;break e}throw Error(n(130,p==null?p:typeof p,""))}return y=oa(ue,v,y,F),y.elementType=p,y.type=A,y.lanes=Y,y}function ff(p,y,v,A){return p=oa(7,p,A,y),p.lanes=v,p}function m2(p,y,v,A){return p=oa(22,p,A,y),p.elementType=H,p.lanes=v,p.stateNode={isHidden:!1},p}function L_(p,y,v){return p=oa(6,p,null,y),p.lanes=v,p}function z_(p,y,v){return y=oa(4,p.children!==null?p.children:[],p.key,y),y.lanes=v,y.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},y}function Qne(p,y,v,A,F){this.tag=y,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=am(0),this.expirationTimes=am(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=am(0),this.identifierPrefix=A,this.onRecoverableError=F,this.mutableSourceEagerHydrationData=null}function B_(p,y,v,A,F,Y,ue,Te,Oe){return p=new Qne(p,y,v,Te,Oe),y===1?(y=1,Y===!0&&(y|=8)):y=0,Y=oa(3,null,null,y),p.current=Y,Y.stateNode=p,Y.memoizedState={element:A,isDehydrated:v,cache:null,transitions:null,pendingSuspenseBoundaries:null},JE(Y),p}function Jne(p,y,v){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:A==null?null:""+A,children:p,containerInfo:y,implementation:v}}function IL(p){if(!p)return id;p=p._reactInternals;e:{if(Eo(p)!==p||p.tag!==1)throw Error(n(170));var y=p;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(qi(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(n(171))}if(p.tag===1){var v=p.type;if(qi(v))return Q4(p,v,y)}return y}function NL(p,y,v,A,F,Y,ue,Te,Oe){return p=B_(v,A,!0,p,F,Y,ue,Te,Oe),p.context=IL(null),v=p.current,A=Ei(),F=hd(v),Y=qu(A,F),Y.callback=y??null,ld(v,Y,F),p.current.lanes=F,Hc(p,F,A),Qi(p,A),p}function g2(p,y,v,A){var F=y.current,Y=Ei(),ue=hd(F);return v=IL(v),y.context===null?y.context=v:y.pendingContext=v,y=qu(Y,ue),y.payload={element:p},A=A===void 0?null:A,A!==null&&(y.callback=A),p=ld(F,y,ue),p!==null&&(Za(p,F,ue,Y),Yv(p,F,ue)),ue}function y2(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 5:return p.child.stateNode;default:return p.child.stateNode}}function kL(p,y){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var v=p.retryLane;p.retryLane=v!==0&&v<y?v:y}}function U_(p,y){kL(p,y),(p=p.alternate)&&kL(p,y)}function ere(){return null}var TL=typeof reportError=="function"?reportError:function(p){console.error(p)};function V_(p){this._internalRoot=p}x2.prototype.render=V_.prototype.render=function(p){var y=this._internalRoot;if(y===null)throw Error(n(409));g2(p,y,null,null)},x2.prototype.unmount=V_.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var y=p.containerInfo;cf(function(){g2(null,p,null,null)}),y[Wu]=null}};function x2(p){this._internalRoot=p}x2.prototype.unstable_scheduleHydration=function(p){if(p){var y=Yc();p={blockedOn:null,target:p,priority:y};for(var v=0;v<zl.length&&y!==0&&y<zl[v].priority;v++);zl.splice(v,0,p),v===0&&qc(p)}};function j_(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function w2(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11&&(p.nodeType!==8||p.nodeValue!==" react-mount-point-unstable "))}function EL(){}function tre(p,y,v,A,F){if(F){if(typeof A=="function"){var Y=A;A=function(){var Xe=y2(ue);Y.call(Xe)}}var ue=NL(y,A,p,0,null,!1,!1,"",EL);return p._reactRootContainer=ue,p[Wu]=ue.current,qy(p.nodeType===8?p.parentNode:p),cf(),ue}for(;F=p.lastChild;)p.removeChild(F);if(typeof A=="function"){var Te=A;A=function(){var Xe=y2(Oe);Te.call(Xe)}}var Oe=B_(p,0,!1,null,null,!1,!1,"",EL);return p._reactRootContainer=Oe,p[Wu]=Oe.current,qy(p.nodeType===8?p.parentNode:p),cf(function(){g2(y,Oe,v,A)}),Oe}function b2(p,y,v,A,F){var Y=v._reactRootContainer;if(Y){var ue=Y;if(typeof F=="function"){var Te=F;F=function(){var Oe=y2(ue);Te.call(Oe)}}g2(y,ue,p,F)}else ue=tre(v,y,p,F,A);return y2(ue)}Hh=function(p){switch(p.tag){case 3:var y=p.stateNode;if(y.current.memoizedState.isDehydrated){var v=Gc(y.pendingLanes);v!==0&&(Ly(y,v|1),Qi(y,Dt()),(In&6)===0&&(Om=Dt()+500,od()))}break;case 13:cf(function(){var A=Ku(p,1);if(A!==null){var F=Ei();Za(A,p,1,F)}}),U_(p,1)}},lm=function(p){if(p.tag===13){var y=Ku(p,134217728);if(y!==null){var v=Ei();Za(y,p,134217728,v)}U_(p,134217728)}},By=function(p){if(p.tag===13){var y=hd(p),v=Ku(p,y);if(v!==null){var A=Ei();Za(v,p,y,A)}U_(p,y)}},Yc=function(){return kn},yv=function(p,y){var v=kn;try{return kn=p,y()}finally{kn=v}},No=function(p,y,v){switch(y){case"input":if(L(p,v),y=v.name,v.type==="radio"&&y!=null){for(v=p;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll("input[name="+JSON.stringify(""+y)+'][type="radio"]'),y=0;y<v.length;y++){var A=v[y];if(A!==p&&A.form===p.form){var F=Fv(A);if(!F)throw Error(n(90));ye(A),L(A,F)}}}break;case"textarea":He(p,v);break;case"select":y=v.value,y!=null&&ie(p,!!v.multiple,y,!1)}},Bh=D_,sm=cf;var nre={usingClientEntryPoint:!1,Events:[Qy,Sm,Fv,Lu,us,D_]},hx={findFiberByHostInstance:tf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rre={bundleType:hx.bundleType,version:hx.version,rendererPackageName:hx.rendererPackageName,rendererConfig:hx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(p){return p=jc(p),p===null?null:p.stateNode},findFiberByHostInstance:hx.findFiberByHostInstance||ere,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var v2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!v2.isDisabled&&v2.supportsFiber)try{Ii=v2.inject(rre),Ni=v2}catch{}}return Ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nre,Ji.createPortal=function(p,y){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j_(y))throw Error(n(200));return Jne(p,y,null,v)},Ji.createRoot=function(p,y){if(!j_(p))throw Error(n(299));var v=!1,A="",F=TL;return y!=null&&(y.unstable_strictMode===!0&&(v=!0),y.identifierPrefix!==void 0&&(A=y.identifierPrefix),y.onRecoverableError!==void 0&&(F=y.onRecoverableError)),y=B_(p,1,!1,null,null,v,!1,A,F),p[Wu]=y.current,qy(p.nodeType===8?p.parentNode:p),new V_(y)},Ji.findDOMNode=function(p){if(p==null)return null;if(p.nodeType===1)return p;var y=p._reactInternals;if(y===void 0)throw typeof p.render=="function"?Error(n(188)):(p=Object.keys(p).join(","),Error(n(268,p)));return p=jc(y),p=p===null?null:p.stateNode,p},Ji.flushSync=function(p){return cf(p)},Ji.hydrate=function(p,y,v){if(!w2(y))throw Error(n(200));return b2(null,p,y,!0,v)},Ji.hydrateRoot=function(p,y,v){if(!j_(p))throw Error(n(405));var A=v!=null&&v.hydratedSources||null,F=!1,Y="",ue=TL;if(v!=null&&(v.unstable_strictMode===!0&&(F=!0),v.identifierPrefix!==void 0&&(Y=v.identifierPrefix),v.onRecoverableError!==void 0&&(ue=v.onRecoverableError)),y=NL(y,null,p,1,v??null,F,!1,Y,ue),p[Wu]=y.current,qy(p),A)for(p=0;p<A.length;p++)v=A[p],F=v._getVersion,F=F(v._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[v,F]:y.mutableSourceEagerHydrationData.push(v,F);return new x2(y)},Ji.render=function(p,y,v){if(!w2(y))throw Error(n(200));return b2(null,p,y,!1,v)},Ji.unmountComponentAtNode=function(p){if(!w2(p))throw Error(n(40));return p._reactRootContainer?(cf(function(){b2(null,null,p,!1,function(){p._reactRootContainer=null,p[Wu]=null})}),!0):!1},Ji.unstable_batchedUpdates=D_,Ji.unstable_renderSubtreeIntoContainer=function(p,y,v,A){if(!w2(v))throw Error(n(200));if(p==null||p._reactInternals===void 0)throw Error(n(38));return b2(p,y,v,!1,A)},Ji.version="18.3.1-next-f1338f8080-20240426",Ji}var PL;function S8(){if(PL)return H_.exports;PL=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),H_.exports=hre(),H_.exports}var FL;function fre(){if(FL)return S2;FL=1;var t=S8();return S2.createRoot=t.createRoot,S2.hydrateRoot=t.hydrateRoot,S2}var pre=fre();const mre=Dp(pre);var px={},LL;function gre(){if(LL)return px;LL=1,Object.defineProperty(px,"__esModule",{value:!0}),px.parse=o,px.serialize=u;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,i=(()=>{const h=function(){};return h.prototype=Object.create(null),h})();function o(h,f){const m=new i,g=h.length;if(g<2)return m;const x=(f==null?void 0:f.decode)||c;let w=0;do{const b=h.indexOf("=",w);if(b===-1)break;const S=h.indexOf(";",w),C=S===-1?g:S;if(b>C){w=h.lastIndexOf(";",b-1)+1;continue}const T=a(h,w,b),D=l(h,b,T),P=h.slice(T,D);if(m[P]===void 0){let I=a(h,b+1,C),E=l(h,C,I);const M=x(h.slice(I,E));m[P]=M}w=C+1}while(w<g);return m}function a(h,f,m){do{const g=h.charCodeAt(f);if(g!==32&&g!==9)return f}while(++f<m);return m}function l(h,f,m){for(;f>m;){const g=h.charCodeAt(--f);if(g!==32&&g!==9)return f+1}return m}function u(h,f,m){const g=(m==null?void 0:m.encode)||encodeURIComponent;if(!t.test(h))throw new TypeError(`argument name is invalid: ${h}`);const x=g(f);if(!e.test(x))throw new TypeError(`argument val is invalid: ${f}`);let w=h+"="+x;if(!m)return w;if(m.maxAge!==void 0){if(!Number.isInteger(m.maxAge))throw new TypeError(`option maxAge is invalid: ${m.maxAge}`);w+="; Max-Age="+m.maxAge}if(m.domain){if(!n.test(m.domain))throw new TypeError(`option domain is invalid: ${m.domain}`);w+="; Domain="+m.domain}if(m.path){if(!r.test(m.path))throw new TypeError(`option path is invalid: ${m.path}`);w+="; Path="+m.path}if(m.expires){if(!d(m.expires)||!Number.isFinite(m.expires.valueOf()))throw new TypeError(`option expires is invalid: ${m.expires}`);w+="; Expires="+m.expires.toUTCString()}if(m.httpOnly&&(w+="; HttpOnly"),m.secure&&(w+="; Secure"),m.partitioned&&(w+="; Partitioned"),m.priority)switch(typeof m.priority=="string"?m.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${m.priority}`)}if(m.sameSite)switch(typeof m.sameSite=="string"?m.sameSite.toLowerCase():m.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${m.sameSite}`)}return w}function c(h){if(h.indexOf("%")===-1)return h;try{return decodeURIComponent(h)}catch{return h}}function d(h){return s.call(h)==="[object Date]"}return px}gre();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var zL="popstate";function yre(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return c$("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Lw(s)}return wre(e,n,null,t)}function vr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Cu(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xre(){return Math.random().toString(36).substring(2,10)}function BL(t,e){return{usr:t.state,key:t.key,idx:e}}function c$(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?u0(e):e,state:n,key:e&&e.key||r||xre()}}function Lw({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function u0(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function wre(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,u=c();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function c(){return(o.state||{idx:null}).idx}function d(){a="POP";let x=c(),w=x==null?null:x-u;u=x,l&&l({action:a,location:g.location,delta:w})}function h(x,w){a="PUSH";let b=c$(g.location,x,w);u=c()+1;let S=BL(b,u),C=g.createHref(b);try{o.pushState(S,"",C)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(C)}i&&l&&l({action:a,location:g.location,delta:1})}function f(x,w){a="REPLACE";let b=c$(g.location,x,w);u=c();let S=BL(b,u),C=g.createHref(b);o.replaceState(S,"",C),i&&l&&l({action:a,location:g.location,delta:0})}function m(x){let w=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof x=="string"?x:Lw(x);return b=b.replace(/ $/,"%20"),vr(w,`No window.location.(origin|href) available to create URL for href: ${b}`),new URL(b,w)}let g={get action(){return a},get location(){return t(s,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(zL,d),l=x,()=>{s.removeEventListener(zL,d),l=null}},createHref(x){return e(s,x)},createURL:m,encodeLocation(x){let w=m(x);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:h,replace:f,go(x){return o.go(x)}};return g}function C8(t,e,n="/"){return bre(t,e,n,!1)}function bre(t,e,n,r){let s=typeof e=="string"?u0(e):e,i=Tc(s.pathname||"/",n);if(i==null)return null;let o=I8(t);vre(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=Rre(i);a=Are(o[l],u,r)}return a}function I8(t,e=[],n=[],r=""){let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(vr(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let u=xc([r,l.relativePath]),c=n.concat(l);i.children&&i.children.length>0&&(vr(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),I8(i.children,e,c,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:Ere(u,i.index),routesMeta:c})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of N8(i.path))s(i,o,l)}),e}function N8(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=N8(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function vre(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:_re(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var Sre=/^:[\w-]+$/,Cre=3,Ire=2,Nre=1,kre=10,Tre=-2,UL=t=>t==="*";function Ere(t,e){let n=t.split("/"),r=n.length;return n.some(UL)&&(r+=Tre),e&&(r+=Ire),n.filter(s=>!UL(s)).reduce((s,i)=>s+(Sre.test(i)?Cre:i===""?Nre:kre),r)}function _re(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function Are(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,c=i==="/"?e:e.slice(i.length)||"/",d=VC({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),h=l.route;if(!d&&u&&n&&!r[r.length-1].route.index&&(d=VC({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:xc([i,d.pathname]),pathnameBase:Pre(xc([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=xc([i,d.pathnameBase]))}return o}function VC(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=$re(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,{paramName:c,isOptional:d},h)=>{if(c==="*"){let m=a[h]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const f=a[h];return d&&!f?u[c]=void 0:u[c]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function $re(t,e=!1,n=!0){Cu(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Rre(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Cu(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Tc(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Mre(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?u0(t):t;return{pathname:n?n.startsWith("/")?n:Dre(n,e):e,search:Fre(r),hash:Lre(s)}}function Dre(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function q_(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Ore(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function k8(t){let e=Ore(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function T8(t,e,n,r=!1){let s;typeof t=="string"?s=u0(t):(s={...t},vr(!s.pathname||!s.pathname.includes("?"),q_("?","pathname","search",s)),vr(!s.pathname||!s.pathname.includes("#"),q_("#","pathname","hash",s)),vr(!s.search||!s.search.includes("#"),q_("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=Mre(s,a),u=o&&o!=="/"&&o.endsWith("/"),c=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}var xc=t=>t.join("/").replace(/\/\/+/g,"/"),Pre=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Fre=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Lre=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function zre(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var E8=["POST","PUT","PATCH","DELETE"];new Set(E8);var Bre=["GET",...E8];new Set(Bre);var c0=W.createContext(null);c0.displayName="DataRouter";var hN=W.createContext(null);hN.displayName="DataRouterState";var _8=W.createContext({isTransitioning:!1});_8.displayName="ViewTransition";var Ure=W.createContext(new Map);Ure.displayName="Fetchers";var Vre=W.createContext(null);Vre.displayName="Await";var $u=W.createContext(null);$u.displayName="Navigation";var N1=W.createContext(null);N1.displayName="Location";var Dc=W.createContext({outlet:null,matches:[],isDataRoute:!1});Dc.displayName="Route";var kM=W.createContext(null);kM.displayName="RouteError";function jre(t,{relative:e}={}){vr(k1(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=W.useContext($u),{hash:s,pathname:i,search:o}=T1(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:xc([n,i])),r.createHref({pathname:a,search:o,hash:s})}function k1(){return W.useContext(N1)!=null}function Op(){return vr(k1(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(N1).location}var A8="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $8(t){W.useContext($u).static||W.useLayoutEffect(t)}function Wre(){let{isDataRoute:t}=W.useContext(Dc);return t?rse():Gre()}function Gre(){vr(k1(),"useNavigate() may be used only in the context of a <Router> component.");let t=W.useContext(c0),{basename:e,navigator:n}=W.useContext($u),{matches:r}=W.useContext(Dc),{pathname:s}=Op(),i=JSON.stringify(k8(r)),o=W.useRef(!1);return $8(()=>{o.current=!0}),W.useCallback((l,u={})=>{if(Cu(o.current,A8),!o.current)return;if(typeof l=="number"){n.go(l);return}let c=T8(l,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:xc([e,c.pathname])),(u.replace?n.replace:n.push)(c,u.state,u)},[e,n,i,s,t])}W.createContext(null);function T1(t,{relative:e}={}){let{matches:n}=W.useContext(Dc),{pathname:r}=Op(),s=JSON.stringify(k8(n));return W.useMemo(()=>T8(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function Hre(t,e){return R8(t,e)}function R8(t,e,n,r){var b;vr(k1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:i}=W.useContext($u),{matches:o}=W.useContext(Dc),a=o[o.length-1],l=a?a.params:{},u=a?a.pathname:"/",c=a?a.pathnameBase:"/",d=a&&a.route;{let S=d&&d.path||"";M8(u,!d||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let h=Op(),f;if(e){let S=typeof e=="string"?u0(e):e;vr(c==="/"||((b=S.pathname)==null?void 0:b.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${S.pathname}" was given in the \`location\` prop.`),f=S}else f=h;let m=f.pathname||"/",g=m;if(c!=="/"){let S=c.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(S.length).join("/")}let x=!i&&n&&n.matches&&n.matches.length>0?n.matches:C8(t,{pathname:g});Cu(d||x!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Cu(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=Zre(x&&x.map(S=>Object.assign({},S,{params:Object.assign({},l,S.params),pathname:xc([c,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?c:xc([c,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),o,n,r);return e&&w?W.createElement(N1.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},w):w}function Yre(){let t=nse(),e=zre(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=W.createElement(W.Fragment,null,W.createElement("p",null," Hey developer "),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:i},"ErrorBoundary")," or"," ",W.createElement("code",{style:i},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},e),n?W.createElement("pre",{style:s},n):null,o)}var Kre=W.createElement(Yre,null),qre=class extends W.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?W.createElement(Dc.Provider,{value:this.props.routeContext},W.createElement(kM.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Xre({routeContext:t,match:e,children:n}){let r=W.useContext(c0);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),W.createElement(Dc.Provider,{value:t},n)}function Zre(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,i=n==null?void 0:n.errors;if(i!=null){let l=s.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);vr(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,l+1))}let o=!1,a=-1;if(n)for(let l=0;l<s.length;l++){let u=s[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(a=l),u.route.id){let{loaderData:c,errors:d}=n,h=u.route.loader&&!c.hasOwnProperty(u.route.id)&&(!d||d[u.route.id]===void 0);if(u.route.lazy||h){o=!0,a>=0?s=s.slice(0,a+1):s=[s[0]];break}}}return s.reduceRight((l,u,c)=>{let d,h=!1,f=null,m=null;n&&(d=i&&u.route.id?i[u.route.id]:void 0,f=u.route.errorElement||Kre,o&&(a<0&&c===0?(M8("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,m=null):a===c&&(h=!0,m=u.route.hydrateFallbackElement||null)));let g=e.concat(s.slice(0,c+1)),x=()=>{let w;return d?w=f:h?w=m:u.route.Component?w=W.createElement(u.route.Component,null):u.route.element?w=u.route.element:w=l,W.createElement(Xre,{match:u,routeContext:{outlet:l,matches:g,isDataRoute:n!=null},children:w})};return n&&(u.route.ErrorBoundary||u.route.errorElement||c===0)?W.createElement(qre,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}function TM(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qre(t){let e=W.useContext(c0);return vr(e,TM(t)),e}function Jre(t){let e=W.useContext(hN);return vr(e,TM(t)),e}function ese(t){let e=W.useContext(Dc);return vr(e,TM(t)),e}function EM(t){let e=ese(t),n=e.matches[e.matches.length-1];return vr(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function tse(){return EM("useRouteId")}function nse(){var r;let t=W.useContext(kM),e=Jre("useRouteError"),n=EM("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function rse(){let{router:t}=Qre("useNavigate"),e=EM("useNavigate"),n=W.useRef(!1);return $8(()=>{n.current=!0}),W.useCallback(async(s,i={})=>{Cu(n.current,A8),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var VL={};function M8(t,e,n){!e&&!VL[t]&&(VL[t]=!0,Cu(!1,n))}W.memo(sse);function sse({routes:t,future:e,state:n}){return R8(t,void 0,n,e)}function Cf(t){vr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ise({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){vr(!k1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=W.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=u0(n));let{pathname:l="/",search:u="",hash:c="",state:d=null,key:h="default"}=n,f=W.useMemo(()=>{let m=Tc(l,o);return m==null?null:{location:{pathname:m,search:u,hash:c,state:d,key:h},navigationType:r}},[o,l,u,c,d,h,r]);return Cu(f!=null,`<Router basename="${o}"> is not able to match the URL "${l}${u}${c}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:W.createElement($u.Provider,{value:a},W.createElement(N1.Provider,{children:e,value:f}))}function ose({children:t,location:e}){return Hre(d$(t),e)}function d$(t,e=[]){let n=[];return W.Children.forEach(t,(r,s)=>{if(!W.isValidElement(r))return;let i=[...e,s];if(r.type===W.Fragment){n.push.apply(n,d$(r.props.children,i));return}vr(r.type===Cf,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),vr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=d$(r.props.children,i)),n.push(o)}),n}var _S="get",AS="application/x-www-form-urlencoded";function fN(t){return t!=null&&typeof t.tagName=="string"}function ase(t){return fN(t)&&t.tagName.toLowerCase()==="button"}function lse(t){return fN(t)&&t.tagName.toLowerCase()==="form"}function use(t){return fN(t)&&t.tagName.toLowerCase()==="input"}function cse(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function dse(t,e){return t.button===0&&(!e||e==="_self")&&!cse(t)}var C2=null;function hse(){if(C2===null)try{new FormData(document.createElement("form"),0),C2=!1}catch{C2=!0}return C2}var fse=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function X_(t){return t!=null&&!fse.has(t)?(Cu(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${AS}"`),null):t}function pse(t,e){let n,r,s,i,o;if(lse(t)){let a=t.getAttribute("action");r=a?Tc(a,e):null,n=t.getAttribute("method")||_S,s=X_(t.getAttribute("enctype"))||AS,i=new FormData(t)}else if(ase(t)||use(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Tc(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||_S,s=X_(t.getAttribute("formenctype"))||X_(a.getAttribute("enctype"))||AS,i=new FormData(a,t),!hse()){let{name:u,type:c,value:d}=t;if(c==="image"){let h=u?`${u}.`:"";i.append(`${h}x`,"0"),i.append(`${h}y`,"0")}else u&&i.append(u,d)}}else{if(fN(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=_S,r=null,s=AS,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}function _M(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function mse(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gse(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function yse(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await mse(i,n);return o.links?o.links():[]}return[]}));return vse(r.flat(1).filter(gse).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function jL(t,e,n,r,s,i){let o=(l,u)=>n[u]?l.route.id!==n[u].route.id:!0,a=(l,u)=>{var c;return n[u].pathname!==l.pathname||((c=n[u].route.path)==null?void 0:c.endsWith("*"))&&n[u].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,u)=>o(l,u)||a(l,u)):i==="data"?e.filter((l,u)=>{var d;let c=r.routes[l.route.id];if(!c||!c.hasLoader)return!1;if(o(l,u)||a(l,u))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function xse(t,e,{includeHydrateFallback:n}={}){return wse(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function wse(t){return[...new Set(t)]}function bse(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function vse(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(bse(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function Sse(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Tc(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function D8(){let t=W.useContext(c0);return _M(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Cse(){let t=W.useContext(hN);return _M(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var AM=W.createContext(void 0);AM.displayName="FrameworkContext";function O8(){let t=W.useContext(AM);return _M(t,"You must render this element inside a <HydratedRouter> element"),t}function Ise(t,e){let n=W.useContext(AM),[r,s]=W.useState(!1),[i,o]=W.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:u,onMouseLeave:c,onTouchStart:d}=e,h=W.useRef(null);W.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let g=w=>{w.forEach(b=>{o(b.isIntersecting)})},x=new IntersectionObserver(g,{threshold:.5});return h.current&&x.observe(h.current),()=>{x.disconnect()}}},[t]),W.useEffect(()=>{if(r){let g=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(g)}}},[r]);let f=()=>{s(!0)},m=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,h,{}]:[i,h,{onFocus:mx(a,f),onBlur:mx(l,m),onMouseEnter:mx(u,f),onMouseLeave:mx(c,m),onTouchStart:mx(d,f)}]:[!1,h,{}]}function mx(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Nse({page:t,...e}){let{router:n}=D8(),r=W.useMemo(()=>C8(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?W.createElement(Tse,{page:t,matches:r,...e}):null}function kse(t){let{manifest:e,routeModules:n}=O8(),[r,s]=W.useState([]);return W.useEffect(()=>{let i=!1;return yse(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function Tse({page:t,matches:e,...n}){let r=Op(),{manifest:s,routeModules:i}=O8(),{basename:o}=D8(),{loaderData:a,matches:l}=Cse(),u=W.useMemo(()=>jL(t,e,l,s,r,"data"),[t,e,l,s,r]),c=W.useMemo(()=>jL(t,e,l,s,r,"assets"),[t,e,l,s,r]),d=W.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let m=new Set,g=!1;if(e.forEach(w=>{var S;let b=s.routes[w.route.id];!b||!b.hasLoader||(!u.some(C=>C.route.id===w.route.id)&&w.route.id in a&&((S=i[w.route.id])!=null&&S.shouldRevalidate)||b.hasClientLoader?g=!0:m.add(w.route.id))}),m.size===0)return[];let x=Sse(t,o);return g&&m.size>0&&x.searchParams.set("_routes",e.filter(w=>m.has(w.route.id)).map(w=>w.route.id).join(",")),[x.pathname+x.search]},[o,a,r,s,u,e,t,i]),h=W.useMemo(()=>xse(c,s),[c,s]),f=kse(c);return W.createElement(W.Fragment,null,d.map(m=>W.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...n})),h.map(m=>W.createElement("link",{key:m,rel:"modulepreload",href:m,...n})),f.map(({key:m,link:g})=>W.createElement("link",{key:m,...g})))}function Ese(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var P8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{P8&&(window.__reactRouterVersion="7.4.0")}catch{}function _se({basename:t,children:e,window:n}){let r=W.useRef();r.current==null&&(r.current=yre({window:n,v5Compat:!0}));let s=r.current,[i,o]=W.useState({action:s.action,location:s.location}),a=W.useCallback(l=>{W.startTransition(()=>o(l))},[o]);return W.useLayoutEffect(()=>s.listen(a),[s,a]),W.createElement(ise,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var F8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gg=W.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:d,...h},f){let{basename:m}=W.useContext($u),g=typeof u=="string"&&F8.test(u),x,w=!1;if(typeof u=="string"&&g&&(x=u,P8))try{let E=new URL(window.location.href),M=u.startsWith("//")?new URL(E.protocol+u):new URL(u),O=Tc(M.pathname,m);M.origin===E.origin&&O!=null?u=O+M.search+M.hash:w=!0}catch{Cu(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=jre(u,{relative:s}),[S,C,T]=Ise(r,h),D=Mse(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:s,viewTransition:d});function P(E){e&&e(E),E.defaultPrevented||D(E)}let I=W.createElement("a",{...h,...T,href:x||b,onClick:w||i?e:P,ref:Ese(f,C),target:l,"data-discover":!g&&n==="render"?"true":void 0});return S&&!g?W.createElement(W.Fragment,null,I,W.createElement(Nse,{page:b})):I});gg.displayName="Link";var Ase=W.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...u},c){let d=T1(o,{relative:u.relative}),h=Op(),f=W.useContext(hN),{navigator:m,basename:g}=W.useContext($u),x=f!=null&&Lse(d)&&a===!0,w=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,b=h.pathname,S=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;n||(b=b.toLowerCase(),S=S?S.toLowerCase():null,w=w.toLowerCase()),S&&g&&(S=Tc(S,g)||S);const C=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let T=b===w||!s&&b.startsWith(w)&&b.charAt(C)==="/",D=S!=null&&(S===w||!s&&S.startsWith(w)&&S.charAt(w.length)==="/"),P={isActive:T,isPending:D,isTransitioning:x},I=T?e:void 0,E;typeof r=="function"?E=r(P):E=[r,T?"active":null,D?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let M=typeof i=="function"?i(P):i;return W.createElement(gg,{...u,"aria-current":I,className:E,ref:c,style:M,to:o,viewTransition:a},typeof l=="function"?l(P):l)});Ase.displayName="NavLink";var $se=W.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=_S,action:a,onSubmit:l,relative:u,preventScrollReset:c,viewTransition:d,...h},f)=>{let m=Pse(),g=Fse(a,{relative:u}),x=o.toLowerCase()==="get"?"get":"post",w=typeof a=="string"&&F8.test(a),b=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let C=S.nativeEvent.submitter,T=(C==null?void 0:C.getAttribute("formmethod"))||o;m(C||S.currentTarget,{fetcherKey:e,method:T,navigate:n,replace:s,state:i,relative:u,preventScrollReset:c,viewTransition:d})};return W.createElement("form",{ref:f,method:x,action:g,onSubmit:r?l:b,...h,"data-discover":!w&&t==="render"?"true":void 0})});$se.displayName="Form";function Rse(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function L8(t){let e=W.useContext(c0);return vr(e,Rse(t)),e}function Mse(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=Wre(),l=Op(),u=T1(t,{relative:i});return W.useCallback(c=>{if(dse(c,e)){c.preventDefault();let d=n!==void 0?n:Lw(l)===Lw(u);a(t,{replace:d,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,u,n,r,e,t,s,i,o])}var Dse=0,Ose=()=>`__${String(++Dse)}__`;function Pse(){let{router:t}=L8("useSubmit"),{basename:e}=W.useContext($u),n=tse();return W.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:l,body:u}=pse(r,e);if(s.navigate===!1){let c=s.fetcherKey||Ose();await t.fetch(c,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:u,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:u,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function Fse(t,{relative:e}={}){let{basename:n}=W.useContext($u),r=W.useContext(Dc);vr(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...T1(t||".",{relative:e})},o=Op();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(c=>c==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let c=a.toString();i.search=c?`?${c}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:xc([n,i.pathname])),Lw(i)}function Lse(t,e={}){let n=W.useContext(_8);vr(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=L8("useViewTransitionState"),s=T1(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Tc(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Tc(n.nextLocation.pathname,r)||n.nextLocation.pathname;return VC(s.pathname,o)!=null||VC(s.pathname,i)!=null}new TextEncoder;var Ea=S8();const zse=Dp(Ea);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Bse={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Use=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),lr=(t,e)=>{const n=W.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:l,...u},c)=>W.createElement("svg",{ref:c,...Bse,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Use(t)}`,a].join(" "),...u},[...e.map(([d,h])=>W.createElement(d,h)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=lr("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vse=lr("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jse=lr("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wse=lr("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gse=lr("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hse=lr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yse=lr("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=lr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kse=lr("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=lr("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qse=lr("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xse=lr("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zse=lr("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qse=lr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jse=lr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eie=lr("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=lr("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tie=lr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nie=lr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rie=lr("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sie=lr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iie=lr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oie=lr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aie=lr("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.325.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lie=lr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),U8=W.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),pN=W.createContext({}),mN=W.createContext(null),gN=typeof document<"u",RM=gN?W.useLayoutEffect:W.useEffect,V8=W.createContext({strict:!1}),MM=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),uie="framerAppearId",j8="data-"+MM(uie);function cie(t,e,n,r){const{visualElement:s}=W.useContext(pN),i=W.useContext(V8),o=W.useContext(mN),a=W.useContext(U8).reducedMotion,l=W.useRef();r=r||i.renderer,!l.current&&r&&(l.current=r(t,{visualState:e,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const u=l.current;W.useInsertionEffect(()=>{u&&u.update(n,o)});const c=W.useRef(!!(n[j8]&&!window.HandoffComplete));return RM(()=>{u&&(u.render(),c.current&&u.animationState&&u.animationState.animateChanges())}),W.useEffect(()=>{u&&(u.updateFeatures(),!c.current&&u.animationState&&u.animationState.animateChanges(),c.current&&(c.current=!1,window.HandoffComplete=!0))}),u}function yg(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function die(t,e,n){return W.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):yg(n)&&(n.current=r))},[e])}function zw(t){return typeof t=="string"||Array.isArray(t)}function yN(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const DM=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],OM=["initial",...DM];function xN(t){return yN(t.animate)||OM.some(e=>zw(t[e]))}function W8(t){return!!(xN(t)||t.variants)}function hie(t,e){if(xN(t)){const{initial:n,animate:r}=t;return{initial:n===!1||zw(n)?n:void 0,animate:zw(r)?r:void 0}}return t.inherit!==!1?e:{}}function fie(t){const{initial:e,animate:n}=hie(t,W.useContext(pN));return W.useMemo(()=>({initial:e,animate:n}),[GL(e),GL(n)])}function GL(t){return Array.isArray(t)?t.join(" "):t}const HL={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Bw={};for(const t in HL)Bw[t]={isEnabled:e=>HL[t].some(n=>!!e[n])};function pie(t){for(const e in t)Bw[e]={...Bw[e],...t[e]}}const PM=W.createContext({}),G8=W.createContext({}),mie=Symbol.for("motionComponentSymbol");function gie({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&pie(t);function i(a,l){let u;const c={...W.useContext(U8),...a,layoutId:yie(a)},{isStatic:d}=c,h=fie(a),f=r(a,d);if(!d&&gN){h.visualElement=cie(s,f,c,e);const m=W.useContext(G8),g=W.useContext(V8).strict;h.visualElement&&(u=h.visualElement.loadFeatures(c,g,t,m))}return W.createElement(pN.Provider,{value:h},u&&h.visualElement?W.createElement(u,{visualElement:h.visualElement,...c}):null,n(s,a,die(f,h.visualElement,l),f,d,h.visualElement))}const o=W.forwardRef(i);return o[mie]=s,o}function yie({layoutId:t}){const e=W.useContext(PM).id;return e&&t!==void 0?e+"-"+t:t}function xie(t){function e(r,s={}){return gie(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const wie=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function FM(t){return typeof t!="string"||t.includes("-")?!1:!!(wie.indexOf(t)>-1||/[A-Z]/.test(t))}const jC={};function bie(t){Object.assign(jC,t)}const E1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pp=new Set(E1);function H8(t,{layout:e,layoutId:n}){return Pp.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!jC[t]||t==="opacity")}const yo=t=>!!(t&&t.getVelocity),vie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Sie=E1.length;function Cie(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let i="";for(let o=0;o<Sie;o++){const a=E1[o];if(t[a]!==void 0){const l=vie[a]||a;i+=`${l}(${t[a]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,r?"":i):n&&r&&(i="none"),i}const Y8=t=>e=>typeof e=="string"&&e.startsWith(t),K8=Y8("--"),h$=Y8("var(--"),Iie=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Nie=(t,e)=>e&&typeof t=="number"?e.transform(t):t,ih=(t,e,n)=>Math.min(Math.max(n,t),e),Fp={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},mw={...Fp,transform:t=>ih(0,1,t)},I2={...Fp,default:1},gw=t=>Math.round(t*1e5)/1e5,wN=/(-)?([\d]*\.?[\d])+/g,q8=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,kie=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function _1(t){return typeof t=="string"}const A1=t=>({test:e=>_1(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Nd=A1("deg"),mu=A1("%"),Xt=A1("px"),Tie=A1("vh"),Eie=A1("vw"),YL={...mu,parse:t=>mu.parse(t)/100,transform:t=>mu.transform(t*100)},KL={...Fp,transform:Math.round},X8={borderWidth:Xt,borderTopWidth:Xt,borderRightWidth:Xt,borderBottomWidth:Xt,borderLeftWidth:Xt,borderRadius:Xt,radius:Xt,borderTopLeftRadius:Xt,borderTopRightRadius:Xt,borderBottomRightRadius:Xt,borderBottomLeftRadius:Xt,width:Xt,maxWidth:Xt,height:Xt,maxHeight:Xt,size:Xt,top:Xt,right:Xt,bottom:Xt,left:Xt,padding:Xt,paddingTop:Xt,paddingRight:Xt,paddingBottom:Xt,paddingLeft:Xt,margin:Xt,marginTop:Xt,marginRight:Xt,marginBottom:Xt,marginLeft:Xt,rotate:Nd,rotateX:Nd,rotateY:Nd,rotateZ:Nd,scale:I2,scaleX:I2,scaleY:I2,scaleZ:I2,skew:Nd,skewX:Nd,skewY:Nd,distance:Xt,translateX:Xt,translateY:Xt,translateZ:Xt,x:Xt,y:Xt,z:Xt,perspective:Xt,transformPerspective:Xt,opacity:mw,originX:YL,originY:YL,originZ:Xt,zIndex:KL,fillOpacity:mw,strokeOpacity:mw,numOctaves:KL};function LM(t,e,n,r){const{style:s,vars:i,transform:o,transformOrigin:a}=t;let l=!1,u=!1,c=!0;for(const d in e){const h=e[d];if(K8(d)){i[d]=h;continue}const f=X8[d],m=Nie(h,f);if(Pp.has(d)){if(l=!0,o[d]=m,!c)continue;h!==(f.default||0)&&(c=!1)}else d.startsWith("origin")?(u=!0,a[d]=m):s[d]=m}if(e.transform||(l||r?s.transform=Cie(t.transform,n,c,r):s.transform&&(s.transform="none")),u){const{originX:d="50%",originY:h="50%",originZ:f=0}=a;s.transformOrigin=`${d} ${h} ${f}`}}const zM=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Z8(t,e,n){for(const r in e)!yo(e[r])&&!H8(r,n)&&(t[r]=e[r])}function _ie({transformTemplate:t},e,n){return W.useMemo(()=>{const r=zM();return LM(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function Aie(t,e,n){const r=t.style||{},s={};return Z8(s,r,t),Object.assign(s,_ie(t,e,n)),t.transformValues?t.transformValues(s):s}function $ie(t,e,n){const r={},s=Aie(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const Rie=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function WC(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Rie.has(t)}let Q8=t=>!WC(t);function Mie(t){t&&(Q8=e=>e.startsWith("on")?!WC(e):t(e))}try{Mie(require("@emotion/is-prop-valid").default)}catch{}function Die(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(Q8(s)||n===!0&&WC(s)||!e&&!WC(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function qL(t,e,n){return typeof t=="string"?t:Xt.transform(e+n*t)}function Oie(t,e,n){const r=qL(e,t.x,t.width),s=qL(n,t.y,t.height);return`${r} ${s}`}const Pie={offset:"stroke-dashoffset",array:"stroke-dasharray"},Fie={offset:"strokeDashoffset",array:"strokeDasharray"};function Lie(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?Pie:Fie;t[i.offset]=Xt.transform(-r);const o=Xt.transform(e),a=Xt.transform(n);t[i.array]=`${o} ${a}`}function BM(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...u},c,d,h){if(LM(t,u,c,h),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:m,dimensions:g}=t;f.transform&&(g&&(m.transform=f.transform),delete f.transform),g&&(s!==void 0||i!==void 0||m.transform)&&(m.transformOrigin=Oie(g,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),r!==void 0&&(f.scale=r),o!==void 0&&Lie(f,o,a,l,!1)}const J8=()=>({...zM(),attrs:{}}),UM=t=>typeof t=="string"&&t.toLowerCase()==="svg";function zie(t,e,n,r){const s=W.useMemo(()=>{const i=J8();return BM(i,e,{enableHardwareAcceleration:!1},UM(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};Z8(i,t.style,t),s.style={...i,...s.style}}return s}function Bie(t=!1){return(n,r,s,{latestValues:i},o)=>{const l=(FM(n)?zie:$ie)(r,i,o,n),c={...Die(r,typeof n=="string",t),...l,ref:s},{children:d}=r,h=W.useMemo(()=>yo(d)?d.get():d,[d]);return W.createElement(n,{...c,children:h})}}function eW(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const tW=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function nW(t,e,n,r){eW(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(tW.has(s)?s:MM(s),e.attrs[s])}function VM(t,e){const{style:n}=t,r={};for(const s in n)(yo(n[s])||e.style&&yo(e.style[s])||H8(s,t))&&(r[s]=n[s]);return r}function rW(t,e){const n=VM(t,e);for(const r in t)if(yo(t[r])||yo(e[r])){const s=E1.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=t[r]}return n}function jM(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}function sW(t){const e=W.useRef(null);return e.current===null&&(e.current=t()),e.current}const GC=t=>Array.isArray(t),Uie=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Vie=t=>GC(t)?t[t.length-1]||0:t;function $S(t){const e=yo(t)?t.get():t;return Uie(e)?e.toValue():e}function jie({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,i){const o={latestValues:Wie(r,s,i,t),renderState:e()};return n&&(o.mount=a=>n(r,a,o)),o}const iW=t=>(e,n)=>{const r=W.useContext(pN),s=W.useContext(mN),i=()=>jie(t,e,r,s);return n?i():sW(i)};function Wie(t,e,n,r){const s={},i=r(t,{});for(const h in i)s[h]=$S(i[h]);let{initial:o,animate:a}=t;const l=xN(t),u=W8(t);e&&u&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let c=n?n.initial===!1:!1;c=c||o===!1;const d=c?a:o;return d&&typeof d!="boolean"&&!yN(d)&&(Array.isArray(d)?d:[d]).forEach(f=>{const m=jM(t,f);if(!m)return;const{transitionEnd:g,transition:x,...w}=m;for(const b in w){let S=w[b];if(Array.isArray(S)){const C=c?S.length-1:0;S=S[C]}S!==null&&(s[b]=S)}for(const b in g)s[b]=g[b]}),s}const Lr=t=>t;let XL=class{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}};function Gie(t){let e=new XL,n=new XL,r=0,s=!1,i=!1;const o=new WeakSet,a={schedule:(l,u=!1,c=!1)=>{const d=c&&s,h=d?e:n;return u&&o.add(l),h.add(l)&&d&&s&&(r=e.order.length),l},cancel:l=>{n.remove(l),o.delete(l)},process:l=>{if(s){i=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const c=e.order[u];c(l),o.has(c)&&(a.schedule(c),t())}s=!1,i&&(i=!1,a.process(l))}};return a}const N2=["prepare","read","update","preRender","render","postRender"],Hie=40;function Yie(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=N2.reduce((d,h)=>(d[h]=Gie(()=>n=!0),d),{}),o=d=>i[d].process(s),a=()=>{const d=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(d-s.timestamp,Hie),1),s.timestamp=d,s.isProcessing=!0,N2.forEach(o),s.isProcessing=!1,n&&e&&(r=!1,t(a))},l=()=>{n=!0,r=!0,s.isProcessing||t(a)};return{schedule:N2.reduce((d,h)=>{const f=i[h];return d[h]=(m,g=!1,x=!1)=>(n||l(),f.schedule(m,g,x)),d},{}),cancel:d=>N2.forEach(h=>i[h].cancel(d)),state:s,steps:i}}const{schedule:er,cancel:Ec,state:ai,steps:Z_}=Yie(typeof requestAnimationFrame<"u"?requestAnimationFrame:Lr,!0),Kie={useVisualState:iW({scrapeMotionValuesFromProps:rW,createRenderState:J8,onMount:(t,e,{renderState:n,latestValues:r})=>{er.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),er.render(()=>{BM(n,r,{enableHardwareAcceleration:!1},UM(e.tagName),t.transformTemplate),nW(e,n)})}})},qie={useVisualState:iW({scrapeMotionValuesFromProps:VM,createRenderState:zM})};function Xie(t,{forwardMotionProps:e=!1},n,r){return{...FM(t)?Kie:qie,preloadedFeatures:n,useRender:Bie(e),createVisualElement:r,Component:t}}function gc(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const oW=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function bN(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Zie=t=>e=>oW(e)&&t(e,bN(e));function wc(t,e,n,r){return gc(t,e,Zie(n),r)}const Qie=(t,e)=>n=>e(t(n)),Zd=(...t)=>t.reduce(Qie);function aW(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const ZL=aW("dragHorizontal"),QL=aW("dragVertical");function lW(t){let e=!1;if(t==="y")e=QL();else if(t==="x")e=ZL();else{const n=ZL(),r=QL();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function uW(){const t=lW(!0);return t?(t(),!1):!0}class Ih{constructor(e){this.isMounted=!1,this.node=e}update(){}}function JL(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||uW())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[r]&&er.update(()=>a[r](i,o))};return wc(t.current,n,s,{passive:!t.getProps()[r]})}class Jie extends Ih{mount(){this.unmount=Zd(JL(this.node,!0),JL(this.node,!1))}unmount(){}}class eoe extends Ih{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Zd(gc(this.node.current,"focus",()=>this.onFocus()),gc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const cW=(t,e)=>e?t===e?!0:cW(t,e.parentElement):!1;function Q_(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,bN(n))}class toe extends Ih{constructor(){super(...arguments),this.removeStartListeners=Lr,this.removeEndListeners=Lr,this.removeAccessibleListeners=Lr,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=wc(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:c,globalTapTarget:d}=this.node.getProps();er.update(()=>{!d&&!cW(this.node.current,a.target)?c&&c(a,l):u&&u(a,l)})},{passive:!(r.onTap||r.onPointerUp)}),o=wc(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=Zd(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||Q_("up",(l,u)=>{const{onTap:c}=this.node.getProps();c&&er.update(()=>c(l,u))})};this.removeEndListeners(),this.removeEndListeners=gc(this.node.current,"keyup",o),Q_("down",(a,l)=>{this.startPress(a,l)})},n=gc(this.node.current,"keydown",e),r=()=>{this.isPressing&&Q_("cancel",(i,o)=>this.cancelPress(i,o))},s=gc(this.node.current,"blur",r);this.removeAccessibleListeners=Zd(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&er.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!uW()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&er.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=wc(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=gc(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Zd(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const f$=new WeakMap,J_=new WeakMap,noe=t=>{const e=f$.get(t.target);e&&e(t)},roe=t=>{t.forEach(noe)};function soe({root:t,...e}){const n=t||document;J_.has(n)||J_.set(n,{});const r=J_.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(roe,{root:t,...e})),r[s]}function ioe(t,e,n){const r=soe(e);return f$.set(t,n),r.observe(t),()=>{f$.delete(t),r.unobserve(t)}}const ooe={some:0,all:1};class aoe extends Ih{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:ooe[s]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),h=u?c:d;h&&h(l)};return ioe(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(loe(e,n))&&this.startObserver()}unmount(){}}function loe({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const uoe={inView:{Feature:aoe},tap:{Feature:toe},focus:{Feature:eoe},hover:{Feature:Jie}};function dW(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function coe(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function doe(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function vN(t,e,n){const r=t.getProps();return jM(r,e,n!==void 0?n:r.custom,coe(t),doe(t))}let WM=Lr;const Jf=t=>t*1e3,bc=t=>t/1e3,hoe={current:!1},hW=t=>Array.isArray(t)&&typeof t[0]=="number";function fW(t){return!!(!t||typeof t=="string"&&pW[t]||hW(t)||Array.isArray(t)&&t.every(fW))}const zx=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,pW={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:zx([0,.65,.55,1]),circOut:zx([.55,0,1,.45]),backIn:zx([.31,.01,.66,-.59]),backOut:zx([.33,1.53,.69,.99])};function mW(t){if(t)return hW(t)?zx(t):Array.isArray(t)?t.map(mW):pW[t]}function foe(t,e,n,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:a,times:l}={}){const u={[e]:n};l&&(u.offset=l);const c=mW(a);return Array.isArray(c)&&(u.easing=c),t.animate(u,{delay:r,duration:s,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function poe(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const gW=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,moe=1e-7,goe=12;function yoe(t,e,n,r,s){let i,o,a=0;do o=e+(n-e)/2,i=gW(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>moe&&++a<goe);return o}function $1(t,e,n,r){if(t===e&&n===r)return Lr;const s=i=>yoe(i,0,1,t,n);return i=>i===0||i===1?i:gW(s(i),e,r)}const xoe=$1(.42,0,1,1),woe=$1(0,0,.58,1),yW=$1(.42,0,.58,1),boe=t=>Array.isArray(t)&&typeof t[0]!="number",xW=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,wW=t=>e=>1-t(1-e),GM=t=>1-Math.sin(Math.acos(t)),bW=wW(GM),voe=xW(GM),vW=$1(.33,1.53,.69,.99),HM=wW(vW),Soe=xW(HM),Coe=t=>(t*=2)<1?.5*HM(t):.5*(2-Math.pow(2,-10*(t-1))),Ioe={linear:Lr,easeIn:xoe,easeInOut:yW,easeOut:woe,circIn:GM,circInOut:voe,circOut:bW,backIn:HM,backInOut:Soe,backOut:vW,anticipate:Coe},ez=t=>{if(Array.isArray(t)){WM(t.length===4);const[e,n,r,s]=t;return $1(e,n,r,s)}else if(typeof t=="string")return Ioe[t];return t},YM=(t,e)=>n=>!!(_1(n)&&kie.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),SW=(t,e,n)=>r=>{if(!_1(r))return r;const[s,i,o,a]=r.match(wN);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Noe=t=>ih(0,255,t),eA={...Fp,transform:t=>Math.round(Noe(t))},jf={test:YM("rgb","red"),parse:SW("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+eA.transform(t)+", "+eA.transform(e)+", "+eA.transform(n)+", "+gw(mw.transform(r))+")"};function koe(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const p$={test:YM("#"),parse:koe,transform:jf.transform},xg={test:YM("hsl","hue"),parse:SW("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+mu.transform(gw(e))+", "+mu.transform(gw(n))+", "+gw(mw.transform(r))+")"},Ri={test:t=>jf.test(t)||p$.test(t)||xg.test(t),parse:t=>jf.test(t)?jf.parse(t):xg.test(t)?xg.parse(t):p$.parse(t),transform:t=>_1(t)?t:t.hasOwnProperty("red")?jf.transform(t):xg.transform(t)},xr=(t,e,n)=>-n*t+n*e+t;function tA(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Toe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=tA(l,a,t+1/3),i=tA(l,a,t),o=tA(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const nA=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},Eoe=[p$,jf,xg],_oe=t=>Eoe.find(e=>e.test(t));function tz(t){const e=_oe(t);let n=e.parse(t);return e===xg&&(n=Toe(n)),n}const CW=(t,e)=>{const n=tz(t),r=tz(e),s={...n};return i=>(s.red=nA(n.red,r.red,i),s.green=nA(n.green,r.green,i),s.blue=nA(n.blue,r.blue,i),s.alpha=xr(n.alpha,r.alpha,i),jf.transform(s))};function Aoe(t){var e,n;return isNaN(t)&&_1(t)&&(((e=t.match(wN))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(q8))===null||n===void 0?void 0:n.length)||0)>0}const IW={regex:Iie,countKey:"Vars",token:"${v}",parse:Lr},NW={regex:q8,countKey:"Colors",token:"${c}",parse:Ri.parse},kW={regex:wN,countKey:"Numbers",token:"${n}",parse:Fp.parse};function rA(t,{regex:e,countKey:n,token:r,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...i.map(s)))}function HC(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&rA(n,IW),rA(n,NW),rA(n,kW),n}function TW(t){return HC(t).values}function EW(t){const{values:e,numColors:n,numVars:r,tokenised:s}=HC(t),i=e.length;return o=>{let a=s;for(let l=0;l<i;l++)l<r?a=a.replace(IW.token,o[l]):l<r+n?a=a.replace(NW.token,Ri.transform(o[l])):a=a.replace(kW.token,gw(o[l]));return a}}const $oe=t=>typeof t=="number"?0:t;function Roe(t){const e=TW(t);return EW(t)(e.map($oe))}const oh={test:Aoe,parse:TW,createTransformer:EW,getAnimatableNone:Roe},_W=(t,e)=>n=>`${n>0?e:t}`;function AW(t,e){return typeof t=="number"?n=>xr(t,e,n):Ri.test(t)?CW(t,e):t.startsWith("var(")?_W(t,e):RW(t,e)}const $W=(t,e)=>{const n=[...t],r=n.length,s=t.map((i,o)=>AW(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}},Moe=(t,e)=>{const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=AW(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}},RW=(t,e)=>{const n=oh.createTransformer(e),r=HC(t),s=HC(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?Zd($W(r.values,s.values),n):_W(t,e)},Uw=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},nz=(t,e)=>n=>xr(t,e,n);function Doe(t){return typeof t=="number"?nz:typeof t=="string"?Ri.test(t)?CW:RW:Array.isArray(t)?$W:typeof t=="object"?Moe:nz}function Ooe(t,e,n){const r=[],s=n||Doe(t[0]),i=t.length-1;for(let o=0;o<i;o++){let a=s(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Lr:e;a=Zd(l,a)}r.push(a)}return r}function MW(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(WM(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Ooe(e,r,s),a=o.length,l=u=>{let c=0;if(a>1)for(;c<t.length-2&&!(u<t[c+1]);c++);const d=Uw(t[c],t[c+1],u);return o[c](d)};return n?u=>l(ih(t[0],t[i-1],u)):l}function Poe(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=Uw(0,e,r);t.push(xr(n,1,s))}}function Foe(t){const e=[0];return Poe(e,t.length-1),e}function Loe(t,e){return t.map(n=>n*e)}function zoe(t,e){return t.map(()=>e||yW).splice(0,t.length-1)}function YC({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=boe(r)?r.map(ez):ez(r),i={done:!1,value:e[0]},o=Loe(n&&n.length===e.length?n:Foe(e),t),a=MW(o,e,{ease:Array.isArray(s)?s:zoe(e,s)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}function DW(t,e){return e?t*(1e3/e):0}const Boe=5;function OW(t,e,n){const r=Math.max(e-Boe,0);return DW(n-t(r),e-r)}const rz=.001,Uoe=.01,Voe=10,joe=.05,Woe=1;function Goe({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,i,o=1-e;o=ih(joe,Woe,o),t=ih(Uoe,Voe,bc(t)),o<1?(s=u=>{const c=u*o,d=c*t,h=c-n,f=m$(u,o),m=Math.exp(-d);return rz-h/f*m},i=u=>{const d=u*o*t,h=d*n+n,f=Math.pow(o,2)*Math.pow(u,2)*t,m=Math.exp(-d),g=m$(Math.pow(u,2),o);return(-s(u)+rz>0?-1:1)*((h-f)*m)/g}):(s=u=>{const c=Math.exp(-u*t),d=(u-n)*t+1;return-.001+c*d},i=u=>{const c=Math.exp(-u*t),d=(n-u)*(t*t);return c*d});const a=5/t,l=Yoe(s,i,a);if(t=Jf(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const Hoe=12;function Yoe(t,e,n){let r=n;for(let s=1;s<Hoe;s++)r=r-t(r)/e(r);return r}function m$(t,e){return t*Math.sqrt(1-e*e)}const Koe=["duration","bounce"],qoe=["stiffness","damping","mass"];function sz(t,e){return e.some(n=>t[n]!==void 0)}function Xoe(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!sz(t,qoe)&&sz(t,Koe)){const n=Goe(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function PW({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:a,damping:l,mass:u,duration:c,velocity:d,isResolvedFromDuration:h}=Xoe({...r,velocity:-bc(r.velocity||0)}),f=d||0,m=l/(2*Math.sqrt(a*u)),g=i-s,x=bc(Math.sqrt(a/u)),w=Math.abs(g)<5;n||(n=w?.01:2),e||(e=w?.005:.5);let b;if(m<1){const S=m$(x,m);b=C=>{const T=Math.exp(-m*x*C);return i-T*((f+m*x*g)/S*Math.sin(S*C)+g*Math.cos(S*C))}}else if(m===1)b=S=>i-Math.exp(-x*S)*(g+(f+x*g)*S);else{const S=x*Math.sqrt(m*m-1);b=C=>{const T=Math.exp(-m*x*C),D=Math.min(S*C,300);return i-T*((f+m*x*g)*Math.sinh(D)+S*g*Math.cosh(D))/S}}return{calculatedDuration:h&&c||null,next:S=>{const C=b(S);if(h)o.done=S>=c;else{let T=f;S!==0&&(m<1?T=OW(b,S,C):T=0);const D=Math.abs(T)<=n,P=Math.abs(i-C)<=e;o.done=D&&P}return o.value=o.done?i:C,o}}}function iz({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:u=.5,restSpeed:c}){const d=t[0],h={done:!1,value:d},f=I=>a!==void 0&&I<a||l!==void 0&&I>l,m=I=>a===void 0?l:l===void 0||Math.abs(a-I)<Math.abs(l-I)?a:l;let g=n*e;const x=d+g,w=o===void 0?x:o(x);w!==x&&(g=w-d);const b=I=>-g*Math.exp(-I/r),S=I=>w+b(I),C=I=>{const E=b(I),M=S(I);h.done=Math.abs(E)<=u,h.value=h.done?w:M};let T,D;const P=I=>{f(h.value)&&(T=I,D=PW({keyframes:[h.value,m(h.value)],velocity:OW(S,I,h.value),damping:s,stiffness:i,restDelta:u,restSpeed:c}))};return P(0),{calculatedDuration:null,next:I=>{let E=!1;return!D&&T===void 0&&(E=!0,C(I),P(I)),T!==void 0&&I>T?D.next(I-T):(!E&&C(I),h)}}}const Zoe=t=>{const e=({timestamp:n})=>t(n);return{start:()=>er.update(e,!0),stop:()=>Ec(e),now:()=>ai.isProcessing?ai.timestamp:performance.now()}},oz=2e4;function az(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<oz;)e+=n,r=t.next(e);return e>=oz?1/0:e}const Qoe={decay:iz,inertia:iz,tween:YC,keyframes:YC,spring:PW};function KC({autoplay:t=!0,delay:e=0,driver:n=Zoe,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:u,onComplete:c,onUpdate:d,...h}){let f=1,m=!1,g,x;const w=()=>{x=new Promise(ee=>{g=ee})};w();let b;const S=Qoe[s]||YC;let C;S!==YC&&typeof r[0]!="number"&&(C=MW([0,100],r,{clamp:!1}),r=[0,100]);const T=S({...h,keyframes:r});let D;a==="mirror"&&(D=S({...h,keyframes:[...r].reverse(),velocity:-(h.velocity||0)}));let P="idle",I=null,E=null,M=null;T.calculatedDuration===null&&i&&(T.calculatedDuration=az(T));const{calculatedDuration:O}=T;let j=1/0,R=1/0;O!==null&&(j=O+o,R=j*(i+1)-o);let z=0;const B=ee=>{if(E===null)return;f>0&&(E=Math.min(E,ee)),f<0&&(E=Math.min(ee-R/f,E)),I!==null?z=I:z=Math.round(ee-E)*f;const de=z-e*(f>=0?1:-1),ge=f>=0?de<0:de>R;z=Math.max(de,0),P==="finished"&&I===null&&(z=R);let Z=z,we=T;if(i){const Be=Math.min(z,R)/j;let se=Math.floor(Be),le=Be%1;!le&&Be>=1&&(le=1),le===1&&se--,se=Math.min(se,i+1),!!(se%2)&&(a==="reverse"?(le=1-le,o&&(le-=o/j)):a==="mirror"&&(we=D)),Z=ih(0,1,le)*j}const Ee=ge?{done:!1,value:r[0]}:we.next(Z);C&&(Ee.value=C(Ee.value));let{done:Le}=Ee;!ge&&O!==null&&(Le=f>=0?z>=R:z<=0);const De=I===null&&(P==="finished"||P==="running"&&Le);return d&&d(Ee.value),De&&K(),Ee},V=()=>{b&&b.stop(),b=void 0},H=()=>{P="idle",V(),g(),w(),E=M=null},K=()=>{P="finished",c&&c(),V(),g()},ne=()=>{if(m)return;b||(b=n(B));const ee=b.now();l&&l(),I!==null?E=ee-I:(!E||P==="finished")&&(E=ee),P==="finished"&&w(),M=E,I=null,P="running",b.start()};t&&ne();const fe={then(ee,de){return x.then(ee,de)},get time(){return bc(z)},set time(ee){ee=Jf(ee),z=ee,I!==null||!b||f===0?I=ee:E=b.now()-ee/f},get duration(){const ee=T.calculatedDuration===null?az(T):T.calculatedDuration;return bc(ee)},get speed(){return f},set speed(ee){ee===f||!b||(f=ee,fe.time=bc(z))},get state(){return P},play:ne,pause:()=>{P="paused",I=z},stop:()=>{m=!0,P!=="idle"&&(P="idle",u&&u(),H())},cancel:()=>{M!==null&&B(M),H()},complete:()=>{P="finished"},sample:ee=>(E=0,B(ee))};return fe}function Joe(t){let e;return()=>(e===void 0&&(e=t()),e)}const eae=Joe(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),tae=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),k2=10,nae=2e4,rae=(t,e)=>e.type==="spring"||t==="backgroundColor"||!fW(e.ease);function sae(t,e,{onUpdate:n,onComplete:r,...s}){if(!(eae()&&tae.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,a,l,u=!1;const c=()=>{l=new Promise(S=>{a=S})};c();let{keyframes:d,duration:h=300,ease:f,times:m}=s;if(rae(e,s)){const S=KC({...s,repeat:0,delay:0});let C={done:!1,value:d[0]};const T=[];let D=0;for(;!C.done&&D<nae;)C=S.sample(D),T.push(C.value),D+=k2;m=void 0,d=T,h=D-k2,f="linear"}const g=foe(t.owner.current,e,d,{...s,duration:h,ease:f,times:m}),x=()=>{u=!1,g.cancel()},w=()=>{u=!0,er.update(x),a(),c()};return g.onfinish=()=>{u||(t.set(poe(d,s)),r&&r(),w())},{then(S,C){return l.then(S,C)},attachTimeline(S){return g.timeline=S,g.onfinish=null,Lr},get time(){return bc(g.currentTime||0)},set time(S){g.currentTime=Jf(S)},get speed(){return g.playbackRate},set speed(S){g.playbackRate=S},get duration(){return bc(h)},play:()=>{o||(g.play(),Ec(x))},pause:()=>g.pause(),stop:()=>{if(o=!0,g.playState==="idle")return;const{currentTime:S}=g;if(S){const C=KC({...s,autoplay:!1});t.setWithVelocity(C.sample(S-k2).value,C.sample(S).value,k2)}w()},complete:()=>{u||g.finish()},cancel:w}}function iae({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const s=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:Lr,pause:Lr,stop:Lr,then:i=>(i(),Promise.resolve()),cancel:Lr,complete:Lr});return e?KC({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const oae={type:"spring",stiffness:500,damping:25,restSpeed:10},aae=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),lae={type:"keyframes",duration:.8},uae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},cae=(t,{keyframes:e})=>e.length>2?lae:Pp.has(t)?t.startsWith("scale")?aae(e[1]):oae:uae,g$=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(oh.test(e)||e==="0")&&!e.startsWith("url(")),dae=new Set(["brightness","contrast","saturate","opacity"]);function hae(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(wN)||[];if(!r)return t;const s=n.replace(r,"");let i=dae.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const fae=/([a-z-]*)\(.*?\)/g,y$={...oh,getAnimatableNone:t=>{const e=t.match(fae);return e?e.map(hae).join(" "):t}},pae={...X8,color:Ri,backgroundColor:Ri,outlineColor:Ri,fill:Ri,stroke:Ri,borderColor:Ri,borderTopColor:Ri,borderRightColor:Ri,borderBottomColor:Ri,borderLeftColor:Ri,filter:y$,WebkitFilter:y$},KM=t=>pae[t];function FW(t,e){let n=KM(t);return n!==y$&&(n=oh),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const LW=t=>/^0[^.\s]+$/.test(t);function mae(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||LW(t)}function gae(t,e,n,r){const s=g$(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=r.from!==void 0?r.from:t.get();let a;const l=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),mae(i[u])&&l.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(a=i[u]);if(s&&l.length&&a)for(let u=0;u<l.length;u++){const c=l[u];i[c]=FW(e,a)}return i}function yae({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length}function qM(t,e){return t[e]||t.default||t}const xae={skipAnimations:!1},XM=(t,e,n,r={})=>s=>{const i=qM(r,t)||{},o=i.delay||r.delay||0;let{elapsed:a=0}=r;a=a-Jf(o);const l=gae(e,t,n,i),u=l[0],c=l[l.length-1],d=g$(t,u),h=g$(t,c);let f={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-a,onUpdate:m=>{e.set(m),i.onUpdate&&i.onUpdate(m)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(yae(i)||(f={...f,...cae(t,f)}),f.duration&&(f.duration=Jf(f.duration)),f.repeatDelay&&(f.repeatDelay=Jf(f.repeatDelay)),!d||!h||hoe.current||i.type===!1||xae.skipAnimations)return iae(f);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const m=sae(e,t,f);if(m)return m}return KC(f)};function qC(t){return!!(yo(t)&&t.add)}const zW=t=>/^\-?\d*\.?\d+$/.test(t);function ZM(t,e){t.indexOf(e)===-1&&t.push(e)}function QM(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class JM{constructor(){this.subscriptions=[]}add(e){return ZM(this.subscriptions,e),()=>QM(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const wae=t=>!isNaN(parseFloat(t));class bae{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=ai;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,er.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>er.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=wae(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new JM);const r=this.events[e].add(n);return e==="change"?()=>{r(),er.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?DW(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Lg(t,e){return new bae(t,e)}const BW=t=>e=>e.test(t),vae={test:t=>t==="auto",parse:t=>t},UW=[Fp,Xt,mu,Nd,Eie,Tie,vae],gx=t=>UW.find(BW(t)),Sae=[...UW,Ri,oh],Cae=t=>Sae.find(BW(t));function Iae(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Lg(n))}function Nae(t,e){const n=vN(t,e);let{transitionEnd:r={},transition:s={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const o in i){const a=Vie(i[o]);Iae(t,o,a)}}function kae(t,e,n){var r,s;const i=Object.keys(e).filter(a=>!t.hasValue(a)),o=i.length;if(o)for(let a=0;a<o;a++){const l=i[a],u=e[l];let c=null;Array.isArray(u)&&(c=u[0]),c===null&&(c=(s=(r=n[l])!==null&&r!==void 0?r:t.readValue(l))!==null&&s!==void 0?s:e[l]),c!=null&&(typeof c=="string"&&(zW(c)||LW(c))?c=parseFloat(c):!Cae(c)&&oh.test(u)&&(c=FW(l,u)),t.addValue(l,Lg(c,{owner:t})),n[l]===void 0&&(n[l]=c),c!==null&&t.setBaseTarget(l,c))}}function Tae(t,e){return e?(e[t]||e.default||e).from:void 0}function Eae(t,e,n){const r={};for(const s in t){const i=Tae(s,e);if(i!==void 0)r[s]=i;else{const o=n.getValue(s);o&&(r[s]=o.get())}}return r}function _ae({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function Aae(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function VW(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");r&&(i=r);const u=[],c=s&&t.animationState&&t.animationState.getState()[s];for(const d in a){const h=t.getValue(d),f=a[d];if(!h||f===void 0||c&&_ae(c,d))continue;const m={delay:n,elapsed:0,...qM(i||{},d)};if(window.HandoffAppearAnimations){const w=t.getProps()[j8];if(w){const b=window.HandoffAppearAnimations(w,d,h,er);b!==null&&(m.elapsed=b,m.isHandoff=!0)}}let g=!m.isHandoff&&!Aae(h,f);if(m.type==="spring"&&(h.getVelocity()||m.velocity)&&(g=!1),h.animation&&(g=!1),g)continue;h.start(XM(d,h,f,t.shouldReduceMotion&&Pp.has(d)?{type:!1}:m));const x=h.animation;qC(l)&&(l.add(d),x.then(()=>l.remove(d))),u.push(x)}return o&&Promise.all(u).then(()=>{o&&Nae(t,o)}),u}function x$(t,e,n={}){const r=vN(t,e,n.custom);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(VW(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:u=0,staggerChildren:c,staggerDirection:d}=s;return $ae(t,e,u+l,c,d,n)}:()=>Promise.resolve(),{when:a}=s;if(a){const[l,u]=a==="beforeChildren"?[i,o]:[o,i];return l().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function $ae(t,e,n=0,r=0,s=1,i){const o=[],a=(t.variantChildren.size-1)*r,l=s===1?(u=0)=>u*r:(u=0)=>a-u*r;return Array.from(t.variantChildren).sort(Rae).forEach((u,c)=>{u.notify("AnimationStart",e),o.push(x$(u,e,{...i,delay:n+l(c)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function Rae(t,e){return t.sortNodePosition(e)}function Mae(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>x$(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=x$(t,e,n);else{const s=typeof e=="function"?vN(t,e,n.custom):e;r=Promise.all(VW(t,s,n))}return r.then(()=>t.notify("AnimationComplete",e))}const Dae=[...DM].reverse(),Oae=DM.length;function Pae(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Mae(t,n,r)))}function Fae(t){let e=Pae(t);const n=zae();let r=!0;const s=(l,u)=>{const c=vN(t,u);if(c){const{transition:d,transitionEnd:h,...f}=c;l={...l,...f,...h}}return l};function i(l){e=l(t)}function o(l,u){const c=t.getProps(),d=t.getVariantContext(!0)||{},h=[],f=new Set;let m={},g=1/0;for(let w=0;w<Oae;w++){const b=Dae[w],S=n[b],C=c[b]!==void 0?c[b]:d[b],T=zw(C),D=b===u?S.isActive:null;D===!1&&(g=w);let P=C===d[b]&&C!==c[b]&&T;if(P&&r&&t.manuallyAnimateOnMount&&(P=!1),S.protectedKeys={...m},!S.isActive&&D===null||!C&&!S.prevProp||yN(C)||typeof C=="boolean")continue;let E=Lae(S.prevProp,C)||b===u&&S.isActive&&!P&&T||w>g&&T,M=!1;const O=Array.isArray(C)?C:[C];let j=O.reduce(s,{});D===!1&&(j={});const{prevResolvedValues:R={}}=S,z={...R,...j},B=V=>{E=!0,f.has(V)&&(M=!0,f.delete(V)),S.needsAnimating[V]=!0};for(const V in z){const H=j[V],K=R[V];if(m.hasOwnProperty(V))continue;let ne=!1;GC(H)&&GC(K)?ne=!dW(H,K):ne=H!==K,ne?H!==void 0?B(V):f.add(V):H!==void 0&&f.has(V)?B(V):S.protectedKeys[V]=!0}S.prevProp=C,S.prevResolvedValues=j,S.isActive&&(m={...m,...j}),r&&t.blockInitialAnimation&&(E=!1),E&&(!P||M)&&h.push(...O.map(V=>({animation:V,options:{type:b,...l}})))}if(f.size){const w={};f.forEach(b=>{const S=t.getBaseTarget(b);S!==void 0&&(w[b]=S)}),h.push({animation:w})}let x=!!h.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(h):Promise.resolve()}function a(l,u,c){var d;if(n[l].isActive===u)return Promise.resolve();(d=t.variantChildren)===null||d===void 0||d.forEach(f=>{var m;return(m=f.animationState)===null||m===void 0?void 0:m.setActive(l,u)}),n[l].isActive=u;const h=o(c,l);for(const f in n)n[f].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n}}function Lae(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!dW(e,t):!1}function pf(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zae(){return{animate:pf(!0),whileInView:pf(),whileHover:pf(),whileTap:pf(),whileDrag:pf(),whileFocus:pf(),exit:pf()}}class Bae extends Ih{constructor(e){super(e),e.animationState||(e.animationState=Fae(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),yN(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Uae=0;class Vae extends Ih{constructor(){super(...arguments),this.id=Uae++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const jae={animation:{Feature:Bae},exit:{Feature:Vae}},lz=(t,e)=>Math.abs(t-e);function Wae(t,e){const n=lz(t.x,e.x),r=lz(t.y,e.y);return Math.sqrt(n**2+r**2)}class jW{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=iA(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,f=Wae(d.offset,{x:0,y:0})>=3;if(!h&&!f)return;const{point:m}=d,{timestamp:g}=ai;this.history.push({...m,timestamp:g});const{onStart:x,onMove:w}=this.handlers;h||(x&&x(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=sA(h,this.transformPagePoint),er.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:f,onSessionEnd:m,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=iA(d.type==="pointercancel"?this.lastMoveEventInfo:sA(h,this.transformPagePoint),this.history);this.startEvent&&f&&f(d,x),m&&m(d,x)},!oW(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=bN(e),a=sA(o,this.transformPagePoint),{point:l}=a,{timestamp:u}=ai;this.history=[{...l,timestamp:u}];const{onSessionStart:c}=n;c&&c(e,iA(a,this.history)),this.removeListeners=Zd(wc(this.contextWindow,"pointermove",this.handlePointerMove),wc(this.contextWindow,"pointerup",this.handlePointerUp),wc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ec(this.updatePoint)}}function sA(t,e){return e?{point:e(t.point)}:t}function uz(t,e){return{x:t.x-e.x,y:t.y-e.y}}function iA({point:t},e){return{point:t,delta:uz(t,WW(e)),offset:uz(t,Gae(e)),velocity:Hae(e,.1)}}function Gae(t){return t[0]}function WW(t){return t[t.length-1]}function Hae(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=WW(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>Jf(e)));)n--;if(!r)return{x:0,y:0};const i=bc(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Ho(t){return t.max-t.min}function w$(t,e=0,n=.01){return Math.abs(t-e)<=n}function cz(t,e,n,r=.5){t.origin=r,t.originPoint=xr(e.min,e.max,t.origin),t.scale=Ho(n)/Ho(e),(w$(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=xr(n.min,n.max,t.origin)-t.originPoint,(w$(t.translate)||isNaN(t.translate))&&(t.translate=0)}function yw(t,e,n,r){cz(t.x,e.x,n.x,r?r.originX:void 0),cz(t.y,e.y,n.y,r?r.originY:void 0)}function dz(t,e,n){t.min=n.min+e.min,t.max=t.min+Ho(e)}function Yae(t,e,n){dz(t.x,e.x,n.x),dz(t.y,e.y,n.y)}function hz(t,e,n){t.min=e.min-n.min,t.max=t.min+Ho(e)}function xw(t,e,n){hz(t.x,e.x,n.x),hz(t.y,e.y,n.y)}function Kae(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?xr(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?xr(n,t,r.max):Math.min(t,n)),t}function fz(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function qae(t,{top:e,left:n,bottom:r,right:s}){return{x:fz(t.x,n,s),y:fz(t.y,e,r)}}function pz(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Xae(t,e){return{x:pz(t.x,e.x),y:pz(t.y,e.y)}}function Zae(t,e){let n=.5;const r=Ho(t),s=Ho(e);return s>r?n=Uw(e.min,e.max-r,t.min):r>s&&(n=Uw(t.min,t.max-s,e.min)),ih(0,1,n)}function Qae(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const b$=.35;function Jae(t=b$){return t===!1?t=0:t===!0&&(t=b$),{x:mz(t,"left","right"),y:mz(t,"top","bottom")}}function mz(t,e,n){return{min:gz(t,e),max:gz(t,n)}}function gz(t,e){return typeof t=="number"?t:t[e]||0}const yz=()=>({translate:0,scale:1,origin:0,originPoint:0}),wg=()=>({x:yz(),y:yz()}),xz=()=>({min:0,max:0}),qr=()=>({x:xz(),y:xz()});function pa(t){return[t("x"),t("y")]}function GW({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function ele({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function tle(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function oA(t){return t===void 0||t===1}function v$({scale:t,scaleX:e,scaleY:n}){return!oA(t)||!oA(e)||!oA(n)}function If(t){return v$(t)||HW(t)||t.z||t.rotate||t.rotateX||t.rotateY}function HW(t){return wz(t.x)||wz(t.y)}function wz(t){return t&&t!=="0%"}function XC(t,e,n){const r=t-n,s=e*r;return n+s}function bz(t,e,n,r,s){return s!==void 0&&(t=XC(t,s,r)),XC(t,n,r)+e}function S$(t,e=0,n=1,r,s){t.min=bz(t.min,e,n,r,s),t.max=bz(t.max,e,n,r,s)}function YW(t,{x:e,y:n}){S$(t.x,e.translate,e.scale,e.originPoint),S$(t.y,n.translate,n.scale,n.originPoint)}function nle(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let a=0;a<s;a++){i=n[a],o=i.projectionDelta;const l=i.instance;l&&l.style&&l.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&bg(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,YW(t,o)),r&&If(i.latestValues)&&bg(t,i.latestValues))}e.x=vz(e.x),e.y=vz(e.y)}function vz(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Dd(t,e){t.min=t.min+e,t.max=t.max+e}function Sz(t,e,[n,r,s]){const i=e[s]!==void 0?e[s]:.5,o=xr(t.min,t.max,i);S$(t,e[n],e[r],o,e.scale)}const rle=["x","scaleX","originX"],sle=["y","scaleY","originY"];function bg(t,e){Sz(t.x,e,rle),Sz(t.y,e,sle)}function KW(t,e){return GW(tle(t.getBoundingClientRect(),e))}function ile(t,e,n){const r=KW(t,n),{scroll:s}=e;return s&&(Dd(r.x,s.offset.x),Dd(r.y,s.offset.y)),r}const qW=({current:t})=>t?t.ownerDocument.defaultView:null,ole=new WeakMap;class ale{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=qr(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=c=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(bN(c,"page").point)},i=(c,d)=>{const{drag:h,dragPropagation:f,onDragStart:m}=this.getProps();if(h&&!f&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=lW(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),pa(x=>{let w=this.getAxisMotionValue(x).get()||0;if(mu.test(w)){const{projection:b}=this.visualElement;if(b&&b.layout){const S=b.layout.layoutBox[x];S&&(w=Ho(S)*(parseFloat(w)/100))}}this.originPoint[x]=w}),m&&er.update(()=>m(c,d),!1,!0);const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},o=(c,d)=>{const{dragPropagation:h,dragDirectionLock:f,onDirectionLock:m,onDrag:g}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:x}=d;if(f&&this.currentDirection===null){this.currentDirection=lle(x),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",d.point,x),this.updateAxis("y",d.point,x),this.visualElement.render(),g&&g(c,d)},a=(c,d)=>this.stop(c,d),l=()=>pa(c=>{var d;return this.getAnimationState(c)==="paused"&&((d=this.getAxisMotionValue(c).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new jW(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:qW(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&er.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!T2(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=Kae(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&yg(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=qae(s.layoutBox,n):this.constraints=!1,this.elastic=Jae(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&pa(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=Qae(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!yg(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=ile(r,s.root,this.visualElement.getTransformPagePoint());let o=Xae(s.layout.layoutBox,i);if(n){const a=n(ele(o));this.hasMutatedConstraints=!!a,a&&(o=GW(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=pa(c=>{if(!T2(c,n,this.currentDirection))return;let d=l&&l[c]||{};o&&(d={min:0,max:0});const h=s?200:1e6,f=s?40:1e7,m={type:"inertia",velocity:r?e[c]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(c,m)});return Promise.all(u).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(XM(e,r,0,n))}stopAnimation(){pa(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){pa(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){pa(n=>{const{drag:r}=this.getProps();if(!T2(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[n];i.set(e[n]-xr(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!yg(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};pa(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();s[o]=Zae({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),pa(o=>{if(!T2(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:u}=this.constraints[o];a.set(xr(l,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;ole.set(this.visualElement,this);const e=this.visualElement.current,n=wc(e,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();yg(l)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=gc(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(pa(c=>{const d=this.getAxisMotionValue(c);d&&(this.originPoint[c]+=l[c].translate,d.set(d.get()+l[c].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=b$,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function T2(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function lle(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class ule extends Ih{constructor(e){super(e),this.removeGroupControls=Lr,this.removeListeners=Lr,this.controls=new ale(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Lr}unmount(){this.removeGroupControls(),this.removeListeners()}}const Cz=t=>(e,n)=>{t&&er.update(()=>t(e,n))};class cle extends Ih{constructor(){super(...arguments),this.removePointerDownListener=Lr}onPointerDown(e){this.session=new jW(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:qW(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:Cz(e),onStart:Cz(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&er.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=wc(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function dle(){const t=W.useContext(mN);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=W.useId();return W.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}const RS={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Iz(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const yx={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Xt.test(t))t=parseFloat(t);else return t;const n=Iz(t,e.target.x),r=Iz(t,e.target.y);return`${n}% ${r}%`}},hle={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=oh.parse(t);if(s.length>5)return r;const i=oh.createTransformer(t),o=typeof s[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;s[0+o]/=a,s[1+o]/=l;const u=xr(a,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class fle extends En.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;bie(ple),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),RS.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||er.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function XW(t){const[e,n]=dle(),r=W.useContext(PM);return En.createElement(fle,{...t,layoutGroup:r,switchLayoutGroup:W.useContext(G8),isPresent:e,safeToRemove:n})}const ple={borderRadius:{...yx,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:yx,borderTopRightRadius:yx,borderBottomLeftRadius:yx,borderBottomRightRadius:yx,boxShadow:hle},ZW=["TopLeft","TopRight","BottomLeft","BottomRight"],mle=ZW.length,Nz=t=>typeof t=="string"?parseFloat(t):t,kz=t=>typeof t=="number"||Xt.test(t);function gle(t,e,n,r,s,i){s?(t.opacity=xr(0,n.opacity!==void 0?n.opacity:1,yle(r)),t.opacityExit=xr(e.opacity!==void 0?e.opacity:1,0,xle(r))):i&&(t.opacity=xr(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<mle;o++){const a=`border${ZW[o]}Radius`;let l=Tz(e,a),u=Tz(n,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||kz(l)===kz(u)?(t[a]=Math.max(xr(Nz(l),Nz(u),r),0),(mu.test(u)||mu.test(l))&&(t[a]+="%")):t[a]=u}(e.rotate||n.rotate)&&(t.rotate=xr(e.rotate||0,n.rotate||0,r))}function Tz(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const yle=QW(0,.5,bW),xle=QW(.5,.95,Lr);function QW(t,e,n){return r=>r<t?0:r>e?1:n(Uw(t,e,r))}function Ez(t,e){t.min=e.min,t.max=e.max}function aa(t,e){Ez(t.x,e.x),Ez(t.y,e.y)}function _z(t,e,n,r,s){return t-=e,t=XC(t,1/n,r),s!==void 0&&(t=XC(t,1/s,r)),t}function wle(t,e=0,n=1,r=.5,s,i=t,o=t){if(mu.test(e)&&(e=parseFloat(e),e=xr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=xr(i.min,i.max,r);t===i&&(a-=e),t.min=_z(t.min,e,n,a,s),t.max=_z(t.max,e,n,a,s)}function Az(t,e,[n,r,s],i,o){wle(t,e[n],e[r],e[s],e.scale,i,o)}const ble=["x","scaleX","originX"],vle=["y","scaleY","originY"];function $z(t,e,n,r){Az(t.x,e,ble,n?n.x:void 0,r?r.x:void 0),Az(t.y,e,vle,n?n.y:void 0,r?r.y:void 0)}function Rz(t){return t.translate===0&&t.scale===1}function JW(t){return Rz(t.x)&&Rz(t.y)}function Sle(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function e9(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function Mz(t){return Ho(t.x)/Ho(t.y)}class Cle{constructor(){this.members=[]}add(e){ZM(this.members,e),e.scheduleRender()}remove(e){if(QM(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Dz(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:l,rotateX:u,rotateY:c}=n;l&&(r+=`rotate(${l}deg) `),u&&(r+=`rotateX(${u}deg) `),c&&(r+=`rotateY(${c}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(r+=`scale(${o}, ${a})`),r||"none"}const Ile=(t,e)=>t.depth-e.depth;class Nle{constructor(){this.children=[],this.isDirty=!1}add(e){ZM(this.children,e),this.isDirty=!0}remove(e){QM(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Ile),this.isDirty=!1,this.children.forEach(e)}}function kle(t,e){const n=performance.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(Ec(r),t(i-e))};return er.read(r,!0),()=>Ec(r)}function Tle(t){window.MotionDebug&&window.MotionDebug.record(t)}function Ele(t){return t instanceof SVGElement&&t.tagName!=="svg"}function _le(t,e,n){const r=yo(t)?t:Lg(t);return r.start(XM("",r,e,n)),r.animation}const Oz=["","X","Y","Z"],Ale={visibility:"hidden"},Pz=1e3;let $le=0;const Nf={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function t9({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},a=e==null?void 0:e()){this.id=$le++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Nf.totalNodes=Nf.resolvedTargetDeltas=Nf.recalculatedProjection=0,this.nodes.forEach(Dle),this.nodes.forEach(zle),this.nodes.forEach(Ble),this.nodes.forEach(Ole),Tle(Nf)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Nle)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new JM),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Ele(o),this.instance=o;const{layoutId:l,layout:u,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(u||l)&&(this.isLayoutDirty=!0),t){let d;const h=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=kle(h,250),RS.hasAnimatedSinceResize&&(RS.hasAnimatedSinceResize=!1,this.nodes.forEach(Lz))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||u)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||c.getDefaultTransition()||Gle,{onLayoutAnimationStart:x,onLayoutAnimationComplete:w}=c.getProps(),b=!this.targetLayout||!e9(this.targetLayout,m)||f,S=!h&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||h&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,S);const C={...qM(g,"layout"),onPlay:x,onComplete:w};(c.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else h||Lz(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ec(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Ule),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const d=this.path[c];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Fz);return}this.isUpdating||this.nodes.forEach(Fle),this.isUpdating=!1,this.nodes.forEach(Lle),this.nodes.forEach(Rle),this.nodes.forEach(Mle),this.clearAllSnapshots();const a=performance.now();ai.delta=ih(0,1e3/60,a-ai.timestamp),ai.timestamp=a,ai.isProcessing=!0,Z_.update.process(ai),Z_.preRender.process(ai),Z_.render.process(ai),ai.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Ple),this.sharedNodes.forEach(Vle)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,er.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){er.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=qr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!JW(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;o&&(a||If(this.latestValues)||c)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Hle(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return qr();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(Dd(a.x,l.offset.x),Dd(a.y,l.offset.y)),a}removeElementScroll(o){const a=qr();aa(a,o);for(let l=0;l<this.path.length;l++){const u=this.path[l],{scroll:c,options:d}=u;if(u!==this.root&&c&&d.layoutScroll){if(c.isRoot){aa(a,o);const{scroll:h}=this.root;h&&(Dd(a.x,-h.offset.x),Dd(a.y,-h.offset.y))}Dd(a.x,c.offset.x),Dd(a.y,c.offset.y)}}return a}applyTransform(o,a=!1){const l=qr();aa(l,o);for(let u=0;u<this.path.length;u++){const c=this.path[u];!a&&c.options.layoutScroll&&c.scroll&&c!==c.root&&bg(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),If(c.latestValues)&&bg(l,c.latestValues)}return If(this.latestValues)&&bg(l,this.latestValues),l}removeTransform(o){const a=qr();aa(a,o);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!If(u.latestValues))continue;v$(u.latestValues)&&u.updateSnapshot();const c=qr(),d=u.measurePageBox();aa(c,d),$z(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return If(this.latestValues)&&$z(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ai.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=ai.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qr(),this.relativeTargetOrigin=qr(),xw(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=qr(),this.targetWithTransforms=qr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Yae(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):aa(this.target,this.layout.layoutBox),YW(this.target,this.targetDelta)):aa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qr(),this.relativeTargetOrigin=qr(),xw(this.relativeTargetOrigin,this.target,f.target),aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Nf.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||v$(this.parent.latestValues)||HW(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===ai.timestamp&&(u=!1),u)return;const{layout:c,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||d))return;aa(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;nle(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox);const{target:m}=a;if(!m){this.projectionTransform&&(this.projectionDelta=wg(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=wg(),this.projectionDeltaWithTransform=wg());const g=this.projectionTransform;yw(this.projectionDelta,this.layoutCorrected,m,this.latestValues),this.projectionTransform=Dz(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==h||this.treeScale.y!==f)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m)),Nf.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},d=wg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=qr(),f=l?l.source:void 0,m=this.layout?this.layout.source:void 0,g=f!==m,x=this.getStack(),w=!x||x.members.length<=1,b=!!(g&&!w&&this.options.crossfade===!0&&!this.path.some(Wle));this.animationProgress=0;let S;this.mixTargetDelta=C=>{const T=C/1e3;zz(d.x,o.x,T),zz(d.y,o.y,T),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(xw(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),jle(this.relativeTarget,this.relativeTargetOrigin,h,T),S&&Sle(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=qr()),aa(S,this.relativeTarget)),g&&(this.animationValues=c,gle(c,u,this.latestValues,T,b,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=T},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ec(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=er.update(()=>{RS.hasAnimatedSinceResize=!0,this.currentAnimation=_le(0,Pz,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Pz),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:c}=o;if(!(!a||!l||!u)){if(this!==o&&this.layout&&u&&n9(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||qr();const d=Ho(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const h=Ho(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}aa(a,l),bg(a,c),yw(this.projectionDeltaWithTransform,this.layoutCorrected,a,c)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Cle),this.sharedNodes.get(o).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const u={};for(let c=0;c<Oz.length;c++){const d="rotate"+Oz[c];l[d]&&(u[d]=l[d],o.setStaticValue(d,0))}o.render();for(const c in u)o.setStaticValue(c,u[c]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Ale;const u={visibility:""},c=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=$S(o==null?void 0:o.pointerEvents)||"",u.transform=c?c(this.latestValues,""):"none",u;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=$S(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!If(this.latestValues)&&(g.transform=c?c({},""):"none",this.hasProjected=!1),g}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),u.transform=Dz(this.projectionDeltaWithTransform,this.treeScale,h),c&&(u.transform=c(h,u.transform));const{x:f,y:m}=this.projectionDelta;u.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,d.animationValues?u.opacity=d===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const g in jC){if(h[g]===void 0)continue;const{correct:x,applyTo:w}=jC[g],b=u.transform==="none"?h[g]:x(h[g],d);if(w){const S=w.length;for(let C=0;C<S;C++)u[w[C]]=b}else u[g]=b}return this.options.layoutId&&(u.pointerEvents=d===this?$S(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(Fz),this.root.sharedNodes.clear()}}}function Rle(t){t.updateLayout()}function Mle(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?pa(d=>{const h=o?n.measuredBox[d]:n.layoutBox[d],f=Ho(h);h.min=r[d].min,h.max=h.min+f}):n9(i,n.layoutBox,r)&&pa(d=>{const h=o?n.measuredBox[d]:n.layoutBox[d],f=Ho(r[d]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+f)});const a=wg();yw(a,r,n.layoutBox);const l=wg();o?yw(l,t.applyTransform(s,!0),n.measuredBox):yw(l,r,n.layoutBox);const u=!JW(a);let c=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const m=qr();xw(m,n.layoutBox,h.layoutBox);const g=qr();xw(g,r,f.layoutBox),e9(m,g)||(c=!0),d.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=m,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeTargetChanged:c})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Dle(t){Nf.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Ole(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Ple(t){t.clearSnapshot()}function Fz(t){t.clearMeasurements()}function Fle(t){t.isLayoutDirty=!1}function Lle(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Lz(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function zle(t){t.resolveTargetDelta()}function Ble(t){t.calcProjection()}function Ule(t){t.resetRotation()}function Vle(t){t.removeLeadSnapshot()}function zz(t,e,n){t.translate=xr(e.translate,0,n),t.scale=xr(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Bz(t,e,n,r){t.min=xr(e.min,n.min,r),t.max=xr(e.max,n.max,r)}function jle(t,e,n,r){Bz(t.x,e.x,n.x,r),Bz(t.y,e.y,n.y,r)}function Wle(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Gle={duration:.45,ease:[.4,0,.1,1]},Uz=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),Vz=Uz("applewebkit/")&&!Uz("chrome/")?Math.round:Lr;function jz(t){t.min=Vz(t.min),t.max=Vz(t.max)}function Hle(t){jz(t.x),jz(t.y)}function n9(t,e,n){return t==="position"||t==="preserve-aspect"&&!w$(Mz(e),Mz(n),.2)}const Yle=t9({attachResizeListener:(t,e)=>gc(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),aA={current:void 0},r9=t9({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!aA.current){const t=new Yle({});t.mount(window),t.setOptions({layoutScroll:!0}),aA.current=t}return aA.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Kle={pan:{Feature:cle},drag:{Feature:ule,ProjectionNode:r9,MeasureLayout:XW}},qle=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Xle(t){const e=qle.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function C$(t,e,n=1){const[r,s]=Xle(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return zW(o)?parseFloat(o):o}else return h$(s)?C$(s,e,n+1):s}function Zle(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(s=>{const i=s.get();if(!h$(i))return;const o=C$(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!h$(i))continue;const o=C$(i,r);o&&(e[s]=o,n||(n={}),n[s]===void 0&&(n[s]=i))}return{target:e,transitionEnd:n}}const Qle=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),s9=t=>Qle.has(t),Jle=t=>Object.keys(t).some(s9),Wz=t=>t===Fp||t===Xt,Gz=(t,e)=>parseFloat(t.split(", ")[e]),Hz=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return Gz(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?Gz(i[1],t):0}},eue=new Set(["x","y","z"]),tue=E1.filter(t=>!eue.has(t));function nue(t){const e=[];return tue.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const zg={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Hz(4,13),y:Hz(5,14)};zg.translateX=zg.x;zg.translateY=zg.y;const rue=(t,e,n)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{a[u]=zg[u](r,i)}),e.render();const l=e.measureViewportBox();return n.forEach(u=>{const c=e.getValue(u);c&&c.jump(a[u]),t[u]=zg[u](l,i)}),t},sue=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(s9);let i=[],o=!1;const a=[];if(s.forEach(l=>{const u=t.getValue(l);if(!t.hasValue(l))return;let c=n[l],d=gx(c);const h=e[l];let f;if(GC(h)){const m=h.length,g=h[0]===null?1:0;c=h[g],d=gx(c);for(let x=g;x<m&&h[x]!==null;x++)f?WM(gx(h[x])===f):f=gx(h[x])}else f=gx(h);if(d!==f)if(Wz(d)&&Wz(f)){const m=u.get();typeof m=="string"&&u.set(parseFloat(m)),typeof h=="string"?e[l]=parseFloat(h):Array.isArray(h)&&f===Xt&&(e[l]=h.map(parseFloat))}else d!=null&&d.transform&&(f!=null&&f.transform)&&(c===0||h===0)?c===0?u.set(f.transform(c)):e[l]=d.transform(h):(o||(i=nue(t),o=!0),a.push(l),r[l]=r[l]!==void 0?r[l]:e[l],u.jump(h))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,u=rue(e,t,a);return i.length&&i.forEach(([c,d])=>{t.getValue(c).set(d)}),t.render(),gN&&l!==null&&window.scrollTo({top:l}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function iue(t,e,n,r){return Jle(e)?sue(t,e,n,r):{target:e,transitionEnd:r}}const oue=(t,e,n,r)=>{const s=Zle(t,e,r);return e=s.target,r=s.transitionEnd,iue(t,e,n,r)},I$={current:null},i9={current:!1};function aue(){if(i9.current=!0,!!gN)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>I$.current=t.matches;t.addListener(e),e()}else I$.current=!1}function lue(t,e,n){const{willChange:r}=e;for(const s in e){const i=e[s],o=n[s];if(yo(i))t.addValue(s,i),qC(r)&&r.add(s);else if(yo(o))t.addValue(s,Lg(i,{owner:t})),qC(r)&&r.remove(s);else if(o!==i)if(t.hasValue(s)){const a=t.getValue(s);!a.hasAnimated&&a.set(i)}else{const a=t.getStaticValue(s);t.addValue(s,Lg(a!==void 0?a:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const Yz=new WeakMap,o9=Object.keys(Bw),uue=o9.length,Kz=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],cue=OM.length;class due{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>er.render(this.render,!1,!0);const{latestValues:a,renderState:l}=i;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=xN(n),this.isVariantNode=W8(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...c}=this.scrapeMotionValuesFromProps(n,{});for(const d in c){const h=c[d];a[d]!==void 0&&yo(h)&&(h.set(a[d],!1),qC(u)&&u.add(d))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,Yz.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),i9.current||aue(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:I$.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Yz.delete(this.current),this.projection&&this.projection.unmount(),Ec(this.notifyUpdate),Ec(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=Pp.has(e),s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&er.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,i){let o,a;for(let l=0;l<uue;l++){const u=o9[l],{isEnabled:c,Feature:d,ProjectionNode:h,MeasureLayout:f}=Bw[u];h&&(o=h),c(n)&&(!this.features[u]&&d&&(this.features[u]=new d(this)),f&&(a=f))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:u,drag:c,dragConstraints:d,layoutScroll:h,layoutRoot:f}=n;this.projection.setOptions({layoutId:l,layout:u,alwaysMeasureLayout:!!c||d&&yg(d),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:h,layoutRoot:f})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):qr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Kz.length;r++){const s=Kz[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=lue(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<cue;r++){const s=OM[r],i=this.props[s];(zw(i)||i===!1)&&(n[s]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Lg(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(n=jM(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!yo(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new JM),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class a9 extends due{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:s},i){let o=Eae(r,e||{},this);if(s&&(n&&(n=s(n)),r&&(r=s(r)),o&&(o=s(o))),i){kae(this,r,o);const a=oue(this,r,o,n);n=a.transitionEnd,r=a.target}return{transition:e,transitionEnd:n,...r}}}function hue(t){return window.getComputedStyle(t)}class fue extends a9{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(Pp.has(n)){const r=KM(n);return r&&r.default||0}else{const r=hue(e),s=(K8(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return KW(e,n)}build(e,n,r,s){LM(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n){return VM(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;yo(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){eW(e,n,r,s)}}class pue extends a9{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Pp.has(n)){const r=KM(n);return r&&r.default||0}return n=tW.has(n)?n:MM(n),e.getAttribute(n)}measureInstanceViewportBox(){return qr()}scrapeMotionValuesFromProps(e,n){return rW(e,n)}build(e,n,r,s){BM(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){nW(e,n,r,s)}mount(e){this.isSVGTag=UM(e.tagName),super.mount(e)}}const mue=(t,e)=>FM(t)?new pue(e,{enableHardwareAcceleration:!1}):new fue(e,{enableHardwareAcceleration:!0}),gue={layout:{ProjectionNode:r9,MeasureLayout:XW}},yue={...jae,...uoe,...Kle,...gue},xi=xie((t,e)=>Xie(t,e,yue,mue));function l9(){const t=W.useRef(!1);return RM(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function xue(){const t=l9(),[e,n]=W.useState(0),r=W.useCallback(()=>{t.current&&n(e+1)},[e]);return[W.useCallback(()=>er.postRender(r),[r]),e]}class wue extends W.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function bue({children:t,isPresent:e}){const n=W.useId(),r=W.useRef(null),s=W.useRef({width:0,height:0,top:0,left:0});return W.useInsertionEffect(()=>{const{width:i,height:o,top:a,left:l}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${a}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),W.createElement(wue,{isPresent:e,childRef:r,sizeRef:s},W.cloneElement(t,{ref:r}))}const lA=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const a=sW(vue),l=W.useId(),u=W.useMemo(()=>({id:l,initial:e,isPresent:n,custom:s,onExitComplete:c=>{a.set(c,!0);for(const d of a.values())if(!d)return;r&&r()},register:c=>(a.set(c,!1),()=>a.delete(c))}),i?void 0:[n]);return W.useMemo(()=>{a.forEach((c,d)=>a.set(d,!1))},[n]),W.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),o==="popLayout"&&(t=W.createElement(bue,{isPresent:n},t)),W.createElement(mN.Provider,{value:u},t)};function vue(){return new Map}function Sue(t){return W.useEffect(()=>()=>t(),[])}const kf=t=>t.key||"";function Cue(t,e){t.forEach(n=>{const r=kf(n);e.set(r,n)})}function Iue(t){const e=[];return W.Children.forEach(t,n=>{W.isValidElement(n)&&e.push(n)}),e}const Nue=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const a=W.useContext(PM).forceRender||xue()[0],l=l9(),u=Iue(t);let c=u;const d=W.useRef(new Map).current,h=W.useRef(c),f=W.useRef(new Map).current,m=W.useRef(!0);if(RM(()=>{m.current=!1,Cue(u,f),h.current=c}),Sue(()=>{m.current=!0,f.clear(),d.clear()}),m.current)return W.createElement(W.Fragment,null,c.map(b=>W.createElement(lA,{key:kf(b),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},b)));c=[...c];const g=h.current.map(kf),x=u.map(kf),w=g.length;for(let b=0;b<w;b++){const S=g[b];x.indexOf(S)===-1&&!d.has(S)&&d.set(S,void 0)}return o==="wait"&&d.size&&(c=[]),d.forEach((b,S)=>{if(x.indexOf(S)!==-1)return;const C=f.get(S);if(!C)return;const T=g.indexOf(S);let D=b;if(!D){const P=()=>{d.delete(S);const I=Array.from(f.keys()).filter(E=>!x.includes(E));if(I.forEach(E=>f.delete(E)),h.current=u.filter(E=>{const M=kf(E);return M===S||I.includes(M)}),!d.size){if(l.current===!1)return;a(),r&&r()}};D=W.createElement(lA,{key:kf(C),isPresent:!1,onExitComplete:P,custom:e,presenceAffectsLayout:i,mode:o},C),d.set(S,D)}c.splice(T,0,D)}),c=c.map(b=>{const S=b.key;return d.has(S)?b:W.createElement(lA,{key:kf(b),isPresent:!0,presenceAffectsLayout:i,mode:o},b)}),W.createElement(W.Fragment,null,d.size?c:c.map(b=>W.cloneElement(b)))};var uA={},xx={},qz;function u9(){if(qz)return xx;qz=1,xx.byteLength=a,xx.toByteArray=u,xx.fromByteArray=h;for(var t=[],e=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,i=r.length;s<i;++s)t[s]=r[s],e[r.charCodeAt(s)]=s;e[45]=62,e[95]=63;function o(f){var m=f.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=f.indexOf("=");g===-1&&(g=m);var x=g===m?0:4-g%4;return[g,x]}function a(f){var m=o(f),g=m[0],x=m[1];return(g+x)*3/4-x}function l(f,m,g){return(m+g)*3/4-g}function u(f){var m,g=o(f),x=g[0],w=g[1],b=new n(l(f,x,w)),S=0,C=w>0?x-4:x,T;for(T=0;T<C;T+=4)m=e[f.charCodeAt(T)]<<18|e[f.charCodeAt(T+1)]<<12|e[f.charCodeAt(T+2)]<<6|e[f.charCodeAt(T+3)],b[S++]=m>>16&255,b[S++]=m>>8&255,b[S++]=m&255;return w===2&&(m=e[f.charCodeAt(T)]<<2|e[f.charCodeAt(T+1)]>>4,b[S++]=m&255),w===1&&(m=e[f.charCodeAt(T)]<<10|e[f.charCodeAt(T+1)]<<4|e[f.charCodeAt(T+2)]>>2,b[S++]=m>>8&255,b[S++]=m&255),b}function c(f){return t[f>>18&63]+t[f>>12&63]+t[f>>6&63]+t[f&63]}function d(f,m,g){for(var x,w=[],b=m;b<g;b+=3)x=(f[b]<<16&16711680)+(f[b+1]<<8&65280)+(f[b+2]&255),w.push(c(x));return w.join("")}function h(f){for(var m,g=f.length,x=g%3,w=[],b=16383,S=0,C=g-x;S<C;S+=b)w.push(d(f,S,S+b>C?C:S+b));return x===1?(m=f[g-1],w.push(t[m>>2]+t[m<<4&63]+"==")):x===2&&(m=(f[g-2]<<8)+f[g-1],w.push(t[m>>10]+t[m>>4&63]+t[m<<2&63]+"=")),w.join("")}return xx}var E2={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Xz;function eD(){return Xz||(Xz=1,E2.read=function(t,e,n,r,s){var i,o,a=s*8-r-1,l=(1<<a)-1,u=l>>1,c=-7,d=n?s-1:0,h=n?-1:1,f=t[e+d];for(d+=h,i=f&(1<<-c)-1,f>>=-c,c+=a;c>0;i=i*256+t[e+d],d+=h,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=r;c>0;o=o*256+t[e+d],d+=h,c-=8);if(i===0)i=1-u;else{if(i===l)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-u}return(f?-1:1)*o*Math.pow(2,i-r)},E2.write=function(t,e,n,r,s,i){var o,a,l,u=i*8-s-1,c=(1<<u)-1,d=c>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,m=r?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?e+=h/l:e+=h*Math.pow(2,1-d),e*l>=2&&(o++,l/=2),o+d>=c?(a=0,o=c):o+d>=1?(a=(e*l-1)*Math.pow(2,s),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;t[n+f]=a&255,f+=m,a/=256,s-=8);for(o=o<<s|a,u+=s;u>0;t[n+f]=o&255,f+=m,o/=256,u-=8);t[n+f-m]|=g*128}),E2}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Zz;function kue(){return Zz||(Zz=1,function(t){const e=u9(),n=eD(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const N=new Uint8Array(1),k={foo:function(){return 42}};return Object.setPrototypeOf(k,Uint8Array.prototype),Object.setPrototypeOf(N,k),N.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(N){if(N>s)throw new RangeError('The value "'+N+'" is invalid for option "size"');const k=new Uint8Array(N);return Object.setPrototypeOf(k,a.prototype),k}function a(N,k,$){if(typeof N=="number"){if(typeof k=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(N)}return l(N,k,$)}a.poolSize=8192;function l(N,k,$){if(typeof N=="string")return h(N,k);if(ArrayBuffer.isView(N))return m(N);if(N==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N);if(me(N,ArrayBuffer)||N&&me(N.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(me(N,SharedArrayBuffer)||N&&me(N.buffer,SharedArrayBuffer)))return g(N,k,$);if(typeof N=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const J=N.valueOf&&N.valueOf();if(J!=null&&J!==N)return a.from(J,k,$);const ce=x(N);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof N[Symbol.toPrimitive]=="function")return a.from(N[Symbol.toPrimitive]("string"),k,$);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N)}a.from=function(N,k,$){return l(N,k,$)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function u(N){if(typeof N!="number")throw new TypeError('"size" argument must be of type number');if(N<0)throw new RangeError('The value "'+N+'" is invalid for option "size"')}function c(N,k,$){return u(N),N<=0?o(N):k!==void 0?typeof $=="string"?o(N).fill(k,$):o(N).fill(k):o(N)}a.alloc=function(N,k,$){return c(N,k,$)};function d(N){return u(N),o(N<0?0:w(N)|0)}a.allocUnsafe=function(N){return d(N)},a.allocUnsafeSlow=function(N){return d(N)};function h(N,k){if((typeof k!="string"||k==="")&&(k="utf8"),!a.isEncoding(k))throw new TypeError("Unknown encoding: "+k);const $=S(N,k)|0;let J=o($);const ce=J.write(N,k);return ce!==$&&(J=J.slice(0,ce)),J}function f(N){const k=N.length<0?0:w(N.length)|0,$=o(k);for(let J=0;J<k;J+=1)$[J]=N[J]&255;return $}function m(N){if(me(N,Uint8Array)){const k=new Uint8Array(N);return g(k.buffer,k.byteOffset,k.byteLength)}return f(N)}function g(N,k,$){if(k<0||N.byteLength<k)throw new RangeError('"offset" is outside of buffer bounds');if(N.byteLength<k+($||0))throw new RangeError('"length" is outside of buffer bounds');let J;return k===void 0&&$===void 0?J=new Uint8Array(N):$===void 0?J=new Uint8Array(N,k):J=new Uint8Array(N,k,$),Object.setPrototypeOf(J,a.prototype),J}function x(N){if(a.isBuffer(N)){const k=w(N.length)|0,$=o(k);return $.length===0||N.copy($,0,0,k),$}if(N.length!==void 0)return typeof N.length!="number"||je(N.length)?o(0):f(N);if(N.type==="Buffer"&&Array.isArray(N.data))return f(N.data)}function w(N){if(N>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return N|0}function b(N){return+N!=N&&(N=0),a.alloc(+N)}a.isBuffer=function(k){return k!=null&&k._isBuffer===!0&&k!==a.prototype},a.compare=function(k,$){if(me(k,Uint8Array)&&(k=a.from(k,k.offset,k.byteLength)),me($,Uint8Array)&&($=a.from($,$.offset,$.byteLength)),!a.isBuffer(k)||!a.isBuffer($))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(k===$)return 0;let J=k.length,ce=$.length;for(let be=0,Ne=Math.min(J,ce);be<Ne;++be)if(k[be]!==$[be]){J=k[be],ce=$[be];break}return J<ce?-1:ce<J?1:0},a.isEncoding=function(k){switch(String(k).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(k,$){if(!Array.isArray(k))throw new TypeError('"list" argument must be an Array of Buffers');if(k.length===0)return a.alloc(0);let J;if($===void 0)for($=0,J=0;J<k.length;++J)$+=k[J].length;const ce=a.allocUnsafe($);let be=0;for(J=0;J<k.length;++J){let Ne=k[J];if(me(Ne,Uint8Array))be+Ne.length>ce.length?(a.isBuffer(Ne)||(Ne=a.from(Ne)),Ne.copy(ce,be)):Uint8Array.prototype.set.call(ce,Ne,be);else if(a.isBuffer(Ne))Ne.copy(ce,be);else throw new TypeError('"list" argument must be an Array of Buffers');be+=Ne.length}return ce};function S(N,k){if(a.isBuffer(N))return N.length;if(ArrayBuffer.isView(N)||me(N,ArrayBuffer))return N.byteLength;if(typeof N!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof N);const $=N.length,J=arguments.length>2&&arguments[2]===!0;if(!J&&$===0)return 0;let ce=!1;for(;;)switch(k){case"ascii":case"latin1":case"binary":return $;case"utf8":case"utf-8":return L(N).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $*2;case"hex":return $>>>1;case"base64":return q(N).length;default:if(ce)return J?-1:L(N).length;k=(""+k).toLowerCase(),ce=!0}}a.byteLength=S;function C(N,k,$){let J=!1;if((k===void 0||k<0)&&(k=0),k>this.length||(($===void 0||$>this.length)&&($=this.length),$<=0)||($>>>=0,k>>>=0,$<=k))return"";for(N||(N="utf8");;)switch(N){case"hex":return ne(this,k,$);case"utf8":case"utf-8":return z(this,k,$);case"ascii":return H(this,k,$);case"latin1":case"binary":return K(this,k,$);case"base64":return R(this,k,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,k,$);default:if(J)throw new TypeError("Unknown encoding: "+N);N=(N+"").toLowerCase(),J=!0}}a.prototype._isBuffer=!0;function T(N,k,$){const J=N[k];N[k]=N[$],N[$]=J}a.prototype.swap16=function(){const k=this.length;if(k%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let $=0;$<k;$+=2)T(this,$,$+1);return this},a.prototype.swap32=function(){const k=this.length;if(k%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let $=0;$<k;$+=4)T(this,$,$+3),T(this,$+1,$+2);return this},a.prototype.swap64=function(){const k=this.length;if(k%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let $=0;$<k;$+=8)T(this,$,$+7),T(this,$+1,$+6),T(this,$+2,$+5),T(this,$+3,$+4);return this},a.prototype.toString=function(){const k=this.length;return k===0?"":arguments.length===0?z(this,0,k):C.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(k){if(!a.isBuffer(k))throw new TypeError("Argument must be a Buffer");return this===k?!0:a.compare(this,k)===0},a.prototype.inspect=function(){let k="";const $=t.INSPECT_MAX_BYTES;return k=this.toString("hex",0,$).replace(/(.{2})/g,"$1 ").trim(),this.length>$&&(k+=" ... "),"<Buffer "+k+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(k,$,J,ce,be){if(me(k,Uint8Array)&&(k=a.from(k,k.offset,k.byteLength)),!a.isBuffer(k))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof k);if($===void 0&&($=0),J===void 0&&(J=k?k.length:0),ce===void 0&&(ce=0),be===void 0&&(be=this.length),$<0||J>k.length||ce<0||be>this.length)throw new RangeError("out of range index");if(ce>=be&&$>=J)return 0;if(ce>=be)return-1;if($>=J)return 1;if($>>>=0,J>>>=0,ce>>>=0,be>>>=0,this===k)return 0;let Ne=be-ce,at=J-$;const St=Math.min(Ne,at),mt=this.slice(ce,be),dt=k.slice($,J);for(let _t=0;_t<St;++_t)if(mt[_t]!==dt[_t]){Ne=mt[_t],at=dt[_t];break}return Ne<at?-1:at<Ne?1:0};function D(N,k,$,J,ce){if(N.length===0)return-1;if(typeof $=="string"?(J=$,$=0):$>2147483647?$=2147483647:$<-2147483648&&($=-2147483648),$=+$,je($)&&($=ce?0:N.length-1),$<0&&($=N.length+$),$>=N.length){if(ce)return-1;$=N.length-1}else if($<0)if(ce)$=0;else return-1;if(typeof k=="string"&&(k=a.from(k,J)),a.isBuffer(k))return k.length===0?-1:P(N,k,$,J,ce);if(typeof k=="number")return k=k&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(N,k,$):Uint8Array.prototype.lastIndexOf.call(N,k,$):P(N,[k],$,J,ce);throw new TypeError("val must be string, number or Buffer")}function P(N,k,$,J,ce){let be=1,Ne=N.length,at=k.length;if(J!==void 0&&(J=String(J).toLowerCase(),J==="ucs2"||J==="ucs-2"||J==="utf16le"||J==="utf-16le")){if(N.length<2||k.length<2)return-1;be=2,Ne/=2,at/=2,$/=2}function St(dt,_t){return be===1?dt[_t]:dt.readUInt16BE(_t*be)}let mt;if(ce){let dt=-1;for(mt=$;mt<Ne;mt++)if(St(N,mt)===St(k,dt===-1?0:mt-dt)){if(dt===-1&&(dt=mt),mt-dt+1===at)return dt*be}else dt!==-1&&(mt-=mt-dt),dt=-1}else for($+at>Ne&&($=Ne-at),mt=$;mt>=0;mt--){let dt=!0;for(let _t=0;_t<at;_t++)if(St(N,mt+_t)!==St(k,_t)){dt=!1;break}if(dt)return mt}return-1}a.prototype.includes=function(k,$,J){return this.indexOf(k,$,J)!==-1},a.prototype.indexOf=function(k,$,J){return D(this,k,$,J,!0)},a.prototype.lastIndexOf=function(k,$,J){return D(this,k,$,J,!1)};function I(N,k,$,J){$=Number($)||0;const ce=N.length-$;J?(J=Number(J),J>ce&&(J=ce)):J=ce;const be=k.length;J>be/2&&(J=be/2);let Ne;for(Ne=0;Ne<J;++Ne){const at=parseInt(k.substr(Ne*2,2),16);if(je(at))return Ne;N[$+Ne]=at}return Ne}function E(N,k,$,J){return ie(L(k,N.length-$),N,$,J)}function M(N,k,$,J){return ie(U(k),N,$,J)}function O(N,k,$,J){return ie(q(k),N,$,J)}function j(N,k,$,J){return ie(re(k,N.length-$),N,$,J)}a.prototype.write=function(k,$,J,ce){if($===void 0)ce="utf8",J=this.length,$=0;else if(J===void 0&&typeof $=="string")ce=$,J=this.length,$=0;else if(isFinite($))$=$>>>0,isFinite(J)?(J=J>>>0,ce===void 0&&(ce="utf8")):(ce=J,J=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const be=this.length-$;if((J===void 0||J>be)&&(J=be),k.length>0&&(J<0||$<0)||$>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");let Ne=!1;for(;;)switch(ce){case"hex":return I(this,k,$,J);case"utf8":case"utf-8":return E(this,k,$,J);case"ascii":case"latin1":case"binary":return M(this,k,$,J);case"base64":return O(this,k,$,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,k,$,J);default:if(Ne)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),Ne=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(N,k,$){return k===0&&$===N.length?e.fromByteArray(N):e.fromByteArray(N.slice(k,$))}function z(N,k,$){$=Math.min(N.length,$);const J=[];let ce=k;for(;ce<$;){const be=N[ce];let Ne=null,at=be>239?4:be>223?3:be>191?2:1;if(ce+at<=$){let St,mt,dt,_t;switch(at){case 1:be<128&&(Ne=be);break;case 2:St=N[ce+1],(St&192)===128&&(_t=(be&31)<<6|St&63,_t>127&&(Ne=_t));break;case 3:St=N[ce+1],mt=N[ce+2],(St&192)===128&&(mt&192)===128&&(_t=(be&15)<<12|(St&63)<<6|mt&63,_t>2047&&(_t<55296||_t>57343)&&(Ne=_t));break;case 4:St=N[ce+1],mt=N[ce+2],dt=N[ce+3],(St&192)===128&&(mt&192)===128&&(dt&192)===128&&(_t=(be&15)<<18|(St&63)<<12|(mt&63)<<6|dt&63,_t>65535&&_t<1114112&&(Ne=_t))}}Ne===null?(Ne=65533,at=1):Ne>65535&&(Ne-=65536,J.push(Ne>>>10&1023|55296),Ne=56320|Ne&1023),J.push(Ne),ce+=at}return V(J)}const B=4096;function V(N){const k=N.length;if(k<=B)return String.fromCharCode.apply(String,N);let $="",J=0;for(;J<k;)$+=String.fromCharCode.apply(String,N.slice(J,J+=B));return $}function H(N,k,$){let J="";$=Math.min(N.length,$);for(let ce=k;ce<$;++ce)J+=String.fromCharCode(N[ce]&127);return J}function K(N,k,$){let J="";$=Math.min(N.length,$);for(let ce=k;ce<$;++ce)J+=String.fromCharCode(N[ce]);return J}function ne(N,k,$){const J=N.length;(!k||k<0)&&(k=0),(!$||$<0||$>J)&&($=J);let ce="";for(let be=k;be<$;++be)ce+=He[N[be]];return ce}function fe(N,k,$){const J=N.slice(k,$);let ce="";for(let be=0;be<J.length-1;be+=2)ce+=String.fromCharCode(J[be]+J[be+1]*256);return ce}a.prototype.slice=function(k,$){const J=this.length;k=~~k,$=$===void 0?J:~~$,k<0?(k+=J,k<0&&(k=0)):k>J&&(k=J),$<0?($+=J,$<0&&($=0)):$>J&&($=J),$<k&&($=k);const ce=this.subarray(k,$);return Object.setPrototypeOf(ce,a.prototype),ce};function ee(N,k,$){if(N%1!==0||N<0)throw new RangeError("offset is not uint");if(N+k>$)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(k,$,J){k=k>>>0,$=$>>>0,J||ee(k,$,this.length);let ce=this[k],be=1,Ne=0;for(;++Ne<$&&(be*=256);)ce+=this[k+Ne]*be;return ce},a.prototype.readUintBE=a.prototype.readUIntBE=function(k,$,J){k=k>>>0,$=$>>>0,J||ee(k,$,this.length);let ce=this[k+--$],be=1;for(;$>0&&(be*=256);)ce+=this[k+--$]*be;return ce},a.prototype.readUint8=a.prototype.readUInt8=function(k,$){return k=k>>>0,$||ee(k,1,this.length),this[k]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(k,$){return k=k>>>0,$||ee(k,2,this.length),this[k]|this[k+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(k,$){return k=k>>>0,$||ee(k,2,this.length),this[k]<<8|this[k+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(k,$){return k=k>>>0,$||ee(k,4,this.length),(this[k]|this[k+1]<<8|this[k+2]<<16)+this[k+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(k,$){return k=k>>>0,$||ee(k,4,this.length),this[k]*16777216+(this[k+1]<<16|this[k+2]<<8|this[k+3])},a.prototype.readBigUInt64LE=Ge(function(k){k=k>>>0,ve(k,"offset");const $=this[k],J=this[k+7];($===void 0||J===void 0)&&xe(k,this.length-8);const ce=$+this[++k]*2**8+this[++k]*2**16+this[++k]*2**24,be=this[++k]+this[++k]*2**8+this[++k]*2**16+J*2**24;return BigInt(ce)+(BigInt(be)<<BigInt(32))}),a.prototype.readBigUInt64BE=Ge(function(k){k=k>>>0,ve(k,"offset");const $=this[k],J=this[k+7];($===void 0||J===void 0)&&xe(k,this.length-8);const ce=$*2**24+this[++k]*2**16+this[++k]*2**8+this[++k],be=this[++k]*2**24+this[++k]*2**16+this[++k]*2**8+J;return(BigInt(ce)<<BigInt(32))+BigInt(be)}),a.prototype.readIntLE=function(k,$,J){k=k>>>0,$=$>>>0,J||ee(k,$,this.length);let ce=this[k],be=1,Ne=0;for(;++Ne<$&&(be*=256);)ce+=this[k+Ne]*be;return be*=128,ce>=be&&(ce-=Math.pow(2,8*$)),ce},a.prototype.readIntBE=function(k,$,J){k=k>>>0,$=$>>>0,J||ee(k,$,this.length);let ce=$,be=1,Ne=this[k+--ce];for(;ce>0&&(be*=256);)Ne+=this[k+--ce]*be;return be*=128,Ne>=be&&(Ne-=Math.pow(2,8*$)),Ne},a.prototype.readInt8=function(k,$){return k=k>>>0,$||ee(k,1,this.length),this[k]&128?(255-this[k]+1)*-1:this[k]},a.prototype.readInt16LE=function(k,$){k=k>>>0,$||ee(k,2,this.length);const J=this[k]|this[k+1]<<8;return J&32768?J|4294901760:J},a.prototype.readInt16BE=function(k,$){k=k>>>0,$||ee(k,2,this.length);const J=this[k+1]|this[k]<<8;return J&32768?J|4294901760:J},a.prototype.readInt32LE=function(k,$){return k=k>>>0,$||ee(k,4,this.length),this[k]|this[k+1]<<8|this[k+2]<<16|this[k+3]<<24},a.prototype.readInt32BE=function(k,$){return k=k>>>0,$||ee(k,4,this.length),this[k]<<24|this[k+1]<<16|this[k+2]<<8|this[k+3]},a.prototype.readBigInt64LE=Ge(function(k){k=k>>>0,ve(k,"offset");const $=this[k],J=this[k+7];($===void 0||J===void 0)&&xe(k,this.length-8);const ce=this[k+4]+this[k+5]*2**8+this[k+6]*2**16+(J<<24);return(BigInt(ce)<<BigInt(32))+BigInt($+this[++k]*2**8+this[++k]*2**16+this[++k]*2**24)}),a.prototype.readBigInt64BE=Ge(function(k){k=k>>>0,ve(k,"offset");const $=this[k],J=this[k+7];($===void 0||J===void 0)&&xe(k,this.length-8);const ce=($<<24)+this[++k]*2**16+this[++k]*2**8+this[++k];return(BigInt(ce)<<BigInt(32))+BigInt(this[++k]*2**24+this[++k]*2**16+this[++k]*2**8+J)}),a.prototype.readFloatLE=function(k,$){return k=k>>>0,$||ee(k,4,this.length),n.read(this,k,!0,23,4)},a.prototype.readFloatBE=function(k,$){return k=k>>>0,$||ee(k,4,this.length),n.read(this,k,!1,23,4)},a.prototype.readDoubleLE=function(k,$){return k=k>>>0,$||ee(k,8,this.length),n.read(this,k,!0,52,8)},a.prototype.readDoubleBE=function(k,$){return k=k>>>0,$||ee(k,8,this.length),n.read(this,k,!1,52,8)};function de(N,k,$,J,ce,be){if(!a.isBuffer(N))throw new TypeError('"buffer" argument must be a Buffer instance');if(k>ce||k<be)throw new RangeError('"value" argument is out of bounds');if($+J>N.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(k,$,J,ce){if(k=+k,$=$>>>0,J=J>>>0,!ce){const at=Math.pow(2,8*J)-1;de(this,k,$,J,at,0)}let be=1,Ne=0;for(this[$]=k&255;++Ne<J&&(be*=256);)this[$+Ne]=k/be&255;return $+J},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(k,$,J,ce){if(k=+k,$=$>>>0,J=J>>>0,!ce){const at=Math.pow(2,8*J)-1;de(this,k,$,J,at,0)}let be=J-1,Ne=1;for(this[$+be]=k&255;--be>=0&&(Ne*=256);)this[$+be]=k/Ne&255;return $+J},a.prototype.writeUint8=a.prototype.writeUInt8=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,1,255,0),this[$]=k&255,$+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,2,65535,0),this[$]=k&255,this[$+1]=k>>>8,$+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,2,65535,0),this[$]=k>>>8,this[$+1]=k&255,$+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,4,4294967295,0),this[$+3]=k>>>24,this[$+2]=k>>>16,this[$+1]=k>>>8,this[$]=k&255,$+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,4,4294967295,0),this[$]=k>>>24,this[$+1]=k>>>16,this[$+2]=k>>>8,this[$+3]=k&255,$+4};function ge(N,k,$,J,ce){ye(k,J,ce,N,$,7);let be=Number(k&BigInt(4294967295));N[$++]=be,be=be>>8,N[$++]=be,be=be>>8,N[$++]=be,be=be>>8,N[$++]=be;let Ne=Number(k>>BigInt(32)&BigInt(4294967295));return N[$++]=Ne,Ne=Ne>>8,N[$++]=Ne,Ne=Ne>>8,N[$++]=Ne,Ne=Ne>>8,N[$++]=Ne,$}function Z(N,k,$,J,ce){ye(k,J,ce,N,$,7);let be=Number(k&BigInt(4294967295));N[$+7]=be,be=be>>8,N[$+6]=be,be=be>>8,N[$+5]=be,be=be>>8,N[$+4]=be;let Ne=Number(k>>BigInt(32)&BigInt(4294967295));return N[$+3]=Ne,Ne=Ne>>8,N[$+2]=Ne,Ne=Ne>>8,N[$+1]=Ne,Ne=Ne>>8,N[$]=Ne,$+8}a.prototype.writeBigUInt64LE=Ge(function(k,$=0){return ge(this,k,$,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Ge(function(k,$=0){return Z(this,k,$,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(k,$,J,ce){if(k=+k,$=$>>>0,!ce){const St=Math.pow(2,8*J-1);de(this,k,$,J,St-1,-St)}let be=0,Ne=1,at=0;for(this[$]=k&255;++be<J&&(Ne*=256);)k<0&&at===0&&this[$+be-1]!==0&&(at=1),this[$+be]=(k/Ne>>0)-at&255;return $+J},a.prototype.writeIntBE=function(k,$,J,ce){if(k=+k,$=$>>>0,!ce){const St=Math.pow(2,8*J-1);de(this,k,$,J,St-1,-St)}let be=J-1,Ne=1,at=0;for(this[$+be]=k&255;--be>=0&&(Ne*=256);)k<0&&at===0&&this[$+be+1]!==0&&(at=1),this[$+be]=(k/Ne>>0)-at&255;return $+J},a.prototype.writeInt8=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,1,127,-128),k<0&&(k=255+k+1),this[$]=k&255,$+1},a.prototype.writeInt16LE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,2,32767,-32768),this[$]=k&255,this[$+1]=k>>>8,$+2},a.prototype.writeInt16BE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,2,32767,-32768),this[$]=k>>>8,this[$+1]=k&255,$+2},a.prototype.writeInt32LE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,4,2147483647,-2147483648),this[$]=k&255,this[$+1]=k>>>8,this[$+2]=k>>>16,this[$+3]=k>>>24,$+4},a.prototype.writeInt32BE=function(k,$,J){return k=+k,$=$>>>0,J||de(this,k,$,4,2147483647,-2147483648),k<0&&(k=4294967295+k+1),this[$]=k>>>24,this[$+1]=k>>>16,this[$+2]=k>>>8,this[$+3]=k&255,$+4},a.prototype.writeBigInt64LE=Ge(function(k,$=0){return ge(this,k,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Ge(function(k,$=0){return Z(this,k,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function we(N,k,$,J,ce,be){if($+J>N.length)throw new RangeError("Index out of range");if($<0)throw new RangeError("Index out of range")}function Ee(N,k,$,J,ce){return k=+k,$=$>>>0,ce||we(N,k,$,4),n.write(N,k,$,J,23,4),$+4}a.prototype.writeFloatLE=function(k,$,J){return Ee(this,k,$,!0,J)},a.prototype.writeFloatBE=function(k,$,J){return Ee(this,k,$,!1,J)};function Le(N,k,$,J,ce){return k=+k,$=$>>>0,ce||we(N,k,$,8),n.write(N,k,$,J,52,8),$+8}a.prototype.writeDoubleLE=function(k,$,J){return Le(this,k,$,!0,J)},a.prototype.writeDoubleBE=function(k,$,J){return Le(this,k,$,!1,J)},a.prototype.copy=function(k,$,J,ce){if(!a.isBuffer(k))throw new TypeError("argument should be a Buffer");if(J||(J=0),!ce&&ce!==0&&(ce=this.length),$>=k.length&&($=k.length),$||($=0),ce>0&&ce<J&&(ce=J),ce===J||k.length===0||this.length===0)return 0;if($<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("Index out of range");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),k.length-$<ce-J&&(ce=k.length-$+J);const be=ce-J;return this===k&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin($,J,ce):Uint8Array.prototype.set.call(k,this.subarray(J,ce),$),be},a.prototype.fill=function(k,$,J,ce){if(typeof k=="string"){if(typeof $=="string"?(ce=$,$=0,J=this.length):typeof J=="string"&&(ce=J,J=this.length),ce!==void 0&&typeof ce!="string")throw new TypeError("encoding must be a string");if(typeof ce=="string"&&!a.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);if(k.length===1){const Ne=k.charCodeAt(0);(ce==="utf8"&&Ne<128||ce==="latin1")&&(k=Ne)}}else typeof k=="number"?k=k&255:typeof k=="boolean"&&(k=Number(k));if($<0||this.length<$||this.length<J)throw new RangeError("Out of range index");if(J<=$)return this;$=$>>>0,J=J===void 0?this.length:J>>>0,k||(k=0);let be;if(typeof k=="number")for(be=$;be<J;++be)this[be]=k;else{const Ne=a.isBuffer(k)?k:a.from(k,ce),at=Ne.length;if(at===0)throw new TypeError('The value "'+k+'" is invalid for argument "value"');for(be=0;be<J-$;++be)this[be+$]=Ne[be%at]}return this};const De={};function Be(N,k,$){De[N]=class extends ${constructor(){super(),Object.defineProperty(this,"message",{value:k.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${N}]`,this.stack,delete this.name}get code(){return N}set code(ce){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ce,writable:!0})}toString(){return`${this.name} [${N}]: ${this.message}`}}}Be("ERR_BUFFER_OUT_OF_BOUNDS",function(N){return N?`${N} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Be("ERR_INVALID_ARG_TYPE",function(N,k){return`The "${N}" argument must be of type number. Received type ${typeof k}`},TypeError),Be("ERR_OUT_OF_RANGE",function(N,k,$){let J=`The value of "${N}" is out of range.`,ce=$;return Number.isInteger($)&&Math.abs($)>2**32?ce=se(String($)):typeof $=="bigint"&&(ce=String($),($>BigInt(2)**BigInt(32)||$<-(BigInt(2)**BigInt(32)))&&(ce=se(ce)),ce+="n"),J+=` It must be ${k}. Received ${ce}`,J},RangeError);function se(N){let k="",$=N.length;const J=N[0]==="-"?1:0;for(;$>=J+4;$-=3)k=`_${N.slice($-3,$)}${k}`;return`${N.slice(0,$)}${k}`}function le(N,k,$){ve(k,"offset"),(N[k]===void 0||N[k+$]===void 0)&&xe(k,N.length-($+1))}function ye(N,k,$,J,ce,be){if(N>$||N<k){const Ne=typeof k=="bigint"?"n":"";let at;throw k===0||k===BigInt(0)?at=`>= 0${Ne} and < 2${Ne} ** ${(be+1)*8}${Ne}`:at=`>= -(2${Ne} ** ${(be+1)*8-1}${Ne}) and < 2 ** ${(be+1)*8-1}${Ne}`,new De.ERR_OUT_OF_RANGE("value",at,N)}le(J,ce,be)}function ve(N,k){if(typeof N!="number")throw new De.ERR_INVALID_ARG_TYPE(k,"number",N)}function xe(N,k,$){throw Math.floor(N)!==N?(ve(N,$),new De.ERR_OUT_OF_RANGE("offset","an integer",N)):k<0?new De.ERR_BUFFER_OUT_OF_BOUNDS:new De.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${k}`,N)}const Ie=/[^+/0-9A-Za-z-_]/g;function te(N){if(N=N.split("=")[0],N=N.trim().replace(Ie,""),N.length<2)return"";for(;N.length%4!==0;)N=N+"=";return N}function L(N,k){k=k||1/0;let $;const J=N.length;let ce=null;const be=[];for(let Ne=0;Ne<J;++Ne){if($=N.charCodeAt(Ne),$>55295&&$<57344){if(!ce){if($>56319){(k-=3)>-1&&be.push(239,191,189);continue}else if(Ne+1===J){(k-=3)>-1&&be.push(239,191,189);continue}ce=$;continue}if($<56320){(k-=3)>-1&&be.push(239,191,189),ce=$;continue}$=(ce-55296<<10|$-56320)+65536}else ce&&(k-=3)>-1&&be.push(239,191,189);if(ce=null,$<128){if((k-=1)<0)break;be.push($)}else if($<2048){if((k-=2)<0)break;be.push($>>6|192,$&63|128)}else if($<65536){if((k-=3)<0)break;be.push($>>12|224,$>>6&63|128,$&63|128)}else if($<1114112){if((k-=4)<0)break;be.push($>>18|240,$>>12&63|128,$>>6&63|128,$&63|128)}else throw new Error("Invalid code point")}return be}function U(N){const k=[];for(let $=0;$<N.length;++$)k.push(N.charCodeAt($)&255);return k}function re(N,k){let $,J,ce;const be=[];for(let Ne=0;Ne<N.length&&!((k-=2)<0);++Ne)$=N.charCodeAt(Ne),J=$>>8,ce=$%256,be.push(ce),be.push(J);return be}function q(N){return e.toByteArray(te(N))}function ie(N,k,$,J){let ce;for(ce=0;ce<J&&!(ce+$>=k.length||ce>=N.length);++ce)k[ce+$]=N[ce];return ce}function me(N,k){return N instanceof k||N!=null&&N.constructor!=null&&N.constructor.name!=null&&N.constructor.name===k.name}function je(N){return N!==N}const He=function(){const N="0123456789abcdef",k=new Array(256);for(let $=0;$<16;++$){const J=$*16;for(let ce=0;ce<16;++ce)k[J+ce]=N[$]+N[ce]}return k}();function Ge(N){return typeof BigInt>"u"?Je:N}function Je(){throw new Error("BigInt not supported")}}(uA)),uA}var Tue=kue(),N$;(function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"})(N$||(N$={}));const Eue="modulepreload",_ue=function(t){return"/"+t},Qz={},Aue=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=_ue(l),l in Qz)return;Qz[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Eue,u||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},ZC="abcdefghijklmnopqrstuvwxyz234567",Bg=Object.create(null);for(let t=0;t<ZC.length;t++)Bg[ZC[t]]=t;Bg[0]=Bg.o;Bg[1]=Bg.i;function $ue(t){let e=0,n=0,r="";function s(i){return e<0?n|=i>>-e:n=i<<e&248,e>3?(e-=8,1):(e<4&&(r+=ZC[n>>3],e+=5),0)}for(let i=0;i<t.length;)i+=s(t[i]);return r+(e<0?ZC[n>>3]:"")}function Rue(t){let e=0,n=0;const r=new Uint8Array(t.length*4/3|0);let s=0;function i(o){let a=Bg[o.toLowerCase()];if(a===void 0)throw new Error(`Invalid character: ${JSON.stringify(o)}`);a<<=3,n|=a>>>e,e+=5,e>=8&&(r[s++]=n,e-=8,e>0?n=a<<5-e&255:n=0)}for(const o of t)i(o);return r.slice(0,s)}const Mue=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Due(t){const e=new Uint8Array(t);let n=-1;for(let r=0;r<e.length;r++){const i=(e[r]^n)&255;n=Mue[i]^n>>>8}return(n^-1)>>>0}function Oue(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function c9(t,...e){if(!Oue(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Jz(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Pue(t,e){c9(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Fm=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function cA(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Hl(t,e){return t<<32-e|t>>>e}function Fue(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function d9(t){return typeof t=="string"&&(t=Fue(t)),c9(t),t}class Lue{clone(){return this._cloneInto()}}function tD(t){const e=r=>t().update(d9(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function h9(t=32){if(Fm&&typeof Fm.getRandomValues=="function")return Fm.getRandomValues(new Uint8Array(t));if(Fm&&typeof Fm.randomBytes=="function")return Fm.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function zue(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),l=r?4:0,u=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+u,a,r)}function Bue(t,e,n){return t&e^~t&n}function Uue(t,e,n){return t&e^t&n^e&n}class f9 extends Lue{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=cA(this.buffer)}update(e){Jz(this);const{view:n,buffer:r,blockLen:s}=this;e=d9(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const l=cA(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Jz(this),Pue(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;zue(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=cA(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=l/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,c[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}}const Vue=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gd=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yd=new Uint32Array(64);class p9 extends f9{constructor(){super(64,32,8,!1),this.A=gd[0]|0,this.B=gd[1]|0,this.C=gd[2]|0,this.D=gd[3]|0,this.E=gd[4]|0,this.F=gd[5]|0,this.G=gd[6]|0,this.H=gd[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:l}=this;return[e,n,r,s,i,o,a,l]}set(e,n,r,s,i,o,a,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(e,n){for(let d=0;d<16;d++,n+=4)yd[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=yd[d-15],f=yd[d-2],m=Hl(h,7)^Hl(h,18)^h>>>3,g=Hl(f,17)^Hl(f,19)^f>>>10;yd[d]=g+yd[d-7]+m+yd[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:l,G:u,H:c}=this;for(let d=0;d<64;d++){const h=Hl(a,6)^Hl(a,11)^Hl(a,25),f=c+h+Bue(a,l,u)+Vue[d]+yd[d]|0,g=(Hl(r,2)^Hl(r,13)^Hl(r,22))+Uue(r,s,i)|0;c=u,u=l,l=a,a=o+f|0,o=i,i=s,s=r,r=f+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(r,s,i,o,a,l,u,c)}roundClean(){yd.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class jue extends p9{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const nD=tD(()=>new p9),Wue=tD(()=>new jue);function Gue(t){return Wue.create().update(new Uint8Array(t)).digest()}const Bx="__principal__",Hue=2,eB=4,Yue="aaaaa-aa",Kue=t=>{var e;return new Uint8Array(((e=t.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(n=>parseInt(n,16)))},que=t=>t.reduce((e,n)=>e+n.toString(16).padStart(2,"0"),"");let zt=class MS{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([eB]))}static managementCanister(){return this.fromHex(Yue)}static selfAuthenticating(e){const n=Gue(e);return new this(new Uint8Array([...n,Hue]))}static from(e){if(typeof e=="string")return MS.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new MS(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new MS(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this(Kue(e))}static fromText(e){let n=e;if(e.includes(Bx)){const o=JSON.parse(e);Bx in o&&(n=o[Bx])}const r=n.toLowerCase().replace(/-/g,"");let s=Rue(r);s=s.slice(4,s.length);const i=new this(s);if(i.toText()!==n)throw new Error(`Principal "${i.toText()}" does not have a valid checksum (original value "${n}" may not be a valid Principal ID).`);return i}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===eB}toUint8Array(){return this._arr}toHex(){return que(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,Due(this._arr));const r=new Uint8Array(e),s=Uint8Array.from(this._arr),i=new Uint8Array([...r,...s]),a=$ue(i).match(/.{1,5}/g);if(!a)throw new Error;return a.join("-")}toString(){return this.toText()}toJSON(){return{[Bx]:this.toText()}}compareTo(e){for(let n=0;n<Math.min(this._arr.length,e._arr.length);n++){if(this._arr[n]<e._arr[n])return"lt";if(this._arr[n]>e._arr[n])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const n=this.compareTo(e);return n=="lt"||n=="eq"}gtEq(e){const n=this.compareTo(e);return n=="gt"||n=="eq"}};const Xue=Object.freeze(Object.defineProperty({__proto__:null,JSON_KEY_PRINCIPAL:Bx,Principal:zt},Symbol.toStringTag,{value:"Module"}));function xl(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.byteLength,0));let n=0;for(const r of t)e.set(new Uint8Array(r),n),n+=r.byteLength;return e.buffer}function On(t){return[...new Uint8Array(t)].map(e=>e.toString(16).padStart(2,"0")).join("")}const Zue=new RegExp(/^[0-9a-fA-F]+$/);function gu(t){if(!Zue.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce((n,r,s)=>(n[s/2|0]=(n[s/2|0]||"")+r,n),[]).map(n=>Number.parseInt(n,16));return new Uint8Array(e).buffer}function rD(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const n=new Uint8Array(t),r=new Uint8Array(e);for(let s=0;s<n.length;s++)if(n[s]!==r[s])return n[s]-r[s];return 0}function R1(t,e){return rD(t,e)===0}function ww(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function sD(t){return t instanceof Uint8Array?ww(t):t instanceof ArrayBuffer?t:Array.isArray(t)?ww(new Uint8Array(t)):"buffer"in t?sD(t.buffer):ww(new Uint8Array(t))}class Tr extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=Tr.prototype,Object.setPrototypeOf(this,Tr.prototype)}}function Pn(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.byteLength,0));let n=0;for(const r of t)e.set(new Uint8Array(r),n),n+=r.byteLength;return e}class Lp{constructor(e,n=(e==null?void 0:e.byteLength)||0){this._buffer=QC(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,n)}get buffer(){return QC(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const n=this._view.subarray(0,e);return this._view=this._view.subarray(e),n.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const n=new Uint8Array(e),r=this._view.byteLength;this._view.byteOffset+this._view.byteLength+n.byteLength>=this._buffer.byteLength?this.alloc(n.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+n.byteLength),this._view.set(n,r)}get end(){return this._view.byteLength===0}alloc(e){const n=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),r=new Uint8Array(n,0,this._view.byteLength+e);r.set(this._view),this._buffer=n,this._view=r}}function dA(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function QC(t){return t instanceof Uint8Array?dA(t):t instanceof ArrayBuffer?t:Array.isArray(t)?dA(new Uint8Array(t)):"buffer"in t?QC(t.buffer):dA(new Uint8Array(t))}function Que(t){const n=new TextEncoder().encode(t);let r=0;for(const s of n)r=(r*223+s)%2**32;return r}function uu(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return Que(t)}function m9(){throw new Error("unexpected end of buffer")}function ap(t,e){return t.byteLength<e&&m9(),t.read(e)}function lp(t){const e=t.readUint8();return e===void 0&&m9(),e}function Er(t){if(typeof t=="number"&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new Lp(new ArrayBuffer(e),0);for(;;){const r=Number(t&BigInt(127));if(t/=BigInt(128),t===BigInt(0)){n.write(new Uint8Array([r]));break}else n.write(new Uint8Array([r|128]))}return n.buffer}function ps(t){let e=BigInt(1),n=BigInt(0),r;do r=lp(t),n+=BigInt(r&127).valueOf()*e,e*=BigInt(128);while(r>=128);return n}function xs(t){typeof t=="number"&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const n=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new Lp(new ArrayBuffer(n),0);for(;;){const i=s(t);if(t/=BigInt(128),e&&t===BigInt(0)&&(i&64)!==0||!e&&t===BigInt(0)&&(i&64)===0){r.write(new Uint8Array([i]));break}else r.write(new Uint8Array([i|128]))}function s(i){const o=i%BigInt(128);return Number(e?BigInt(128)-o-BigInt(1):o)}return r.buffer}function kd(t){const e=new Uint8Array(t.buffer);let n=0;for(;n<e.byteLength;n++)if(e[n]<128){if((e[n]&64)===0)return ps(t);break}const r=new Uint8Array(ap(t,n+1));let s=BigInt(0);for(let i=r.byteLength-1;i>=0;i--)s=s*BigInt(128)+BigInt(128-(r[i]&127)-1);return-s-BigInt(1)}function Jue(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return g9(t,e)}function g9(t,e){t=BigInt(t);const n=new Lp(new ArrayBuffer(Math.min(1,e)),0);let r=0,s=BigInt(256),i=BigInt(0),o=Number(t%s);for(n.write(new Uint8Array([o]));++r<e;)t<0&&i===BigInt(0)&&o!==0&&(i=BigInt(1)),o=Number((t/s-i)%BigInt(256)),n.write(new Uint8Array([o])),s*=BigInt(256);return n.buffer}function y9(t,e){let n=BigInt(lp(t)),r=BigInt(1),s=0;for(;++s<e;){r*=BigInt(256);const i=BigInt(lp(t));n=n+r*i}return n}function ece(t,e){let n=y9(t,e);const r=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return n>=r&&(n-=r*BigInt(2)),n}function k$(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const DS="DIDL",tB=400;function Vw(t,e,n){return t.map((r,s)=>n(r,e[s]))}class tce{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,n){const r=this._typs.length;this._idx.set(e.name,r),this._typs.push(n)}merge(e,n){const r=this._idx.get(e.name),s=this._idx.get(n);if(r===void 0)throw new Error("Missing type index for "+e);if(s===void 0)throw new Error("Missing type index for "+n);this._typs[r]=this._typs[s],this._typs.splice(s,1),this._idx.delete(n)}encode(){const e=Er(this._typs.length),n=Pn(...this._typs);return Pn(e,n)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return xs(this._idx.get(e)||0)}}class nce{visitType(e,n){throw new Error("Not implemented")}visitPrimitive(e,n){return this.visitType(e,n)}visitEmpty(e,n){return this.visitPrimitive(e,n)}visitBool(e,n){return this.visitPrimitive(e,n)}visitNull(e,n){return this.visitPrimitive(e,n)}visitReserved(e,n){return this.visitPrimitive(e,n)}visitText(e,n){return this.visitPrimitive(e,n)}visitNumber(e,n){return this.visitPrimitive(e,n)}visitInt(e,n){return this.visitNumber(e,n)}visitNat(e,n){return this.visitNumber(e,n)}visitFloat(e,n){return this.visitPrimitive(e,n)}visitFixedInt(e,n){return this.visitNumber(e,n)}visitFixedNat(e,n){return this.visitNumber(e,n)}visitPrincipal(e,n){return this.visitPrimitive(e,n)}visitConstruct(e,n){return this.visitType(e,n)}visitVec(e,n,r){return this.visitConstruct(e,r)}visitOpt(e,n,r){return this.visitConstruct(e,r)}visitRecord(e,n,r){return this.visitConstruct(e,r)}visitTuple(e,n,r){const s=n.map((i,o)=>[`_${o}_`,i]);return this.visitRecord(e,s,r)}visitVariant(e,n,r){return this.visitConstruct(e,r)}visitRec(e,n,r){return this.visitConstruct(n,r)}visitFunc(e,n){return this.visitConstruct(e,n)}visitService(e,n){return this.visitConstruct(e,n)}}class SN{display(){return this.name}valueToString(e){return jr(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class Fa extends SN{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class Nh extends SN{checkType(e){if(e instanceof kh){const n=e.getType();if(typeof n>"u")throw new Error("type mismatch with uninitialized type");return n}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class x9 extends Fa{accept(e,n){return e.visitEmpty(this,n)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return xs(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class w9 extends SN{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,n){throw e.visitType(this,n)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,n){let r=n.decodeValue(e,n);Object(r)!==r&&(r=Object(r));let s;return n instanceof kh?s=()=>n.getType():s=()=>n,Object.defineProperty(r,"type",{value:s,writable:!0,enumerable:!1,configurable:!0}),r}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class b9 extends Fa{accept(e,n){return e.visitBool(this,n)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return xs(-2)}decodeValue(e,n){switch(this.checkType(n),lp(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class v9 extends Fa{accept(e,n){return e.visitNull(this,n)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return xs(-1)}decodeValue(e,n){return this.checkType(n),null}get name(){return"null"}}class JC extends Fa{accept(e,n){return e.visitReserved(this,n)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return xs(-16)}decodeValue(e,n){return n.name!==this.name&&n.decodeValue(e,n),null}get name(){return"reserved"}}class S9 extends Fa{accept(e,n){return e.visitText(this,n)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){const n=new TextEncoder().encode(e),r=Er(n.byteLength);return Pn(r,n)}encodeType(){return xs(-15)}decodeValue(e,n){this.checkType(n);const r=ps(e),s=ap(e,Number(r));return new TextDecoder("utf8",{fatal:!0}).decode(s)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class C9 extends Fa{accept(e,n){return e.visitInt(this,n)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){return xs(e)}encodeType(){return xs(-4)}decodeValue(e,n){return this.checkType(n),kd(e)}get name(){return"int"}valueToString(e){return e.toString()}}class I9 extends Fa{accept(e,n){return e.visitNat(this,n)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){return Er(e)}encodeType(){return xs(-3)}decodeValue(e,n){return this.checkType(n),ps(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class iD extends Fa{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,n){return e.visitFloat(this,n)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){const n=new ArrayBuffer(this._bits/8),r=new DataView(n);return this._bits===32?r.setFloat32(0,e,!0):r.setFloat64(0,e,!0),n}encodeType(){const e=this._bits===32?-13:-14;return xs(e)}decodeValue(e,n){this.checkType(n);const r=ap(e,this._bits/8),s=new DataView(r);return this._bits===32?s.getFloat32(0,!0):s.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class up extends Fa{constructor(e){super(),this._bits=e}accept(e,n){return e.visitFixedInt(this,n)}covariant(e){const n=k$(this._bits-1)*BigInt(-1),r=k$(this._bits-1)-BigInt(1);let s=!1;if(typeof e=="bigint")s=e>=n&&e<=r;else if(Number.isInteger(e)){const i=BigInt(e);s=i>=n&&i<=r}else s=!1;if(s)return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){return g9(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return xs(-9-e)}decodeValue(e,n){this.checkType(n);const r=ece(e,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class Qd extends Fa{constructor(e){super(),this._bits=e}accept(e,n){return e.visitFixedNat(this,n)}covariant(e){const n=k$(this._bits);let r=!1;if(typeof e=="bigint"&&e>=BigInt(0)?r=e<n:Number.isInteger(e)&&e>=0?r=BigInt(e)<n:r=!1,r)return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){return Jue(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return xs(-5-e)}decodeValue(e,n){this.checkType(n);const r=y9(e,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class CN extends Nh{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof Qd&&e._bits===8&&(this._blobOptimization=!0)}accept(e,n){return e.visitVec(this,this._type,n)}covariant(e){const n=this._type instanceof Qd?this._type._bits:this._type instanceof up?this._type._bits:0;if(ArrayBuffer.isView(e)&&n==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((r,s)=>{try{return this._type.covariant(r)}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${s} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){const n=Er(e.length);if(this._blobOptimization)return Pn(n,new Uint8Array(e));if(ArrayBuffer.isView(e))return Pn(n,new Uint8Array(e.buffer));const r=new Lp(new ArrayBuffer(n.byteLength+e.length),0);r.write(n);for(const s of e){const i=this._type.encodeValue(s);r.write(new Uint8Array(i))}return r.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const n=xs(-19),r=this._type.encodeType(e);e.add(this,Pn(n,r))}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof CN))throw new Error("Not a vector type");const s=Number(ps(e));if(this._type instanceof Qd){if(this._type._bits==8)return new Uint8Array(e.read(s));if(this._type._bits==16)return new Uint16Array(e.read(s*2));if(this._type._bits==32)return new Uint32Array(e.read(s*4));if(this._type._bits==64)return new BigUint64Array(e.read(s*8))}if(this._type instanceof up){if(this._type._bits==8)return new Int8Array(e.read(s));if(this._type._bits==16)return new Int16Array(e.read(s*2));if(this._type._bits==32)return new Int32Array(e.read(s*4));if(this._type._bits==64)return new BigInt64Array(e.read(s*8))}const i=[];for(let o=0;o<s;o++)i.push(this._type.decodeValue(e,r._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(r=>this._type.valueToString(r)).join("; ")+"}"}}class Ug extends Nh{constructor(e){super(),this._type=e}accept(e,n){return e.visitOpt(this,this._type,n)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(n){throw new Error(`Invalid ${this.display()} argument: ${jr(e)} 

-> ${n.message}`)}throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):Pn(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const n=xs(-18),r=this._type.encodeType(e);e.add(this,Pn(n,r))}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof Ug))throw new Error("Not an option type");switch(lp(e)){case 0:return[];case 1:return[this._type.decodeValue(e,r._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class M1 extends Nh{constructor(e={}){super(),this._fields=Object.entries(e).sort((n,r)=>uu(n[0])-uu(r[0]))}accept(e,n){return e.visitRecord(this,this._fields,n)}tryAsTuple(){const e=[];for(let n=0;n<this._fields.length;n++){const[r,s]=this._fields[n];if(r!==`_${n}_`)return null;e.push(s)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([n,r])=>{if(!e.hasOwnProperty(n))throw new Error(`Record is missing key "${n}".`);try{return r.covariant(e[n])}catch(s){throw new Error(`Invalid ${this.display()} argument: 

field ${n} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){const n=this._fields.map(([s])=>e[s]),r=Vw(this._fields,n,([,s],i)=>s.encodeValue(i));return Pn(...r)}_buildTypeTableImpl(e){this._fields.forEach(([i,o])=>o.buildTypeTable(e));const n=xs(-20),r=Er(this._fields.length),s=this._fields.map(([i,o])=>Pn(Er(uu(i)),o.encodeType(e)));e.add(this,Pn(n,r,Pn(...s)))}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof M1))throw new Error("Not a record type");const s={};let i=0,o=0;for(;o<r._fields.length;){const[a,l]=r._fields[o];if(i>=this._fields.length){l.decodeValue(e,l),o++;continue}const[u,c]=this._fields[i],d=uu(this._fields[i][0]),h=uu(a);if(d===h)s[u]=c.decodeValue(e,l),i++,o++;else if(h>d)if(c instanceof Ug||c instanceof JC)s[u]=[],i++;else throw new Error("Cannot find required field "+u);else l.decodeValue(e,l),o++}for(const[a,l]of this._fields.slice(i))if(l instanceof Ug||l instanceof JC)s[a]=[];else throw new Error("Cannot find required field "+a);return s}get name(){return`record {${this._fields.map(([n,r])=>n+":"+r.name).join("; ")}}`}display(){return`record {${this._fields.map(([n,r])=>n+":"+r.display()).join("; ")}}`}valueToString(e){const n=this._fields.map(([s])=>e[s]);return`record {${Vw(this._fields,n,([s,i],o)=>s+"="+i.valueToString(o)).join("; ")}}`}}class IN extends M1{constructor(e){const n={};e.forEach((r,s)=>n["_"+s+"_"]=r),super(n),this._components=e}accept(e,n){return e.visitTuple(this,this._components,n)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((n,r)=>{try{return n.covariant(e[r])}catch(s){throw new Error(`Invalid ${this.display()} argument: 

index ${r} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){const n=Vw(this._components,e,(r,s)=>r.encodeValue(s));return Pn(...n)}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof IN))throw new Error("not a tuple type");if(r._components.length<this._components.length)throw new Error("tuple mismatch");const s=[];for(const[i,o]of r._components.entries())i>=this._components.length?o.decodeValue(e,o):s.push(this._components[i].decodeValue(e,o));return s}display(){return`record {${this._components.map(n=>n.display()).join("; ")}}`}valueToString(e){return`record {${Vw(this._components,e,(r,s)=>r.valueToString(s)).join("; ")}}`}}class NN extends Nh{constructor(e={}){super(),this._fields=Object.entries(e).sort((n,r)=>uu(n[0])-uu(r[0]))}accept(e,n){return e.visitVariant(this,this._fields,n)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([n,r])=>{try{return!e.hasOwnProperty(n)||r.covariant(e[n])}catch(s){throw new Error(`Invalid ${this.display()} argument: 

variant ${n} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){for(let n=0;n<this._fields.length;n++){const[r,s]=this._fields[n];if(e.hasOwnProperty(r)){const i=Er(n),o=s.encodeValue(e[r]);return Pn(i,o)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,i])=>{i.buildTypeTable(e)});const n=xs(-21),r=Er(this._fields.length),s=this._fields.map(([i,o])=>Pn(Er(uu(i)),o.encodeType(e)));e.add(this,Pn(n,r,...s))}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof NN))throw new Error("Not a variant type");const s=Number(ps(e));if(s>=r._fields.length)throw Error("Invalid variant index: "+s);const[i,o]=r._fields[s];for(const[a,l]of this._fields)if(uu(i)===uu(a)){const u=l.decodeValue(e,o);return{[a]:u}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map(([n,r])=>n+":"+r.name).join("; ")}}`}display(){return`variant {${this._fields.map(([n,r])=>n+(r.name==="null"?"":`:${r.display()}`)).join("; ")}}`}valueToString(e){for(const[n,r]of this._fields)if(e.hasOwnProperty(n)){const s=r.valueToString(e[n]);return s==="null"?`variant {${n}}`:`variant {${n}=${s}}`}throw new Error("Variant has no data: "+e)}}class kh extends Nh{constructor(){super(...arguments),this._id=kh._counter++,this._type=void 0}accept(e,n){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,n)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,n){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,n)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}kh._counter=0;function oD(t){if(lp(t)!==1)throw new Error("Cannot decode principal");const n=Number(ps(t));return zt.fromUint8Array(new Uint8Array(ap(t,n)))}class N9 extends Fa{accept(e,n){return e.visitPrincipal(this,n)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){const n=e.toUint8Array(),r=Er(n.byteLength);return Pn(new Uint8Array([1]),r,n)}encodeType(){return xs(-24)}decodeValue(e,n){return this.checkType(n),oD(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class aD extends Nh{constructor(e,n,r=[]){super(),this.argTypes=e,this.retTypes=n,this.annotations=r}static argsToString(e,n){if(e.length!==n.length)throw new Error("arity mismatch");return"("+e.map((r,s)=>r.valueToString(n[s])).join(", ")+")"}accept(e,n){return e.visitFunc(this,n)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue([e,n]){const r=e.toUint8Array(),s=Er(r.byteLength),i=Pn(new Uint8Array([1]),s,r),o=new TextEncoder().encode(n),a=Er(o.byteLength);return Pn(new Uint8Array([1]),i,a,o)}_buildTypeTableImpl(e){this.argTypes.forEach(u=>u.buildTypeTable(e)),this.retTypes.forEach(u=>u.buildTypeTable(e));const n=xs(-22),r=Er(this.argTypes.length),s=Pn(...this.argTypes.map(u=>u.encodeType(e))),i=Er(this.retTypes.length),o=Pn(...this.retTypes.map(u=>u.encodeType(e))),a=Er(this.annotations.length),l=Pn(...this.annotations.map(u=>this.encodeAnnotation(u)));e.add(this,Pn(n,r,s,i,o,a,l))}decodeValue(e){if(lp(e)!==1)throw new Error("Cannot decode function reference");const r=oD(e),s=Number(ps(e)),i=ap(e,s),a=new TextDecoder("utf8",{fatal:!0}).decode(i);return[r,a]}get name(){const e=this.argTypes.map(s=>s.name).join(", "),n=this.retTypes.map(s=>s.name).join(", "),r=" "+this.annotations.join(" ");return`(${e}) -> (${n})${r}`}valueToString([e,n]){return`func "${e.toText()}".${n}`}display(){const e=this.argTypes.map(s=>s.display()).join(", "),n=this.retTypes.map(s=>s.display()).join(", "),r=" "+this.annotations.join(" ");return`(${e})  (${n})${r}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class k9 extends Nh{constructor(e){super(),this._fields=Object.entries(e).sort((n,r)=>n[0]<r[0]?-1:n[0]>r[0]?1:0)}accept(e,n){return e.visitService(this,n)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${jr(e)}`)}encodeValue(e){const n=e.toUint8Array(),r=Er(n.length);return Pn(new Uint8Array([1]),r,n)}_buildTypeTableImpl(e){this._fields.forEach(([i,o])=>o.buildTypeTable(e));const n=xs(-23),r=Er(this._fields.length),s=this._fields.map(([i,o])=>{const a=new TextEncoder().encode(i),l=Er(a.length);return Pn(l,a,o.encodeType(e))});e.add(this,Pn(n,r,...s))}decodeValue(e){return oD(e)}get name(){return`service {${this._fields.map(([n,r])=>n+":"+r.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function jr(t){const e=JSON.stringify(t,(n,r)=>typeof r=="bigint"?`BigInt(${r})`:r);return e&&e.length>tB?e.substring(0,tB-3)+"...":e}function T$(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const n=new tce;t.forEach(l=>l.buildTypeTable(n));const r=new TextEncoder().encode(DS),s=n.encode(),i=Er(e.length),o=Pn(...t.map(l=>l.encodeType(n))),a=Pn(...Vw(t,e,(l,u)=>{try{l.covariant(u)}catch(c){throw new Error(c.message+`

`)}return l.encodeValue(u)}));return Pn(r,s,i,o,a)}function T9(t,e){const n=new Lp(e);if(e.byteLength<DS.length)throw new Error("Message length smaller than magic number");const r=ap(n,DS.length),s=new TextDecoder().decode(r);if(s!==DS)throw new Error("Wrong magic number: "+JSON.stringify(s));function i(f){const m=[],g=Number(ps(f));for(let b=0;b<g;b++){const S=Number(kd(f));switch(S){case-18:case-19:{const C=Number(kd(f));m.push([S,C]);break}case-20:case-21:{const C=[];let T=Number(ps(f)),D;for(;T--;){const P=Number(ps(f));if(P>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof D=="number"&&D>=P)throw new Error("field id collision or not sorted");D=P;const I=Number(kd(f));C.push([P,I])}m.push([S,C]);break}case-22:{const C=[];let T=Number(ps(f));for(;T--;)C.push(Number(kd(f)));const D=[];let P=Number(ps(f));for(;P--;)D.push(Number(kd(f)));const I=[];let E=Number(ps(f));for(;E--;)switch(Number(ps(f))){case 1:{I.push("query");break}case 2:{I.push("oneway");break}case 3:{I.push("composite_query");break}default:throw new Error("unknown annotation")}m.push([S,[C,D,I]]);break}case-23:{let C=Number(ps(f));const T=[];for(;C--;){const D=Number(ps(f)),P=new TextDecoder().decode(ap(f,D)),I=kd(f);T.push([P,I])}m.push([S,T]);break}default:throw new Error("Illegal op_code: "+S)}}const x=[],w=Number(ps(f));for(let b=0;b<w;b++)x.push(Number(kd(f)));return[m,x]}const[o,a]=i(n);if(a.length<t.length)throw new Error("Wrong number of return values");const l=o.map(f=>Z9());function u(f){if(f<-24)throw new Error("future value not supported");if(f<0)switch(f){case-1:return $9;case-2:return A9;case-3:return D9;case-4:return M9;case-5:return U9;case-6:return V9;case-7:return j9;case-8:return W9;case-9:return F9;case-10:return L9;case-11:return z9;case-12:return B9;case-13:return O9;case-14:return P9;case-15:return R9;case-16:return _9;case-17:return E9;case-24:return G9;default:throw new Error("Illegal op_code: "+f)}if(f>=o.length)throw new Error("type index out of range");return l[f]}function c(f){switch(f[0]){case-19:{const m=u(f[1]);return Y9(m)}case-18:{const m=u(f[1]);return K9(m)}case-20:{const m={};for(const[w,b]of f[1]){const S=`_${w}_`;m[S]=u(b)}const g=q9(m),x=g.tryAsTuple();return Array.isArray(x)?H9(...x):g}case-21:{const m={};for(const[g,x]of f[1]){const w=`_${g}_`;m[w]=u(x)}return X9(m)}case-22:{const[m,g,x]=f[1];return Q9(m.map(w=>u(w)),g.map(w=>u(w)),x)}case-23:{const m={},g=f[1];for(const[x,w]of g){let b=u(w);if(b instanceof kh&&(b=b.getType()),!(b instanceof aD))throw new Error("Illegal service definition: services can only contain functions");m[x]=b}return J9(m)}default:throw new Error("Illegal op_code: "+f[0])}}o.forEach((f,m)=>{if(f[0]===-22){const g=c(f);l[m].fill(g)}}),o.forEach((f,m)=>{if(f[0]!==-22){const g=c(f);l[m].fill(g)}});const d=a.map(f=>u(f)),h=t.map((f,m)=>f.decodeValue(n,d[m]));for(let f=t.length;f<d.length;f++)d[f].decodeValue(n,d[f]);if(n.byteLength>0)throw new Error("decode: Left-over bytes");return h}const E9=new x9,_9=new JC,rce=new w9,A9=new b9,$9=new v9,R9=new S9,M9=new C9,D9=new I9,O9=new iD(32),P9=new iD(64),F9=new up(8),L9=new up(16),z9=new up(32),B9=new up(64),U9=new Qd(8),V9=new Qd(16),j9=new Qd(32),W9=new Qd(64),G9=new N9;function H9(...t){return new IN(t)}function Y9(t){return new CN(t)}function K9(t){return new Ug(t)}function q9(t){return new M1(t)}function X9(t){return new NN(t)}function Z9(){return new kh}function Q9(t,e,n=[]){return new aD(t,e,n)}function J9(t){return new k9(t)}const sce=Object.freeze(Object.defineProperty({__proto__:null,Bool:A9,BoolClass:b9,ConstructType:Nh,Empty:E9,EmptyClass:x9,FixedIntClass:up,FixedNatClass:Qd,Float32:O9,Float64:P9,FloatClass:iD,Func:Q9,FuncClass:aD,Int:M9,Int16:L9,Int32:z9,Int64:B9,Int8:F9,IntClass:C9,Nat:D9,Nat16:V9,Nat32:j9,Nat64:W9,Nat8:U9,NatClass:I9,Null:$9,NullClass:v9,Opt:K9,OptClass:Ug,PrimitiveType:Fa,Principal:G9,PrincipalClass:N9,Rec:Z9,RecClass:kh,Record:q9,RecordClass:M1,Reserved:_9,ReservedClass:JC,Service:J9,ServiceClass:k9,Text:R9,TextClass:S9,Tuple:H9,TupleClass:IN,Type:SN,Unknown:rce,UnknownClass:w9,Variant:X9,VariantClass:NN,Vec:Y9,VecClass:CN,Visitor:nce,decode:T9,encode:T$},Symbol.toStringTag,{value:"Module"}));var hA={},fA={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var nB;function kN(){return nB||(nB=1,function(t){var e=u9(),n=eD(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50;var s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var te=new Uint8Array(1),L={foo:function(){return 42}};return Object.setPrototypeOf(L,Uint8Array.prototype),Object.setPrototypeOf(te,L),te.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(te){if(te>s)throw new RangeError('The value "'+te+'" is invalid for option "size"');var L=new Uint8Array(te);return Object.setPrototypeOf(L,a.prototype),L}function a(te,L,U){if(typeof te=="number"){if(typeof L=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(te)}return l(te,L,U)}a.poolSize=8192;function l(te,L,U){if(typeof te=="string")return h(te,L);if(ArrayBuffer.isView(te))return m(te);if(te==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof te);if(ve(te,ArrayBuffer)||te&&ve(te.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ve(te,SharedArrayBuffer)||te&&ve(te.buffer,SharedArrayBuffer)))return g(te,L,U);if(typeof te=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var re=te.valueOf&&te.valueOf();if(re!=null&&re!==te)return a.from(re,L,U);var q=x(te);if(q)return q;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof te[Symbol.toPrimitive]=="function")return a.from(te[Symbol.toPrimitive]("string"),L,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof te)}a.from=function(te,L,U){return l(te,L,U)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function u(te){if(typeof te!="number")throw new TypeError('"size" argument must be of type number');if(te<0)throw new RangeError('The value "'+te+'" is invalid for option "size"')}function c(te,L,U){return u(te),te<=0?o(te):L!==void 0?typeof U=="string"?o(te).fill(L,U):o(te).fill(L):o(te)}a.alloc=function(te,L,U){return c(te,L,U)};function d(te){return u(te),o(te<0?0:w(te)|0)}a.allocUnsafe=function(te){return d(te)},a.allocUnsafeSlow=function(te){return d(te)};function h(te,L){if((typeof L!="string"||L==="")&&(L="utf8"),!a.isEncoding(L))throw new TypeError("Unknown encoding: "+L);var U=S(te,L)|0,re=o(U),q=re.write(te,L);return q!==U&&(re=re.slice(0,q)),re}function f(te){for(var L=te.length<0?0:w(te.length)|0,U=o(L),re=0;re<L;re+=1)U[re]=te[re]&255;return U}function m(te){if(ve(te,Uint8Array)){var L=new Uint8Array(te);return g(L.buffer,L.byteOffset,L.byteLength)}return f(te)}function g(te,L,U){if(L<0||te.byteLength<L)throw new RangeError('"offset" is outside of buffer bounds');if(te.byteLength<L+(U||0))throw new RangeError('"length" is outside of buffer bounds');var re;return L===void 0&&U===void 0?re=new Uint8Array(te):U===void 0?re=new Uint8Array(te,L):re=new Uint8Array(te,L,U),Object.setPrototypeOf(re,a.prototype),re}function x(te){if(a.isBuffer(te)){var L=w(te.length)|0,U=o(L);return U.length===0||te.copy(U,0,0,L),U}if(te.length!==void 0)return typeof te.length!="number"||xe(te.length)?o(0):f(te);if(te.type==="Buffer"&&Array.isArray(te.data))return f(te.data)}function w(te){if(te>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return te|0}function b(te){return+te!=te&&(te=0),a.alloc(+te)}a.isBuffer=function(L){return L!=null&&L._isBuffer===!0&&L!==a.prototype},a.compare=function(L,U){if(ve(L,Uint8Array)&&(L=a.from(L,L.offset,L.byteLength)),ve(U,Uint8Array)&&(U=a.from(U,U.offset,U.byteLength)),!a.isBuffer(L)||!a.isBuffer(U))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(L===U)return 0;for(var re=L.length,q=U.length,ie=0,me=Math.min(re,q);ie<me;++ie)if(L[ie]!==U[ie]){re=L[ie],q=U[ie];break}return re<q?-1:q<re?1:0},a.isEncoding=function(L){switch(String(L).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(L,U){if(!Array.isArray(L))throw new TypeError('"list" argument must be an Array of Buffers');if(L.length===0)return a.alloc(0);var re;if(U===void 0)for(U=0,re=0;re<L.length;++re)U+=L[re].length;var q=a.allocUnsafe(U),ie=0;for(re=0;re<L.length;++re){var me=L[re];if(ve(me,Uint8Array))ie+me.length>q.length?a.from(me).copy(q,ie):Uint8Array.prototype.set.call(q,me,ie);else if(a.isBuffer(me))me.copy(q,ie);else throw new TypeError('"list" argument must be an Array of Buffers');ie+=me.length}return q};function S(te,L){if(a.isBuffer(te))return te.length;if(ArrayBuffer.isView(te)||ve(te,ArrayBuffer))return te.byteLength;if(typeof te!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof te);var U=te.length,re=arguments.length>2&&arguments[2]===!0;if(!re&&U===0)return 0;for(var q=!1;;)switch(L){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return De(te).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U*2;case"hex":return U>>>1;case"base64":return le(te).length;default:if(q)return re?-1:De(te).length;L=(""+L).toLowerCase(),q=!0}}a.byteLength=S;function C(te,L,U){var re=!1;if((L===void 0||L<0)&&(L=0),L>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0,L>>>=0,U<=L))return"";for(te||(te="utf8");;)switch(te){case"hex":return ne(this,L,U);case"utf8":case"utf-8":return z(this,L,U);case"ascii":return H(this,L,U);case"latin1":case"binary":return K(this,L,U);case"base64":return R(this,L,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,L,U);default:if(re)throw new TypeError("Unknown encoding: "+te);te=(te+"").toLowerCase(),re=!0}}a.prototype._isBuffer=!0;function T(te,L,U){var re=te[L];te[L]=te[U],te[U]=re}a.prototype.swap16=function(){var L=this.length;if(L%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var U=0;U<L;U+=2)T(this,U,U+1);return this},a.prototype.swap32=function(){var L=this.length;if(L%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var U=0;U<L;U+=4)T(this,U,U+3),T(this,U+1,U+2);return this},a.prototype.swap64=function(){var L=this.length;if(L%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var U=0;U<L;U+=8)T(this,U,U+7),T(this,U+1,U+6),T(this,U+2,U+5),T(this,U+3,U+4);return this},a.prototype.toString=function(){var L=this.length;return L===0?"":arguments.length===0?z(this,0,L):C.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(L){if(!a.isBuffer(L))throw new TypeError("Argument must be a Buffer");return this===L?!0:a.compare(this,L)===0},a.prototype.inspect=function(){var L="",U=t.INSPECT_MAX_BYTES;return L=this.toString("hex",0,U).replace(/(.{2})/g,"$1 ").trim(),this.length>U&&(L+=" ... "),"<Buffer "+L+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(L,U,re,q,ie){if(ve(L,Uint8Array)&&(L=a.from(L,L.offset,L.byteLength)),!a.isBuffer(L))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof L);if(U===void 0&&(U=0),re===void 0&&(re=L?L.length:0),q===void 0&&(q=0),ie===void 0&&(ie=this.length),U<0||re>L.length||q<0||ie>this.length)throw new RangeError("out of range index");if(q>=ie&&U>=re)return 0;if(q>=ie)return-1;if(U>=re)return 1;if(U>>>=0,re>>>=0,q>>>=0,ie>>>=0,this===L)return 0;for(var me=ie-q,je=re-U,He=Math.min(me,je),Ge=this.slice(q,ie),Je=L.slice(U,re),N=0;N<He;++N)if(Ge[N]!==Je[N]){me=Ge[N],je=Je[N];break}return me<je?-1:je<me?1:0};function D(te,L,U,re,q){if(te.length===0)return-1;if(typeof U=="string"?(re=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),U=+U,xe(U)&&(U=q?0:te.length-1),U<0&&(U=te.length+U),U>=te.length){if(q)return-1;U=te.length-1}else if(U<0)if(q)U=0;else return-1;if(typeof L=="string"&&(L=a.from(L,re)),a.isBuffer(L))return L.length===0?-1:P(te,L,U,re,q);if(typeof L=="number")return L=L&255,typeof Uint8Array.prototype.indexOf=="function"?q?Uint8Array.prototype.indexOf.call(te,L,U):Uint8Array.prototype.lastIndexOf.call(te,L,U):P(te,[L],U,re,q);throw new TypeError("val must be string, number or Buffer")}function P(te,L,U,re,q){var ie=1,me=te.length,je=L.length;if(re!==void 0&&(re=String(re).toLowerCase(),re==="ucs2"||re==="ucs-2"||re==="utf16le"||re==="utf-16le")){if(te.length<2||L.length<2)return-1;ie=2,me/=2,je/=2,U/=2}function He($,J){return ie===1?$[J]:$.readUInt16BE(J*ie)}var Ge;if(q){var Je=-1;for(Ge=U;Ge<me;Ge++)if(He(te,Ge)===He(L,Je===-1?0:Ge-Je)){if(Je===-1&&(Je=Ge),Ge-Je+1===je)return Je*ie}else Je!==-1&&(Ge-=Ge-Je),Je=-1}else for(U+je>me&&(U=me-je),Ge=U;Ge>=0;Ge--){for(var N=!0,k=0;k<je;k++)if(He(te,Ge+k)!==He(L,k)){N=!1;break}if(N)return Ge}return-1}a.prototype.includes=function(L,U,re){return this.indexOf(L,U,re)!==-1},a.prototype.indexOf=function(L,U,re){return D(this,L,U,re,!0)},a.prototype.lastIndexOf=function(L,U,re){return D(this,L,U,re,!1)};function I(te,L,U,re){U=Number(U)||0;var q=te.length-U;re?(re=Number(re),re>q&&(re=q)):re=q;var ie=L.length;re>ie/2&&(re=ie/2);for(var me=0;me<re;++me){var je=parseInt(L.substr(me*2,2),16);if(xe(je))return me;te[U+me]=je}return me}function E(te,L,U,re){return ye(De(L,te.length-U),te,U,re)}function M(te,L,U,re){return ye(Be(L),te,U,re)}function O(te,L,U,re){return ye(le(L),te,U,re)}function j(te,L,U,re){return ye(se(L,te.length-U),te,U,re)}a.prototype.write=function(L,U,re,q){if(U===void 0)q="utf8",re=this.length,U=0;else if(re===void 0&&typeof U=="string")q=U,re=this.length,U=0;else if(isFinite(U))U=U>>>0,isFinite(re)?(re=re>>>0,q===void 0&&(q="utf8")):(q=re,re=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ie=this.length-U;if((re===void 0||re>ie)&&(re=ie),L.length>0&&(re<0||U<0)||U>this.length)throw new RangeError("Attempt to write outside buffer bounds");q||(q="utf8");for(var me=!1;;)switch(q){case"hex":return I(this,L,U,re);case"utf8":case"utf-8":return E(this,L,U,re);case"ascii":case"latin1":case"binary":return M(this,L,U,re);case"base64":return O(this,L,U,re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,L,U,re);default:if(me)throw new TypeError("Unknown encoding: "+q);q=(""+q).toLowerCase(),me=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(te,L,U){return L===0&&U===te.length?e.fromByteArray(te):e.fromByteArray(te.slice(L,U))}function z(te,L,U){U=Math.min(te.length,U);for(var re=[],q=L;q<U;){var ie=te[q],me=null,je=ie>239?4:ie>223?3:ie>191?2:1;if(q+je<=U){var He,Ge,Je,N;switch(je){case 1:ie<128&&(me=ie);break;case 2:He=te[q+1],(He&192)===128&&(N=(ie&31)<<6|He&63,N>127&&(me=N));break;case 3:He=te[q+1],Ge=te[q+2],(He&192)===128&&(Ge&192)===128&&(N=(ie&15)<<12|(He&63)<<6|Ge&63,N>2047&&(N<55296||N>57343)&&(me=N));break;case 4:He=te[q+1],Ge=te[q+2],Je=te[q+3],(He&192)===128&&(Ge&192)===128&&(Je&192)===128&&(N=(ie&15)<<18|(He&63)<<12|(Ge&63)<<6|Je&63,N>65535&&N<1114112&&(me=N))}}me===null?(me=65533,je=1):me>65535&&(me-=65536,re.push(me>>>10&1023|55296),me=56320|me&1023),re.push(me),q+=je}return V(re)}var B=4096;function V(te){var L=te.length;if(L<=B)return String.fromCharCode.apply(String,te);for(var U="",re=0;re<L;)U+=String.fromCharCode.apply(String,te.slice(re,re+=B));return U}function H(te,L,U){var re="";U=Math.min(te.length,U);for(var q=L;q<U;++q)re+=String.fromCharCode(te[q]&127);return re}function K(te,L,U){var re="";U=Math.min(te.length,U);for(var q=L;q<U;++q)re+=String.fromCharCode(te[q]);return re}function ne(te,L,U){var re=te.length;(!L||L<0)&&(L=0),(!U||U<0||U>re)&&(U=re);for(var q="",ie=L;ie<U;++ie)q+=Ie[te[ie]];return q}function fe(te,L,U){for(var re=te.slice(L,U),q="",ie=0;ie<re.length-1;ie+=2)q+=String.fromCharCode(re[ie]+re[ie+1]*256);return q}a.prototype.slice=function(L,U){var re=this.length;L=~~L,U=U===void 0?re:~~U,L<0?(L+=re,L<0&&(L=0)):L>re&&(L=re),U<0?(U+=re,U<0&&(U=0)):U>re&&(U=re),U<L&&(U=L);var q=this.subarray(L,U);return Object.setPrototypeOf(q,a.prototype),q};function ee(te,L,U){if(te%1!==0||te<0)throw new RangeError("offset is not uint");if(te+L>U)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(L,U,re){L=L>>>0,U=U>>>0,re||ee(L,U,this.length);for(var q=this[L],ie=1,me=0;++me<U&&(ie*=256);)q+=this[L+me]*ie;return q},a.prototype.readUintBE=a.prototype.readUIntBE=function(L,U,re){L=L>>>0,U=U>>>0,re||ee(L,U,this.length);for(var q=this[L+--U],ie=1;U>0&&(ie*=256);)q+=this[L+--U]*ie;return q},a.prototype.readUint8=a.prototype.readUInt8=function(L,U){return L=L>>>0,U||ee(L,1,this.length),this[L]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(L,U){return L=L>>>0,U||ee(L,2,this.length),this[L]|this[L+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(L,U){return L=L>>>0,U||ee(L,2,this.length),this[L]<<8|this[L+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(L,U){return L=L>>>0,U||ee(L,4,this.length),(this[L]|this[L+1]<<8|this[L+2]<<16)+this[L+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(L,U){return L=L>>>0,U||ee(L,4,this.length),this[L]*16777216+(this[L+1]<<16|this[L+2]<<8|this[L+3])},a.prototype.readIntLE=function(L,U,re){L=L>>>0,U=U>>>0,re||ee(L,U,this.length);for(var q=this[L],ie=1,me=0;++me<U&&(ie*=256);)q+=this[L+me]*ie;return ie*=128,q>=ie&&(q-=Math.pow(2,8*U)),q},a.prototype.readIntBE=function(L,U,re){L=L>>>0,U=U>>>0,re||ee(L,U,this.length);for(var q=U,ie=1,me=this[L+--q];q>0&&(ie*=256);)me+=this[L+--q]*ie;return ie*=128,me>=ie&&(me-=Math.pow(2,8*U)),me},a.prototype.readInt8=function(L,U){return L=L>>>0,U||ee(L,1,this.length),this[L]&128?(255-this[L]+1)*-1:this[L]},a.prototype.readInt16LE=function(L,U){L=L>>>0,U||ee(L,2,this.length);var re=this[L]|this[L+1]<<8;return re&32768?re|4294901760:re},a.prototype.readInt16BE=function(L,U){L=L>>>0,U||ee(L,2,this.length);var re=this[L+1]|this[L]<<8;return re&32768?re|4294901760:re},a.prototype.readInt32LE=function(L,U){return L=L>>>0,U||ee(L,4,this.length),this[L]|this[L+1]<<8|this[L+2]<<16|this[L+3]<<24},a.prototype.readInt32BE=function(L,U){return L=L>>>0,U||ee(L,4,this.length),this[L]<<24|this[L+1]<<16|this[L+2]<<8|this[L+3]},a.prototype.readFloatLE=function(L,U){return L=L>>>0,U||ee(L,4,this.length),n.read(this,L,!0,23,4)},a.prototype.readFloatBE=function(L,U){return L=L>>>0,U||ee(L,4,this.length),n.read(this,L,!1,23,4)},a.prototype.readDoubleLE=function(L,U){return L=L>>>0,U||ee(L,8,this.length),n.read(this,L,!0,52,8)},a.prototype.readDoubleBE=function(L,U){return L=L>>>0,U||ee(L,8,this.length),n.read(this,L,!1,52,8)};function de(te,L,U,re,q,ie){if(!a.isBuffer(te))throw new TypeError('"buffer" argument must be a Buffer instance');if(L>q||L<ie)throw new RangeError('"value" argument is out of bounds');if(U+re>te.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(L,U,re,q){if(L=+L,U=U>>>0,re=re>>>0,!q){var ie=Math.pow(2,8*re)-1;de(this,L,U,re,ie,0)}var me=1,je=0;for(this[U]=L&255;++je<re&&(me*=256);)this[U+je]=L/me&255;return U+re},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(L,U,re,q){if(L=+L,U=U>>>0,re=re>>>0,!q){var ie=Math.pow(2,8*re)-1;de(this,L,U,re,ie,0)}var me=re-1,je=1;for(this[U+me]=L&255;--me>=0&&(je*=256);)this[U+me]=L/je&255;return U+re},a.prototype.writeUint8=a.prototype.writeUInt8=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,1,255,0),this[U]=L&255,U+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,2,65535,0),this[U]=L&255,this[U+1]=L>>>8,U+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,2,65535,0),this[U]=L>>>8,this[U+1]=L&255,U+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,4,4294967295,0),this[U+3]=L>>>24,this[U+2]=L>>>16,this[U+1]=L>>>8,this[U]=L&255,U+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,4,4294967295,0),this[U]=L>>>24,this[U+1]=L>>>16,this[U+2]=L>>>8,this[U+3]=L&255,U+4},a.prototype.writeIntLE=function(L,U,re,q){if(L=+L,U=U>>>0,!q){var ie=Math.pow(2,8*re-1);de(this,L,U,re,ie-1,-ie)}var me=0,je=1,He=0;for(this[U]=L&255;++me<re&&(je*=256);)L<0&&He===0&&this[U+me-1]!==0&&(He=1),this[U+me]=(L/je>>0)-He&255;return U+re},a.prototype.writeIntBE=function(L,U,re,q){if(L=+L,U=U>>>0,!q){var ie=Math.pow(2,8*re-1);de(this,L,U,re,ie-1,-ie)}var me=re-1,je=1,He=0;for(this[U+me]=L&255;--me>=0&&(je*=256);)L<0&&He===0&&this[U+me+1]!==0&&(He=1),this[U+me]=(L/je>>0)-He&255;return U+re},a.prototype.writeInt8=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,1,127,-128),L<0&&(L=255+L+1),this[U]=L&255,U+1},a.prototype.writeInt16LE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,2,32767,-32768),this[U]=L&255,this[U+1]=L>>>8,U+2},a.prototype.writeInt16BE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,2,32767,-32768),this[U]=L>>>8,this[U+1]=L&255,U+2},a.prototype.writeInt32LE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,4,2147483647,-2147483648),this[U]=L&255,this[U+1]=L>>>8,this[U+2]=L>>>16,this[U+3]=L>>>24,U+4},a.prototype.writeInt32BE=function(L,U,re){return L=+L,U=U>>>0,re||de(this,L,U,4,2147483647,-2147483648),L<0&&(L=4294967295+L+1),this[U]=L>>>24,this[U+1]=L>>>16,this[U+2]=L>>>8,this[U+3]=L&255,U+4};function ge(te,L,U,re,q,ie){if(U+re>te.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function Z(te,L,U,re,q){return L=+L,U=U>>>0,q||ge(te,L,U,4),n.write(te,L,U,re,23,4),U+4}a.prototype.writeFloatLE=function(L,U,re){return Z(this,L,U,!0,re)},a.prototype.writeFloatBE=function(L,U,re){return Z(this,L,U,!1,re)};function we(te,L,U,re,q){return L=+L,U=U>>>0,q||ge(te,L,U,8),n.write(te,L,U,re,52,8),U+8}a.prototype.writeDoubleLE=function(L,U,re){return we(this,L,U,!0,re)},a.prototype.writeDoubleBE=function(L,U,re){return we(this,L,U,!1,re)},a.prototype.copy=function(L,U,re,q){if(!a.isBuffer(L))throw new TypeError("argument should be a Buffer");if(re||(re=0),!q&&q!==0&&(q=this.length),U>=L.length&&(U=L.length),U||(U=0),q>0&&q<re&&(q=re),q===re||L.length===0||this.length===0)return 0;if(U<0)throw new RangeError("targetStart out of bounds");if(re<0||re>=this.length)throw new RangeError("Index out of range");if(q<0)throw new RangeError("sourceEnd out of bounds");q>this.length&&(q=this.length),L.length-U<q-re&&(q=L.length-U+re);var ie=q-re;return this===L&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(U,re,q):Uint8Array.prototype.set.call(L,this.subarray(re,q),U),ie},a.prototype.fill=function(L,U,re,q){if(typeof L=="string"){if(typeof U=="string"?(q=U,U=0,re=this.length):typeof re=="string"&&(q=re,re=this.length),q!==void 0&&typeof q!="string")throw new TypeError("encoding must be a string");if(typeof q=="string"&&!a.isEncoding(q))throw new TypeError("Unknown encoding: "+q);if(L.length===1){var ie=L.charCodeAt(0);(q==="utf8"&&ie<128||q==="latin1")&&(L=ie)}}else typeof L=="number"?L=L&255:typeof L=="boolean"&&(L=Number(L));if(U<0||this.length<U||this.length<re)throw new RangeError("Out of range index");if(re<=U)return this;U=U>>>0,re=re===void 0?this.length:re>>>0,L||(L=0);var me;if(typeof L=="number")for(me=U;me<re;++me)this[me]=L;else{var je=a.isBuffer(L)?L:a.from(L,q),He=je.length;if(He===0)throw new TypeError('The value "'+L+'" is invalid for argument "value"');for(me=0;me<re-U;++me)this[me+U]=je[me%He]}return this};var Ee=/[^+/0-9A-Za-z-_]/g;function Le(te){if(te=te.split("=")[0],te=te.trim().replace(Ee,""),te.length<2)return"";for(;te.length%4!==0;)te=te+"=";return te}function De(te,L){L=L||1/0;for(var U,re=te.length,q=null,ie=[],me=0;me<re;++me){if(U=te.charCodeAt(me),U>55295&&U<57344){if(!q){if(U>56319){(L-=3)>-1&&ie.push(239,191,189);continue}else if(me+1===re){(L-=3)>-1&&ie.push(239,191,189);continue}q=U;continue}if(U<56320){(L-=3)>-1&&ie.push(239,191,189),q=U;continue}U=(q-55296<<10|U-56320)+65536}else q&&(L-=3)>-1&&ie.push(239,191,189);if(q=null,U<128){if((L-=1)<0)break;ie.push(U)}else if(U<2048){if((L-=2)<0)break;ie.push(U>>6|192,U&63|128)}else if(U<65536){if((L-=3)<0)break;ie.push(U>>12|224,U>>6&63|128,U&63|128)}else if(U<1114112){if((L-=4)<0)break;ie.push(U>>18|240,U>>12&63|128,U>>6&63|128,U&63|128)}else throw new Error("Invalid code point")}return ie}function Be(te){for(var L=[],U=0;U<te.length;++U)L.push(te.charCodeAt(U)&255);return L}function se(te,L){for(var U,re,q,ie=[],me=0;me<te.length&&!((L-=2)<0);++me)U=te.charCodeAt(me),re=U>>8,q=U%256,ie.push(q),ie.push(re);return ie}function le(te){return e.toByteArray(Le(te))}function ye(te,L,U,re){for(var q=0;q<re&&!(q+U>=L.length||q>=te.length);++q)L[q+U]=te[q];return q}function ve(te,L){return te instanceof L||te!=null&&te.constructor!=null&&te.constructor.name!=null&&te.constructor.name===L.name}function xe(te){return te!==te}var Ie=function(){for(var te="0123456789abcdef",L=new Array(256),U=0;U<16;++U)for(var re=U*16,q=0;q<16;++q)L[re+q]=te[U]+te[q];return L}()}(fA)),fA}var OS={exports:{}},ice=OS.exports,rB;function TN(){return rB||(rB=1,function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,i=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,f=1e9;function m(D){var P,I,E,M=Z.prototype={constructor:Z,toString:null,valueOf:null},O=new Z(1),j=20,R=4,z=-7,B=21,V=-1e7,H=1e7,K=!1,ne=1,fe=0,ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},de="0123456789abcdefghijklmnopqrstuvwxyz",ge=!0;function Z(se,le){var ye,ve,xe,Ie,te,L,U,re,q=this;if(!(q instanceof Z))return new Z(se,le);if(le==null){if(se&&se._isBigNumber===!0){q.s=se.s,!se.c||se.e>H?q.c=q.e=null:se.e<V?q.c=[q.e=0]:(q.e=se.e,q.c=se.c.slice());return}if((L=typeof se=="number")&&se*0==0){if(q.s=1/se<0?(se=-se,-1):1,se===~~se){for(Ie=0,te=se;te>=10;te/=10,Ie++);Ie>H?q.c=q.e=null:(q.e=Ie,q.c=[se]);return}re=String(se)}else{if(!r.test(re=String(se)))return E(q,re,L);q.s=re.charCodeAt(0)==45?(re=re.slice(1),-1):1}(Ie=re.indexOf("."))>-1&&(re=re.replace(".","")),(te=re.search(/e/i))>0?(Ie<0&&(Ie=te),Ie+=+re.slice(te+1),re=re.substring(0,te)):Ie<0&&(Ie=re.length)}else{if(b(le,2,de.length,"Base"),le==10&&ge)return q=new Z(se),De(q,j+q.e+1,R);if(re=String(se),L=typeof se=="number"){if(se*0!=0)return E(q,re,L,le);if(q.s=1/se<0?(re=re.slice(1),-1):1,Z.DEBUG&&re.replace(/^0\.0*|\./,"").length>15)throw Error(a+se)}else q.s=re.charCodeAt(0)===45?(re=re.slice(1),-1):1;for(ye=de.slice(0,le),Ie=te=0,U=re.length;te<U;te++)if(ye.indexOf(ve=re.charAt(te))<0){if(ve=="."){if(te>Ie){Ie=U;continue}}else if(!xe&&(re==re.toUpperCase()&&(re=re.toLowerCase())||re==re.toLowerCase()&&(re=re.toUpperCase()))){xe=!0,te=-1,Ie=0;continue}return E(q,String(se),L,le)}L=!1,re=I(re,le,10,q.s),(Ie=re.indexOf("."))>-1?re=re.replace(".",""):Ie=re.length}for(te=0;re.charCodeAt(te)===48;te++);for(U=re.length;re.charCodeAt(--U)===48;);if(re=re.slice(te,++U)){if(U-=te,L&&Z.DEBUG&&U>15&&(se>c||se!==i(se)))throw Error(a+q.s*se);if((Ie=Ie-te-1)>H)q.c=q.e=null;else if(Ie<V)q.c=[q.e=0];else{if(q.e=Ie,q.c=[],te=(Ie+1)%u,Ie<0&&(te+=u),te<U){for(te&&q.c.push(+re.slice(0,te)),U-=u;te<U;)q.c.push(+re.slice(te,te+=u));te=u-(re=re.slice(te)).length}else te-=U;for(;te--;re+="0");q.c.push(+re)}}else q.c=[q.e=0]}Z.clone=m,Z.ROUND_UP=0,Z.ROUND_DOWN=1,Z.ROUND_CEIL=2,Z.ROUND_FLOOR=3,Z.ROUND_HALF_UP=4,Z.ROUND_HALF_DOWN=5,Z.ROUND_HALF_EVEN=6,Z.ROUND_HALF_CEIL=7,Z.ROUND_HALF_FLOOR=8,Z.EUCLID=9,Z.config=Z.set=function(se){var le,ye;if(se!=null)if(typeof se=="object"){if(se.hasOwnProperty(le="DECIMAL_PLACES")&&(ye=se[le],b(ye,0,f,le),j=ye),se.hasOwnProperty(le="ROUNDING_MODE")&&(ye=se[le],b(ye,0,8,le),R=ye),se.hasOwnProperty(le="EXPONENTIAL_AT")&&(ye=se[le],ye&&ye.pop?(b(ye[0],-1e9,0,le),b(ye[1],0,f,le),z=ye[0],B=ye[1]):(b(ye,-1e9,f,le),z=-(B=ye<0?-ye:ye))),se.hasOwnProperty(le="RANGE"))if(ye=se[le],ye&&ye.pop)b(ye[0],-1e9,-1,le),b(ye[1],1,f,le),V=ye[0],H=ye[1];else if(b(ye,-1e9,f,le),ye)V=-(H=ye<0?-ye:ye);else throw Error(o+le+" cannot be zero: "+ye);if(se.hasOwnProperty(le="CRYPTO"))if(ye=se[le],ye===!!ye)if(ye)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))K=ye;else throw K=!ye,Error(o+"crypto unavailable");else K=ye;else throw Error(o+le+" not true or false: "+ye);if(se.hasOwnProperty(le="MODULO_MODE")&&(ye=se[le],b(ye,0,9,le),ne=ye),se.hasOwnProperty(le="POW_PRECISION")&&(ye=se[le],b(ye,0,f,le),fe=ye),se.hasOwnProperty(le="FORMAT"))if(ye=se[le],typeof ye=="object")ee=ye;else throw Error(o+le+" not an object: "+ye);if(se.hasOwnProperty(le="ALPHABET"))if(ye=se[le],typeof ye=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(ye))ge=ye.slice(0,10)=="0123456789",de=ye;else throw Error(o+le+" invalid: "+ye)}else throw Error(o+"Object expected: "+se);return{DECIMAL_PLACES:j,ROUNDING_MODE:R,EXPONENTIAL_AT:[z,B],RANGE:[V,H],CRYPTO:K,MODULO_MODE:ne,POW_PRECISION:fe,FORMAT:ee,ALPHABET:de}},Z.isBigNumber=function(se){if(!se||se._isBigNumber!==!0)return!1;if(!Z.DEBUG)return!0;var le,ye,ve=se.c,xe=se.e,Ie=se.s;e:if({}.toString.call(ve)=="[object Array]"){if((Ie===1||Ie===-1)&&xe>=-1e9&&xe<=f&&xe===i(xe)){if(ve[0]===0){if(xe===0&&ve.length===1)return!0;break e}if(le=(xe+1)%u,le<1&&(le+=u),String(ve[0]).length==le){for(le=0;le<ve.length;le++)if(ye=ve[le],ye<0||ye>=l||ye!==i(ye))break e;if(ye!==0)return!0}}}else if(ve===null&&xe===null&&(Ie===null||Ie===1||Ie===-1))return!0;throw Error(o+"Invalid BigNumber: "+se)},Z.maximum=Z.max=function(){return Ee(arguments,-1)},Z.minimum=Z.min=function(){return Ee(arguments,1)},Z.random=function(){var se=9007199254740992,le=Math.random()*se&2097151?function(){return i(Math.random()*se)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(ye){var ve,xe,Ie,te,L,U=0,re=[],q=new Z(O);if(ye==null?ye=j:b(ye,0,f),te=s(ye/u),K)if(crypto.getRandomValues){for(ve=crypto.getRandomValues(new Uint32Array(te*=2));U<te;)L=ve[U]*131072+(ve[U+1]>>>11),L>=9e15?(xe=crypto.getRandomValues(new Uint32Array(2)),ve[U]=xe[0],ve[U+1]=xe[1]):(re.push(L%1e14),U+=2);U=te/2}else if(crypto.randomBytes){for(ve=crypto.randomBytes(te*=7);U<te;)L=(ve[U]&31)*281474976710656+ve[U+1]*1099511627776+ve[U+2]*4294967296+ve[U+3]*16777216+(ve[U+4]<<16)+(ve[U+5]<<8)+ve[U+6],L>=9e15?crypto.randomBytes(7).copy(ve,U):(re.push(L%1e14),U+=7);U=te/7}else throw K=!1,Error(o+"crypto unavailable");if(!K)for(;U<te;)L=le(),L<9e15&&(re[U++]=L%1e14);for(te=re[--U],ye%=u,te&&ye&&(L=d[u-ye],re[U]=i(te/L)*L);re[U]===0;re.pop(),U--);if(U<0)re=[Ie=0];else{for(Ie=-1;re[0]===0;re.splice(0,1),Ie-=u);for(U=1,L=re[0];L>=10;L/=10,U++);U<u&&(Ie-=u-U)}return q.e=Ie,q.c=re,q}}(),Z.sum=function(){for(var se=1,le=arguments,ye=new Z(le[0]);se<le.length;)ye=ye.plus(le[se++]);return ye},I=function(){var se="0123456789";function le(ye,ve,xe,Ie){for(var te,L=[0],U,re=0,q=ye.length;re<q;){for(U=L.length;U--;L[U]*=ve);for(L[0]+=Ie.indexOf(ye.charAt(re++)),te=0;te<L.length;te++)L[te]>xe-1&&(L[te+1]==null&&(L[te+1]=0),L[te+1]+=L[te]/xe|0,L[te]%=xe)}return L.reverse()}return function(ye,ve,xe,Ie,te){var L,U,re,q,ie,me,je,He,Ge=ye.indexOf("."),Je=j,N=R;for(Ge>=0&&(q=fe,fe=0,ye=ye.replace(".",""),He=new Z(ve),me=He.pow(ye.length-Ge),fe=q,He.c=le(T(x(me.c),me.e,"0"),10,xe,se),He.e=He.c.length),je=le(ye,ve,xe,te?(L=de,se):(L=se,de)),re=q=je.length;je[--q]==0;je.pop());if(!je[0])return L.charAt(0);if(Ge<0?--re:(me.c=je,me.e=re,me.s=Ie,me=P(me,He,Je,N,xe),je=me.c,ie=me.r,re=me.e),U=re+Je+1,Ge=je[U],q=xe/2,ie=ie||U<0||je[U+1]!=null,ie=N<4?(Ge!=null||ie)&&(N==0||N==(me.s<0?3:2)):Ge>q||Ge==q&&(N==4||ie||N==6&&je[U-1]&1||N==(me.s<0?8:7)),U<1||!je[0])ye=ie?T(L.charAt(1),-Je,L.charAt(0)):L.charAt(0);else{if(je.length=U,ie)for(--xe;++je[--U]>xe;)je[U]=0,U||(++re,je=[1].concat(je));for(q=je.length;!je[--q];);for(Ge=0,ye="";Ge<=q;ye+=L.charAt(je[Ge++]));ye=T(ye,re,L.charAt(0))}return ye}}(),P=function(){function se(ve,xe,Ie){var te,L,U,re,q=0,ie=ve.length,me=xe%h,je=xe/h|0;for(ve=ve.slice();ie--;)U=ve[ie]%h,re=ve[ie]/h|0,te=je*U+re*me,L=me*U+te%h*h+q,q=(L/Ie|0)+(te/h|0)+je*re,ve[ie]=L%Ie;return q&&(ve=[q].concat(ve)),ve}function le(ve,xe,Ie,te){var L,U;if(Ie!=te)U=Ie>te?1:-1;else for(L=U=0;L<Ie;L++)if(ve[L]!=xe[L]){U=ve[L]>xe[L]?1:-1;break}return U}function ye(ve,xe,Ie,te){for(var L=0;Ie--;)ve[Ie]-=L,L=ve[Ie]<xe[Ie]?1:0,ve[Ie]=L*te+ve[Ie]-xe[Ie];for(;!ve[0]&&ve.length>1;ve.splice(0,1));}return function(ve,xe,Ie,te,L){var U,re,q,ie,me,je,He,Ge,Je,N,k,$,J,ce,be,Ne,at,St=ve.s==xe.s?1:-1,mt=ve.c,dt=xe.c;if(!mt||!mt[0]||!dt||!dt[0])return new Z(!ve.s||!xe.s||(mt?dt&&mt[0]==dt[0]:!dt)?NaN:mt&&mt[0]==0||!dt?St*0:St/0);for(Ge=new Z(St),Je=Ge.c=[],re=ve.e-xe.e,St=Ie+re+1,L||(L=l,re=g(ve.e/u)-g(xe.e/u),St=St/u|0),q=0;dt[q]==(mt[q]||0);q++);if(dt[q]>(mt[q]||0)&&re--,St<0)Je.push(1),ie=!0;else{for(ce=mt.length,Ne=dt.length,q=0,St+=2,me=i(L/(dt[0]+1)),me>1&&(dt=se(dt,me,L),mt=se(mt,me,L),Ne=dt.length,ce=mt.length),J=Ne,N=mt.slice(0,Ne),k=N.length;k<Ne;N[k++]=0);at=dt.slice(),at=[0].concat(at),be=dt[0],dt[1]>=L/2&&be++;do{if(me=0,U=le(dt,N,Ne,k),U<0){if($=N[0],Ne!=k&&($=$*L+(N[1]||0)),me=i($/be),me>1)for(me>=L&&(me=L-1),je=se(dt,me,L),He=je.length,k=N.length;le(je,N,He,k)==1;)me--,ye(je,Ne<He?at:dt,He,L),He=je.length,U=1;else me==0&&(U=me=1),je=dt.slice(),He=je.length;if(He<k&&(je=[0].concat(je)),ye(N,je,k,L),k=N.length,U==-1)for(;le(dt,N,Ne,k)<1;)me++,ye(N,Ne<k?at:dt,k,L),k=N.length}else U===0&&(me++,N=[0]);Je[q++]=me,N[0]?N[k++]=mt[J]||0:(N=[mt[J]],k=1)}while((J++<ce||N[0]!=null)&&St--);ie=N[0]!=null,Je[0]||Je.splice(0,1)}if(L==l){for(q=1,St=Je[0];St>=10;St/=10,q++);De(Ge,Ie+(Ge.e=q+re*u-1)+1,te,ie)}else Ge.e=re,Ge.r=+ie;return Ge}}();function we(se,le,ye,ve){var xe,Ie,te,L,U;if(ye==null?ye=R:b(ye,0,8),!se.c)return se.toString();if(xe=se.c[0],te=se.e,le==null)U=x(se.c),U=ve==1||ve==2&&(te<=z||te>=B)?C(U,te):T(U,te,"0");else if(se=De(new Z(se),le,ye),Ie=se.e,U=x(se.c),L=U.length,ve==1||ve==2&&(le<=Ie||Ie<=z)){for(;L<le;U+="0",L++);U=C(U,Ie)}else if(le-=te,U=T(U,Ie,"0"),Ie+1>L){if(--le>0)for(U+=".";le--;U+="0");}else if(le+=Ie-L,le>0)for(Ie+1==L&&(U+=".");le--;U+="0");return se.s<0&&xe?"-"+U:U}function Ee(se,le){for(var ye,ve,xe=1,Ie=new Z(se[0]);xe<se.length;xe++)ve=new Z(se[xe]),(!ve.s||(ye=w(Ie,ve))===le||ye===0&&Ie.s===le)&&(Ie=ve);return Ie}function Le(se,le,ye){for(var ve=1,xe=le.length;!le[--xe];le.pop());for(xe=le[0];xe>=10;xe/=10,ve++);return(ye=ve+ye*u-1)>H?se.c=se.e=null:ye<V?se.c=[se.e=0]:(se.e=ye,se.c=le),se}E=function(){var se=/^(-?)0([xbo])(?=\w[\w.]*$)/i,le=/^([^.]+)\.$/,ye=/^\.([^.]+)$/,ve=/^-?(Infinity|NaN)$/,xe=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Ie,te,L,U){var re,q=L?te:te.replace(xe,"");if(ve.test(q))Ie.s=isNaN(q)?null:q<0?-1:1;else{if(!L&&(q=q.replace(se,function(ie,me,je){return re=(je=je.toLowerCase())=="x"?16:je=="b"?2:8,!U||U==re?me:ie}),U&&(re=U,q=q.replace(le,"$1").replace(ye,"0.$1")),te!=q))return new Z(q,re);if(Z.DEBUG)throw Error(o+"Not a"+(U?" base "+U:"")+" number: "+te);Ie.s=null}Ie.c=Ie.e=null}}();function De(se,le,ye,ve){var xe,Ie,te,L,U,re,q,ie=se.c,me=d;if(ie){e:{for(xe=1,L=ie[0];L>=10;L/=10,xe++);if(Ie=le-xe,Ie<0)Ie+=u,te=le,U=ie[re=0],q=i(U/me[xe-te-1]%10);else if(re=s((Ie+1)/u),re>=ie.length)if(ve){for(;ie.length<=re;ie.push(0));U=q=0,xe=1,Ie%=u,te=Ie-u+1}else break e;else{for(U=L=ie[re],xe=1;L>=10;L/=10,xe++);Ie%=u,te=Ie-u+xe,q=te<0?0:i(U/me[xe-te-1]%10)}if(ve=ve||le<0||ie[re+1]!=null||(te<0?U:U%me[xe-te-1]),ve=ye<4?(q||ve)&&(ye==0||ye==(se.s<0?3:2)):q>5||q==5&&(ye==4||ve||ye==6&&(Ie>0?te>0?U/me[xe-te]:0:ie[re-1])%10&1||ye==(se.s<0?8:7)),le<1||!ie[0])return ie.length=0,ve?(le-=se.e+1,ie[0]=me[(u-le%u)%u],se.e=-le||0):ie[0]=se.e=0,se;if(Ie==0?(ie.length=re,L=1,re--):(ie.length=re+1,L=me[u-Ie],ie[re]=te>0?i(U/me[xe-te]%me[te])*L:0),ve)for(;;)if(re==0){for(Ie=1,te=ie[0];te>=10;te/=10,Ie++);for(te=ie[0]+=L,L=1;te>=10;te/=10,L++);Ie!=L&&(se.e++,ie[0]==l&&(ie[0]=1));break}else{if(ie[re]+=L,ie[re]!=l)break;ie[re--]=0,L=1}for(Ie=ie.length;ie[--Ie]===0;ie.pop());}se.e>H?se.c=se.e=null:se.e<V&&(se.c=[se.e=0])}return se}function Be(se){var le,ye=se.e;return ye===null?se.toString():(le=x(se.c),le=ye<=z||ye>=B?C(le,ye):T(le,ye,"0"),se.s<0?"-"+le:le)}return M.absoluteValue=M.abs=function(){var se=new Z(this);return se.s<0&&(se.s=1),se},M.comparedTo=function(se,le){return w(this,new Z(se,le))},M.decimalPlaces=M.dp=function(se,le){var ye,ve,xe,Ie=this;if(se!=null)return b(se,0,f),le==null?le=R:b(le,0,8),De(new Z(Ie),se+Ie.e+1,le);if(!(ye=Ie.c))return null;if(ve=((xe=ye.length-1)-g(this.e/u))*u,xe=ye[xe])for(;xe%10==0;xe/=10,ve--);return ve<0&&(ve=0),ve},M.dividedBy=M.div=function(se,le){return P(this,new Z(se,le),j,R)},M.dividedToIntegerBy=M.idiv=function(se,le){return P(this,new Z(se,le),0,1)},M.exponentiatedBy=M.pow=function(se,le){var ye,ve,xe,Ie,te,L,U,re,q,ie=this;if(se=new Z(se),se.c&&!se.isInteger())throw Error(o+"Exponent not an integer: "+Be(se));if(le!=null&&(le=new Z(le)),L=se.e>14,!ie.c||!ie.c[0]||ie.c[0]==1&&!ie.e&&ie.c.length==1||!se.c||!se.c[0])return q=new Z(Math.pow(+Be(ie),L?se.s*(2-S(se)):+Be(se))),le?q.mod(le):q;if(U=se.s<0,le){if(le.c?!le.c[0]:!le.s)return new Z(NaN);ve=!U&&ie.isInteger()&&le.isInteger(),ve&&(ie=ie.mod(le))}else{if(se.e>9&&(ie.e>0||ie.e<-1||(ie.e==0?ie.c[0]>1||L&&ie.c[1]>=24e7:ie.c[0]<8e13||L&&ie.c[0]<=9999975e7)))return Ie=ie.s<0&&S(se)?-0:0,ie.e>-1&&(Ie=1/Ie),new Z(U?1/Ie:Ie);fe&&(Ie=s(fe/u+2))}for(L?(ye=new Z(.5),U&&(se.s=1),re=S(se)):(xe=Math.abs(+Be(se)),re=xe%2),q=new Z(O);;){if(re){if(q=q.times(ie),!q.c)break;Ie?q.c.length>Ie&&(q.c.length=Ie):ve&&(q=q.mod(le))}if(xe){if(xe=i(xe/2),xe===0)break;re=xe%2}else if(se=se.times(ye),De(se,se.e+1,1),se.e>14)re=S(se);else{if(xe=+Be(se),xe===0)break;re=xe%2}ie=ie.times(ie),Ie?ie.c&&ie.c.length>Ie&&(ie.c.length=Ie):ve&&(ie=ie.mod(le))}return ve?q:(U&&(q=O.div(q)),le?q.mod(le):Ie?De(q,fe,R,te):q)},M.integerValue=function(se){var le=new Z(this);return se==null?se=R:b(se,0,8),De(le,le.e+1,se)},M.isEqualTo=M.eq=function(se,le){return w(this,new Z(se,le))===0},M.isFinite=function(){return!!this.c},M.isGreaterThan=M.gt=function(se,le){return w(this,new Z(se,le))>0},M.isGreaterThanOrEqualTo=M.gte=function(se,le){return(le=w(this,new Z(se,le)))===1||le===0},M.isInteger=function(){return!!this.c&&g(this.e/u)>this.c.length-2},M.isLessThan=M.lt=function(se,le){return w(this,new Z(se,le))<0},M.isLessThanOrEqualTo=M.lte=function(se,le){return(le=w(this,new Z(se,le)))===-1||le===0},M.isNaN=function(){return!this.s},M.isNegative=function(){return this.s<0},M.isPositive=function(){return this.s>0},M.isZero=function(){return!!this.c&&this.c[0]==0},M.minus=function(se,le){var ye,ve,xe,Ie,te=this,L=te.s;if(se=new Z(se,le),le=se.s,!L||!le)return new Z(NaN);if(L!=le)return se.s=-le,te.plus(se);var U=te.e/u,re=se.e/u,q=te.c,ie=se.c;if(!U||!re){if(!q||!ie)return q?(se.s=-le,se):new Z(ie?te:NaN);if(!q[0]||!ie[0])return ie[0]?(se.s=-le,se):new Z(q[0]?te:R==3?-0:0)}if(U=g(U),re=g(re),q=q.slice(),L=U-re){for((Ie=L<0)?(L=-L,xe=q):(re=U,xe=ie),xe.reverse(),le=L;le--;xe.push(0));xe.reverse()}else for(ve=(Ie=(L=q.length)<(le=ie.length))?L:le,L=le=0;le<ve;le++)if(q[le]!=ie[le]){Ie=q[le]<ie[le];break}if(Ie&&(xe=q,q=ie,ie=xe,se.s=-se.s),le=(ve=ie.length)-(ye=q.length),le>0)for(;le--;q[ye++]=0);for(le=l-1;ve>L;){if(q[--ve]<ie[ve]){for(ye=ve;ye&&!q[--ye];q[ye]=le);--q[ye],q[ve]+=l}q[ve]-=ie[ve]}for(;q[0]==0;q.splice(0,1),--re);return q[0]?Le(se,q,re):(se.s=R==3?-1:1,se.c=[se.e=0],se)},M.modulo=M.mod=function(se,le){var ye,ve,xe=this;return se=new Z(se,le),!xe.c||!se.s||se.c&&!se.c[0]?new Z(NaN):!se.c||xe.c&&!xe.c[0]?new Z(xe):(ne==9?(ve=se.s,se.s=1,ye=P(xe,se,0,3),se.s=ve,ye.s*=ve):ye=P(xe,se,0,ne),se=xe.minus(ye.times(se)),!se.c[0]&&ne==1&&(se.s=xe.s),se)},M.multipliedBy=M.times=function(se,le){var ye,ve,xe,Ie,te,L,U,re,q,ie,me,je,He,Ge,Je,N=this,k=N.c,$=(se=new Z(se,le)).c;if(!k||!$||!k[0]||!$[0])return!N.s||!se.s||k&&!k[0]&&!$||$&&!$[0]&&!k?se.c=se.e=se.s=null:(se.s*=N.s,!k||!$?se.c=se.e=null:(se.c=[0],se.e=0)),se;for(ve=g(N.e/u)+g(se.e/u),se.s*=N.s,U=k.length,ie=$.length,U<ie&&(He=k,k=$,$=He,xe=U,U=ie,ie=xe),xe=U+ie,He=[];xe--;He.push(0));for(Ge=l,Je=h,xe=ie;--xe>=0;){for(ye=0,me=$[xe]%Je,je=$[xe]/Je|0,te=U,Ie=xe+te;Ie>xe;)re=k[--te]%Je,q=k[te]/Je|0,L=je*re+q*me,re=me*re+L%Je*Je+He[Ie]+ye,ye=(re/Ge|0)+(L/Je|0)+je*q,He[Ie--]=re%Ge;He[Ie]=ye}return ye?++ve:He.splice(0,1),Le(se,He,ve)},M.negated=function(){var se=new Z(this);return se.s=-se.s||null,se},M.plus=function(se,le){var ye,ve=this,xe=ve.s;if(se=new Z(se,le),le=se.s,!xe||!le)return new Z(NaN);if(xe!=le)return se.s=-le,ve.minus(se);var Ie=ve.e/u,te=se.e/u,L=ve.c,U=se.c;if(!Ie||!te){if(!L||!U)return new Z(xe/0);if(!L[0]||!U[0])return U[0]?se:new Z(L[0]?ve:xe*0)}if(Ie=g(Ie),te=g(te),L=L.slice(),xe=Ie-te){for(xe>0?(te=Ie,ye=U):(xe=-xe,ye=L),ye.reverse();xe--;ye.push(0));ye.reverse()}for(xe=L.length,le=U.length,xe-le<0&&(ye=U,U=L,L=ye,le=xe),xe=0;le;)xe=(L[--le]=L[le]+U[le]+xe)/l|0,L[le]=l===L[le]?0:L[le]%l;return xe&&(L=[xe].concat(L),++te),Le(se,L,te)},M.precision=M.sd=function(se,le){var ye,ve,xe,Ie=this;if(se!=null&&se!==!!se)return b(se,1,f),le==null?le=R:b(le,0,8),De(new Z(Ie),se,le);if(!(ye=Ie.c))return null;if(xe=ye.length-1,ve=xe*u+1,xe=ye[xe]){for(;xe%10==0;xe/=10,ve--);for(xe=ye[0];xe>=10;xe/=10,ve++);}return se&&Ie.e+1>ve&&(ve=Ie.e+1),ve},M.shiftedBy=function(se){return b(se,-9007199254740991,c),this.times("1e"+se)},M.squareRoot=M.sqrt=function(){var se,le,ye,ve,xe,Ie=this,te=Ie.c,L=Ie.s,U=Ie.e,re=j+4,q=new Z("0.5");if(L!==1||!te||!te[0])return new Z(!L||L<0&&(!te||te[0])?NaN:te?Ie:1/0);if(L=Math.sqrt(+Be(Ie)),L==0||L==1/0?(le=x(te),(le.length+U)%2==0&&(le+="0"),L=Math.sqrt(+le),U=g((U+1)/2)-(U<0||U%2),L==1/0?le="5e"+U:(le=L.toExponential(),le=le.slice(0,le.indexOf("e")+1)+U),ye=new Z(le)):ye=new Z(L+""),ye.c[0]){for(U=ye.e,L=U+re,L<3&&(L=0);;)if(xe=ye,ye=q.times(xe.plus(P(Ie,xe,re,1))),x(xe.c).slice(0,L)===(le=x(ye.c)).slice(0,L))if(ye.e<U&&--L,le=le.slice(L-3,L+1),le=="9999"||!ve&&le=="4999"){if(!ve&&(De(xe,xe.e+j+2,0),xe.times(xe).eq(Ie))){ye=xe;break}re+=4,L+=4,ve=1}else{(!+le||!+le.slice(1)&&le.charAt(0)=="5")&&(De(ye,ye.e+j+2,1),se=!ye.times(ye).eq(Ie));break}}return De(ye,ye.e+j+1,R,se)},M.toExponential=function(se,le){return se!=null&&(b(se,0,f),se++),we(this,se,le,1)},M.toFixed=function(se,le){return se!=null&&(b(se,0,f),se=se+this.e+1),we(this,se,le)},M.toFormat=function(se,le,ye){var ve,xe=this;if(ye==null)se!=null&&le&&typeof le=="object"?(ye=le,le=null):se&&typeof se=="object"?(ye=se,se=le=null):ye=ee;else if(typeof ye!="object")throw Error(o+"Argument not an object: "+ye);if(ve=xe.toFixed(se,le),xe.c){var Ie,te=ve.split("."),L=+ye.groupSize,U=+ye.secondaryGroupSize,re=ye.groupSeparator||"",q=te[0],ie=te[1],me=xe.s<0,je=me?q.slice(1):q,He=je.length;if(U&&(Ie=L,L=U,U=Ie,He-=Ie),L>0&&He>0){for(Ie=He%L||L,q=je.substr(0,Ie);Ie<He;Ie+=L)q+=re+je.substr(Ie,L);U>0&&(q+=re+je.slice(Ie)),me&&(q="-"+q)}ve=ie?q+(ye.decimalSeparator||"")+((U=+ye.fractionGroupSize)?ie.replace(new RegExp("\\d{"+U+"}\\B","g"),"$&"+(ye.fractionGroupSeparator||"")):ie):q}return(ye.prefix||"")+ve+(ye.suffix||"")},M.toFraction=function(se){var le,ye,ve,xe,Ie,te,L,U,re,q,ie,me,je=this,He=je.c;if(se!=null&&(L=new Z(se),!L.isInteger()&&(L.c||L.s!==1)||L.lt(O)))throw Error(o+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+Be(L));if(!He)return new Z(je);for(le=new Z(O),re=ye=new Z(O),ve=U=new Z(O),me=x(He),Ie=le.e=me.length-je.e-1,le.c[0]=d[(te=Ie%u)<0?u+te:te],se=!se||L.comparedTo(le)>0?Ie>0?le:re:L,te=H,H=1/0,L=new Z(me),U.c[0]=0;q=P(L,le,0,1),xe=ye.plus(q.times(ve)),xe.comparedTo(se)!=1;)ye=ve,ve=xe,re=U.plus(q.times(xe=re)),U=xe,le=L.minus(q.times(xe=le)),L=xe;return xe=P(se.minus(ye),ve,0,1),U=U.plus(xe.times(re)),ye=ye.plus(xe.times(ve)),U.s=re.s=je.s,Ie=Ie*2,ie=P(re,ve,Ie,R).minus(je).abs().comparedTo(P(U,ye,Ie,R).minus(je).abs())<1?[re,ve]:[U,ye],H=te,ie},M.toNumber=function(){return+Be(this)},M.toPrecision=function(se,le){return se!=null&&b(se,1,f),we(this,se,le,2)},M.toString=function(se){var le,ye=this,ve=ye.s,xe=ye.e;return xe===null?ve?(le="Infinity",ve<0&&(le="-"+le)):le="NaN":(se==null?le=xe<=z||xe>=B?C(x(ye.c),xe):T(x(ye.c),xe,"0"):se===10&&ge?(ye=De(new Z(ye),j+xe+1,R),le=T(x(ye.c),ye.e,"0")):(b(se,2,de.length,"Base"),le=I(T(x(ye.c),xe,"0"),10,se,ve,!0)),ve<0&&ye.c[0]&&(le="-"+le)),le},M.valueOf=M.toJSON=function(){return Be(this)},M._isBigNumber=!0,D!=null&&Z.set(D),Z}function g(D){var P=D|0;return D>0||D===P?P:P-1}function x(D){for(var P,I,E=1,M=D.length,O=D[0]+"";E<M;){for(P=D[E++]+"",I=u-P.length;I--;P="0"+P);O+=P}for(M=O.length;O.charCodeAt(--M)===48;);return O.slice(0,M+1||1)}function w(D,P){var I,E,M=D.c,O=P.c,j=D.s,R=P.s,z=D.e,B=P.e;if(!j||!R)return null;if(I=M&&!M[0],E=O&&!O[0],I||E)return I?E?0:-R:j;if(j!=R)return j;if(I=j<0,E=z==B,!M||!O)return E?0:!M^I?1:-1;if(!E)return z>B^I?1:-1;for(R=(z=M.length)<(B=O.length)?z:B,j=0;j<R;j++)if(M[j]!=O[j])return M[j]>O[j]^I?1:-1;return z==B?0:z>B^I?1:-1}function b(D,P,I,E){if(D<P||D>I||D!==i(D))throw Error(o+(E||"Argument")+(typeof D=="number"?D<P||D>I?" out of range: ":" not an integer: ":" not a primitive number: ")+String(D))}function S(D){var P=D.c.length-1;return g(D.e/u)==P&&D.c[P]%2!=0}function C(D,P){return(D.length>1?D.charAt(0)+"."+D.slice(1):D)+(P<0?"e":"e+")+P}function T(D,P,I){var E,M;if(P<0){for(M=I+".";++P;M+=I);D=M+D}else if(E=D.length,++P>E){for(M=I,P-=E;--P;M+=I);D+=M}else P<E&&(D=D.slice(0,P)+"."+D.slice(P));return D}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(ice)}(OS)),OS.exports}var pA,sB;function oce(){return sB||(sB=1,pA=function(e,n,r){var s=new e.Uint8Array(r),i=n.pushInt,o=n.pushInt32,a=n.pushInt32Neg,l=n.pushInt64,u=n.pushInt64Neg,c=n.pushFloat,d=n.pushFloatSingle,h=n.pushFloatDouble,f=n.pushTrue,m=n.pushFalse,g=n.pushUndefined,x=n.pushNull,w=n.pushInfinity,b=n.pushInfinityNeg,S=n.pushNaN,C=n.pushNaNNeg,T=n.pushArrayStart,D=n.pushArrayStartFixed,P=n.pushArrayStartFixed32,I=n.pushArrayStartFixed64,E=n.pushObjectStart,M=n.pushObjectStartFixed,O=n.pushObjectStartFixed32,j=n.pushObjectStartFixed64,R=n.pushByteString,z=n.pushByteStringStart,B=n.pushUtf8String,V=n.pushUtf8StringStart,H=n.pushSimpleUnassigned,K=n.pushTagStart,ne=n.pushTagStart4,fe=n.pushTagStart8,ee=n.pushTagUnassigned,de=n.pushBreak,ge=e.Math.pow,Z=0,we=0,Ee=0;function Le(Re){for(Re=Re|0,Z=0,we=Re;(Z|0)<(we|0)&&(Ee=Gi[s[Z]&255](s[Z]|0)|0,!((Ee|0)>0)););return Ee|0}function De(Re){return Re=Re|0,((Z|0)+(Re|0)|0)<(we|0)?0:1}function Be(Re){return Re=Re|0,s[Re|0]<<8|s[Re+1|0]|0}function se(Re){return Re=Re|0,s[Re|0]<<24|s[Re+1|0]<<16|s[Re+2|0]<<8|s[Re+3|0]|0}function le(Re){return Re=Re|0,i(Re|0),Z=Z+1|0,0}function ye(Re){return Re=Re|0,De(1)|0?1:(i(s[Z+1|0]|0),Z=Z+2|0,0)}function ve(Re){return Re=Re|0,De(2)|0?1:(i(Be(Z+1|0)|0),Z=Z+3|0,0)}function xe(Re){return Re=Re|0,De(4)|0?1:(o(Be(Z+1|0)|0,Be(Z+3|0)|0),Z=Z+5|0,0)}function Ie(Re){return Re=Re|0,De(8)|0?1:(l(Be(Z+1|0)|0,Be(Z+3|0)|0,Be(Z+5|0)|0,Be(Z+7|0)|0),Z=Z+9|0,0)}function te(Re){return Re=Re|0,i(-1-(Re-32|0)|0),Z=Z+1|0,0}function L(Re){return Re=Re|0,De(1)|0?1:(i(-1-(s[Z+1|0]|0)|0),Z=Z+2|0,0)}function U(Re){Re=Re|0;var Dt=0;return De(2)|0?1:(Dt=Be(Z+1|0)|0,i(-1-(Dt|0)|0),Z=Z+3|0,0)}function re(Re){return Re=Re|0,De(4)|0?1:(a(Be(Z+1|0)|0,Be(Z+3|0)|0),Z=Z+5|0,0)}function q(Re){return Re=Re|0,De(8)|0?1:(u(Be(Z+1|0)|0,Be(Z+3|0)|0,Be(Z+5|0)|0,Be(Z+7|0)|0),Z=Z+9|0,0)}function ie(Re){Re=Re|0;var Dt=0,an=0,en=0;return en=Re-64|0,De(en|0)|0?1:(Dt=Z+1|0,an=(Z+1|0)+(en|0)|0,R(Dt|0,an|0),Z=an|0,0)}function me(Re){Re=Re|0;var Dt=0,an=0,en=0;return De(1)|0||(en=s[Z+1|0]|0,Dt=Z+2|0,an=(Z+2|0)+(en|0)|0,De(en+1|0)|0)?1:(R(Dt|0,an|0),Z=an|0,0)}function je(Re){Re=Re|0;var Dt=0,an=0,en=0;return De(2)|0||(en=Be(Z+1|0)|0,Dt=Z+3|0,an=(Z+3|0)+(en|0)|0,De(en+2|0)|0)?1:(R(Dt|0,an|0),Z=an|0,0)}function He(Re){Re=Re|0;var Dt=0,an=0,en=0;return De(4)|0||(en=se(Z+1|0)|0,Dt=Z+5|0,an=(Z+5|0)+(en|0)|0,De(en+4|0)|0)?1:(R(Dt|0,an|0),Z=an|0,0)}function Ge(Re){return Re=Re|0,1}function Je(Re){return Re=Re|0,z(),Z=Z+1|0,0}function N(Re){Re=Re|0;var Dt=0,an=0,en=0;return en=Re-96|0,De(en|0)|0?1:(Dt=Z+1|0,an=(Z+1|0)+(en|0)|0,B(Dt|0,an|0),Z=an|0,0)}function k(Re){Re=Re|0;var Dt=0,an=0,en=0;return De(1)|0||(en=s[Z+1|0]|0,Dt=Z+2|0,an=(Z+2|0)+(en|0)|0,De(en+1|0)|0)?1:(B(Dt|0,an|0),Z=an|0,0)}function $(Re){Re=Re|0;var Dt=0,an=0,en=0;return De(2)|0||(en=Be(Z+1|0)|0,Dt=Z+3|0,an=(Z+3|0)+(en|0)|0,De(en+2|0)|0)?1:(B(Dt|0,an|0),Z=an|0,0)}function J(Re){Re=Re|0;var Dt=0,an=0,en=0;return De(4)|0||(en=se(Z+1|0)|0,Dt=Z+5|0,an=(Z+5|0)+(en|0)|0,De(en+4|0)|0)?1:(B(Dt|0,an|0),Z=an|0,0)}function ce(Re){return Re=Re|0,1}function be(Re){return Re=Re|0,V(),Z=Z+1|0,0}function Ne(Re){return Re=Re|0,D(Re-128|0),Z=Z+1|0,0}function at(Re){return Re=Re|0,De(1)|0?1:(D(s[Z+1|0]|0),Z=Z+2|0,0)}function St(Re){return Re=Re|0,De(2)|0?1:(D(Be(Z+1|0)|0),Z=Z+3|0,0)}function mt(Re){return Re=Re|0,De(4)|0?1:(P(Be(Z+1|0)|0,Be(Z+3|0)|0),Z=Z+5|0,0)}function dt(Re){return Re=Re|0,De(8)|0?1:(I(Be(Z+1|0)|0,Be(Z+3|0)|0,Be(Z+5|0)|0,Be(Z+7|0)|0),Z=Z+9|0,0)}function _t(Re){return Re=Re|0,T(),Z=Z+1|0,0}function hn(Re){Re=Re|0;var Dt=0;return Dt=Re-160|0,De(Dt|0)|0?1:(M(Dt|0),Z=Z+1|0,0)}function No(Re){return Re=Re|0,De(1)|0?1:(M(s[Z+1|0]|0),Z=Z+2|0,0)}function ko(Re){return Re=Re|0,De(2)|0?1:(M(Be(Z+1|0)|0),Z=Z+3|0,0)}function To(Re){return Re=Re|0,De(4)|0?1:(O(Be(Z+1|0)|0,Be(Z+3|0)|0),Z=Z+5|0,0)}function Pl(Re){return Re=Re|0,De(8)|0?1:(j(Be(Z+1|0)|0,Be(Z+3|0)|0,Be(Z+5|0)|0,Be(Z+7|0)|0),Z=Z+9|0,0)}function Lu(Re){return Re=Re|0,E(),Z=Z+1|0,0}function us(Re){return Re=Re|0,K(Re-192|0|0),Z=Z+1|0,0}function Bh(Re){return Re=Re|0,K(Re|0),Z=Z+1|0,0}function sm(Re){return Re=Re|0,K(Re|0),Z=Z+1|0,0}function zu(Re){return Re=Re|0,K(Re|0),Z=Z+1|0,0}function Bc(Re){return Re=Re|0,K(Re|0),Z=Z+1|0,0}function Xn(Re){return Re=Re|0,K(Re-192|0|0),Z=Z+1|0,0}function ja(Re){return Re=Re|0,K(Re|0),Z=Z+1|0,0}function Uc(Re){return Re=Re|0,K(Re|0),Z=Z+1|0,0}function Jo(Re){return Re=Re|0,K(Re|0),Z=Z+1|0,0}function Ci(Re){return Re=Re|0,De(1)|0?1:(K(s[Z+1|0]|0),Z=Z+2|0,0)}function Bu(Re){return Re=Re|0,De(2)|0?1:(K(Be(Z+1|0)|0),Z=Z+3|0,0)}function Bn(Re){return Re=Re|0,De(4)|0?1:(ne(Be(Z+1|0)|0,Be(Z+3|0)|0),Z=Z+5|0,0)}function Ys(Re){return Re=Re|0,De(8)|0?1:(fe(Be(Z+1|0)|0,Be(Z+3|0)|0,Be(Z+5|0)|0,Be(Z+7|0)|0),Z=Z+9|0,0)}function Zn(Re){return Re=Re|0,H((Re|0)-224|0),Z=Z+1|0,0}function Oy(Re){return Re=Re|0,m(),Z=Z+1|0,0}function Vc(Re){return Re=Re|0,f(),Z=Z+1|0,0}function Eo(Re){return Re=Re|0,x(),Z=Z+1|0,0}function Uu(Re){return Re=Re|0,g(),Z=Z+1|0,0}function Fl(Re){return Re=Re|0,De(1)|0?1:(H(s[Z+1|0]|0),Z=Z+2|0,0)}function im(Re){Re=Re|0;var Dt=0,an=0,en=1,Wa=0,Dr=0,Py=0;return De(2)|0?1:(Dt=s[Z+1|0]|0,an=s[Z+2|0]|0,(Dt|0)&128&&(en=-1),Wa=+(((Dt|0)&124)>>2),Dr=+(((Dt|0)&3)<<8|an),+Wa==0?c(+(+en*5960464477539063e-23*+Dr)):+Wa==31?+en==1?+Dr>0?S():w():+Dr>0?C():b():c(+(+en*ge(2,+(+Wa-25))*+(1024+Dr))),Z=Z+3|0,0)}function jc(Re){return Re=Re|0,De(4)|0?1:(d(s[Z+1|0]|0,s[Z+2|0]|0,s[Z+3|0]|0,s[Z+4|0]|0),Z=Z+5|0,0)}function Wc(Re){return Re=Re|0,De(8)|0?1:(h(s[Z+1|0]|0,s[Z+2|0]|0,s[Z+3|0]|0,s[Z+4|0]|0,s[Z+5|0]|0,s[Z+6|0]|0,s[Z+7|0]|0,s[Z+8|0]|0),Z=Z+9|0,0)}function Cn(Re){return Re=Re|0,1}function Ks(Re){return Re=Re|0,de(),Z=Z+1|0,0}var Gi=[le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,ye,ve,xe,Ie,Cn,Cn,Cn,Cn,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,te,L,U,re,q,Cn,Cn,Cn,Cn,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,me,je,He,Ge,Cn,Cn,Cn,Je,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,k,$,J,ce,Cn,Cn,Cn,be,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,at,St,mt,dt,Cn,Cn,Cn,_t,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,hn,No,ko,To,Pl,Cn,Cn,Cn,Lu,us,us,us,us,us,us,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Xn,Ci,Bu,Bn,Ys,Cn,Cn,Cn,Cn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Zn,Oy,Vc,Eo,Uu,Fl,im,jc,Wc,Cn,Cn,Cn,Ks];return{parse:Le}}),pA}var mA={},eo={},iB;function EN(){if(iB)return eo;iB=1;const t=TN().BigNumber;return eo.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},eo.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},eo.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},eo.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},eo.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},eo.SHIFT32=Math.pow(2,32),eo.SHIFT16=Math.pow(2,16),eo.MAX_SAFE_HIGH=2097151,eo.NEG_ONE=new t(-1),eo.TEN=new t(10),eo.TWO=new t(2),eo.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5},eo}var oB;function lD(){return oB||(oB=1,function(t){const{Buffer:e}=kN(),n=TN().BigNumber,r=EN(),s=r.SHIFT32,i=r.SHIFT16,o=2097151;t.parseHalf=function(u){var c,d,h;return h=u[0]&128?-1:1,c=(u[0]&124)>>2,d=(u[0]&3)<<8|u[1],c?c===31?h*(d?NaN:1/0):h*Math.pow(2,c-25)*(1024+d):h*5960464477539063e-23*d};function a(l){return l<16?"0"+l.toString(16):l.toString(16)}t.arrayBufferToBignumber=function(l){const u=l.byteLength;let c="";for(let d=0;d<u;d++)c+=a(l[d]);return new n(c,16)},t.buildMap=l=>{const u=new Map,c=Object.keys(l),d=c.length;for(let h=0;h<d;h++)u.set(c[h],l[c[h]]);return u},t.buildInt32=(l,u)=>l*i+u,t.buildInt64=(l,u,c,d)=>{const h=t.buildInt32(l,u),f=t.buildInt32(c,d);return h>o?new n(h).times(s).plus(f):h*s+f},t.writeHalf=function(u,c){const d=e.allocUnsafe(4);d.writeFloatBE(c,0);const h=d.readUInt32BE(0);if((h&8191)!==0)return!1;var f=h>>16&32768;const m=h>>23&255,g=h&8388607;if(m>=113&&m<=142)f+=(m-112<<10)+(g>>13);else if(m>=103&&m<113){if(g&(1<<126-m)-1)return!1;f+=g+8388608>>126-m}else return!1;return u.writeUInt16BE(f,0),!0},t.keySorter=function(l,u){var c=l[0].byteLength,d=u[0].byteLength;return c>d?1:d>c?-1:l[0].compare(u[0])},t.isNegativeZero=l=>l===0&&1/l<0,t.nextPowerOf2=l=>{let u=0;if(l&&!(l&l-1))return l;for(;l!==0;)l>>=1,u+=1;return 1<<u}}(mA)),mA}var gA,aB;function eG(){if(aB)return gA;aB=1;const t=EN(),e=t.MT,n=t.SIMPLE,r=t.SYMS;class s{constructor(o){if(typeof o!="number")throw new Error("Invalid Simple type: "+typeof o);if(o<0||o>255||(o|0)!==o)throw new Error("value must be a small positive integer: "+o);this.value=o}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(o){return o._pushInt(this.value,e.SIMPLE_FLOAT)}static isSimple(o){return o instanceof s}static decode(o,a){switch(a==null&&(a=!0),o){case n.FALSE:return!1;case n.TRUE:return!0;case n.NULL:return a?null:r.NULL;case n.UNDEFINED:return a?void 0:r.UNDEFINED;case-1:if(!a)throw new Error("Invalid BREAK");return r.BREAK;default:return new s(o)}}}return gA=s,gA}var yA,lB;function tG(){if(lB)return yA;lB=1;class t{constructor(n,r,s){if(this.tag=n,this.value=r,this.err=s,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(n){return n._pushTag(this.tag),n.pushAny(this.value)}convert(n){var r,s;if(s=n!=null?n[this.tag]:void 0,typeof s!="function"&&(s=t["_tag"+this.tag],typeof s!="function"))return this;try{return s.call(t,this.value)}catch(i){return r=i,this.err=r,this}}}return yA=t,yA}var xA,uB;function nG(){if(uB)return xA;uB=1;const t=self.location?self.location.protocol+"//"+self.location.host:"",e=self.URL;class n{constructor(i="",o=t){this.super=new e(i,o),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(i){this.super.hash=i}set host(i){this.super.host=i}set hostname(i){this.super.hostname=i}set href(i){this.super.href=i}set origin(i){this.super.origin=i}set password(i){this.super.password=i}set pathname(i){this.super.pathname=i}set port(i){this.super.port=i}set protocol(i){this.super.protocol=i}set search(i){this.super.search=i}set searchParams(i){this.super.searchParams=i}set username(i){this.super.username=i}createObjectURL(i){return this.super.createObjectURL(i)}revokeObjectURL(i){this.super.revokeObjectURL(i)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function r(s){if(typeof s=="string")return new e(s).toString();if(!(s instanceof e)){const i=s.username&&s.password?`${s.username}:${s.password}@`:"",o=s.auth?s.auth+"@":"",a=s.port?":"+s.port:"",l=s.protocol?s.protocol+"//":"",u=s.host||"",c=s.hostname||"",d=s.search||(s.query?"?"+s.query:""),h=s.hash||"",f=s.pathname||"",m=s.path||f+d;return`${l}${i||o}${u||c+a}${m}${h}`}}return xA={URLWithLegacySupport:n,URLSearchParams:self.URLSearchParams,defaultBase:t,format:r},xA}var wA,cB;function ace(){if(cB)return wA;cB=1;const{URLWithLegacySupport:t,format:e}=nG();return wA=(n,r={},s={},i)=>{let o=r.protocol?r.protocol.replace(":",""):"http";o=(s[o]||i||o)+":";let a;try{a=new t(n)}catch{a={}}const l=Object.assign({},r,{protocol:o||a.protocol,host:r.host||a.host});return new t(n,e(l)).toString()},wA}var bA,dB;function rG(){if(dB)return bA;dB=1;const{URLWithLegacySupport:t,format:e,URLSearchParams:n,defaultBase:r}=nG(),s=ace();return bA={URL:t,URLSearchParams:n,format:e,relative:s,defaultBase:r},bA}var vA,hB;function sG(){if(hB)return vA;hB=1;const{Buffer:t}=kN(),e=eD(),n=TN().BigNumber,r=oce(),s=lD(),i=EN(),o=eG(),a=tG(),{URL:l}=rG();class u{constructor(d){d=d||{},!d.size||d.size<65536?d.size=65536:d.size=s.nextPowerOf2(d.size),this._heap=new ArrayBuffer(d.size),this._heap8=new Uint8Array(this._heap),this._buffer=t.from(this._heap),this._reset(),this._knownTags=Object.assign({0:h=>new Date(h),1:h=>new Date(h*1e3),2:h=>s.arrayBufferToBignumber(h),3:h=>i.NEG_ONE.minus(s.arrayBufferToBignumber(h)),4:h=>i.TEN.pow(h[0]).times(h[1]),5:h=>i.TWO.pow(h[0]).times(h[1]),32:h=>new l(h),35:h=>new RegExp(h)},d.tags),this.parser=r(u$,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var d=this._parents.pop();if(d.length>0)throw new Error(`Missing ${d.length} elements`);switch(d.type){case i.PARENT.TAG:this._push(this.createTag(d.ref[0],d.ref[1]));break;case i.PARENT.BYTE_STRING:this._push(this.createByteString(d.ref,d.length));break;case i.PARENT.UTF8_STRING:this._push(this.createUtf8String(d.ref,d.length));break;case i.PARENT.MAP:if(d.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(d.ref,d.length));break;case i.PARENT.OBJECT:if(d.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(d.ref,d.length));break;case i.PARENT.ARRAY:this._push(this.createArray(d.ref,d.length));break}this._currentParent&&this._currentParent.type===i.PARENT.TAG&&this._dec()}_dec(){const d=this._currentParent;d.length<0||(d.length--,d.length===0&&this._closeParent())}_push(d,h){const f=this._currentParent;switch(f.values++,f.type){case i.PARENT.ARRAY:case i.PARENT.BYTE_STRING:case i.PARENT.UTF8_STRING:f.length>-1?this._ref[this._ref.length-f.length]=d:this._ref.push(d),this._dec();break;case i.PARENT.OBJECT:f.tmpKey!=null?(this._ref[f.tmpKey]=d,f.tmpKey=null,this._dec()):(f.tmpKey=d,typeof f.tmpKey!="string"&&(f.type=i.PARENT.MAP,f.ref=s.buildMap(f.ref)));break;case i.PARENT.MAP:f.tmpKey!=null?(this._ref.set(f.tmpKey,d),f.tmpKey=null,this._dec()):f.tmpKey=d;break;case i.PARENT.TAG:this._ref.push(d),h||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(d,h,f){this._parents[this._depth]={type:h,length:f,ref:d,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:i.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(d,h){const f=this._knownTags[d];return f?f(h):new a(d,h)}createMap(d,h){return d}createObject(d,h){return d}createArray(d,h){return d}createByteString(d,h){return t.concat(d)}createByteStringFromHeap(d,h){return d===h?t.alloc(0):t.from(this._heap.slice(d,h))}createInt(d){return d}createInt32(d,h){return s.buildInt32(d,h)}createInt64(d,h,f,m){return s.buildInt64(d,h,f,m)}createFloat(d){return d}createFloatSingle(d,h,f,m){return e.read([d,h,f,m],0,!1,23,4)}createFloatDouble(d,h,f,m,g,x,w,b){return e.read([d,h,f,m,g,x,w,b],0,!1,52,8)}createInt32Neg(d,h){return-1-s.buildInt32(d,h)}createInt64Neg(d,h,f,m){const g=s.buildInt32(d,h),x=s.buildInt32(f,m);return g>i.MAX_SAFE_HIGH?i.NEG_ONE.minus(new n(g).times(i.SHIFT32).plus(x)):-1-(g*i.SHIFT32+x)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(d,h){return d.join("")}createUtf8StringFromHeap(d,h){return d===h?"":this._buffer.toString("utf8",d,h)}createSimpleUnassigned(d){return new o(d)}pushInt(d){this._push(this.createInt(d))}pushInt32(d,h){this._push(this.createInt32(d,h))}pushInt64(d,h,f,m){this._push(this.createInt64(d,h,f,m))}pushFloat(d){this._push(this.createFloat(d))}pushFloatSingle(d,h,f,m){this._push(this.createFloatSingle(d,h,f,m))}pushFloatDouble(d,h,f,m,g,x,w,b){this._push(this.createFloatDouble(d,h,f,m,g,x,w,b))}pushInt32Neg(d,h){this._push(this.createInt32Neg(d,h))}pushInt64Neg(d,h,f,m){this._push(this.createInt64Neg(d,h,f,m))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],i.PARENT.ARRAY,-1)}pushArrayStartFixed(d){this._createArrayStartFixed(d)}pushArrayStartFixed32(d,h){const f=s.buildInt32(d,h);this._createArrayStartFixed(f)}pushArrayStartFixed64(d,h,f,m){const g=s.buildInt64(d,h,f,m);this._createArrayStartFixed(g)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(d){this._createObjectStartFixed(d)}pushObjectStartFixed32(d,h){const f=s.buildInt32(d,h);this._createObjectStartFixed(f)}pushObjectStartFixed64(d,h,f,m){const g=s.buildInt64(d,h,f,m);this._createObjectStartFixed(g)}pushByteStringStart(){this._parents[this._depth]={type:i.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(d,h){this._push(this.createByteStringFromHeap(d,h))}pushUtf8StringStart(){this._parents[this._depth]={type:i.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(d,h){this._push(this.createUtf8StringFromHeap(d,h))}pushSimpleUnassigned(d){this._push(this.createSimpleUnassigned(d))}pushTagStart(d){this._parents[this._depth]={type:i.PARENT.TAG,length:1,ref:[d]}}pushTagStart4(d,h){this.pushTagStart(s.buildInt32(d,h))}pushTagStart8(d,h,f,m){this.pushTagStart(s.buildInt64(d,h,f,m))}pushTagUnassigned(d){this._push(this.createTag(d))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(d){if(d===0){this._push(this.createObject({}));return}this._createParent({},i.PARENT.OBJECT,d)}_createArrayStartFixed(d){if(d===0){this._push(this.createArray([]));return}this._createParent(new Array(d),i.PARENT.ARRAY,d)}_decode(d){if(d.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(d);const h=this.parser.parse(d.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(h>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(d){return this._decode(d),this._res[0]}decodeAll(d){return this._decode(d),this._res}static decode(d,h){return typeof d=="string"&&(d=t.from(d,h||"hex")),new u({size:d.length}).decodeFirst(d)}static decodeAll(d,h){return typeof d=="string"&&(d=t.from(d,h||"hex")),new u({size:d.length}).decodeAll(d)}}return u.decodeFirst=u.decode,vA=u,vA}var SA,fB;function lce(){if(fB)return SA;fB=1;const{Buffer:t}=kN(),e=sG(),n=lD();class r extends e{createTag(o,a){return`${o}(${a})`}createInt(o){return super.createInt(o).toString()}createInt32(o,a){return super.createInt32(o,a).toString()}createInt64(o,a,l,u){return super.createInt64(o,a,l,u).toString()}createInt32Neg(o,a){return super.createInt32Neg(o,a).toString()}createInt64Neg(o,a,l,u){return super.createInt64Neg(o,a,l,u).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(o){const a=super.createFloat(o);return n.isNegativeZero(o)?"-0_1":`${a}_1`}createFloatSingle(o,a,l,u){return`${super.createFloatSingle(o,a,l,u)}_2`}createFloatDouble(o,a,l,u,c,d,h,f){return`${super.createFloatDouble(o,a,l,u,c,d,h,f)}_3`}createByteString(o,a){const l=o.join(", ");return a===-1?`(_ ${l})`:`h'${l}`}createByteStringFromHeap(o,a){return`h'${t.from(super.createByteStringFromHeap(o,a)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(o){return`simple(${o})`}createArray(o,a){const l=super.createArray(o,a);return a===-1?`[_ ${l.join(", ")}]`:`[${l.join(", ")}]`}createMap(o,a){const l=super.createMap(o),u=Array.from(l.keys()).reduce(s(l),"");return a===-1?`{_ ${u}}`:`{${u}}`}createObject(o,a){const l=super.createObject(o),u=Object.keys(l).reduce(s(l),"");return a===-1?`{_ ${u}}`:`{${u}}`}createUtf8String(o,a){const l=o.join(", ");return a===-1?`(_ ${l})`:`"${l}"`}createUtf8StringFromHeap(o,a){return`"${t.from(super.createUtf8StringFromHeap(o,a)).toString("utf8")}"`}static diagnose(o,a){return typeof o=="string"&&(o=t.from(o,a||"hex")),new r().decodeFirst(o)}}SA=r;function s(i){return(o,a)=>o?`${o}, ${a}: ${i[a]}`:`${a}: ${i[a]}`}return SA}var CA,pB;function uce(){if(pB)return CA;pB=1;const{Buffer:t}=kN(),{URL:e}=rG(),n=TN().BigNumber,r=lD(),s=EN(),i=s.MT,o=s.NUMBYTES,a=s.SHIFT32,l=s.SYMS,u=s.TAG,c=s.MT.SIMPLE_FLOAT<<5|s.NUMBYTES.TWO,d=s.MT.SIMPLE_FLOAT<<5|s.NUMBYTES.FOUR,h=s.MT.SIMPLE_FLOAT<<5|s.NUMBYTES.EIGHT,f=s.MT.SIMPLE_FLOAT<<5|s.SIMPLE.TRUE,m=s.MT.SIMPLE_FLOAT<<5|s.SIMPLE.FALSE,g=s.MT.SIMPLE_FLOAT<<5|s.SIMPLE.UNDEFINED,x=s.MT.SIMPLE_FLOAT<<5|s.SIMPLE.NULL,w=new n("0x20000000000000"),b=t.from("f97e00","hex"),S=t.from("f9fc00","hex"),C=t.from("f97c00","hex");function T(P){return{}.toString.call(P).slice(8,-1)}class D{constructor(I){I=I||{},this.streaming=typeof I.stream=="function",this.onData=I.stream,this.semanticTypes=[[e,this._pushUrl],[n,this._pushBigNumber]];const E=I.genTypes||[],M=E.length;for(let O=0;O<M;O++)this.addSemanticType(E[O][0],E[O][1]);this._reset()}addSemanticType(I,E){const M=this.semanticTypes.length;for(let O=0;O<M;O++)if(this.semanticTypes[O][0]===I){const R=this.semanticTypes[O][1];return this.semanticTypes[O][1]=E,R}return this.semanticTypes.push([I,E]),null}push(I){return I&&(this.result[this.offset]=I,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=I.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(I,E,M){return this.result[this.offset]=I,this.resultMethod[this.offset]=E,this.resultLength[this.offset]=M,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(I){return this.pushWrite(I,1,1)}_pushUInt16BE(I){return this.pushWrite(I,2,2)}_pushUInt32BE(I){return this.pushWrite(I,3,4)}_pushDoubleBE(I){return this.pushWrite(I,4,8)}_pushNaN(){return this.push(b)}_pushInfinity(I){const E=I<0?S:C;return this.push(E)}_pushFloat(I){const E=t.allocUnsafe(2);if(r.writeHalf(E,I)&&r.parseHalf(E)===I)return this._pushUInt8(c)&&this.push(E);const M=t.allocUnsafe(4);return M.writeFloatBE(I,0),M.readFloatBE(0)===I?this._pushUInt8(d)&&this.push(M):this._pushUInt8(h)&&this._pushDoubleBE(I)}_pushInt(I,E,M){const O=E<<5;return I<24?this._pushUInt8(O|I):I<=255?this._pushUInt8(O|o.ONE)&&this._pushUInt8(I):I<=65535?this._pushUInt8(O|o.TWO)&&this._pushUInt16BE(I):I<=4294967295?this._pushUInt8(O|o.FOUR)&&this._pushUInt32BE(I):I<=Number.MAX_SAFE_INTEGER?this._pushUInt8(O|o.EIGHT)&&this._pushUInt32BE(Math.floor(I/a))&&this._pushUInt32BE(I%a):E===i.NEG_INT?this._pushFloat(M):this._pushFloat(I)}_pushIntNum(I){return I<0?this._pushInt(-I-1,i.NEG_INT,I):this._pushInt(I,i.POS_INT)}_pushNumber(I){switch(!1){case I===I:return this._pushNaN(I);case isFinite(I):return this._pushInfinity(I);case I%1!==0:return this._pushIntNum(I);default:return this._pushFloat(I)}}_pushString(I){const E=t.byteLength(I,"utf8");return this._pushInt(E,i.UTF8_STRING)&&this.pushWrite(I,5,E)}_pushBoolean(I){return this._pushUInt8(I?f:m)}_pushUndefined(I){return this._pushUInt8(g)}_pushArray(I,E){const M=E.length;if(!I._pushInt(M,i.ARRAY))return!1;for(let O=0;O<M;O++)if(!I.pushAny(E[O]))return!1;return!0}_pushTag(I){return this._pushInt(I,i.TAG)}_pushDate(I,E){return I._pushTag(u.DATE_EPOCH)&&I.pushAny(Math.round(E/1e3))}_pushBuffer(I,E){return I._pushInt(E.length,i.BYTE_STRING)&&I.push(E)}_pushNoFilter(I,E){return I._pushBuffer(I,E.slice())}_pushRegexp(I,E){return I._pushTag(u.REGEXP)&&I.pushAny(E.source)}_pushSet(I,E){if(!I._pushInt(E.size,i.ARRAY))return!1;for(const M of E)if(!I.pushAny(M))return!1;return!0}_pushUrl(I,E){return I._pushTag(u.URI)&&I.pushAny(E.format())}_pushBigint(I){let E=u.POS_BIGINT;I.isNegative()&&(I=I.negated().minus(1),E=u.NEG_BIGINT);let M=I.toString(16);M.length%2&&(M="0"+M);const O=t.from(M,"hex");return this._pushTag(E)&&this._pushBuffer(this,O)}_pushBigNumber(I,E){if(E.isNaN())return I._pushNaN();if(!E.isFinite())return I._pushInfinity(E.isNegative()?-1/0:1/0);if(E.isInteger())return I._pushBigint(E);if(!(I._pushTag(u.DECIMAL_FRAC)&&I._pushInt(2,i.ARRAY)))return!1;const M=E.decimalPlaces(),O=E.multipliedBy(new n(10).pow(M));return I._pushIntNum(-M)?O.abs().isLessThan(w)?I._pushIntNum(O.toNumber()):I._pushBigint(O):!1}_pushMap(I,E){return I._pushInt(E.size,i.MAP)?this._pushRawMap(E.size,Array.from(E)):!1}_pushObject(I){if(!I)return this._pushUInt8(x);for(var E=this.semanticTypes.length,M=0;M<E;M++)if(I instanceof this.semanticTypes[M][0])return this.semanticTypes[M][1].call(I,this,I);var O=I.encodeCBOR;if(typeof O=="function")return O.call(I,this);var j=Object.keys(I),R=j.length;return this._pushInt(R,i.MAP)?this._pushRawMap(R,j.map(z=>[z,I[z]])):!1}_pushRawMap(I,E){E=E.map(function(O){return O[0]=D.encode(O[0]),O}).sort(r.keySorter);for(var M=0;M<I;M++)if(!this.push(E[M][0])||!this.pushAny(E[M][1]))return!1;return!0}write(I){return this.pushAny(I)}pushAny(I){var E=T(I);switch(E){case"Number":return this._pushNumber(I);case"String":return this._pushString(I);case"Boolean":return this._pushBoolean(I);case"Object":return this._pushObject(I);case"Array":return this._pushArray(this,I);case"Uint8Array":return this._pushBuffer(this,t.isBuffer(I)?I:t.from(I));case"Null":return this._pushUInt8(x);case"Undefined":return this._pushUndefined(I);case"Map":return this._pushMap(this,I);case"Set":return this._pushSet(this,I);case"URL":return this._pushUrl(this,I);case"BigNumber":return this._pushBigNumber(this,I);case"Date":return this._pushDate(this,I);case"RegExp":return this._pushRegexp(this,I);case"Symbol":switch(I){case l.NULL:return this._pushObject(null);case l.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+I.toString())}default:throw new Error("Unknown type: "+typeof I+", "+(I?I.toString():""))}}finalize(){if(this.offset===0)return null;for(var I=this.result,E=this.resultLength,M=this.resultMethod,O=this.offset,j=0,R=0;R<O;R++)j+=E[R];var z=t.allocUnsafe(j),B=0,V=0;for(R=0;R<O;R++){switch(V=E[R],M[R]){case 0:I[R].copy(z,B);break;case 1:z.writeUInt8(I[R],B,!0);break;case 2:z.writeUInt16BE(I[R],B,!0);break;case 3:z.writeUInt32BE(I[R],B,!0);break;case 4:z.writeDoubleBE(I[R],B,!0);break;case 5:z.write(I[R],B,V,"utf8");break;default:throw new Error("unkown method")}B+=V}var H=z;return this._reset(),H}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(I){const E=new D;if(!E.pushAny(I))throw new Error("Failed to encode input");return E.finalize()}}return CA=D,CA}var mB;function cce(){return mB||(mB=1,function(t){t.Diagnose=lce(),t.Decoder=sG(),t.Encoder=uce(),t.Simple=eG(),t.Tagged=tG(),t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}}(hA)),hA}var dce=cce();const iG=Dp(dce);function fl(t){return ww(nD.create().update(new Uint8Array(t)).digest())}function PS(t){if(t instanceof iG.Tagged)return PS(t.value);if(typeof t=="string")return oG(t);if(typeof t=="number")return fl(Er(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return fl(t);if(Array.isArray(t)){const e=t.map(PS);return fl(xl(...e))}else{if(t&&typeof t=="object"&&t._isPrincipal)return fl(t.toUint8Array());if(typeof t=="object"&&t!==null&&typeof t.toHash=="function")return PS(t.toHash());if(typeof t=="object")return eI(t);if(typeof t=="bigint")return fl(Er(t))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const oG=t=>{const e=new TextEncoder().encode(t);return fl(e)};function cp(t){return eI(t)}function eI(t){const r=Object.entries(t).filter(([,o])=>o!==void 0).map(([o,a])=>{const l=oG(o),u=PS(a);return[l,u]}).sort(([o],[a])=>rD(o,a)),s=xl(...r.map(o=>xl(...o)));return fl(s)}var hce=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};const fce=new TextEncoder().encode(`
ic-request`);class uD{getPrincipal(){return this._principal||(this._principal=zt.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:n}=e,r=hce(e,["body"]),s=cp(n);return Object.assign(Object.assign({},r),{body:{content:n,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(xl(fce,s))}})}}class Jd{getPrincipal(){return zt.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var wx={},Qu={},Wn={},gB;function aG(){if(gB)return Wn;gB=1,Object.defineProperty(Wn,"__esModule",{value:!0});const t=9007199254740992;function e(R,...z){const B=new Uint8Array(R.byteLength+z.reduce((H,K)=>H+K.byteLength,0));B.set(new Uint8Array(R),0);let V=R.byteLength;for(const H of z)B.set(new Uint8Array(H),V),V+=H.byteLength;return B.buffer}function n(R,z,B){B=B.replace(/[^0-9a-fA-F]/g,"");const V=2**(z-24);B=B.slice(-V*2).padStart(V*2,"0");const H=[(R<<5)+z].concat(B.match(/../g).map(K=>parseInt(K,16)));return new Uint8Array(H).buffer}function r(R,z){if(z<24)return new Uint8Array([(R<<5)+z]).buffer;{const B=z<=255?24:z<=65535?25:z<=4294967295?26:27;return n(R,B,z.toString(16))}}function s(R){const z=[];for(let B=0;B<R.length;B++){let V=R.charCodeAt(B);V<128?z.push(V):V<2048?z.push(192|V>>6,128|V&63):V<55296||V>=57344?z.push(224|V>>12,128|V>>6&63,128|V&63):(B++,V=(V&1023)<<10|R.charCodeAt(B)&1023,z.push(240|V>>18,128|V>>12&63,128|V>>6&63,128|V&63))}return e(new Uint8Array(r(3,R.length)),new Uint8Array(z))}function i(R,z){if(R==14277111)return e(new Uint8Array([217,217,247]),z);if(R<24)return e(new Uint8Array([192+R]),z);{const B=R<=255?24:R<=65535?25:R<=4294967295?26:27,V=2**(B-24),H=R.toString(16).slice(-V*2).padStart(V*2,"0"),K=[192+B].concat(H.match(/../g).map(ne=>parseInt(ne,16)));return new Uint8Array(K).buffer}}Wn.tagged=i;function o(R){return new Uint8Array(R).buffer}Wn.raw=o;function a(R){if(isNaN(R))throw new RangeError("Invalid number.");R=Math.min(Math.max(0,R),23);const z=[0+R];return new Uint8Array(z).buffer}Wn.uSmall=a;function l(R,z){if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,R),255),R=R.toString(16),n(0,24,R)}Wn.u8=l;function u(R,z){if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,R),65535),R=R.toString(16),n(0,25,R)}Wn.u16=u;function c(R,z){if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,R),4294967295),R=R.toString(16),n(0,26,R)}Wn.u32=c;function d(R,z){if(typeof R=="string"&&z==16){if(R.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return n(0,27,R)}if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,R),t),R=R.toString(16),n(0,27,R)}Wn.u64=d;function h(R){if(isNaN(R))throw new RangeError("Invalid number.");if(R===0)return a(0);R=Math.min(Math.max(0,-R),24)-1;const z=[32+R];return new Uint8Array(z).buffer}Wn.iSmall=h;function f(R,z){if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,-R-1),255),R=R.toString(16),n(1,24,R)}Wn.i8=f;function m(R,z){if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,-R-1),65535),R=R.toString(16),n(1,25,R)}Wn.i16=m;function g(R,z){if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,-R-1),4294967295),R=R.toString(16),n(1,26,R)}Wn.i32=g;function x(R,z){if(typeof R=="string"&&z==16){if(R.startsWith("-")?R=R.slice(1):R="0",R.match(/[^0-9a-fA-F]/)||R.length>16)throw new RangeError("Invalid number.");let B=!1,V=R.split("").reduceRight((H,K)=>{if(B)return K+H;let ne=parseInt(K,16)-1;return ne>=0?(B=!0,ne.toString(16)+H):"f"+H},"");return B?n(1,27,V):d(0)}if(R=parseInt(""+R,z),isNaN(R))throw new RangeError("Invalid number.");return R=Math.min(Math.max(0,-R-1),9007199254740992),R=R.toString(16),n(1,27,R)}Wn.i64=x;function w(R){return R>=0?R<24?a(R):R<=255?l(R):R<=65535?u(R):R<=4294967295?c(R):d(R):R>=-24?h(R):R>=-255?f(R):R>=-65535?m(R):R>=-4294967295?g(R):x(R)}Wn.number=w;function b(R){return e(r(2,R.byteLength),R)}Wn.bytes=b;function S(R){return s(R)}Wn.string=S;function C(R){return e(r(4,R.length),...R)}Wn.array=C;function T(R,z=!1){R instanceof Map||(R=new Map(Object.entries(R)));let B=Array.from(R.entries());return z&&(B=B.sort(([V],[H])=>V.localeCompare(H))),e(r(5,R.size),...B.map(([V,H])=>e(s(V),H)))}Wn.map=T;function D(R){const z=new Float32Array([R]);return e(new Uint8Array([250]),new Uint8Array(z.buffer))}Wn.singleFloat=D;function P(R){const z=new Float64Array([R]);return e(new Uint8Array([251]),new Uint8Array(z.buffer))}Wn.doubleFloat=P;function I(R){return R?E():M()}Wn.bool=I;function E(){return o(new Uint8Array([245]))}Wn.true_=E;function M(){return o(new Uint8Array([244]))}Wn.false_=M;function O(){return o(new Uint8Array([246]))}Wn.null_=O;function j(){return o(new Uint8Array([247]))}return Wn.undefined_=j,Wn}var yB;function pce(){if(yB)return Qu;yB=1;var t=Qu&&Qu.__importStar||function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var u in a)Object.hasOwnProperty.call(a,u)&&(l[u]=a[u]);return l.default=a,l};Object.defineProperty(Qu,"__esModule",{value:!0});const e=t(aG()),n=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class r{constructor(l,u=!1){this._serializer=l,this._stable=u,this.name="jsonDefault",this.priority=-100}match(l){return["undefined","boolean","number","string","object"].indexOf(typeof l)!=-1}encode(l){switch(typeof l){case"undefined":return e.undefined_();case"boolean":return e.bool(l);case"number":return Math.floor(l)===l?e.number(l):e.doubleFloat(l);case"string":return e.string(l);case"object":if(l===null)return e.null_();if(Array.isArray(l))return e.array(l.map(u=>this._serializer.serializeValue(u)));if(n.find(u=>l instanceof u))return e.bytes(l.buffer);if(Object.getOwnPropertyNames(l).indexOf("toJSON")!==-1)return this.encode(l.toJSON());if(l instanceof Map){const u=new Map;for(const[c,d]of l.entries())u.set(c,this._serializer.serializeValue(d));return e.map(u,this._stable)}else{const u=new Map;for(const[c,d]of Object.entries(l))u.set(c,this._serializer.serializeValue(d));return e.map(u,this._stable)}default:throw new Error("Invalid value.")}}}Qu.JsonDefaultCborEncoder=r;class s{constructor(){this.name="cborEncoder",this.priority=-90}match(l){return typeof l=="object"&&typeof l.toCBOR=="function"}encode(l){return l.toCBOR()}}Qu.ToCborEncoder=s;class i{constructor(){this._encoders=new Set}static withDefaultEncoders(l=!1){const u=new this;return u.addEncoder(new r(u,l)),u.addEncoder(new s),u}removeEncoder(l){for(const u of this._encoders.values())u.name==l&&this._encoders.delete(u)}addEncoder(l){this._encoders.add(l)}getEncoderFor(l){let u=null;for(const c of this._encoders)(!u||c.priority>u.priority)&&c.match(l)&&(u=c);if(u===null)throw new Error("Could not find an encoder for value.");return u}serializeValue(l){return this.getEncoderFor(l).encode(l)}serialize(l){return this.serializeValue(l)}}Qu.CborSerializer=i;class o extends i{serialize(l){return e.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(l))]))}}return Qu.SelfDescribeCborSerializer=o,Qu}var xB;function mce(){return xB||(xB=1,function(t){function e(s){for(var i in s)t.hasOwnProperty(i)||(t[i]=s[i])}var n=wx&&wx.__importStar||function(s){if(s&&s.__esModule)return s;var i={};if(s!=null)for(var o in s)Object.hasOwnProperty.call(s,o)&&(i[o]=s[o]);return i.default=s,i};Object.defineProperty(t,"__esModule",{value:!0}),e(pce());const r=n(aG());t.value=r}(wx)),wx}var Lo=mce();class gce{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return Lo.value.bytes(e.toUint8Array())}}class yce{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return Lo.value.bytes(new Uint8Array(e))}}class xce{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?Lo.value.tagged(2,Lo.value.bytes(gu(e.toString(16)))):Lo.value.tagged(3,Lo.value.bytes(gu((BigInt("-1")*e).toString(16))))}}const _N=Lo.SelfDescribeCborSerializer.withDefaultEncoders(!0);_N.addEncoder(new gce);_N.addEncoder(new yce);_N.addEncoder(new xce);var E$;(function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"})(E$||(E$={}));function FS(t){return _N.serialize(t)}function wB(t){const e=t.byteLength;let n=BigInt(0);for(let r=0;r<e;r++)n=n*BigInt(256)+BigInt(t[r]);return n}class wce extends iG.Decoder{createByteString(e){return xl(...e)}createByteStringFromHeap(e,n){return e===n?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,n))}}function du(t){const e=new Uint8Array(t),n=new wce({size:e.byteLength,tags:{2:r=>wB(r),3:r=>-wB(r),[E$.Semantic]:r=>r}});try{return n.decodeFirst(e)}catch(r){throw new Error(`Failed to decode CBOR: ${r}, input: ${On(e)}`)}}const _2=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var tI;(function(t){t.Call="call"})(tI||(tI={}));function _$(){const t=new ArrayBuffer(16),e=new DataView(t),n=_2(),r=_2(),s=_2(),i=_2();return e.setUint32(0,n),e.setUint32(4,r),e.setUint32(8,s),e.setUint32(12,i),t}const bB=BigInt(1e6),bce=60*1e3;class Ux{constructor(e){if(e<90*1e3){const a=BigInt(Date.now()+e)*bB/BigInt(1e9);this._value=a*BigInt(1e9);return}const i=BigInt(Math.floor(Date.now()+e-bce))*bB/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=i}toCBOR(){return Lo.value.u64(this._value.toString(16),16)}toHash(){return Er(this._value)}}function vB(t=_$){return async e=>{const n=e.request.headers;e.request.headers=n,e.endpoint==="call"&&(e.body.nonce=t())}}function Vx(t){const e=[];return t.forEach((n,r)=>{e.push([r,n])}),e}class IA extends Tr{constructor(e,n){super(e),this.response=n,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class vce extends Tr{constructor(e,n,r,s,i,o){super(e),this.response=n,this.requestId=r,this.senderPubkey=s,this.senderSig=i,this.ingressExpiry=o,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class Sce extends Tr{constructor(e,n,r,s,i,o){super(e),this.response=n,this.requestId=r,this.senderPubkey=s,this.senderSig=i,this.ingressExpiry=o,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class Cce extends Tr{constructor(e,n,r,s,i,o){super(e),this.response=n,this.requestId=r,this.senderPubkey=s,this.senderSig=i,this.ingressExpiry=o,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cD=BigInt(0),dD=BigInt(1),Ice=BigInt(2);function AN(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ah(t){if(!AN(t))throw new Error("Uint8Array expected")}function bw(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Nce=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function dp(t){ah(t);let e="";for(let n=0;n<t.length;n++)e+=Nce[t[n]];return e}function lG(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?cD:BigInt("0x"+t)}const Ju={_0:48,_9:57,A:65,F:70,a:97,f:102};function SB(t){if(t>=Ju._0&&t<=Ju._9)return t-Ju._0;if(t>=Ju.A&&t<=Ju.F)return t-(Ju.A-10);if(t>=Ju.a&&t<=Ju.f)return t-(Ju.a-10)}function uG(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=SB(t.charCodeAt(i)),a=SB(t.charCodeAt(i+1));if(o===void 0||a===void 0){const l=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}r[s]=o*16+a}return r}function ul(t){return lG(dp(t))}function vw(t){return ah(t),lG(dp(Uint8Array.from(t).reverse()))}function Us(t,e){return uG(t.toString(16).padStart(e*2,"0"))}function nI(t,e){return Us(t,e).reverse()}function Mi(t,e,n){let r;if(typeof e=="string")try{r=uG(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(AN(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function Qr(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];ah(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}function hD(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const NA=t=>typeof t=="bigint"&&cD<=t;function cG(t,e,n){return NA(t)&&NA(e)&&NA(n)&&e<=t&&t<n}function Vd(t,e,n,r){if(!cG(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function Sw(t){let e;for(e=0;t>cD;t>>=dD,e+=1);return e}function kce(t,e){return t>>BigInt(e)&dD}const LS=t=>(Ice<<BigInt(t-1))-dD,Tce={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||AN(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function D1(t,e,n={}){const r=(s,i,o)=>{const a=Tce[i];if(typeof a!="function")throw new Error("invalid validator function");const l=t[s];if(!(o&&l===void 0)&&!a(l,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+l)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}const CB=()=>{throw new Error("not implemented")};function jw(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Es=BigInt(0),dr=BigInt(1),jd=BigInt(2),Ece=BigInt(3),A$=BigInt(4),IB=BigInt(5),NB=BigInt(8);function Nr(t,e){const n=t%e;return n>=Es?n:e+n}function _ce(t,e,n){if(e<Es)throw new Error("invalid exponent, negatives unsupported");if(n<=Es)throw new Error("invalid modulus");if(n===dr)return Es;let r=dr;for(;e>Es;)e&dr&&(r=r*t%n),t=t*t%n,e>>=dr;return r}function Yl(t,e,n){let r=t;for(;e-- >Es;)r*=r,r%=n;return r}function kB(t,e){if(t===Es)throw new Error("invert: expected non-zero number");if(e<=Es)throw new Error("invert: expected positive modulus, got "+e);let n=Nr(t,e),r=e,s=Es,i=dr;for(;n!==Es;){const a=r/n,l=r%n,u=s-i*a;r=n,n=l,s=i,i=u}if(r!==dr)throw new Error("invert: does not exist");return Nr(s,e)}function Ace(t){const e=(t-dr)/jd;let n,r,s;for(n=t-dr,r=0;n%jd===Es;n/=jd,r++);for(s=jd;s<t&&_ce(s,e,t)!==t-dr;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+dr)/A$;return function(l,u){const c=l.pow(u,o);if(!l.eql(l.sqr(c),u))throw new Error("Cannot find square root");return c}}const i=(n+dr)/jd;return function(a,l){if(a.pow(l,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=r,c=a.pow(a.mul(a.ONE,s),n),d=a.pow(l,i),h=a.pow(l,n);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let g=a.sqr(h);f<u&&!a.eql(g,a.ONE);f++)g=a.sqr(g);const m=a.pow(c,dr<<BigInt(u-f-1));c=a.sqr(m),d=a.mul(d,m),h=a.mul(h,c),u=f}return d}}function $ce(t){if(t%A$===Ece){const e=(t+dr)/A$;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%NB===IB){const e=(t-IB)/NB;return function(r,s){const i=r.mul(s,jd),o=r.pow(i,e),a=r.mul(s,o),l=r.mul(r.mul(a,jd),o),u=r.mul(a,r.sub(l,r.ONE));if(!r.eql(r.sqr(u),s))throw new Error("Cannot find square root");return u}}return Ace(t)}const Rce=(t,e)=>(Nr(t,e)&dr)===dr,Mce=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function dG(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Mce.reduce((r,s)=>(r[s]="function",r),e);return D1(t,n)}function zS(t,e,n){if(n<Es)throw new Error("invalid exponent, negatives unsupported");if(n===Es)return t.ONE;if(n===dr)return e;let r=t.ONE,s=e;for(;n>Es;)n&dr&&(r=t.mul(r,s)),s=t.sqr(s),n>>=dr;return r}function BS(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function Dce(t){const e=(t-dr)/jd;return(n,r)=>n.pow(r,e)}function hG(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function O1(t,e,n=!1,r={}){if(t<=Es)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=hG(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:LS(s),ZERO:Es,ONE:dr,create:l=>Nr(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof l);return Es<=l&&l<t},is0:l=>l===Es,isOdd:l=>(l&dr)===dr,neg:l=>Nr(-l,t),eql:(l,u)=>l===u,sqr:l=>Nr(l*l,t),add:(l,u)=>Nr(l+u,t),sub:(l,u)=>Nr(l-u,t),mul:(l,u)=>Nr(l*u,t),pow:(l,u)=>zS(a,l,u),div:(l,u)=>Nr(l*kB(u,t),t),sqrN:l=>l*l,addN:(l,u)=>l+u,subN:(l,u)=>l-u,mulN:(l,u)=>l*u,inv:l=>kB(l,t),sqrt:r.sqrt||(l=>(o||(o=$ce(t)),o(a,l))),invertBatch:l=>BS(a,l),cmov:(l,u,c)=>c?u:l,toBytes:l=>n?nI(l,i):Us(l,i),fromBytes:l=>{if(l.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+l.length);return n?vw(l):ul(l)}});return Object.freeze(a)}function fG(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function pG(t){const e=fG(t);return e+Math.ceil(e/2)}function Oce(t,e,n=!1){const r=t.length,s=fG(e),i=pG(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?vw(t):ul(t),a=Nr(o,e-dr)+dr;return n?nI(a,s):Us(a,s)}const Pce=ul;function Od(t,e){if(Ww(t),Ww(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=t&255,t>>>=8;return new Uint8Array(n)}function Fce(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function Ww(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Lce(t,e,n,r){ah(t),ah(e),Ww(n),e.length>255&&(e=r(Qr(hD("H2C-OVERSIZE-DST-"),e)));const{outputLen:s,blockLen:i}=r,o=Math.ceil(n/s);if(n>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Qr(e,Od(e.length,1)),l=Od(0,i),u=Od(n,2),c=new Array(o),d=r(Qr(l,t,u,Od(0,1),a));c[0]=r(Qr(d,Od(1,1),a));for(let f=1;f<=o;f++){const m=[Fce(d,c[f-1]),Od(f+1,1),a];c[f]=r(Qr(...m))}return Qr(...c).slice(0,n)}function zce(t,e,n,r,s){if(ah(t),ah(e),Ww(n),e.length>255){const i=Math.ceil(2*r/8);e=s.create({dkLen:i}).update(hD("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:n}).update(t).update(Od(n,2)).update(e).update(Od(e.length,1)).digest()}function TB(t,e,n){D1(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:s,m:i,hash:o,expand:a,DST:l}=n;ah(t),Ww(e);const u=typeof l=="string"?hD(l):l,c=r.toString(2).length,d=Math.ceil((c+s)/8),h=e*i*d;let f;if(a==="xmd")f=Lce(t,u,h,o);else if(a==="xof")f=zce(t,u,h,s,o);else if(a==="_internal_pass")f=t;else throw new Error('expand must be "xmd" or "xof"');const m=new Array(e);for(let g=0;g<e;g++){const x=new Array(i);for(let w=0;w<i;w++){const b=d*(w+g*i),S=f.subarray(b,b+d);x[w]=Nr(Pce(S),r)}m[g]=x}return m}function mG(t,e){const n=e.map(r=>Array.from(r).reverse());return(r,s)=>{const[i,o,a,l]=n.map(u=>u.reduce((c,d)=>t.add(t.mul(c,r),d)));return r=t.div(i,o),s=t.mul(s,t.div(a,l)),{x:r,y:s}}}function EB(t,e,n){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,s){const i=TB(r,2,{...n,DST:n.DST,...s}),o=t.fromAffine(e(i[0])),a=t.fromAffine(e(i[1])),l=o.add(a).clearCofactor();return l.assertValidity(),l},encodeToCurve(r,s){const i=TB(r,1,{...n,DST:n.encodeDST,...s}),o=t.fromAffine(e(i[0])).clearCofactor();return o.assertValidity(),o},mapToCurve(r){if(!Array.isArray(r))throw new Error("mapToCurve: expected array of bigints");for(const i of r)if(typeof i!="bigint")throw new Error("mapToCurve: expected array of bigints");const s=t.fromAffine(e(r)).clearCofactor();return s.assertValidity(),s}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _B=BigInt(0),A2=BigInt(1);function kA(t,e){const n=e.negate();return t?n:e}function gG(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function TA(t,e){gG(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function Bce(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function Uce(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const EA=new WeakMap,yG=new WeakMap;function _A(t){return yG.get(t)||1}function xG(t,e){return{constTimeNegate:kA,hasPrecomputes(n){return _A(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>_B;)r&A2&&(s=s.add(i)),i=i.double(),r>>=A2;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=TA(r,e),o=[];let a=n,l=a;for(let u=0;u<s;u++){l=a,o.push(l);for(let c=1;c<i;c++)l=l.add(a),o.push(l);a=l.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=TA(n,e);let a=t.ZERO,l=t.BASE;const u=BigInt(2**n-1),c=2**n,d=BigInt(n);for(let h=0;h<i;h++){const f=h*o;let m=Number(s&u);s>>=d,m>o&&(m-=c,s+=A2);const g=f,x=f+Math.abs(m)-1,w=h%2!==0,b=m<0;m===0?l=l.add(kA(w,r[g])):a=a.add(kA(b,r[x]))}return{p:a,f:l}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=TA(n,e),l=BigInt(2**n-1),u=2**n,c=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===_B)break;let f=Number(s&l);if(s>>=c,f>a&&(f-=u,s+=A2),f===0)continue;let m=r[h+Math.abs(f)-1];f<0&&(m=m.negate()),i=i.add(m)}return i},getPrecomputes(n,r,s){let i=EA.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&EA.set(r,s(i))),i},wNAFCached(n,r,s){const i=_A(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=_A(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){gG(r,e),yG.set(n,r),EA.delete(n)}}}function wG(t,e,n,r){if(Bce(n,t),Uce(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=Sw(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,l=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let c=s;for(let d=u;d>=0;d-=o){l.fill(s);for(let f=0;f<r.length;f++){const m=r[f],g=Number(m>>BigInt(d)&BigInt(a));l[g]=l[g].add(n[f])}let h=s;for(let f=l.length-1,m=s;f>0;f--)m=m.add(l[f]),h=h.add(m);if(c=c.add(h),d!==0)for(let f=0;f<o;f++)c=c.double()}return c}function bG(t){return dG(t.Fp),D1(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...hG(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Vce(t){const e=bG(t);D1(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const Pf=BigInt(0),Pr=BigInt(1),xd=BigInt(2),rI=BigInt(3),AB=BigInt(4);function $B(t){const e=Vce(t),{Fp:n}=e,r=O1(e.n,e.nBitLength),s=e.toBytes||((g,x,w)=>{const b=x.toAffine();return Qr(Uint8Array.from([4]),n.toBytes(b.x),n.toBytes(b.y))}),i=e.fromBytes||(g=>{const x=g.subarray(1),w=n.fromBytes(x.subarray(0,n.BYTES)),b=n.fromBytes(x.subarray(n.BYTES,2*n.BYTES));return{x:w,y:b}});function o(g){const{a:x,b:w}=e,b=n.sqr(g),S=n.mul(b,g);return n.add(n.add(S,n.mul(g,x)),w)}if(!n.eql(n.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return cG(g,Pr,e.n)}function l(g){const{allowedPrivateKeyLengths:x,nByteLength:w,wrapPrivateKey:b,n:S}=e;if(x&&typeof g!="bigint"){if(AN(g)&&(g=dp(g)),typeof g!="string"||!x.includes(g.length))throw new Error("invalid private key");g=g.padStart(w*2,"0")}let C;try{C=typeof g=="bigint"?g:ul(Mi("private key",g,w))}catch{throw new Error("invalid private key, expected hex or "+w+" bytes, got "+typeof g)}return b&&(C=Nr(C,S)),Vd("private key",C,Pr,S),C}function u(g){if(!(g instanceof h))throw new Error("ProjectivePoint expected")}const c=jw((g,x)=>{const{px:w,py:b,pz:S}=g;if(n.eql(S,n.ONE))return{x:w,y:b};const C=g.is0();x==null&&(x=C?n.ONE:n.inv(S));const T=n.mul(w,x),D=n.mul(b,x),P=n.mul(S,x);if(C)return{x:n.ZERO,y:n.ZERO};if(!n.eql(P,n.ONE))throw new Error("invZ was invalid");return{x:T,y:D}}),d=jw(g=>{if(g.is0()){if(e.allowInfinityPoint&&!n.is0(g.py))return;throw new Error("bad point: ZERO")}const{x,y:w}=g.toAffine();if(!n.isValid(x)||!n.isValid(w))throw new Error("bad point: x or y not FE");const b=n.sqr(w),S=o(x);if(!n.eql(b,S))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class h{constructor(x,w,b){if(this.px=x,this.py=w,this.pz=b,x==null||!n.isValid(x))throw new Error("x required");if(w==null||!n.isValid(w))throw new Error("y required");if(b==null||!n.isValid(b))throw new Error("z required");Object.freeze(this)}static fromAffine(x){const{x:w,y:b}=x||{};if(!x||!n.isValid(w)||!n.isValid(b))throw new Error("invalid affine point");if(x instanceof h)throw new Error("projective point not allowed");const S=C=>n.eql(C,n.ZERO);return S(w)&&S(b)?h.ZERO:new h(w,b,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(x){const w=n.invertBatch(x.map(b=>b.pz));return x.map((b,S)=>b.toAffine(w[S])).map(h.fromAffine)}static fromHex(x){const w=h.fromAffine(i(Mi("pointHex",x)));return w.assertValidity(),w}static fromPrivateKey(x){return h.BASE.multiply(l(x))}static msm(x,w){return wG(h,r,x,w)}_setWindowSize(x){m.setWindowSize(this,x)}assertValidity(){d(this)}hasEvenY(){const{y:x}=this.toAffine();if(n.isOdd)return!n.isOdd(x);throw new Error("Field doesn't support isOdd")}equals(x){u(x);const{px:w,py:b,pz:S}=this,{px:C,py:T,pz:D}=x,P=n.eql(n.mul(w,D),n.mul(C,S)),I=n.eql(n.mul(b,D),n.mul(T,S));return P&&I}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:x,b:w}=e,b=n.mul(w,rI),{px:S,py:C,pz:T}=this;let D=n.ZERO,P=n.ZERO,I=n.ZERO,E=n.mul(S,S),M=n.mul(C,C),O=n.mul(T,T),j=n.mul(S,C);return j=n.add(j,j),I=n.mul(S,T),I=n.add(I,I),D=n.mul(x,I),P=n.mul(b,O),P=n.add(D,P),D=n.sub(M,P),P=n.add(M,P),P=n.mul(D,P),D=n.mul(j,D),I=n.mul(b,I),O=n.mul(x,O),j=n.sub(E,O),j=n.mul(x,j),j=n.add(j,I),I=n.add(E,E),E=n.add(I,E),E=n.add(E,O),E=n.mul(E,j),P=n.add(P,E),O=n.mul(C,T),O=n.add(O,O),E=n.mul(O,j),D=n.sub(D,E),I=n.mul(O,M),I=n.add(I,I),I=n.add(I,I),new h(D,P,I)}add(x){u(x);const{px:w,py:b,pz:S}=this,{px:C,py:T,pz:D}=x;let P=n.ZERO,I=n.ZERO,E=n.ZERO;const M=e.a,O=n.mul(e.b,rI);let j=n.mul(w,C),R=n.mul(b,T),z=n.mul(S,D),B=n.add(w,b),V=n.add(C,T);B=n.mul(B,V),V=n.add(j,R),B=n.sub(B,V),V=n.add(w,S);let H=n.add(C,D);return V=n.mul(V,H),H=n.add(j,z),V=n.sub(V,H),H=n.add(b,S),P=n.add(T,D),H=n.mul(H,P),P=n.add(R,z),H=n.sub(H,P),E=n.mul(M,V),P=n.mul(O,z),E=n.add(P,E),P=n.sub(R,E),E=n.add(R,E),I=n.mul(P,E),R=n.add(j,j),R=n.add(R,j),z=n.mul(M,z),V=n.mul(O,V),R=n.add(R,z),z=n.sub(j,z),z=n.mul(M,z),V=n.add(V,z),j=n.mul(R,V),I=n.add(I,j),j=n.mul(H,V),P=n.mul(B,P),P=n.sub(P,j),j=n.mul(B,R),E=n.mul(H,E),E=n.add(E,j),new h(P,I,E)}subtract(x){return this.add(x.negate())}is0(){return this.equals(h.ZERO)}wNAF(x){return m.wNAFCached(this,x,h.normalizeZ)}multiplyUnsafe(x){const{endo:w,n:b}=e;Vd("scalar",x,Pf,b);const S=h.ZERO;if(x===Pf)return S;if(this.is0()||x===Pr)return this;if(!w||m.hasPrecomputes(this))return m.wNAFCachedUnsafe(this,x,h.normalizeZ);let{k1neg:C,k1:T,k2neg:D,k2:P}=w.splitScalar(x),I=S,E=S,M=this;for(;T>Pf||P>Pf;)T&Pr&&(I=I.add(M)),P&Pr&&(E=E.add(M)),M=M.double(),T>>=Pr,P>>=Pr;return C&&(I=I.negate()),D&&(E=E.negate()),E=new h(n.mul(E.px,w.beta),E.py,E.pz),I.add(E)}multiply(x){const{endo:w,n:b}=e;Vd("scalar",x,Pr,b);let S,C;if(w){const{k1neg:T,k1:D,k2neg:P,k2:I}=w.splitScalar(x);let{p:E,f:M}=this.wNAF(D),{p:O,f:j}=this.wNAF(I);E=m.constTimeNegate(T,E),O=m.constTimeNegate(P,O),O=new h(n.mul(O.px,w.beta),O.py,O.pz),S=E.add(O),C=M.add(j)}else{const{p:T,f:D}=this.wNAF(x);S=T,C=D}return h.normalizeZ([S,C])[0]}multiplyAndAddUnsafe(x,w,b){const S=h.BASE,C=(D,P)=>P===Pf||P===Pr||!D.equals(S)?D.multiplyUnsafe(P):D.multiply(P),T=C(this,w).add(C(x,b));return T.is0()?void 0:T}toAffine(x){return c(this,x)}isTorsionFree(){const{h:x,isTorsionFree:w}=e;if(x===Pr)return!0;if(w)return w(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:x,clearCofactor:w}=e;return x===Pr?this:w?w(h,this):this.multiplyUnsafe(e.h)}toRawBytes(x=!0){return bw("isCompressed",x),this.assertValidity(),s(h,this,x)}toHex(x=!0){return bw("isCompressed",x),dp(this.toRawBytes(x))}}h.BASE=new h(e.Gx,e.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=e.nBitLength,m=xG(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:o,isWithinCurveOrder:a}}function jce(t,e){const n=t.ORDER;let r=Pf;for(let m=n-Pr;m%xd===Pf;m/=xd)r+=Pr;const s=r,i=xd<<s-Pr-Pr,o=i*xd,a=(n-Pr)/o,l=(a-Pr)/xd,u=o-Pr,c=i,d=t.pow(e,a),h=t.pow(e,(a+Pr)/xd);let f=(m,g)=>{let x=d,w=t.pow(g,u),b=t.sqr(w);b=t.mul(b,g);let S=t.mul(m,b);S=t.pow(S,l),S=t.mul(S,w),w=t.mul(S,g),b=t.mul(S,m);let C=t.mul(b,w);S=t.pow(C,c);let T=t.eql(S,t.ONE);w=t.mul(b,h),S=t.mul(C,x),b=t.cmov(w,b,T),C=t.cmov(S,C,T);for(let D=s;D>Pr;D--){let P=D-xd;P=xd<<P-Pr;let I=t.pow(C,P);const E=t.eql(I,t.ONE);w=t.mul(b,x),x=t.mul(x,x),I=t.mul(C,x),b=t.cmov(w,b,E),C=t.cmov(I,C,E)}return{isValid:T,value:b}};if(t.ORDER%AB===rI){const m=(t.ORDER-rI)/AB,g=t.sqrt(t.neg(e));f=(x,w)=>{let b=t.sqr(w);const S=t.mul(x,w);b=t.mul(b,S);let C=t.pow(b,m);C=t.mul(C,S);const T=t.mul(C,g),D=t.mul(t.sqr(C),w),P=t.eql(D,x);let I=t.cmov(T,C,P);return{isValid:P,value:I}}}return f}function vG(t,e){if(dG(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=jce(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let s,i,o,a,l,u,c,d;s=t.sqr(r),s=t.mul(s,e.Z),i=t.sqr(s),i=t.add(i,s),o=t.add(i,t.ONE),o=t.mul(o,e.B),a=t.cmov(e.Z,t.neg(i),!t.eql(i,t.ZERO)),a=t.mul(a,e.A),i=t.sqr(o),u=t.sqr(a),l=t.mul(u,e.A),i=t.add(i,l),i=t.mul(i,o),u=t.mul(u,a),l=t.mul(u,e.B),i=t.add(i,l),c=t.mul(s,o);const{isValid:h,value:f}=n(i,u);d=t.mul(s,r),d=t.mul(d,f),c=t.cmov(c,o,h),d=t.cmov(d,f,h);const m=t.isOdd(r)===t.isOdd(d);return d=t.cmov(t.neg(d),d,m),c=t.div(c,a),{x:c,y:d}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Wce=BigInt(0),$2=BigInt(1),RB=BigInt(2),vg=BigInt(3);function Gce(t){const e=[];for(;t>$2;t>>=$2)(t&$2)===Wce?e.unshift(0):(t&vg)===vg?(e.unshift(-1),t+=$2):e.unshift(1);return e}function Hce(t){const{Fp:e,Fr:n,Fp2:r,Fp6:s,Fp12:i}=t.fields,o=t.params.xNegative,a=t.params.twistType,l=$B({n:n.ORDER,...t.G1}),u=Object.assign(l,EB(l.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),c=$B({n:n.ORDER,...t.G2}),d=Object.assign(c,EB(c.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let h;if(a==="multiplicative")h=(ge,Z,we,Ee,Le,De)=>i.mul014(Ee,ge,r.mul(Z,Le),r.mul(we,De));else if(a==="divisive")h=(ge,Z,we,Ee,Le,De)=>i.mul034(Ee,r.mul(we,De),r.mul(Z,Le),ge);else throw new Error("bls: unknown twist type");const f=r.div(r.ONE,r.mul(r.ONE,RB));function m(ge,Z,we,Ee){const Le=r.sqr(we),De=r.sqr(Ee),Be=r.mulByB(r.mul(De,vg)),se=r.mul(Be,vg),le=r.sub(r.sub(r.sqr(r.add(we,Ee)),De),Le),ye=r.sub(Be,Le),ve=r.mul(r.sqr(Z),vg),xe=r.neg(le);return ge.push([ye,ve,xe]),Z=r.mul(r.mul(r.mul(r.sub(Le,se),Z),we),f),we=r.sub(r.sqr(r.mul(r.add(Le,se),f)),r.mul(r.sqr(Be),vg)),Ee=r.mul(Le,le),{Rx:Z,Ry:we,Rz:Ee}}function g(ge,Z,we,Ee,Le,De){const Be=r.sub(we,r.mul(De,Ee)),se=r.sub(Z,r.mul(Le,Ee)),le=r.sub(r.mul(Be,Le),r.mul(se,De)),ye=r.neg(Be),ve=se;ge.push([le,ye,ve]);const xe=r.sqr(se),Ie=r.mul(xe,se),te=r.mul(xe,Z),L=r.add(r.sub(Ie,r.mul(te,RB)),r.mul(r.sqr(Be),Ee));return Z=r.mul(se,L),we=r.sub(r.mul(r.sub(te,L),Be),r.mul(Ie,we)),Ee=r.mul(Ee,Ie),{Rx:Z,Ry:we,Rz:Ee}}const x=Gce(t.params.ateLoopSize),w=jw(ge=>{const Z=ge,{x:we,y:Ee}=Z.toAffine(),Le=we,De=Ee,Be=r.neg(Ee);let se=Le,le=De,ye=r.ONE;const ve=[];for(const xe of x){const Ie=[];({Rx:se,Ry:le,Rz:ye}=m(Ie,se,le,ye)),xe&&({Rx:se,Ry:le,Rz:ye}=g(Ie,se,le,ye,Le,xe===-1?Be:De)),ve.push(Ie)}if(t.postPrecompute){const xe=ve[ve.length-1];t.postPrecompute(se,le,ye,Le,De,g.bind(null,xe))}return ve});function b(ge,Z=!1){let we=i.ONE;if(ge.length){const Ee=ge[0][0].length;for(let Le=0;Le<Ee;Le++){we=i.sqr(we);for(const[De,Be,se]of ge)for(const[le,ye,ve]of De[Le])we=h(le,ye,ve,we,Be,se)}}return o&&(we=i.conjugate(we)),Z?i.finalExponentiate(we):we}function S(ge,Z=!0){const we=[];u.ProjectivePoint.normalizeZ(ge.map(({g1:Ee})=>Ee)),d.ProjectivePoint.normalizeZ(ge.map(({g2:Ee})=>Ee));for(const{g1:Ee,g2:Le}of ge){if(Ee.equals(u.ProjectivePoint.ZERO)||Le.equals(d.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");Ee.assertValidity(),Le.assertValidity();const De=Ee.toAffine();we.push([w(Le),De.x,De.y])}return b(we,Z)}function C(ge,Z,we=!0){return S([{g1:ge,g2:Z}],we)}const T={randomPrivateKey:()=>{const ge=pG(n.ORDER);return Oce(t.randomBytes(ge),n.ORDER)},calcPairingPrecomputes:w},{ShortSignature:D}=t.G1,{Signature:P}=t.G2;function I(ge){return ge instanceof u.ProjectivePoint?ge:u.ProjectivePoint.fromHex(ge)}function E(ge,Z){return ge instanceof u.ProjectivePoint?ge:u.hashToCurve(Mi("point",ge),Z)}function M(ge){return ge instanceof d.ProjectivePoint?ge:P.fromHex(ge)}function O(ge,Z){return ge instanceof d.ProjectivePoint?ge:d.hashToCurve(Mi("point",ge),Z)}function j(ge){return u.ProjectivePoint.fromPrivateKey(ge).toRawBytes(!0)}function R(ge){return d.ProjectivePoint.fromPrivateKey(ge).toRawBytes(!0)}function z(ge,Z,we){const Ee=O(ge,we);Ee.assertValidity();const Le=Ee.multiply(u.normPrivateKeyToScalar(Z));return ge instanceof d.ProjectivePoint?Le:P.toRawBytes(Le)}function B(ge,Z,we){const Ee=E(ge,we);Ee.assertValidity();const Le=Ee.multiply(u.normPrivateKeyToScalar(Z));return ge instanceof u.ProjectivePoint?Le:D.toRawBytes(Le)}function V(ge,Z,we,Ee){const Le=I(we),De=O(Z,Ee),Be=u.ProjectivePoint.BASE,se=M(ge),le=S([{g1:Le.negate(),g2:De},{g1:Be,g2:se}]);return i.eql(le,i.ONE)}function H(ge,Z,we,Ee){const Le=M(we),De=E(Z,Ee),Be=d.ProjectivePoint.BASE,se=I(ge),le=S([{g1:De,g2:Le},{g1:se,g2:Be.negate()}]);return i.eql(le,i.ONE)}function K(ge){if(!Array.isArray(ge)||ge.length===0)throw new Error("expected non-empty array")}function ne(ge){K(ge);const we=ge.map(I).reduce((Ee,Le)=>Ee.add(Le),u.ProjectivePoint.ZERO);return ge[0]instanceof u.ProjectivePoint?(we.assertValidity(),we):we.toRawBytes(!0)}function fe(ge){K(ge);const we=ge.map(M).reduce((Ee,Le)=>Ee.add(Le),d.ProjectivePoint.ZERO);return ge[0]instanceof d.ProjectivePoint?(we.assertValidity(),we):P.toRawBytes(we)}function ee(ge){K(ge);const we=ge.map(I).reduce((Ee,Le)=>Ee.add(Le),u.ProjectivePoint.ZERO);return ge[0]instanceof u.ProjectivePoint?(we.assertValidity(),we):D.toRawBytes(we)}function de(ge,Z,we,Ee){if(K(Z),we.length!==Z.length)throw new Error("amount of public keys and messages should be equal");const Le=M(ge),De=Z.map(ye=>O(ye,Ee)),Be=we.map(I),se=new Map;for(let ye=0;ye<Be.length;ye++){const ve=Be[ye],xe=De[ye];let Ie=se.get(xe);Ie===void 0&&(Ie=[],se.set(xe,Ie)),Ie.push(ve)}const le=[];try{for(const[ye,ve]of se){const xe=ve.reduce((Ie,te)=>Ie.add(te));le.push({g1:xe,g2:ye})}return le.push({g1:u.ProjectivePoint.BASE.negate(),g2:Le}),i.eql(S(le),i.ONE)}catch{return!1}}return u.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:j,getPublicKeyForShortSignatures:R,sign:z,signShortSignature:B,verify:V,verifyBatch:de,verifyShortSignature:H,aggregatePublicKeys:ne,aggregateSignatures:fe,aggregateShortSignatures:ee,millerLoopBatch:b,pairing:C,pairingBatch:S,G1:u,G2:d,Signature:P,ShortSignature:D,fields:{Fr:n,Fp:e,Fp2:r,Fp6:s,Fp12:i},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:T}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Yce=BigInt(0),Sg=BigInt(1),fc=BigInt(2),MB=BigInt(3);function AA(t,e,n,r,s=1,i){const o=BigInt(i===void 0?r:i),a=n**BigInt(r),l=[];for(let u=0;u<s;u++){const c=BigInt(u+1),d=[];for(let h=0,f=Sg;h<r;h++){const m=(c*f-c)/o%a;d.push(t.pow(e,m)),f*=n}l.push(d)}return l}function Kce(t,e,n){const r=e.pow(n,(t.ORDER-Sg)/MB),s=e.pow(n,(t.ORDER-Sg)/fc);function i(h,f){const m=e.mul(e.frobeniusMap(h,1),r),g=e.mul(e.frobeniusMap(f,1),s);return[m,g]}const o=e.pow(n,(t.ORDER**fc-Sg)/MB),a=e.pow(n,(t.ORDER**fc-Sg)/fc);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function l(h,f){return[e.mul(h,o),e.neg(f)]}const u=h=>(f,m)=>{const g=m.toAffine(),x=h(g.x,g.y);return f.fromAffine({x:x[0],y:x[1]})},c=u(i),d=u(l);return{psi:i,psi2:l,G2psi:c,G2psi2:d,PSI_X:r,PSI_Y:s,PSI2_X:o,PSI2_Y:a}}function qce(t){const{ORDER:e}=t,n=O1(e),r=n.create(t.NONRESIDUE||BigInt(-1)),s=Dce(e),i=n.div(n.ONE,fc),o=AA(n,r,n.ORDER,2)[0],a=({c0:R,c1:z},{c0:B,c1:V})=>({c0:n.add(R,B),c1:n.add(z,V)}),l=({c0:R,c1:z},{c0:B,c1:V})=>({c0:n.sub(R,B),c1:n.sub(z,V)}),u=({c0:R,c1:z},B)=>{if(typeof B=="bigint")return{c0:n.mul(R,B),c1:n.mul(z,B)};const{c0:V,c1:H}=B;let K=n.mul(R,V),ne=n.mul(z,H);const fe=n.sub(K,ne),ee=n.sub(n.mul(n.add(R,z),n.add(V,H)),n.add(K,ne));return{c0:fe,c1:ee}},c=({c0:R,c1:z})=>{const B=n.add(R,z),V=n.sub(R,z),H=n.add(R,R);return{c0:n.mul(B,V),c1:n.mul(H,z)}},d=R=>{if(R.length!==2)throw new Error("invalid tuple");const z=R.map(B=>n.create(B));return{c0:z[0],c1:z[1]}},h=e*e,f=d(t.FP2_NONRESIDUE),m={ORDER:h,isLE:n.isLE,NONRESIDUE:f,BITS:Sw(h),BYTES:Math.ceil(Sw(h)/8),MASK:LS(Sw(h)),ZERO:{c0:n.ZERO,c1:n.ZERO},ONE:{c0:n.ONE,c1:n.ZERO},create:R=>R,isValid:({c0:R,c1:z})=>typeof R=="bigint"&&typeof z=="bigint",is0:({c0:R,c1:z})=>n.is0(R)&&n.is0(z),eql:({c0:R,c1:z},{c0:B,c1:V})=>n.eql(R,B)&&n.eql(z,V),neg:({c0:R,c1:z})=>({c0:n.neg(R),c1:n.neg(z)}),pow:(R,z)=>zS(m,R,z),invertBatch:R=>BS(m,R),add:a,sub:l,mul:u,sqr:c,addN:a,subN:l,mulN:u,sqrN:c,div:(R,z)=>m.mul(R,typeof z=="bigint"?n.inv(n.create(z)):m.inv(z)),inv:({c0:R,c1:z})=>{const B=n.inv(n.create(R*R+z*z));return{c0:n.mul(B,n.create(R)),c1:n.mul(B,n.create(-z))}},sqrt:R=>{if(t.Fp2sqrt)return t.Fp2sqrt(R);const{c0:z,c1:B}=R;if(n.is0(B))return n.eql(s(n,z),n.ONE)?m.create({c0:n.sqrt(z),c1:n.ZERO}):m.create({c0:n.ZERO,c1:n.sqrt(n.div(z,r))});const V=n.sqrt(n.sub(n.sqr(z),n.mul(n.sqr(B),r)));let H=n.mul(n.add(V,z),i);const K=s(n,H);!n.is0(K)&&!n.eql(K,n.ONE)&&(H=n.sub(H,V));const ne=n.sqrt(H),fe=m.create({c0:ne,c1:n.div(n.mul(B,i),ne)});if(!m.eql(m.sqr(fe),R))throw new Error("Cannot find square root");const ee=fe,de=m.neg(ee),{re:ge,im:Z}=m.reim(ee),{re:we,im:Ee}=m.reim(de);return Z>Ee||Z===Ee&&ge>we?ee:de},isOdd:R=>{const{re:z,im:B}=m.reim(R),V=z%fc,H=z===Yce,K=B%fc;return BigInt(V||H&&K)==Sg},fromBytes(R){if(R.length!==m.BYTES)throw new Error("fromBytes invalid length="+R.length);return{c0:n.fromBytes(R.subarray(0,n.BYTES)),c1:n.fromBytes(R.subarray(n.BYTES))}},toBytes:({c0:R,c1:z})=>Qr(n.toBytes(R),n.toBytes(z)),cmov:({c0:R,c1:z},{c0:B,c1:V},H)=>({c0:n.cmov(R,B,H),c1:n.cmov(z,V,H)}),reim:({c0:R,c1:z})=>({re:R,im:z}),mulByNonresidue:({c0:R,c1:z})=>m.mul({c0:R,c1:z},f),mulByB:t.Fp2mulByB,fromBigTuple:d,frobeniusMap:({c0:R,c1:z},B)=>({c0:R,c1:n.mul(z,o[B%2])})},g=({c0:R,c1:z,c2:B},{c0:V,c1:H,c2:K})=>({c0:m.add(R,V),c1:m.add(z,H),c2:m.add(B,K)}),x=({c0:R,c1:z,c2:B},{c0:V,c1:H,c2:K})=>({c0:m.sub(R,V),c1:m.sub(z,H),c2:m.sub(B,K)}),w=({c0:R,c1:z,c2:B},V)=>{if(typeof V=="bigint")return{c0:m.mul(R,V),c1:m.mul(z,V),c2:m.mul(B,V)};const{c0:H,c1:K,c2:ne}=V,fe=m.mul(R,H),ee=m.mul(z,K),de=m.mul(B,ne);return{c0:m.add(fe,m.mulByNonresidue(m.sub(m.mul(m.add(z,B),m.add(K,ne)),m.add(ee,de)))),c1:m.add(m.sub(m.mul(m.add(R,z),m.add(H,K)),m.add(fe,ee)),m.mulByNonresidue(de)),c2:m.sub(m.add(ee,m.mul(m.add(R,B),m.add(H,ne))),m.add(fe,de))}},b=({c0:R,c1:z,c2:B})=>{let V=m.sqr(R),H=m.mul(m.mul(R,z),fc),K=m.mul(m.mul(z,B),fc),ne=m.sqr(B);return{c0:m.add(m.mulByNonresidue(K),V),c1:m.add(m.mulByNonresidue(ne),H),c2:m.sub(m.sub(m.add(m.add(H,m.sqr(m.add(m.sub(R,z),B))),K),V),ne)}},[S,C]=AA(m,f,n.ORDER,6,2,3),T={ORDER:m.ORDER,isLE:m.isLE,BITS:3*m.BITS,BYTES:3*m.BYTES,MASK:LS(3*m.BITS),ZERO:{c0:m.ZERO,c1:m.ZERO,c2:m.ZERO},ONE:{c0:m.ONE,c1:m.ZERO,c2:m.ZERO},create:R=>R,isValid:({c0:R,c1:z,c2:B})=>m.isValid(R)&&m.isValid(z)&&m.isValid(B),is0:({c0:R,c1:z,c2:B})=>m.is0(R)&&m.is0(z)&&m.is0(B),neg:({c0:R,c1:z,c2:B})=>({c0:m.neg(R),c1:m.neg(z),c2:m.neg(B)}),eql:({c0:R,c1:z,c2:B},{c0:V,c1:H,c2:K})=>m.eql(R,V)&&m.eql(z,H)&&m.eql(B,K),sqrt:CB,div:(R,z)=>T.mul(R,typeof z=="bigint"?n.inv(n.create(z)):T.inv(z)),pow:(R,z)=>zS(T,R,z),invertBatch:R=>BS(T,R),add:g,sub:x,mul:w,sqr:b,addN:g,subN:x,mulN:w,sqrN:b,inv:({c0:R,c1:z,c2:B})=>{let V=m.sub(m.sqr(R),m.mulByNonresidue(m.mul(B,z))),H=m.sub(m.mulByNonresidue(m.sqr(B)),m.mul(R,z)),K=m.sub(m.sqr(z),m.mul(R,B)),ne=m.inv(m.add(m.mulByNonresidue(m.add(m.mul(B,H),m.mul(z,K))),m.mul(R,V)));return{c0:m.mul(ne,V),c1:m.mul(ne,H),c2:m.mul(ne,K)}},fromBytes:R=>{if(R.length!==T.BYTES)throw new Error("fromBytes invalid length="+R.length);return{c0:m.fromBytes(R.subarray(0,m.BYTES)),c1:m.fromBytes(R.subarray(m.BYTES,2*m.BYTES)),c2:m.fromBytes(R.subarray(2*m.BYTES))}},toBytes:({c0:R,c1:z,c2:B})=>Qr(m.toBytes(R),m.toBytes(z),m.toBytes(B)),cmov:({c0:R,c1:z,c2:B},{c0:V,c1:H,c2:K},ne)=>({c0:m.cmov(R,V,ne),c1:m.cmov(z,H,ne),c2:m.cmov(B,K,ne)}),fromBigSix:R=>{if(!Array.isArray(R)||R.length!==6)throw new Error("invalid Fp6 usage");return{c0:m.fromBigTuple(R.slice(0,2)),c1:m.fromBigTuple(R.slice(2,4)),c2:m.fromBigTuple(R.slice(4,6))}},frobeniusMap:({c0:R,c1:z,c2:B},V)=>({c0:m.frobeniusMap(R,V),c1:m.mul(m.frobeniusMap(z,V),S[V%6]),c2:m.mul(m.frobeniusMap(B,V),C[V%6])}),mulByFp2:({c0:R,c1:z,c2:B},V)=>({c0:m.mul(R,V),c1:m.mul(z,V),c2:m.mul(B,V)}),mulByNonresidue:({c0:R,c1:z,c2:B})=>({c0:m.mulByNonresidue(B),c1:R,c2:z}),mul1:({c0:R,c1:z,c2:B},V)=>({c0:m.mulByNonresidue(m.mul(B,V)),c1:m.mul(R,V),c2:m.mul(z,V)}),mul01({c0:R,c1:z,c2:B},V,H){let K=m.mul(R,V),ne=m.mul(z,H);return{c0:m.add(m.mulByNonresidue(m.sub(m.mul(m.add(z,B),H),ne)),K),c1:m.sub(m.sub(m.mul(m.add(V,H),m.add(R,z)),K),ne),c2:m.add(m.sub(m.mul(m.add(R,B),V),K),ne)}}},D=AA(m,f,n.ORDER,12,1,6)[0],P=({c0:R,c1:z},{c0:B,c1:V})=>({c0:T.add(R,B),c1:T.add(z,V)}),I=({c0:R,c1:z},{c0:B,c1:V})=>({c0:T.sub(R,B),c1:T.sub(z,V)}),E=({c0:R,c1:z},B)=>{if(typeof B=="bigint")return{c0:T.mul(R,B),c1:T.mul(z,B)};let{c0:V,c1:H}=B,K=T.mul(R,V),ne=T.mul(z,H);return{c0:T.add(K,T.mulByNonresidue(ne)),c1:T.sub(T.mul(T.add(R,z),T.add(V,H)),T.add(K,ne))}},M=({c0:R,c1:z})=>{let B=T.mul(R,z);return{c0:T.sub(T.sub(T.mul(T.add(T.mulByNonresidue(z),R),T.add(R,z)),B),T.mulByNonresidue(B)),c1:T.add(B,B)}};function O(R,z){const B=m.sqr(R),V=m.sqr(z);return{first:m.add(m.mulByNonresidue(V),B),second:m.sub(m.sub(m.sqr(m.add(R,z)),B),V)}}const j={ORDER:m.ORDER,isLE:T.isLE,BITS:2*m.BITS,BYTES:2*m.BYTES,MASK:LS(2*m.BITS),ZERO:{c0:T.ZERO,c1:T.ZERO},ONE:{c0:T.ONE,c1:T.ZERO},create:R=>R,isValid:({c0:R,c1:z})=>T.isValid(R)&&T.isValid(z),is0:({c0:R,c1:z})=>T.is0(R)&&T.is0(z),neg:({c0:R,c1:z})=>({c0:T.neg(R),c1:T.neg(z)}),eql:({c0:R,c1:z},{c0:B,c1:V})=>T.eql(R,B)&&T.eql(z,V),sqrt:CB,inv:({c0:R,c1:z})=>{let B=T.inv(T.sub(T.sqr(R),T.mulByNonresidue(T.sqr(z))));return{c0:T.mul(R,B),c1:T.neg(T.mul(z,B))}},div:(R,z)=>j.mul(R,typeof z=="bigint"?n.inv(n.create(z)):j.inv(z)),pow:(R,z)=>zS(j,R,z),invertBatch:R=>BS(j,R),add:P,sub:I,mul:E,sqr:M,addN:P,subN:I,mulN:E,sqrN:M,fromBytes:R=>{if(R.length!==j.BYTES)throw new Error("fromBytes invalid length="+R.length);return{c0:T.fromBytes(R.subarray(0,T.BYTES)),c1:T.fromBytes(R.subarray(T.BYTES))}},toBytes:({c0:R,c1:z})=>Qr(T.toBytes(R),T.toBytes(z)),cmov:({c0:R,c1:z},{c0:B,c1:V},H)=>({c0:T.cmov(R,B,H),c1:T.cmov(z,V,H)}),fromBigTwelve:R=>({c0:T.fromBigSix(R.slice(0,6)),c1:T.fromBigSix(R.slice(6,12))}),frobeniusMap(R,z){const{c0:B,c1:V,c2:H}=T.frobeniusMap(R.c1,z),K=D[z%12];return{c0:T.frobeniusMap(R.c0,z),c1:T.create({c0:m.mul(B,K),c1:m.mul(V,K),c2:m.mul(H,K)})}},mulByFp2:({c0:R,c1:z},B)=>({c0:T.mulByFp2(R,B),c1:T.mulByFp2(z,B)}),conjugate:({c0:R,c1:z})=>({c0:R,c1:T.neg(z)}),mul014:({c0:R,c1:z},B,V,H)=>{let K=T.mul01(R,B,V),ne=T.mul1(z,H);return{c0:T.add(T.mulByNonresidue(ne),K),c1:T.sub(T.sub(T.mul01(T.add(z,R),B,m.add(V,H)),K),ne)}},mul034:({c0:R,c1:z},B,V,H)=>{const K=T.create({c0:m.mul(R.c0,B),c1:m.mul(R.c1,B),c2:m.mul(R.c2,B)}),ne=T.mul01(z,V,H),fe=T.mul01(T.add(R,z),m.add(B,V),H);return{c0:T.add(T.mulByNonresidue(ne),K),c1:T.sub(fe,T.add(K,ne))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:n,Fp2:m,Fp6:T,Fp4Square:O,Fp12:j}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $i=BigInt(0),sI=BigInt(1),Is=BigInt(2),R2=BigInt(3),Cw=BigInt(4),Pd=BigInt("0xd201000000010000"),Xce=Sw(Pd),{Fp:At,Fp2:Lt,Fp6:$$,Fp4Square:$A,Fp12:pn}=qce({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[sI,sI],Fp2mulByB:({c0:t,c1:e})=>{const n=At.mul(t,Cw),r=At.mul(e,Cw);return{c0:At.sub(n,r),c1:At.add(n,r)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:n,c1:r,c2:s}=t,{c0:i,c1:o,c2:a}=e,{first:l,second:u}=$A(n,o),{first:c,second:d}=$A(i,s),{first:h,second:f}=$A(r,a),m=Lt.mulByNonresidue(f);return{c0:$$.create({c0:Lt.add(Lt.mul(Lt.sub(l,n),Is),l),c1:Lt.add(Lt.mul(Lt.sub(c,r),Is),c),c2:Lt.add(Lt.mul(Lt.sub(h,s),Is),h)}),c1:$$.create({c0:Lt.add(Lt.mul(Lt.add(m,i),Is),m),c1:Lt.add(Lt.mul(Lt.add(u,o),Is),u),c2:Lt.add(Lt.mul(Lt.add(d,a),Is),d)})}},Fp12cyclotomicExp(t,e){let n=pn.ONE;for(let r=Xce-1;r>=0;r--)n=pn._cyclotomicSquare(n),kce(e,r)&&(n=pn.mul(n,t));return n},Fp12finalExponentiate:t=>{const e=Pd,n=pn.div(pn.frobeniusMap(t,6),t),r=pn.mul(pn.frobeniusMap(n,2),n),s=pn.conjugate(pn._cyclotomicExp(r,e)),i=pn.mul(pn.conjugate(pn._cyclotomicSquare(r)),s),o=pn.conjugate(pn._cyclotomicExp(i,e)),a=pn.conjugate(pn._cyclotomicExp(o,e)),l=pn.mul(pn.conjugate(pn._cyclotomicExp(a,e)),pn._cyclotomicSquare(s)),u=pn.conjugate(pn._cyclotomicExp(l,e)),c=pn.frobeniusMap(pn.mul(s,a),2),d=pn.frobeniusMap(pn.mul(o,r),3),h=pn.frobeniusMap(pn.mul(l,pn.conjugate(r)),1),f=pn.mul(pn.mul(u,pn.conjugate(i)),r);return pn.mul(pn.mul(pn.mul(c,d),h),f)}}),DB=O1(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),Zce=mG(Lt,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>Lt.fromBigTuple(e.map(BigInt))))),Qce=mG(At,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),Jce=vG(Lt,{A:Lt.create({c0:At.create($i),c1:At.create(BigInt(240))}),B:Lt.create({c0:At.create(BigInt(1012)),c1:At.create(BigInt(1012))}),Z:Lt.create({c0:At.create(BigInt(-2)),c1:At.create(BigInt(-1))})}),ede=vG(At,{A:At.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:At.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:At.create(BigInt(11))}),{G2psi:OB,G2psi2:tde}=Kce(At,Lt,Lt.div(Lt.ONE,Lt.NONRESIDUE)),RA=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:At.ORDER,m:2,k:128,expand:"xmd",hash:nD}),iI=Gw(At.toBytes($i),{infinity:!0,compressed:!0});function M2(t){t=t.slice();const e=t[0]&224,n=!!(e>>7&1),r=!!(e>>6&1),s=!!(e>>5&1);return t[0]&=31,{compressed:n,infinity:r,sort:s,value:t}}function Gw(t,e){if(t[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function PB(t){t.assertValidity();const e=t.equals(ma.G1.ProjectivePoint.ZERO),{x:n,y:r}=t.toAffine();if(e)return iI.slice();const s=At.ORDER,i=!!(r*Is/s);return Gw(Us(n,At.BYTES),{compressed:!0,sort:i})}function FB(t){t.assertValidity();const e=At.BYTES;if(t.equals(ma.G2.ProjectivePoint.ZERO))return Qr(iI,Us($i,e));const{x:n,y:r}=t.toAffine(),{re:s,im:i}=Lt.reim(n),{re:o,im:a}=Lt.reim(r),u=!!((a>$i?a*Is:o*Is)/At.ORDER&sI),c=s;return Qr(Gw(Us(i,e),{sort:u,compressed:!0}),Us(c,e))}const ma=Hce({fields:{Fp:At,Fp2:Lt,Fp6:$$,Fp12:pn,Fr:DB},G1:{Fp:At,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:At.ZERO,b:Cw,htfDefaults:{...RA,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new t(At.mul(e.px,n),e.py,e.pz);return e.multiplyUnsafe(Pd).negate().multiplyUnsafe(Pd).equals(r)},clearCofactor:(t,e)=>e.multiplyUnsafe(Pd).add(e),mapToCurve:t=>{const{x:e,y:n}=ede(At.create(t[0]));return Qce(e,n)},fromBytes:t=>{const{compressed:e,infinity:n,sort:r,value:s}=M2(t);if(s.length===48&&e){const i=At.ORDER,o=ul(s),a=At.create(o&At.MASK);if(n){if(a!==$i)throw new Error("G1: non-empty compressed point at infinity");return{x:$i,y:$i}}const l=At.add(At.pow(a,R2),At.create(ma.params.G1b));let u=At.sqrt(l);if(!u)throw new Error("invalid compressed G1 point");return u*Is/i!==BigInt(r)&&(u=At.neg(u)),{x:At.create(a),y:At.create(u)}}else if(s.length===96&&!e){const i=ul(s.subarray(0,At.BYTES)),o=ul(s.subarray(At.BYTES));if(n){if(i!==$i||o!==$i)throw new Error("G1: non-empty point at infinity");return ma.G1.ProjectivePoint.ZERO.toAffine()}return{x:At.create(i),y:At.create(o)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(t,e,n)=>{const r=e.equals(t.ZERO),{x:s,y:i}=e.toAffine();if(n){if(r)return iI.slice();const o=At.ORDER,a=!!(i*Is/o);return Gw(Us(s,At.BYTES),{compressed:!0,sort:a})}else return r?Qr(new Uint8Array([64]),new Uint8Array(2*At.BYTES-1)):Qr(Us(s,At.BYTES),Us(i,At.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:n,value:r}=M2(Mi("signatureHex",t,48)),s=At.ORDER,i=ul(r);if(e)return ma.G1.ProjectivePoint.ZERO;const o=At.create(i&At.MASK),a=At.add(At.pow(o,R2),At.create(ma.params.G1b));let l=At.sqrt(a);if(!l)throw new Error("invalid compressed G1 point");const u=BigInt(n);l*Is/s!==u&&(l=At.neg(l));const c=ma.G1.ProjectivePoint.fromAffine({x:o,y:l});return c.assertValidity(),c},toRawBytes(t){return PB(t)},toHex(t){return dp(PB(t))}}},G2:{Fp:Lt,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:Lt.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:Lt.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:Lt.ZERO,b:Lt.fromBigTuple([Cw,Cw]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...RA},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:n}=Jce(Lt.fromBigTuple(t));return Zce(e,n)},isTorsionFree:(t,e)=>e.multiplyUnsafe(Pd).negate().equals(OB(t,e)),clearCofactor:(t,e)=>{const n=Pd;let r=e.multiplyUnsafe(n).negate(),s=OB(t,e),i=e.double();return i=tde(t,i),i=i.subtract(s),s=r.add(s),s=s.multiplyUnsafe(n).negate(),i=i.add(s),i=i.subtract(r),i.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:n,sort:r,value:s}=M2(t);if(!e&&!n&&r||!e&&n&&r||r&&n&&e)throw new Error("invalid encoding flag: "+(t[0]&224));const i=At.BYTES,o=(a,l,u)=>ul(a.slice(l,u));if(s.length===96&&e){const a=ma.params.G2b,l=At.ORDER;if(n){if(s.reduce((g,x)=>g!==0?x+1:x,0)>0)throw new Error("invalid compressed G2 point");return{x:Lt.ZERO,y:Lt.ZERO}}const u=o(s,0,i),c=o(s,i,2*i),d=Lt.create({c0:At.create(c),c1:At.create(u)}),h=Lt.add(Lt.pow(d,R2),a);let f=Lt.sqrt(h);const m=f.c1===$i?f.c0*Is/l:f.c1*Is/l?sI:$i;return f=r&&m>0?f:Lt.neg(f),{x:d,y:f}}else if(s.length===192&&!e){if(n){if(s.reduce((d,h)=>d!==0?h+1:h,0)>0)throw new Error("invalid uncompressed G2 point");return{x:Lt.ZERO,y:Lt.ZERO}}const a=o(s,0,i),l=o(s,i,2*i),u=o(s,2*i,3*i),c=o(s,3*i,4*i);return{x:Lt.fromBigTuple([l,a]),y:Lt.fromBigTuple([c,u])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(t,e,n)=>{const{BYTES:r,ORDER:s}=At,i=e.equals(t.ZERO),{x:o,y:a}=e.toAffine();if(n){if(i)return Qr(iI,Us($i,r));const l=!!(a.c1===$i?a.c0*Is/s:a.c1*Is/s);return Qr(Gw(Us(o.c1,r),{compressed:!0,sort:l}),Us(o.c0,r))}else{if(i)return Qr(new Uint8Array([64]),new Uint8Array(4*r-1));const{re:l,im:u}=Lt.reim(o),{re:c,im:d}=Lt.reim(a);return Qr(Us(u,r),Us(l,r),Us(d,r),Us(c,r))}},Signature:{fromHex(t){const{infinity:e,sort:n,value:r}=M2(Mi("signatureHex",t)),s=At.ORDER,i=r.length/2;if(i!==48&&i!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const o=ul(r.slice(0,i)),a=ul(r.slice(i));if(e)return ma.G2.ProjectivePoint.ZERO;const l=At.create(o&At.MASK),u=At.create(a),c=Lt.create({c0:u,c1:l}),d=Lt.add(Lt.pow(c,R2),ma.params.G2b);let h=Lt.sqrt(d);if(!h)throw new Error("Failed to find a square root");const{re:f,im:m}=Lt.reim(h),g=BigInt(n),x=m>$i&&m*Is/s!==g,w=m===$i&&f*Is/s!==g;(x||w)&&(h=Lt.neg(h));const b=ma.G2.ProjectivePoint.fromAffine({x:c,y:h});return b.assertValidity(),b},toRawBytes(t){return FB(t)},toHex(t){return dp(FB(t))}}},params:{ateLoopSize:Pd,r:DB.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:RA,hash:nD,randomBytes:h9});function nde(t,e,n){const r=typeof t=="string"?t:On(t),s=typeof e=="string"?e:On(e),i=typeof n=="string"?n:On(n);return ma.verifyShortSignature(s,i,r)}const SG=t=>ps(new Lp(t)),fD=t=>{const e=SG(t);return new Date(Number(e)/1e6)};var rde=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},sde=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},US;class iu extends Tr{constructor(e){super(`Invalid certificate: ${e}`)}}var zo;(function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"})(zo||(zo={}));function ide(t,e){const n=new Uint8Array(t),r=new Uint8Array(e);for(let s=0;s<n.length;s++)if(n[s]>r[s])return!0;return!1}class vc{constructor(e,n,r,s,i=5,o=!1){this._rootKey=n,this._canisterId=r,this._blsVerify=s,this._maxAgeInMinutes=i,US.set(this,!1),rde(this,US,o,"f"),this.cert=du(new Uint8Array(e))}static async create(e){const n=vc.createUnverified(e);return await n.verify(),n}static createUnverified(e){let n=e.blsVerify;return n||(n=nde),new vc(e.certificate,e.rootKey,e.canisterId,n,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return Vg(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await VS(this.cert.tree),n=await this._checkDelegationAndGetKey(this.cert.delegation),r=this.cert.signature,s=ade(n),i=xl(jx("ic-state-root"),e);let o=!1;const a=Bo(this.lookup(["time"]));if(!a)throw new iu("Certificate does not contain a time");if(!sde(this,US,"f")){const u=this._maxAgeInMinutes*60*1e3,c=Date.now(),d=c-u,h=c+3e5,f=fD(a);if(f.getTime()<d)throw new iu(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+f.toISOString()+" Current time: "+new Date(c).toISOString());if(f.getTime()>h)throw new iu("Certificate is signed more than 5 minutes in the future. Certificate time: "+f.toISOString()+" Current time: "+new Date(c).toISOString())}try{o=await this._blsVerify(new Uint8Array(s),new Uint8Array(r),new Uint8Array(i))}catch{o=!1}if(!o)throw new iu("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const n=await vc.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(n.cert.delegation)throw new iu("Delegation certificates cannot be nested");if(await n.verify(),this._canisterId.toString()!==ehe&&!CG({canisterId:this._canisterId,subnetId:zt.fromUint8Array(new Uint8Array(e.subnet_id)),tree:n.cert.tree}))throw new iu(`Canister ${this._canisterId} not in range of delegations for subnet 0x${On(e.subnet_id)}`);const r=Bo(n.lookup(["subnet",e.subnet_id,"public_key"]));if(!r)throw new Error(`Could not find subnet key for subnet 0x${On(e.subnet_id)}`);return r}}US=new WeakMap;const bx=gu("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),ode=96;function ade(t){const e=bx.byteLength+ode;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const n=t.slice(0,bx.byteLength);if(!R1(n,bx))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${bx}, but get ${n}`);return t.slice(bx.byteLength)}function Bo(t){if(t.status===kr.Found){if(t.value instanceof ArrayBuffer)return t.value;if(t.value instanceof Uint8Array)return t.value.buffer}}async function VS(t){switch(t[0]){case zo.Empty:return fl(jx("ic-hashtree-empty"));case zo.Pruned:return t[1];case zo.Leaf:return fl(xl(jx("ic-hashtree-leaf"),t[1]));case zo.Labeled:return fl(xl(jx("ic-hashtree-labeled"),t[1],await VS(t[2])));case zo.Fork:return fl(xl(jx("ic-hashtree-fork"),await VS(t[1]),await VS(t[2])));default:throw new Error("unreachable")}}function jx(t){const e=new Uint8Array([t.length]),n=new TextEncoder().encode(t);return xl(e,n)}var kr;(function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"})(kr||(kr={}));var pc;(function(t){t.Less="less",t.Greater="greater"})(pc||(pc={}));function Vg(t,e){if(t.length===0)switch(e[0]){case zo.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:kr.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:kr.Found,value:e[1].buffer}:{status:kr.Found,value:e[1]}}default:return{status:kr.Found,value:e}}const n=typeof t[0]=="string"?new TextEncoder().encode(t[0]):t[0],r=jS(n,e);switch(r.status){case kr.Found:return Vg(t.slice(1),r.value);case pc.Greater:case pc.Less:return{status:kr.Absent};default:return r}}function R$(t){switch(t[0]){case zo.Empty:return[];case zo.Fork:return R$(t[1]).concat(R$(t[2]));default:return[t]}}function jS(t,e){switch(e[0]){case zo.Labeled:return ide(t,e[1])?{status:pc.Greater}:R1(t,e[1])?{status:kr.Found,value:e[2]}:{status:pc.Less};case zo.Fork:const n=jS(t,e[1]);switch(n.status){case pc.Greater:{const r=jS(t,e[2]);return r.status===pc.Less?{status:kr.Absent}:r}case kr.Unknown:{let r=jS(t,e[2]);return r.status===pc.Less?{status:kr.Unknown}:r}default:return n}case zo.Pruned:return{status:kr.Unknown};default:return{status:kr.Absent}}}function CG(t){const{canisterId:e,subnetId:n,tree:r}=t,s=Vg(["subnet",n.toUint8Array(),"canister_ranges"],r);if(s.status!==kr.Found||!(s.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${n}`);return du(s.value).map(l=>[zt.fromUint8Array(l[0]),zt.fromUint8Array(l[1])]).some(l=>l[0].ltEq(e)&&l[1].gtEq(e))}class lde{constructor(e,n,r){this.key=e,this.path=n,this.decodeStrategy=r}}const IG=async t=>{const{agent:e,paths:n}=t,r=zt.from(t.canisterId),s=[...new Set(n)],i=s.map(l=>M$(l,r)),o=new Map,a=s.map((l,u)=>(async()=>{var c;try{const d=await e.readState(r,{paths:[i[u]]});if(e.rootKey==null)throw new Error("Agent is missing root key");const h=await vc.create({certificate:d.certificate,rootKey:e.rootKey,canisterId:r,disableTimeVerification:!0}),f=(x,w)=>{if(w==="subnet"){if(e.rootKey==null)throw new Error("Agent is missing root key");const b=NG(d.certificate,r,e.rootKey);return{path:w,data:b}}else return{path:w,data:Bo(x.lookup(M$(w,r)))}},{path:m,data:g}=f(h,s[u]);if(!g)console.warn(`Expected to find result for path ${m}, but instead found nothing.`),typeof m=="string"?o.set(m,null):o.set(m.key,null);else switch(m){case"time":{o.set(m,fD(g));break}case"controllers":{o.set(m,cde(g));break}case"module_hash":{o.set(m,LB(g));break}case"subnet":{o.set(m,g);break}case"candid":{o.set(m,new TextDecoder().decode(g));break}default:if(typeof m!="string"&&"key"in m&&"path"in m)switch(m.decodeStrategy){case"raw":o.set(m.key,g);break;case"leb128":{o.set(m.key,SG(g));break}case"cbor":{o.set(m.key,kG(g));break}case"hex":{o.set(m.key,LB(g));break}case"utf-8":o.set(m.key,ude(g))}}}catch(d){if(!((c=d==null?void 0:d.message)===null||c===void 0)&&c.includes("Invalid certificate"))throw new Tr(d.message);typeof l!="string"&&"key"in l&&"path"in l?o.set(l.key,null):o.set(l,null),console.group(),console.warn(`Expected to find result for path ${l}, but instead found nothing.`),console.warn(d),console.groupEnd()}})());return await Promise.all(a),o},NG=(t,e,n)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const r=du(new Uint8Array(t)),s=r.tree;let i=r.delegation,o;if(i&&i.subnet_id?o=zt.fromUint8Array(new Uint8Array(i.subnet_id)):!i&&typeof n<"u"?(o=zt.selfAuthenticating(new Uint8Array(n)),i={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)}):(o=zt.selfAuthenticating(zt.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),i={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)}),!CG({canisterId:e,subnetId:o,tree:s}))throw new Error("Canister not in range");const l=Vg(["subnet",i.subnet_id,"node"],s);if(l.status!==kr.Found)throw new Error("Node not found");if(l.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const u=R$(l.value),c=new Map;return u.forEach(d=>{const h=zt.from(new Uint8Array(d[1])).toText(),f=Vg(["public_key"],d[2]);if(f.status!==kr.Found)throw new Error("Public key not found");const m=f.value;if(m.byteLength!==44)throw new Error("Invalid public key length");c.set(h,m)}),{subnetId:zt.fromUint8Array(new Uint8Array(i.subnet_id)).toText(),nodeKeys:c}},M$=(t,e)=>{const n=new TextEncoder,r=i=>new DataView(n.encode(i).buffer).buffer,s=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[r("time")];case"controllers":return[r("canister"),s,r("controllers")];case"module_hash":return[r("canister"),s,r("module_hash")];case"subnet":return[r("subnet")];case"candid":return[r("canister"),s,r("metadata"),r("candid:service")];default:if("key"in t&&"path"in t)if(typeof t.path=="string"||t.path instanceof ArrayBuffer){const i=t.path,o=typeof i=="string"?r(i):i;return[r("canister"),s,r("metadata"),o]}else return t.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},LB=t=>On(t),kG=t=>du(t),ude=t=>new TextDecoder().decode(t),cde=t=>kG(t).map(n=>zt.fromUint8Array(new Uint8Array(n))),dde=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:lde,encodePath:M$,fetchNodeKeys:NG,request:IG},Symbol.toStringTag,{value:"Module"})),D2=BigInt(2**32-1),D$=BigInt(32);function TG(t,e=!1){return e?{h:Number(t&D2),l:Number(t>>D$&D2)}:{h:Number(t>>D$&D2)|0,l:Number(t&D2)|0}}function hde(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=TG(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const fde=(t,e)=>BigInt(t>>>0)<<D$|BigInt(e>>>0),pde=(t,e,n)=>t>>>n,mde=(t,e,n)=>t<<32-n|e>>>n,gde=(t,e,n)=>t>>>n|e<<32-n,yde=(t,e,n)=>t<<32-n|e>>>n,xde=(t,e,n)=>t<<64-n|e>>>n-32,wde=(t,e,n)=>t>>>n-32|e<<64-n,bde=(t,e)=>e,vde=(t,e)=>t,Sde=(t,e,n)=>t<<n|e>>>32-n,Cde=(t,e,n)=>e<<n|t>>>32-n,Ide=(t,e,n)=>e<<n-32|t>>>64-n,Nde=(t,e,n)=>t<<n-32|e>>>64-n;function kde(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Tde=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Ede=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,_de=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),Ade=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,$de=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),Rde=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,ln={fromBig:TG,split:hde,toBig:fde,shrSH:pde,shrSL:mde,rotrSH:gde,rotrSL:yde,rotrBH:xde,rotrBL:wde,rotr32H:bde,rotr32L:vde,rotlSH:Sde,rotlSL:Cde,rotlBH:Ide,rotlBL:Nde,add:kde,add3L:Tde,add3H:Ede,add4L:_de,add4H:Ade,add5H:Rde,add5L:$de},[Mde,Dde]=ln.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),wd=new Uint32Array(80),bd=new Uint32Array(80);class Ode extends f9{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:l,Eh:u,El:c,Fh:d,Fl:h,Gh:f,Gl:m,Hh:g,Hl:x}=this;return[e,n,r,s,i,o,a,l,u,c,d,h,f,m,g,x]}set(e,n,r,s,i,o,a,l,u,c,d,h,f,m,g,x){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=l|0,this.Eh=u|0,this.El=c|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=m|0,this.Hh=g|0,this.Hl=x|0}process(e,n){for(let S=0;S<16;S++,n+=4)wd[S]=e.getUint32(n),bd[S]=e.getUint32(n+=4);for(let S=16;S<80;S++){const C=wd[S-15]|0,T=bd[S-15]|0,D=ln.rotrSH(C,T,1)^ln.rotrSH(C,T,8)^ln.shrSH(C,T,7),P=ln.rotrSL(C,T,1)^ln.rotrSL(C,T,8)^ln.shrSL(C,T,7),I=wd[S-2]|0,E=bd[S-2]|0,M=ln.rotrSH(I,E,19)^ln.rotrBH(I,E,61)^ln.shrSH(I,E,6),O=ln.rotrSL(I,E,19)^ln.rotrBL(I,E,61)^ln.shrSL(I,E,6),j=ln.add4L(P,O,bd[S-7],bd[S-16]),R=ln.add4H(j,D,M,wd[S-7],wd[S-16]);wd[S]=R|0,bd[S]=j|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:l,Dh:u,Dl:c,Eh:d,El:h,Fh:f,Fl:m,Gh:g,Gl:x,Hh:w,Hl:b}=this;for(let S=0;S<80;S++){const C=ln.rotrSH(d,h,14)^ln.rotrSH(d,h,18)^ln.rotrBH(d,h,41),T=ln.rotrSL(d,h,14)^ln.rotrSL(d,h,18)^ln.rotrBL(d,h,41),D=d&f^~d&g,P=h&m^~h&x,I=ln.add5L(b,T,P,Dde[S],bd[S]),E=ln.add5H(I,w,C,D,Mde[S],wd[S]),M=I|0,O=ln.rotrSH(r,s,28)^ln.rotrBH(r,s,34)^ln.rotrBH(r,s,39),j=ln.rotrSL(r,s,28)^ln.rotrBL(r,s,34)^ln.rotrBL(r,s,39),R=r&i^r&a^i&a,z=s&o^s&l^o&l;w=g|0,b=x|0,g=f|0,x=m|0,f=d|0,m=h|0,{h:d,l:h}=ln.add(u|0,c|0,E|0,M|0),u=a|0,c=l|0,a=i|0,l=o|0,i=r|0,o=s|0;const B=ln.add3L(M,j,z);r=ln.add3H(B,E,O,R),s=B|0}({h:r,l:s}=ln.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=ln.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l}=ln.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:u,l:c}=ln.add(this.Dh|0,this.Dl|0,u|0,c|0),{h:d,l:h}=ln.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:m}=ln.add(this.Fh|0,this.Fl|0,f|0,m|0),{h:g,l:x}=ln.add(this.Gh|0,this.Gl|0,g|0,x|0),{h:w,l:b}=ln.add(this.Hh|0,this.Hl|0,w|0,b|0),this.set(r,s,i,o,a,l,u,c,d,h,f,m,g,x,w,b)}roundClean(){wd.fill(0),bd.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Pde=tD(()=>new Ode);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qa=BigInt(0),to=BigInt(1),O2=BigInt(2),Fde=BigInt(8),Lde={zip215:!0};function zde(t){const e=bG(t);return D1(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Bde(t){const e=zde(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:l}=e,u=O2<<BigInt(a*8)-to,c=n.create,d=O1(e.n,e.nBitLength),h=e.uvRatio||((V,H)=>{try{return{isValid:!0,value:n.sqrt(V*n.inv(H))}}catch{return{isValid:!1,value:Qa}}}),f=e.adjustScalarBytes||(V=>V),m=e.domain||((V,H,K)=>{if(bw("phflag",K),H.length||K)throw new Error("Contexts/pre-hash are not supported");return V});function g(V,H){Vd("coordinate "+V,H,Qa,u)}function x(V){if(!(V instanceof S))throw new Error("ExtendedPoint expected")}const w=jw((V,H)=>{const{ex:K,ey:ne,ez:fe}=V,ee=V.is0();H==null&&(H=ee?Fde:n.inv(fe));const de=c(K*H),ge=c(ne*H),Z=c(fe*H);if(ee)return{x:Qa,y:to};if(Z!==to)throw new Error("invZ was invalid");return{x:de,y:ge}}),b=jw(V=>{const{a:H,d:K}=e;if(V.is0())throw new Error("bad point: ZERO");const{ex:ne,ey:fe,ez:ee,et:de}=V,ge=c(ne*ne),Z=c(fe*fe),we=c(ee*ee),Ee=c(we*we),Le=c(ge*H),De=c(we*c(Le+Z)),Be=c(Ee+c(K*c(ge*Z)));if(De!==Be)throw new Error("bad point: equation left != right (1)");const se=c(ne*fe),le=c(ee*de);if(se!==le)throw new Error("bad point: equation left != right (2)");return!0});class S{constructor(H,K,ne,fe){this.ex=H,this.ey=K,this.ez=ne,this.et=fe,g("x",H),g("y",K),g("z",ne),g("t",fe),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(H){if(H instanceof S)throw new Error("extended point not allowed");const{x:K,y:ne}=H||{};return g("x",K),g("y",ne),new S(K,ne,to,c(K*ne))}static normalizeZ(H){const K=n.invertBatch(H.map(ne=>ne.ez));return H.map((ne,fe)=>ne.toAffine(K[fe])).map(S.fromAffine)}static msm(H,K){return wG(S,d,H,K)}_setWindowSize(H){D.setWindowSize(this,H)}assertValidity(){b(this)}equals(H){x(H);const{ex:K,ey:ne,ez:fe}=this,{ex:ee,ey:de,ez:ge}=H,Z=c(K*ge),we=c(ee*fe),Ee=c(ne*ge),Le=c(de*fe);return Z===we&&Ee===Le}is0(){return this.equals(S.ZERO)}negate(){return new S(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){const{a:H}=e,{ex:K,ey:ne,ez:fe}=this,ee=c(K*K),de=c(ne*ne),ge=c(O2*c(fe*fe)),Z=c(H*ee),we=K+ne,Ee=c(c(we*we)-ee-de),Le=Z+de,De=Le-ge,Be=Z-de,se=c(Ee*De),le=c(Le*Be),ye=c(Ee*Be),ve=c(De*Le);return new S(se,le,ve,ye)}add(H){x(H);const{a:K,d:ne}=e,{ex:fe,ey:ee,ez:de,et:ge}=this,{ex:Z,ey:we,ez:Ee,et:Le}=H;if(K===BigInt(-1)){const q=c((ee-fe)*(we+Z)),ie=c((ee+fe)*(we-Z)),me=c(ie-q);if(me===Qa)return this.double();const je=c(de*O2*Le),He=c(ge*O2*Ee),Ge=He+je,Je=ie+q,N=He-je,k=c(Ge*me),$=c(Je*N),J=c(Ge*N),ce=c(me*Je);return new S(k,$,ce,J)}const De=c(fe*Z),Be=c(ee*we),se=c(ge*ne*Le),le=c(de*Ee),ye=c((fe+ee)*(Z+we)-De-Be),ve=le-se,xe=le+se,Ie=c(Be-K*De),te=c(ye*ve),L=c(xe*Ie),U=c(ye*Ie),re=c(ve*xe);return new S(te,L,re,U)}subtract(H){return this.add(H.negate())}wNAF(H){return D.wNAFCached(this,H,S.normalizeZ)}multiply(H){const K=H;Vd("scalar",K,to,r);const{p:ne,f:fe}=this.wNAF(K);return S.normalizeZ([ne,fe])[0]}multiplyUnsafe(H,K=S.ZERO){const ne=H;return Vd("scalar",ne,Qa,r),ne===Qa?T:this.is0()||ne===to?this:D.wNAFCachedUnsafe(this,ne,S.normalizeZ,K)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return D.unsafeLadder(this,r).is0()}toAffine(H){return w(this,H)}clearCofactor(){const{h:H}=e;return H===to?this:this.multiplyUnsafe(H)}static fromHex(H,K=!1){const{d:ne,a:fe}=e,ee=n.BYTES;H=Mi("pointHex",H,ee),bw("zip215",K);const de=H.slice(),ge=H[ee-1];de[ee-1]=ge&-129;const Z=vw(de),we=K?u:n.ORDER;Vd("pointHex.y",Z,Qa,we);const Ee=c(Z*Z),Le=c(Ee-to),De=c(ne*Ee-fe);let{isValid:Be,value:se}=h(Le,De);if(!Be)throw new Error("Point.fromHex: invalid y coordinate");const le=(se&to)===to,ye=(ge&128)!==0;if(!K&&se===Qa&&ye)throw new Error("Point.fromHex: x=0 and x_0=1");return ye!==le&&(se=c(-se)),S.fromAffine({x:se,y:Z})}static fromPrivateKey(H){return E(H).point}toRawBytes(){const{x:H,y:K}=this.toAffine(),ne=nI(K,n.BYTES);return ne[ne.length-1]|=H&to?128:0,ne}toHex(){return dp(this.toRawBytes())}}S.BASE=new S(e.Gx,e.Gy,to,c(e.Gx*e.Gy)),S.ZERO=new S(Qa,to,to,Qa);const{BASE:C,ZERO:T}=S,D=xG(S,a*8);function P(V){return Nr(V,r)}function I(V){return P(vw(V))}function E(V){const H=n.BYTES;V=Mi("private key",V,H);const K=Mi("hashed private key",i(V),2*H),ne=f(K.slice(0,H)),fe=K.slice(H,2*H),ee=I(ne),de=C.multiply(ee),ge=de.toRawBytes();return{head:ne,prefix:fe,scalar:ee,point:de,pointBytes:ge}}function M(V){return E(V).pointBytes}function O(V=new Uint8Array,...H){const K=Qr(...H);return I(i(m(K,Mi("context",V),!!s)))}function j(V,H,K={}){V=Mi("message",V),s&&(V=s(V));const{prefix:ne,scalar:fe,pointBytes:ee}=E(H),de=O(K.context,ne,V),ge=C.multiply(de).toRawBytes(),Z=O(K.context,ge,ee,V),we=P(de+Z*fe);Vd("signature.s",we,Qa,r);const Ee=Qr(ge,nI(we,n.BYTES));return Mi("result",Ee,n.BYTES*2)}const R=Lde;function z(V,H,K,ne=R){const{context:fe,zip215:ee}=ne,de=n.BYTES;V=Mi("signature",V,2*de),H=Mi("message",H),K=Mi("publicKey",K,de),ee!==void 0&&bw("zip215",ee),s&&(H=s(H));const ge=vw(V.slice(de,2*de));let Z,we,Ee;try{Z=S.fromHex(K,ee),we=S.fromHex(V.slice(0,de),ee),Ee=C.multiplyUnsafe(ge)}catch{return!1}if(!ee&&Z.isSmallOrder())return!1;const Le=O(fe,we.toRawBytes(),Z.toRawBytes(),H);return we.add(Z.multiplyUnsafe(Le)).subtract(Ee).clearCofactor().equals(S.ZERO)}return C._setWindowSize(8),{CURVE:e,getPublicKey:M,sign:j,verify:z,ExtendedPoint:S,utils:{getExtendedPublicKey:E,randomPrivateKey:()=>o(n.BYTES),precompute(V=8,H=S.BASE){return H._setWindowSize(V),H.multiply(BigInt(3)),H}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pD=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),zB=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Ude=BigInt(1),BB=BigInt(2);BigInt(3);const Vde=BigInt(5),jde=BigInt(8);function Wde(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=pD,a=t*t%i*t%i,l=Yl(a,BB,i)*a%i,u=Yl(l,Ude,i)*t%i,c=Yl(u,Vde,i)*u%i,d=Yl(c,e,i)*c%i,h=Yl(d,n,i)*d%i,f=Yl(h,r,i)*h%i,m=Yl(f,s,i)*f%i,g=Yl(m,s,i)*f%i,x=Yl(g,e,i)*c%i;return{pow_p_5_8:Yl(x,BB,i)*t%i,b2:a}}function Gde(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Hde(t,e){const n=pD,r=Nr(e*e*e,n),s=Nr(r*r*e,n),i=Wde(t*s).pow_p_5_8;let o=Nr(t*r*i,n);const a=Nr(e*o*o,n),l=o,u=Nr(o*zB,n),c=a===t,d=a===Nr(-t,n),h=a===Nr(-t*zB,n);return c&&(o=l),(d||h)&&(o=u),Rce(o,n)&&(o=Nr(-o,n)),{isValid:c||d,value:o}}const Yde=O1(pD,void 0,!0),Kde={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Yde,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:jde,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Pde,randomBytes:h9,adjustScalarBytes:Gde,uvRatio:Hde},eg=Bde(Kde);var UB=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},_i=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ii,Wx,EG,_G;class qde{constructor(e={}){ii.set(this,void 0),Wx.set(this,void 0),this[EG]=this.entries.bind(this),this[_G]="ExpirableMap";const{source:n=[],expirationTime:r=10*60*1e3}=e,s=Date.now();UB(this,ii,new Map([...n].map(([i,o])=>[i,{value:o,timestamp:s}])),"f"),UB(this,Wx,r,"f")}prune(){const e=Date.now();for(const[n,r]of _i(this,ii,"f").entries())e-r.timestamp>_i(this,Wx,"f")&&_i(this,ii,"f").delete(n);return this}set(e,n){this.prune();const r={value:n,timestamp:Date.now()};return _i(this,ii,"f").set(e,r),this}get(e){const n=_i(this,ii,"f").get(e);if(n!==void 0){if(Date.now()-n.timestamp>_i(this,Wx,"f")){_i(this,ii,"f").delete(e);return}return n.value}}clear(){_i(this,ii,"f").clear()}entries(){const e=_i(this,ii,"f").entries();return function*(){for(const[r,s]of e)yield[r,s.value]}()}values(){const e=_i(this,ii,"f").values();return function*(){for(const r of e)yield r.value}()}keys(){return _i(this,ii,"f").keys()}forEach(e,n){for(const[r,s]of _i(this,ii,"f").entries())e.call(n,s.value,r,this)}has(e){return _i(this,ii,"f").has(e)}delete(e){return _i(this,ii,"f").delete(e)}get size(){return _i(this,ii,"f").size}}ii=new WeakMap,Wx=new WeakMap,EG=Symbol.iterator,_G=Symbol.toStringTag;const VB=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},jB=(t,e,n)=>{if(n<=127)return t[e]=n,1;if(n<=255)return t[e]=129,t[e+1]=n,2;if(n<=65535)return t[e]=130,t[e+1]=n>>8,t[e+2]=n,3;if(n<=16777215)return t[e]=131,t[e+1]=n>>16,t[e+2]=n>>8,t[e+3]=n,4;throw new Error("Length too long (> 4 bytes)")},O$=(t,e)=>{if(t[e]<128)return 1;if(t[e]===128)throw new Error("Invalid length 0");if(t[e]===129)return 2;if(t[e]===130)return 3;if(t[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},Xde=(t,e)=>{const n=O$(t,e);if(n===1)return t[e];if(n===2)return t[e+1];if(n===3)return(t[e+1]<<8)+t[e+2];if(n===4)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const oI=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function AG(t,e){const n=2+VB(t.byteLength+1),r=e.byteLength+n+t.byteLength;let s=0;const i=new Uint8Array(1+VB(r)+r);return i[s++]=48,s+=jB(i,s,r),i.set(e,s),s+=e.byteLength,i[s++]=3,s+=jB(i,s,t.byteLength+1),i[s++]=0,i.set(new Uint8Array(t),s),i}const $G=(t,e)=>{let n=0;const r=(a,l)=>{if(s[n++]!==a)throw new Error("Expected: "+l)},s=new Uint8Array(t);if(r(48,"sequence"),n+=O$(s,n),!R1(s.slice(n,n+e.byteLength),e))throw new Error("Not the expected OID.");n+=e.byteLength,r(3,"bit string");const i=Xde(s,n)-1;n+=O$(s,n),r(0,"0 padding");const o=s.slice(n);if(i!==o.length)throw new Error(`DER payload mismatch: Expected length ${i} actual length ${o.length}`);return o};var WB=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},GB=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},WS,GS;let RG=class Gx{constructor(e){if(WS.set(this,void 0),GS.set(this,void 0),e.byteLength!==Gx.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");WB(this,WS,e,"f"),WB(this,GS,Gx.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new Gx(e)}static fromDer(e){return new Gx(this.derDecode(e))}static derEncode(e){return AG(e,oI).buffer}static derDecode(e){const n=$G(e,oI);if(n.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return n}get rawKey(){return GB(this,WS,"f")}get derKey(){return GB(this,GS,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};WS=new WeakMap,GS=new WeakMap;RG.RAW_KEY_LENGTH=32;class Zde{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(n=>n!==e)}notify(e,...n){this.observers.forEach(r=>r(e,...n))}}class Qde extends Zde{constructor(){super()}print(e,...n){this.notify({message:e,level:"info"},...n)}warn(e,...n){this.notify({message:e,level:"warn"},...n)}error(e,n,...r){this.notify({message:e,level:"error",error:n},...r)}}var Kl=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ni=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Zl,HS,YS,KS,qS,XS,ZS,QS,tg;const MG=.5,DG=1.5,OG=500,PG=6e4,FG=9e5,LG=10;class $N{constructor(e=$N.default){Zl.set(this,void 0),HS.set(this,void 0),YS.set(this,void 0),KS.set(this,void 0),qS.set(this,void 0),XS.set(this,void 0),ZS.set(this,void 0),QS.set(this,void 0),tg.set(this,0);const{initialInterval:n=OG,randomizationFactor:r=MG,multiplier:s=DG,maxInterval:i=PG,maxElapsedTime:o=FG,maxIterations:a=LG,date:l=Date}=e;Kl(this,Zl,n,"f"),Kl(this,HS,r,"f"),Kl(this,YS,s,"f"),Kl(this,KS,i,"f"),Kl(this,QS,l,"f"),Kl(this,qS,l.now(),"f"),Kl(this,XS,o,"f"),Kl(this,ZS,a,"f")}get ellapsedTimeInMsec(){return ni(this,QS,"f").now()-ni(this,qS,"f")}get currentInterval(){return ni(this,Zl,"f")}get count(){return ni(this,tg,"f")}get randomValueFromInterval(){const e=ni(this,HS,"f")*ni(this,Zl,"f"),n=ni(this,Zl,"f")-e,r=ni(this,Zl,"f")+e;return Math.random()*(r-n)+n}incrementCurrentInterval(){var e;return Kl(this,Zl,Math.min(ni(this,Zl,"f")*ni(this,YS,"f"),ni(this,KS,"f")),"f"),Kl(this,tg,(e=ni(this,tg,"f"),e++,e),"f"),ni(this,Zl,"f")}next(){return this.ellapsedTimeInMsec>=ni(this,XS,"f")||ni(this,tg,"f")>=ni(this,ZS,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}Zl=new WeakMap,HS=new WeakMap,YS=new WeakMap,KS=new WeakMap,qS=new WeakMap,XS=new WeakMap,ZS=new WeakMap,QS=new WeakMap,tg=new WeakMap;$N.default={initialInterval:OG,randomizationFactor:MG,multiplier:DG,maxInterval:PG,maxElapsedTime:FG,maxIterations:LG,date:Date};var Fs=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ht=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},li,Tf,Tg,Ql,ac,Cg,Hx,ng,tl,ll,Ef,_f,Yx,rg,sg,Af,Ff,zG,JS,eC,$f,lc;(function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"})(lc||(lc={}));const P2=60*1e3,Jde="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",ehe="aaaaa-aa",the="ic0.app",nhe=".ic0.app",rhe="icp0.io",she=".icp0.io",ihe="icp-api.io",ohe=".icp-api.io";class MA extends Tr{constructor(e){super(e),this.message=e}}class F2 extends Tr{constructor(e){super(e),this.message=e}}function ahe(){let t;if(typeof window<"u")if(window.fetch)t=window.fetch.bind(window);else throw new MA("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)t=global.fetch.bind(global);else throw new MA("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new MA("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function lhe(t){let e;if(t!==void 0)!t.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+t):e=new URL(t);else{const n=["ic0.app","icp0.io","127.0.0.1","localhost"],r=[".github.dev",".gitpod.io"],s=typeof window<"u"?window.location:void 0,i=s==null?void 0:s.hostname;let o;i&&typeof i=="string"&&(r.some(a=>i.endsWith(a))?o=i:o=n.find(a=>i.endsWith(a))),s&&o?e=new URL(`${s.protocol}//${o}${s.port?":"+s.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}class po{constructor(e={}){var n,r;li.add(this),Tf.set(this,null),Tg.set(this,!1),Ql.set(this,void 0),ac.set(this,void 0),Cg.set(this,void 0),Hx.set(this,void 0),ng.set(this,0),tl.set(this,void 0),ll.set(this,void 0),Ef.set(this,void 0),_f.set(this,void 0),this._isAgent=!0,this.config={},Yx.set(this,0),this.log=new Qde,rg.set(this,[]),sg.set(this,[]),Af.set(this,new qde({expirationTime:5*60*1e3})),Ff.set(this,!0),eC.set(this,(o,a)=>{if(ht(this,Ff,"f")===!1)return o;if(!a)throw new iu("Invalid signature from replica signed query: no matching node key found.");const{status:l,signatures:u=[],requestId:c}=o,d=new TextEncoder().encode("\vic-response");for(const h of u){const{timestamp:f,identity:m}=h,g=zt.fromUint8Array(m).toText();let x;if(l==="replied"){const{reply:T}=o;x=eI({status:l,reply:T,timestamp:BigInt(f),request_id:c})}else if(l==="rejected"){const{reject_code:T,reject_message:D,error_code:P}=o;x=eI({status:l,reject_code:T,reject_message:D,error_code:P,timestamp:BigInt(f),request_id:c})}else throw new Error(`Unknown status: ${l}`);const w=xl(d,new Uint8Array(x)),b=a==null?void 0:a.nodeKeys.get(g);if(!b)throw new iu("Invalid signature from replica signed query: no matching node key found.");const S=RG.fromDer(b).rawKey;if(eg.verify(h.signature,new Uint8Array(w),new Uint8Array(S)))return o;throw new iu(`Invalid signature from replica ${g} signed query.`)}return o}),this.config=e,Fs(this,ac,e.fetch||ahe()||fetch.bind(global),"f"),Fs(this,Cg,e.fetchOptions,"f"),Fs(this,Hx,e.callOptions,"f"),Fs(this,Tg,(n=e.shouldFetchRootKey)!==null&&n!==void 0?n:!1,"f"),e.rootKey?this.rootKey=e.rootKey:ht(this,Tg,"f")?this.rootKey=null:this.rootKey=gu(Jde);const s=lhe(e.host);this.host=new URL(s),e.verifyQuerySignatures!==void 0&&Fs(this,Ff,e.verifyQuerySignatures,"f"),Fs(this,ll,(r=e.retryTimes)!==null&&r!==void 0?r:3,"f");const i=()=>new $N({maxIterations:ht(this,ll,"f")});if(Fs(this,Ef,e.backoffStrategy||i,"f"),this.host.hostname.endsWith(nhe)?this.host.hostname=the:this.host.hostname.endsWith(she)?this.host.hostname=rhe:this.host.hostname.endsWith(ohe)&&(this.host.hostname=ihe),e.credentials){const{name:o,password:a}=e.credentials;Fs(this,tl,`${o}${a?":"+a:""}`,"f")}if(Fs(this,Ql,Promise.resolve(e.identity||new Jd),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new Tr(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new Tr(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);Fs(this,_f,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",vB(_$)),e.useQueryNonces&&this.addTransform("query",vB(_$)),e.logToConsole&&this.log.subscribe(o=>{o.level==="error"?console.error(o.message):o.level==="warn"?console.warn(o.message):console.log(o.message)})}get waterMark(){return ht(this,Yx,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const n=po.createSync(e),r=[n.syncTime()];return n.host.toString()!=="https://icp-api.io"&&e.shouldFetchRootKey&&r.push(n.fetchRootKey()),await Promise.all(r),n}static async from(e){var n;try{return"config"in e?await po.create(e.config):await po.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:(n=e._identity)!==null&&n!==void 0?n:void 0})}catch{throw new Tr("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,n,r=n.priority||0){if(e==="update"){const s=ht(this,sg,"f").findIndex(i=>(i.priority||0)<r);ht(this,sg,"f").splice(s>=0?s:ht(this,sg,"f").length,0,Object.assign(n,{priority:r}))}else if(e==="query"){const s=ht(this,rg,"f").findIndex(i=>(i.priority||0)<r);ht(this,rg,"f").splice(s>=0?s:ht(this,rg,"f").length,0,Object.assign(n,{priority:r}))}}async getPrincipal(){if(!ht(this,Ql,"f"))throw new F2("This identity has expired due this application's security policy. Please refresh your authentication.");return(await ht(this,Ql,"f")).getPrincipal()}async call(e,n,r){var s,i;await ht(this,li,"m",$f).call(this);const o=(s=n.callSync)!==null&&s!==void 0?s:!0,a=await(r!==void 0?await r:await ht(this,Ql,"f"));if(!a)throw new F2("This identity has expired due this application's security policy. Please refresh your authentication.");const l=zt.from(e),u=n.effectiveCanisterId?zt.from(n.effectiveCanisterId):l,c=a.getPrincipal()||zt.anonymous();let d=new Ux(ht(this,_f,"f")*P2);Math.abs(ht(this,ng,"f"))>1e3*30&&(d=new Ux(ht(this,_f,"f")*P2+ht(this,ng,"f")));const h={request_type:tI.Call,canister_id:l,method_name:n.methodName,arg:n.arg,sender:c,ingress_expiry:d};let f=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ht(this,tl,"f")?{Authorization:"Basic "+btoa(ht(this,tl,"f"))}:{})},endpoint:"call",body:h});const m=f.body.nonce?g(f.body.nonce):void 0;h.nonce=m;function g(S){return new Uint8Array(S)}f=await a.transformRequest(f);const x=FS(f.body),w=ht(this,Ef,"f").call(this),b=cp(h);try{const S=()=>(this.log.print(`fetching "/api/v3/canister/${u.toText()}/call" with request:`,f),ht(this,ac,"f").call(this,""+new URL(`/api/v3/canister/${u.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,Hx,"f")),f.request),{body:x}))),C=()=>(this.log.print(`fetching "/api/v2/canister/${u.toText()}/call" with request:`,f),ht(this,ac,"f").call(this,""+new URL(`/api/v2/canister/${u.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,Hx,"f")),f.request),{body:x}))),D=await ht(this,li,"m",JS).call(this,{request:o?S:C,backoff:w,tries:0}),P=await D.arrayBuffer(),I=D.status===200&&P.byteLength>0?du(P):null;if(I&&"certificate"in I){const E=await this.parseTimeFromResponse({certificate:I.certificate});Fs(this,Yx,E,"f")}return{requestId:b,response:{ok:D.ok,status:D.status,statusText:D.statusText,body:I,headers:Vx(D.headers)},requestDetails:h}}catch(S){if(S.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},n),{callSync:!1}),r);const C=`Error while making call: ${(i=S.message)!==null&&i!==void 0?i:String(S)}`,T=new vce(C,S,On(b),On(f.body.sender_pubkey),On(f.body.sender_sig),String(f.body.content.ingress_expiry._value));throw this.log.error(C,T),T}}async query(e,n,r){var s,i,o,a;await ht(this,li,"m",$f).call(this);const l=ht(this,Ef,"f").call(this),u=n.effectiveCanisterId?zt.from(n.effectiveCanisterId):zt.from(e);this.log.print(`ecid ${u.toString()}`),this.log.print(`canisterId ${e.toString()}`);let c,d;const h=await(r!==void 0?r:ht(this,Ql,"f"));if(!h)throw new F2("This identity has expired due this application's security policy. Please refresh your authentication.");const f=zt.from(e),m=(h==null?void 0:h.getPrincipal())||zt.anonymous(),g={request_type:"query",canister_id:f,method_name:n.methodName,arg:n.arg,sender:m,ingress_expiry:new Ux(ht(this,_f,"f")*P2)},x=cp(g);c=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ht(this,tl,"f")?{Authorization:"Basic "+btoa(ht(this,tl,"f"))}:{})},endpoint:"read",body:g}),c=await(h==null?void 0:h.transformRequest(c));const w=FS(c.body),b={canister:f.toText(),ecid:u,transformedRequest:c,body:w,requestId:x,backoff:l,tries:0},S=async()=>({requestDetails:g,query:await ht(this,li,"m",zG).call(this,b)}),C=async()=>{if(!ht(this,Ff,"f"))return;const T=ht(this,Af,"f").get(u.toString());return T||(await this.fetchSubnetKeys(u.toString()),ht(this,Af,"f").get(u.toString()))};try{const[T,D]=await Promise.all([S(),C()]);d=T;const{requestDetails:P,query:I}=d,E=Object.assign(Object.assign({},I),{requestDetails:P});if(this.log.print("Query response:",E),!ht(this,Ff,"f"))return E;try{return ht(this,eC,"f").call(this,E,D)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),ht(this,Af,"f").delete(e.toString()),await this.fetchSubnetKeys(u.toString());const O=ht(this,Af,"f").get(e.toString());if(!O)throw new iu("Invalid signature from replica signed query: no matching node key found.");return ht(this,eC,"f").call(this,E,O)}}catch(T){const D=`Error while making call: ${(s=T.message)!==null&&s!==void 0?s:String(T)}`,P=new Sce(D,T,String(x),On((i=c==null?void 0:c.body)===null||i===void 0?void 0:i.sender_pubkey),On((o=c==null?void 0:c.body)===null||o===void 0?void 0:o.sender_sig),String((a=c==null?void 0:c.body)===null||a===void 0?void 0:a.content.ingress_expiry._value));throw this.log.error(D,P),P}}async createReadStateRequest(e,n){await ht(this,li,"m",$f).call(this);const r=await(n!==void 0?await n:await ht(this,Ql,"f"));if(!r)throw new F2("This identity has expired due this application's security policy. Please refresh your authentication.");const s=(r==null?void 0:r.getPrincipal())||zt.anonymous(),i=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ht(this,tl,"f")?{Authorization:"Basic "+btoa(ht(this,tl,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:s,ingress_expiry:new Ux(ht(this,_f,"f")*P2)}});return r==null?void 0:r.transformRequest(i)}async readState(e,n,r,s){var i,o,a,l;function u(g){for(const x of g.paths){const[w,b]=x,S=new TextEncoder().encode("request_status");if(R1(w,S))return b}}const c=u(n);await ht(this,li,"m",$f).call(this);const d=typeof e=="string"?zt.fromText(e):e,h=s??await this.createReadStateRequest(n,r),f=FS(h.body);this.log.print(`fetching "/api/v2/canister/${d}/read_state" with request:`,h);const m=ht(this,Ef,"f").call(this);try{const g=await ht(this,li,"m",JS).call(this,{request:()=>ht(this,ac,"f").call(this,""+new URL(`/api/v2/canister/${d.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,Cg,"f")),h.request),{body:f})),backoff:m,tries:0});if(!g.ok)throw new Error(`Server returned an error:
  Code: ${g.status} (${g.statusText})
  Body: ${await g.text()}
`);const x=du(await g.arrayBuffer());this.log.print("Read state response:",x);const w=await this.parseTimeFromResponse(x);return w>0&&(this.log.print("Read state response time:",w),Fs(this,Yx,w,"f")),x}catch(g){const x=`Caught exception while attempting to read state: ${(i=g.message)!==null&&i!==void 0?i:String(g)}`,w=new Cce(x,g,String(c),On((o=h==null?void 0:h.body)===null||o===void 0?void 0:o.sender_pubkey),On((a=h==null?void 0:h.body)===null||a===void 0?void 0:a.sender_sig),String((l=h==null?void 0:h.body)===null||l===void 0?void 0:l.content.ingress_expiry._value));throw this.log.error(x,w),w}}async parseTimeFromResponse(e){let n;if(e.certificate){const r=du(e.certificate);if(r&&"tree"in r)n=r.tree;else throw new Error("Could not decode time from response");const s=Vg(["time"],n);if(s.status!==kr.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(s.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(s))throw new Error("Time was not found in the response or was not in its expected format.");const i=fD(sD(s.value));return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",Number(i)),Number(i)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){await ht(this,li,"m",$f).call(this);const n=await Aue(()=>Promise.resolve().then(()=>dde),[]),r=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const s=po.createSync({identity:new Jd,host:this.host.toString(),fetch:ht(this,ac,"f"),retryTimes:0}),o=(await n.request({canisterId:e??zt.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:s,paths:["time"]})).get("time");o&&(Fs(this,ng,Number(o)-Number(r),"f"),this.log.notify({message:`Syncing time: offset of ${ht(this,ng,"f")}`,level:"info"}))}catch(s){this.log.error("Caught exception while attempting to sync time",s)}}async status(){const e=ht(this,tl,"f")?{Authorization:"Basic "+btoa(ht(this,tl,"f"))}:{};this.log.print('fetching "/api/v2/status"');const n=ht(this,Ef,"f").call(this),r=await ht(this,li,"m",JS).call(this,{backoff:n,request:()=>ht(this,ac,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},ht(this,Cg,"f"))),tries:0});return du(await r.arrayBuffer())}async fetchRootKey(){let e;return ht(this,Tf,"f")?e=await ht(this,Tf,"f"):(Fs(this,Tf,new Promise((n,r)=>{this.status().then(s=>{const i=s.root_key;this.rootKey=i,n(i)}).catch(r)}),"f"),e=await ht(this,Tf,"f")),Fs(this,Tf,null,"f"),e}invalidateIdentity(){Fs(this,Ql,null,"f")}replaceIdentity(e){Fs(this,Ql,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await ht(this,li,"m",$f).call(this);const n=zt.from(e),s=(await IG({canisterId:n,paths:["subnet"],agent:this})).get("subnet");if(s&&typeof s=="object"&&"nodeKeys"in s)return ht(this,Af,"f").set(n.toText(),s),s}_transform(e){let n=Promise.resolve(e);if(e.endpoint==="call")for(const r of ht(this,sg,"f"))n=n.then(s=>r(s).then(i=>i||s));else for(const r of ht(this,rg,"f"))n=n.then(s=>r(s).then(i=>i||s));return n}}Tf=new WeakMap,Tg=new WeakMap,Ql=new WeakMap,ac=new WeakMap,Cg=new WeakMap,Hx=new WeakMap,ng=new WeakMap,tl=new WeakMap,ll=new WeakMap,Ef=new WeakMap,_f=new WeakMap,Yx=new WeakMap,rg=new WeakMap,sg=new WeakMap,Af=new WeakMap,Ff=new WeakMap,eC=new WeakMap,li=new WeakSet,zG=async function t(e){var n,r;const{ecid:s,transformedRequest:i,body:o,requestId:a,backoff:l,tries:u}=e,c=u===0?0:l.next();if(this.log.print(`fetching "/api/v2/canister/${s.toString()}/query" with tries:`,{tries:u,backoff:l,delay:c}),c===null)throw new Tr(`Timestamp failed to pass the watermark after retrying the configured ${ht(this,ll,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);c>0&&await new Promise(m=>setTimeout(m,c));let d;try{this.log.print(`fetching "/api/v2/canister/${s.toString()}/query" with request:`,i);const m=await ht(this,ac,"f").call(this,""+new URL(`/api/v2/canister/${s.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},ht(this,Cg,"f")),i.request),{body:o}));if(m.status===200){const g=du(await m.arrayBuffer());d=Object.assign(Object.assign({},g),{httpDetails:{ok:m.ok,status:m.status,statusText:m.statusText,headers:Vx(m.headers)},requestId:a})}else throw new IA(`Gateway returned an error:
  Code: ${m.status} (${m.statusText})
  Body: ${await m.text()}
`,{ok:m.ok,status:m.status,statusText:m.statusText,headers:Vx(m.headers)})}catch(m){if(u<ht(this,ll,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${m}
  Retrying query.`),await ht(this,li,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw m}const h=(r=(n=d.signatures)===null||n===void 0?void 0:n[0])===null||r===void 0?void 0:r.timestamp;if(!ht(this,Ff,"f"))return d;if(!h)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const f=Number(BigInt(h)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:f}),Number(this.waterMark)>f){const m=new Tr("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",m,{timestamp:h,waterMark:this.waterMark}),u<ht(this,ll,"f"))return await ht(this,li,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw new Tr(`Timestamp failed to pass the watermark after retrying the configured ${ht(this,ll,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return d},JS=async function t(e){const{request:n,backoff:r,tries:s}=e,i=s===0?0:r.next();if(i===null)throw new Tr(`Timestamp failed to pass the watermark after retrying the configured ${ht(this,ll,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);i>0&&await new Promise(u=>setTimeout(u,i));let o;try{o=await n()}catch(u){if(ht(this,ll,"f")>s)return this.log.warn(`Caught exception while attempting to make request:
  ${u}
  Retrying request.`),await ht(this,li,"m",t).call(this,{request:n,backoff:r,tries:s+1});throw u}if(o.ok)return o;const a=await o.clone().text(),l=`Server returned an error:
  Code: ${o.status} (${o.statusText})
  Body: ${a}
`;if(o.status===404&&o.url.includes("api/v3"))throw new IA("v3 api not supported. Fall back to v2",{ok:o.ok,status:o.status,statusText:o.statusText,headers:Vx(o.headers)});if(s<ht(this,ll,"f"))return await ht(this,li,"m",t).call(this,{request:n,backoff:r,tries:s+1});throw new IA(l,{ok:o.ok,status:o.status,statusText:o.statusText,headers:Vx(o.headers)})},$f=async function(){if(!this.rootKey)if(this.rootKey===null&&ht(this,Tg,"f"))await this.fetchRootKey();else throw new Tr(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${ht(this,Tg,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var HB;(function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"})(HB||(HB={}));function YB(){const t=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}const uhe=5*60*1e3;function RN(){return WG(UG(BG(),1e3),jG(1e3,1.2),VG(uhe))}function BG(){let t=!0;return async()=>t?(t=!1,!0):!1}function UG(t,e){return async(n,r,s)=>{if(await t(n,r,s))return new Promise(i=>setTimeout(i,e))}}function che(t){let e=t;return async(n,r,s)=>{if(--e<=0)throw new Error(`Failed to retrieve a reply for request after ${t} attempts:
  Request ID: ${On(r)}
  Request status: ${s}
`)}}function dhe(t){return()=>new Promise(e=>setTimeout(e,t))}function VG(t){const e=Date.now()+t;return async(n,r,s)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:
  Request ID: ${On(r)}
  Request status: ${s}
`)}}function jG(t,e){let n=t;return()=>new Promise(r=>setTimeout(()=>{n*=e,r()},n))}function WG(...t){return async(e,n,r)=>{for(const s of t)await s(e,n,r)}}const hhe=Object.freeze(Object.defineProperty({__proto__:null,backoff:jG,chain:WG,conditionalDelay:UG,defaultStrategy:RN,maxAttempts:che,once:BG,throttle:dhe,timeout:VG},Symbol.toStringTag,{value:"Module"}));async function mD(t,e,n,r=RN(),s,i){var o;const a=[new TextEncoder().encode("request_status"),n],l=s??await((o=t.createReadStateRequest)===null||o===void 0?void 0:o.call(t,{paths:[a]})),u=await t.readState(e,{paths:[a]},void 0,l);if(t.rootKey==null)throw new Error("Agent root key not initialized before polling");const c=await vc.create({certificate:u.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:i}),d=Bo(c.lookup([...a,new TextEncoder().encode("status")]));let h;switch(typeof d>"u"?h=lc.Unknown:h=new TextDecoder().decode(d),h){case lc.Replied:return{reply:Bo(c.lookup([...a,"reply"])),certificate:c};case lc.Received:case lc.Unknown:case lc.Processing:return await r(e,n,h),mD(t,e,n,r,l,i);case lc.Rejected:{const f=new Uint8Array(Bo(c.lookup([...a,"reject_code"])))[0],m=new TextDecoder().decode(Bo(c.lookup([...a,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${On(n)}
  Reject code: ${f}
  Reject text: ${m}
`)}case lc.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${On(n)}
`)}throw new Error("unreachable")}const fhe=Object.freeze(Object.defineProperty({__proto__:null,defaultStrategy:RN,pollForResponse:mD,strategy:hhe},Symbol.toStringTag,{value:"Module"})),phe=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),n=t.Text,r=t.Record({network:e,address:n,min_confirmations:t.Opt(t.Nat32)}),s=t.Nat64,i=s,o=t.Nat32,a=t.Record({start_height:o,end_height:t.Opt(o),network:e}),l=t.Vec(t.Nat8),u=t.Record({tip_height:o,block_headers:t.Vec(l)}),c=t.Record({network:e}),d=t.Nat64,h=t.Vec(d),f=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:n}),m=t.Vec(t.Nat8),g=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),x=t.Record({height:t.Nat32,value:s,outpoint:g}),w=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:o,tip_block_hash:m,utxos:t.Vec(x)}),b=t.Record({transaction:t.Vec(t.Nat8),network:e}),S=t.Principal,C=t.Record({canister_id:S,num_requested_changes:t.Opt(t.Nat64)}),T=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),D=t.Vec(t.Nat8),P=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:D}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),I=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:T,details:P}),E=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(I),total_num_changes:t.Nat64}),M=t.Record({canister_id:S}),O=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),j=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:O,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),R=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:j,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),z=t.Record({canister_id:S}),B=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(O),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),V=t.Record({settings:t.Opt(B),sender_canister_version:t.Opt(t.Nat64)}),H=t.Record({canister_id:S}),K=t.Record({canister_id:S}),ne=t.Record({canister_id:S,snapshot_id:D}),fe=t.Record({canister_id:S}),ee=t.Variant({secp256k1:t.Null}),de=t.Record({key_id:t.Record({name:t.Text,curve:ee}),canister_id:t.Opt(S),derivation_path:t.Vec(t.Vec(t.Nat8))}),ge=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),Z=t.Record({canister_id:S}),we=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),Ee=t.Record({canister_log_records:t.Vec(we)}),Le=t.Record({value:t.Text,name:t.Text}),De=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(Le)}),Be=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:De})],[De],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(Le)}),se=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),le=t.Record({hash:t.Vec(t.Nat8)}),ye=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:se,chunk_hashes_list:t.Vec(le),target_canister:S,store_canister:t.Opt(S),sender_canister_version:t.Opt(t.Nat64)}),ve=t.Vec(t.Nat8),xe=t.Record({arg:t.Vec(t.Nat8),wasm_module:ve,mode:se,canister_id:S,sender_canister_version:t.Opt(t.Nat64)}),Ie=t.Record({canister_id:S}),te=t.Record({id:D,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),L=t.Vec(te),U=t.Record({canister_id:S,sender_canister_version:t.Opt(t.Nat64),snapshot_id:D}),re=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),q=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),ie=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(q)})),me=t.Record({settings:t.Opt(B),specified_id:t.Opt(S),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),je=t.Record({canister_id:S}),He=t.Record({canister_id:S,amount:t.Nat}),Ge=t.Vec(t.Nat8),Je=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),N=t.Record({key_id:t.Record({algorithm:Je,name:t.Text}),canister_id:t.Opt(S),derivation_path:t.Vec(t.Vec(t.Nat8))}),k=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),$=t.Record({key_id:t.Record({name:t.Text,curve:ee}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),J=t.Record({signature:t.Vec(t.Nat8)}),ce=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),be=t.Record({aux:t.Opt(ce),key_id:t.Record({algorithm:Je,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),Ne=t.Record({signature:t.Vec(t.Nat8)}),at=t.Record({canister_id:S}),St=t.Record({canister_id:S}),mt=t.Record({canister_id:S}),dt=t.Vec(le),_t=t.Record({subnet_id:t.Principal}),hn=t.Record({replica_version:t.Text}),No=t.Record({replace_snapshot:t.Opt(D),canister_id:S}),ko=te,To=t.Record({canister_id:S,sender_canister_version:t.Opt(t.Nat64)}),Pl=t.Record({canister_id:t.Principal,settings:B,sender_canister_version:t.Opt(t.Nat64)}),Lu=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),us=le;return t.Service({bitcoin_get_balance:t.Func([r],[i],[]),bitcoin_get_block_headers:t.Func([a],[u],[]),bitcoin_get_current_fee_percentiles:t.Func([c],[h],[]),bitcoin_get_utxos:t.Func([f],[w],[]),bitcoin_send_transaction:t.Func([b],[],[]),canister_info:t.Func([C],[E],[]),canister_status:t.Func([M],[R],[]),clear_chunk_store:t.Func([z],[],[]),create_canister:t.Func([V],[H],[]),delete_canister:t.Func([K],[],[]),delete_canister_snapshot:t.Func([ne],[],[]),deposit_cycles:t.Func([fe],[],[]),ecdsa_public_key:t.Func([de],[ge],[]),fetch_canister_logs:t.Func([Z],[Ee],["query"]),http_request:t.Func([Be],[De],[]),install_chunked_code:t.Func([ye],[],[]),install_code:t.Func([xe],[],[]),list_canister_snapshots:t.Func([Ie],[L],[]),load_canister_snapshot:t.Func([U],[],[]),node_metrics_history:t.Func([re],[ie],[]),provisional_create_canister_with_cycles:t.Func([me],[je],[]),provisional_top_up_canister:t.Func([He],[],[]),raw_rand:t.Func([],[Ge],[]),schnorr_public_key:t.Func([N],[k],[]),sign_with_ecdsa:t.Func([$],[J],[]),sign_with_schnorr:t.Func([be],[Ne],[]),start_canister:t.Func([at],[],[]),stop_canister:t.Func([St],[],[]),stored_chunks:t.Func([mt],[dt],[]),subnet_info:t.Func([_t],[hn],[]),take_canister_snapshot:t.Func([No],[ko],[]),uninstall_code:t.Func([To],[],[]),update_settings:t.Func([Pl],[],[]),upload_chunk:t.Func([Lu],[us],[])})};class GG extends Tr{constructor(e,n,r,s){super(["Call failed:",`  Canister: ${e.toText()}`,`  Method: ${n} (${r})`,...Object.getOwnPropertyNames(s).map(i=>`  "${i}": ${JSON.stringify(s[i])}`)].join(`
`)),this.canisterId=e,this.methodName=n,this.type=r,this.props=s}}class mhe extends GG{constructor(e,n,r){var s;super(e,n,"query",{Status:r.status,Code:(s=N$[r.reject_code])!==null&&s!==void 0?s:`Unknown Code "${r.reject_code}"`,Message:r.reject_message}),this.result=r}}class KB extends GG{constructor(e,n,r,s,i,o,a){super(e,n,"update",Object.assign({"Request ID":On(r)},s.body?Object.assign(Object.assign({},a?{"Error code":a}:{}),{"Reject code":String(i),"Reject message":o}):{"HTTP status code":s.status.toString(),"HTTP status text":s.statusText})),this.requestId=r,this.response=s,this.reject_code=i,this.reject_message=o,this.error_code=a}}const ya=Symbol.for("ic-agent-metadata");class Sc{constructor(e){this[ya]=Object.freeze(e)}static agentOf(e){return e[ya].config.agent}static interfaceOf(e){return e[ya].service}static canisterIdOf(e){return zt.from(e[ya].config.canisterId)}static async install(e,n){const r=e.mode===void 0?{install:null}:e.mode,s=e.arg?[...new Uint8Array(e.arg)]:[],i=[...new Uint8Array(e.module)],o=typeof n.canisterId=="string"?zt.fromText(n.canisterId):n.canisterId;await qB(n).install_code({mode:r,arg:s,wasm_module:i,canister_id:o,sender_canister_version:[]})}static async createCanister(e,n){function r(i){return[{controllers:i.controllers?[i.controllers]:[],compute_allocation:i.compute_allocation?[i.compute_allocation]:[],freezing_threshold:i.freezing_threshold?[i.freezing_threshold]:[],memory_allocation:i.memory_allocation?[i.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:s}=await qB(e||{}).provisional_create_canister_with_cycles({amount:[],settings:r(n||{}),specified_id:[],sender_canister_version:[]});return s}static async createAndInstallCanister(e,n,r){const s=await this.createCanister(r);return await this.install(Object.assign({},n),Object.assign(Object.assign({},r),{canisterId:s})),this.createActor(e,Object.assign(Object.assign({},r),{canisterId:s}))}static createActorClass(e,n){const r=e({IDL:sce});class s extends Sc{constructor(o){if(!o.canisterId)throw new Tr(`Canister ID is required, but received ${typeof o.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const a=typeof o.canisterId=="string"?zt.fromText(o.canisterId):o.canisterId;super({config:Object.assign(Object.assign(Object.assign({},HG),o),{canisterId:a}),service:r});for(const[l,u]of r._fields)n!=null&&n.httpDetails&&u.annotations.push(P$),n!=null&&n.certificate&&u.annotations.push(YG),this[l]=ghe(this,l,u,o.blsVerify)}}return s}static createActor(e,n){if(!n.canisterId)throw new Tr(`Canister ID is required, but received ${typeof n.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(e))(n)}static createActorWithHttpDetails(e,n){return new(this.createActorClass(e,{httpDetails:!0}))(n)}static createActorWithExtendedDetails(e,n,r={httpDetails:!0,certificate:!0}){return new(this.createActorClass(e,r))(n)}}function Lm(t,e){const n=T9(t,Tue.Buffer.from(e));switch(n.length){case 0:return;case 1:return n[0];default:return n}}const HG={pollingStrategyFactory:RN},P$="http-details",YG="certificate";function ghe(t,e,n,r){let s;n.annotations.includes("query")||n.annotations.includes("composite_query")?s=async(o,...a)=>{var l,u;o=Object.assign(Object.assign({},o),(u=(l=t[ya].config).queryTransform)===null||u===void 0?void 0:u.call(l,e,a,Object.assign(Object.assign({},t[ya].config),o)));const c=o.agent||t[ya].config.agent||YB(),d=zt.from(o.canisterId||t[ya].config.canisterId),h=T$(n.argTypes,a),f=await c.query(d,{methodName:e,arg:h,effectiveCanisterId:o.effectiveCanisterId}),m=Object.assign(Object.assign({},f.httpDetails),{requestDetails:f.requestDetails});switch(f.status){case"rejected":throw new mhe(d,e,f);case"replied":return n.annotations.includes(P$)?{httpDetails:m,result:Lm(n.retTypes,f.reply.arg)}:Lm(n.retTypes,f.reply.arg)}}:s=async(o,...a)=>{var l,u;o=Object.assign(Object.assign({},o),(u=(l=t[ya].config).callTransform)===null||u===void 0?void 0:u.call(l,e,a,Object.assign(Object.assign({},t[ya].config),o)));const c=o.agent||t[ya].config.agent||YB(),{canisterId:d,effectiveCanisterId:h,pollingStrategyFactory:f}=Object.assign(Object.assign(Object.assign({},HG),t[ya].config),o),m=zt.from(d),g=h!==void 0?zt.from(h):m,x=T$(n.argTypes,a),{requestId:w,response:b,requestDetails:S}=await c.call(m,{methodName:e,arg:x,effectiveCanisterId:g});let C,T;if(b.body&&b.body.certificate){if(c.rootKey==null)throw new Error("Agent is missing root key");const E=b.body.certificate;T=await vc.create({certificate:QC(E),rootKey:c.rootKey,canisterId:zt.from(d),blsVerify:r});const M=[new TextEncoder().encode("request_status"),w];switch(new TextDecoder().decode(Bo(T.lookup([...M,"status"])))){case"replied":C=Bo(T.lookup([...M,"reply"]));break;case"rejected":{const j=new Uint8Array(Bo(T.lookup([...M,"reject_code"])))[0],R=new TextDecoder().decode(Bo(T.lookup([...M,"reject_message"]))),z=Bo(T.lookup([...M,"error_code"])),B=z?new TextDecoder().decode(z):void 0;throw new KB(m,e,w,b,j,R,B)}}}else if(b.body&&"reject_message"in b.body){const{reject_code:E,reject_message:M,error_code:O}=b.body;throw new KB(m,e,w,b,E,M,O)}if(b.status===202){const E=f(),M=await mD(c,g,w,E,r);T=M.certificate,C=M.reply}const D=n.annotations.includes(P$),P=n.annotations.includes(YG),I=Object.assign(Object.assign({},b),{requestDetails:S});if(C!==void 0)return D&&P?{httpDetails:I,certificate:T,result:Lm(n.retTypes,C)}:P?{certificate:T,result:Lm(n.retTypes,C)}:D?{httpDetails:I,result:Lm(n.retTypes,C)}:Lm(n.retTypes,C);if(n.retTypes.length===0)return D?{httpDetails:b,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${n.retTypes.join(",")}].`)};const i=(...o)=>s({},...o);return i.withOptions=o=>(...a)=>s(o,...a),i}function qB(t){function e(n,r){if(t.effectiveCanisterId)return{effectiveCanisterId:zt.from(t.effectiveCanisterId)};const s=r[0];let i=zt.fromHex("");return s&&typeof s=="object"&&s.target_canister&&n==="install_chunked_code"&&(i=zt.from(s.target_canister)),s&&typeof s=="object"&&s.canister_id&&(i=zt.from(s.canister_id)),{effectiveCanisterId:i}}return Sc.createActor(phe,Object.assign(Object.assign(Object.assign({},t),{canisterId:zt.fromHex("")}),{callTransform:e,queryTransform:e}))}var yhe=(t=>(t[t.FractionalMoreThan8Decimals=0]="FractionalMoreThan8Decimals",t[t.InvalidFormat=1]="InvalidFormat",t[t.FractionalTooManyDecimals=2]="FractionalTooManyDecimals",t))(yhe||{});BigInt(1e8);var xhe=class{constructor(e,n,r){this.id=e,this.service=n,this.certifiedService=r,this.caller=({certified:s=!0})=>s?this.certifiedService:this.service}get canisterId(){return this.id}},KG=t=>t==null,whe=t=>!KG(t),bhe=()=>po.createSync({host:"https://icp-api.io",identity:new Jd}),vhe=({options:{canisterId:t,serviceOverride:e,certifiedServiceOverride:n,agent:r,callTransform:s,queryTransform:i},idlFactory:o,certifiedIdlFactory:a})=>{let l=r??bhe(),u=e??Sc.createActor(o,{agent:l,canisterId:t,callTransform:s,queryTransform:i}),c=n??Sc.createActor(a,{agent:l,canisterId:t,callTransform:s,queryTransform:i});return{service:u,certifiedService:c,agent:l,canisterId:t}},qG=t=>new Uint8Array(t),She=t=>Array.from(t).map(e=>e.charCodeAt(0)),Che=t=>(t instanceof Uint8Array||(t=Uint8Array.from(t)),t.reduce((e,n)=>e+n.toString(16).padStart(2,"0"),"")),XB="abcdefghijklmnopqrstuvwxyz234567",Hw=Object.create(null);for(let t=0;t<XB.length;t++)Hw[XB[t]]=t;Hw[0]=Hw.o;Hw[1]=Hw.i;var Ihe=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),Nhe=t=>{let e=-1;for(let n=0;n<t.length;n++){let r=(t[n]^e)&255;e=Ihe[r]^e>>>8}return(e^-1)>>>0},khe=t=>{let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,Nhe(t),!1),new Uint8Array(e)},Po=t=>whe(t)?[t]:[],The=Object.create,XG=Object.defineProperty,Ehe=Object.getOwnPropertyDescriptor,_he=Object.getOwnPropertyNames,Ahe=Object.getPrototypeOf,$he=Object.prototype.hasOwnProperty,gD=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Rhe=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of _he(e))!$he.call(t,s)&&s!==n&&XG(t,s,{get:()=>e[s],enumerable:!(r=Ehe(e,s))||r.enumerable});return t},Mhe=(t,e,n)=>(n=t!=null?The(Ahe(t)):{},Rhe(!t||!t.__esModule?XG(n,"default",{value:t,enumerable:!0}):n,t));function Dhe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function ZG(t,...e){if(!Dhe(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function ZB(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ohe(t,e){ZG(t);let n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var DA=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ql=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Phe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function QG(t){return typeof t=="string"&&(t=Phe(t)),ZG(t),t}var Fhe=class{clone(){return this._cloneInto()}};function Lhe(t){let e=r=>t().update(QG(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function zhe(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);let s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),l=r?4:0,u=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+u,a,r)}var Bhe=(t,e,n)=>t&e^~t&n,Uhe=(t,e,n)=>t&e^t&n^e&n,Vhe=class extends Fhe{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=DA(this.buffer)}update(e){ZB(this);let{view:n,buffer:r,blockLen:s}=this;e=QG(e);let i=e.length;for(let o=0;o<i;){let a=Math.min(s-this.pos,i-o);if(a===s){let l=DA(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ZB(this),Ohe(e,this),this.finished=!0;let{buffer:n,view:r,blockLen:s,isLE:i}=this,{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;zhe(r,s-8,BigInt(this.length*8),i),this.process(r,0);let a=DA(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=l/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,c[d],i)}digest(){let{buffer:e,outputLen:n}=this;this.digestInto(e);let r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}},jhe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),vd=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Sd=new Uint32Array(64),Whe=class extends Vhe{constructor(){super(64,32,8,!1),this.A=vd[0]|0,this.B=vd[1]|0,this.C=vd[2]|0,this.D=vd[3]|0,this.E=vd[4]|0,this.F=vd[5]|0,this.G=vd[6]|0,this.H=vd[7]|0}get(){let{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:l}=this;return[e,n,r,s,i,o,a,l]}set(e,n,r,s,i,o,a,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(e,n){for(let d=0;d<16;d++,n+=4)Sd[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){let h=Sd[d-15],f=Sd[d-2],m=ql(h,7)^ql(h,18)^h>>>3,g=ql(f,17)^ql(f,19)^f>>>10;Sd[d]=g+Sd[d-7]+m+Sd[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:l,G:u,H:c}=this;for(let d=0;d<64;d++){let h=ql(a,6)^ql(a,11)^ql(a,25),f=c+h+Bhe(a,l,u)+jhe[d]+Sd[d]|0,m=(ql(r,2)^ql(r,13)^ql(r,22))+Uhe(r,s,i)|0;c=u,u=l,l=a,a=o+f|0,o=i,i=s,s=r,r=f+m|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(r,s,i,o,a,l,u,c)}roundClean(){Sd.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Ghe=class extends Whe{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},Hhe=Lhe(()=>new Ghe),F$=class L${constructor(e){this.bytes=e}static fromHex(e){return new L$(Uint8Array.from(Buffer.from(e,"hex")))}static fromPrincipal({principal:e,subAccount:n=yD.fromID(0)}){let r=She(`
account-id`),s=Hhe.create();s.update(qG([...r,...e.toUint8Array(),...n.toUint8Array()]));let i=s.digest(),o=khe(i),a=new Uint8Array([...o,...i]);return new L$(a)}toHex(){return Che(this.bytes)}toUint8Array(){return this.bytes}toNumbers(){return Array.from(this.bytes)}toAccountIdentifierHash(){return{hash:this.toUint8Array()}}},yD=class tC{constructor(e){this.bytes=e}static fromBytes(e){return e.length!=32?Error("Subaccount length must be 32-bytes"):new tC(e)}static fromPrincipal(e){let n=new Uint8Array(32).fill(0),r=e.toUint8Array();n[0]=r.length;for(let s=0;s<r.length;s++)n[1+s]=r[s];return new tC(n)}static fromID(e){if(e<0)throw new Error("Number cannot be negative");if(e>Number.MAX_SAFE_INTEGER)throw new Error("Number is too large to fit in 32 bytes.");let n=new DataView(new ArrayBuffer(32));if(typeof n.setBigUint64=="function")n.setBigUint64(24,BigInt(e));else{let s=BigInt(1)<<BigInt(32);n.setUint32(24,Number(BigInt(e)>>BigInt(32))),n.setUint32(28,Number(BigInt(e)%s))}let r=new Uint8Array(n.buffer);return new tC(r)}toUint8Array(){return this.bytes}};/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/var Yhe=zt.fromText("ryjl3-tyaaa-aaaaa-aaaba-cai");zt.fromText("qhbym-qaaaa-aaaaa-aaafq-cai");var Khe=t=>t instanceof F$?t:F$.fromHex(t),qhe=({IDL:t})=>{let e=t.Vec(t.Nat8),n=t.Record({owner:t.Principal,subaccount:t.Opt(e)}),r=t.Record({icrc2:t.Bool}),s=t.Record({icrc1_minting_account:t.Opt(n),feature_flags:t.Opt(r)}),i=t.Record({e8s:t.Nat64}),o=t.Text,a=t.Record({secs:t.Nat64,nanos:t.Nat32}),l=t.Record({num_blocks_to_archive:t.Nat64,max_transactions_per_response:t.Opt(t.Nat64),trigger_threshold:t.Nat64,more_controller_ids:t.Opt(t.Vec(t.Principal)),max_message_size_bytes:t.Opt(t.Nat64),cycles_for_archive_creation:t.Opt(t.Nat64),node_max_memory_size_bytes:t.Opt(t.Nat64),controller_id:t.Principal}),u=t.Record({send_whitelist:t.Vec(t.Principal),token_symbol:t.Opt(t.Text),transfer_fee:t.Opt(i),minting_account:o,transaction_window:t.Opt(a),max_message_size_bytes:t.Opt(t.Nat64),icrc1_minting_account:t.Opt(n),archive_options:t.Opt(l),initial_values:t.Vec(t.Tuple(o,i)),token_name:t.Opt(t.Text),feature_flags:t.Opt(r)});t.Variant({Upgrade:t.Opt(s),Init:u});let c=t.Vec(t.Nat8),d=t.Record({account:c}),h=t.Record({account:o}),f=t.Record({canister_id:t.Principal}),m=t.Record({archives:t.Vec(f)}),g=t.Nat,x=t.Variant({Int:t.Int,Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text}),w=t.Nat64,b=t.Record({to:n,fee:t.Opt(g),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(e),created_at_time:t.Opt(w),amount:g}),S=t.Nat,C=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,BadBurn:t.Record({min_burn_amount:g}),Duplicate:t.Record({duplicate_of:S}),BadFee:t.Record({expected_fee:g}),CreatedInFuture:t.Record({ledger_time:t.Nat64}),TooOld:t.Null,InsufficientFunds:t.Record({balance:g})}),T=t.Variant({Ok:S,Err:C}),D=t.Record({utc_offset_minutes:t.Opt(t.Int16),language:t.Text}),P=t.Record({metadata:D,device_spec:t.Opt(t.Variant({GenericDisplay:t.Null,LineDisplay:t.Record({characters_per_line:t.Nat16,lines_per_page:t.Nat16})}))}),I=t.Record({arg:t.Vec(t.Nat8),method:t.Text,user_preferences:P}),E=t.Variant({LineDisplayMessage:t.Record({pages:t.Vec(t.Record({lines:t.Vec(t.Text)}))}),GenericDisplayMessage:t.Text}),M=t.Record({metadata:D,consent_message:E}),O=t.Record({description:t.Text}),j=t.Variant({GenericError:t.Record({description:t.Text,error_code:t.Nat}),InsufficientPayment:O,UnsupportedCanisterCall:O,ConsentMessageUnavailable:O}),R=t.Variant({Ok:M,Err:j}),z=t.Record({account:n,spender:n}),B=t.Record({allowance:g,expires_at:t.Opt(w)}),V=t.Record({fee:t.Opt(g),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(e),created_at_time:t.Opt(w),amount:g,expected_allowance:t.Opt(g),expires_at:t.Opt(w),spender:n}),H=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,Duplicate:t.Record({duplicate_of:S}),BadFee:t.Record({expected_fee:g}),AllowanceChanged:t.Record({current_allowance:g}),CreatedInFuture:t.Record({ledger_time:t.Nat64}),TooOld:t.Null,Expired:t.Record({ledger_time:t.Nat64}),InsufficientFunds:t.Record({balance:g})}),K=t.Variant({Ok:S,Err:H}),ne=t.Record({to:n,fee:t.Opt(g),spender_subaccount:t.Opt(e),from:n,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(w),amount:g}),fe=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,InsufficientAllowance:t.Record({allowance:g}),BadBurn:t.Record({min_burn_amount:g}),Duplicate:t.Record({duplicate_of:S}),BadFee:t.Record({expected_fee:g}),CreatedInFuture:t.Record({ledger_time:w}),TooOld:t.Null,InsufficientFunds:t.Record({balance:g})}),ee=t.Variant({Ok:S,Err:fe}),de=t.Nat64,ge=t.Record({start:de,length:t.Nat64}),Z=t.Nat64,we=t.Record({timestamp_nanos:t.Nat64}),Ee=t.Variant({Approve:t.Record({fee:i,from:c,allowance_e8s:t.Int,allowance:i,expected_allowance:t.Opt(i),expires_at:t.Opt(we),spender:c}),Burn:t.Record({from:c,amount:i,spender:t.Opt(c)}),Mint:t.Record({to:c,amount:i}),Transfer:t.Record({to:c,fee:i,from:c,amount:i,spender:t.Opt(t.Vec(t.Nat8))})}),Le=t.Record({memo:Z,icrc1_memo:t.Opt(t.Vec(t.Nat8)),operation:t.Opt(Ee),created_at_time:we}),De=t.Record({transaction:Le,timestamp:we,parent_hash:t.Opt(t.Vec(t.Nat8))}),Be=t.Record({blocks:t.Vec(De)}),se=t.Variant({BadFirstBlockIndex:t.Record({requested_index:de,first_valid_index:de}),Other:t.Record({error_message:t.Text,error_code:t.Nat64})}),le=t.Variant({Ok:Be,Err:se}),ye=t.Func([ge],[le],[]),ve=t.Record({callback:ye,start:de,length:t.Nat64}),xe=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),blocks:t.Vec(De),chain_length:t.Nat64,first_block_index:de,archived_blocks:t.Vec(ve)}),Ie=t.Record({callback:t.Func([ge],[t.Variant({Ok:t.Vec(t.Vec(t.Nat8)),Err:se})],[]),start:t.Nat64,length:t.Nat64}),te=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),blocks:t.Vec(t.Vec(t.Nat8)),chain_length:t.Nat64,first_block_index:t.Nat64,archived_blocks:t.Vec(Ie)}),L=t.Record({to:o,fee:i,memo:Z,from_subaccount:t.Opt(e),created_at_time:t.Opt(we),amount:i}),U=t.Record({to:c,fee:i,memo:Z,from_subaccount:t.Opt(e),created_at_time:t.Opt(we),amount:i}),re=t.Variant({TxTooOld:t.Record({allowed_window_nanos:t.Nat64}),BadFee:t.Record({expected_fee:i}),TxDuplicate:t.Record({duplicate_of:de}),TxCreatedInFuture:t.Null,InsufficientFunds:t.Record({balance:i})}),q=t.Variant({Ok:de,Err:re}),ie=t.Record({}),me=t.Record({transfer_fee:i});return t.Service({account_balance:t.Func([d],[i],[]),account_balance_dfx:t.Func([h],[i],[]),account_identifier:t.Func([n],[c],[]),archives:t.Func([],[m],[]),decimals:t.Func([],[t.Record({decimals:t.Nat32})],[]),icrc10_supported_standards:t.Func([],[t.Vec(t.Record({url:t.Text,name:t.Text}))],[]),icrc1_balance_of:t.Func([n],[g],[]),icrc1_decimals:t.Func([],[t.Nat8],[]),icrc1_fee:t.Func([],[g],[]),icrc1_metadata:t.Func([],[t.Vec(t.Tuple(t.Text,x))],[]),icrc1_minting_account:t.Func([],[t.Opt(n)],[]),icrc1_name:t.Func([],[t.Text],[]),icrc1_supported_standards:t.Func([],[t.Vec(t.Record({url:t.Text,name:t.Text}))],[]),icrc1_symbol:t.Func([],[t.Text],[]),icrc1_total_supply:t.Func([],[g],[]),icrc1_transfer:t.Func([b],[T],[]),icrc21_canister_call_consent_message:t.Func([I],[R],[]),icrc2_allowance:t.Func([z],[B],[]),icrc2_approve:t.Func([V],[K],[]),icrc2_transfer_from:t.Func([ne],[ee],[]),is_ledger_ready:t.Func([],[t.Bool],[]),name:t.Func([],[t.Record({name:t.Text})],[]),query_blocks:t.Func([ge],[xe],[]),query_encoded_blocks:t.Func([ge],[te],[]),send_dfx:t.Func([L],[de],[]),symbol:t.Func([],[t.Record({symbol:t.Text})],[]),transfer:t.Func([U],[q],[]),transfer_fee:t.Func([ie],[me],[])})},Xhe=({IDL:t})=>{let e=t.Vec(t.Nat8),n=t.Record({owner:t.Principal,subaccount:t.Opt(e)}),r=t.Record({icrc2:t.Bool}),s=t.Record({icrc1_minting_account:t.Opt(n),feature_flags:t.Opt(r)}),i=t.Record({e8s:t.Nat64}),o=t.Text,a=t.Record({secs:t.Nat64,nanos:t.Nat32}),l=t.Record({num_blocks_to_archive:t.Nat64,max_transactions_per_response:t.Opt(t.Nat64),trigger_threshold:t.Nat64,more_controller_ids:t.Opt(t.Vec(t.Principal)),max_message_size_bytes:t.Opt(t.Nat64),cycles_for_archive_creation:t.Opt(t.Nat64),node_max_memory_size_bytes:t.Opt(t.Nat64),controller_id:t.Principal}),u=t.Record({send_whitelist:t.Vec(t.Principal),token_symbol:t.Opt(t.Text),transfer_fee:t.Opt(i),minting_account:o,transaction_window:t.Opt(a),max_message_size_bytes:t.Opt(t.Nat64),icrc1_minting_account:t.Opt(n),archive_options:t.Opt(l),initial_values:t.Vec(t.Tuple(o,i)),token_name:t.Opt(t.Text),feature_flags:t.Opt(r)});t.Variant({Upgrade:t.Opt(s),Init:u});let c=t.Vec(t.Nat8),d=t.Record({account:c}),h=t.Record({account:o}),f=t.Record({canister_id:t.Principal}),m=t.Record({archives:t.Vec(f)}),g=t.Nat,x=t.Variant({Int:t.Int,Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text}),w=t.Nat64,b=t.Record({to:n,fee:t.Opt(g),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(e),created_at_time:t.Opt(w),amount:g}),S=t.Nat,C=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,BadBurn:t.Record({min_burn_amount:g}),Duplicate:t.Record({duplicate_of:S}),BadFee:t.Record({expected_fee:g}),CreatedInFuture:t.Record({ledger_time:t.Nat64}),TooOld:t.Null,InsufficientFunds:t.Record({balance:g})}),T=t.Variant({Ok:S,Err:C}),D=t.Record({utc_offset_minutes:t.Opt(t.Int16),language:t.Text}),P=t.Record({metadata:D,device_spec:t.Opt(t.Variant({GenericDisplay:t.Null,LineDisplay:t.Record({characters_per_line:t.Nat16,lines_per_page:t.Nat16})}))}),I=t.Record({arg:t.Vec(t.Nat8),method:t.Text,user_preferences:P}),E=t.Variant({LineDisplayMessage:t.Record({pages:t.Vec(t.Record({lines:t.Vec(t.Text)}))}),GenericDisplayMessage:t.Text}),M=t.Record({metadata:D,consent_message:E}),O=t.Record({description:t.Text}),j=t.Variant({GenericError:t.Record({description:t.Text,error_code:t.Nat}),InsufficientPayment:O,UnsupportedCanisterCall:O,ConsentMessageUnavailable:O}),R=t.Variant({Ok:M,Err:j}),z=t.Record({account:n,spender:n}),B=t.Record({allowance:g,expires_at:t.Opt(w)}),V=t.Record({fee:t.Opt(g),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(e),created_at_time:t.Opt(w),amount:g,expected_allowance:t.Opt(g),expires_at:t.Opt(w),spender:n}),H=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,Duplicate:t.Record({duplicate_of:S}),BadFee:t.Record({expected_fee:g}),AllowanceChanged:t.Record({current_allowance:g}),CreatedInFuture:t.Record({ledger_time:t.Nat64}),TooOld:t.Null,Expired:t.Record({ledger_time:t.Nat64}),InsufficientFunds:t.Record({balance:g})}),K=t.Variant({Ok:S,Err:H}),ne=t.Record({to:n,fee:t.Opt(g),spender_subaccount:t.Opt(e),from:n,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(w),amount:g}),fe=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,InsufficientAllowance:t.Record({allowance:g}),BadBurn:t.Record({min_burn_amount:g}),Duplicate:t.Record({duplicate_of:S}),BadFee:t.Record({expected_fee:g}),CreatedInFuture:t.Record({ledger_time:w}),TooOld:t.Null,InsufficientFunds:t.Record({balance:g})}),ee=t.Variant({Ok:S,Err:fe}),de=t.Nat64,ge=t.Record({start:de,length:t.Nat64}),Z=t.Nat64,we=t.Record({timestamp_nanos:t.Nat64}),Ee=t.Variant({Approve:t.Record({fee:i,from:c,allowance_e8s:t.Int,allowance:i,expected_allowance:t.Opt(i),expires_at:t.Opt(we),spender:c}),Burn:t.Record({from:c,amount:i,spender:t.Opt(c)}),Mint:t.Record({to:c,amount:i}),Transfer:t.Record({to:c,fee:i,from:c,amount:i,spender:t.Opt(t.Vec(t.Nat8))})}),Le=t.Record({memo:Z,icrc1_memo:t.Opt(t.Vec(t.Nat8)),operation:t.Opt(Ee),created_at_time:we}),De=t.Record({transaction:Le,timestamp:we,parent_hash:t.Opt(t.Vec(t.Nat8))}),Be=t.Record({blocks:t.Vec(De)}),se=t.Variant({BadFirstBlockIndex:t.Record({requested_index:de,first_valid_index:de}),Other:t.Record({error_message:t.Text,error_code:t.Nat64})}),le=t.Variant({Ok:Be,Err:se}),ye=t.Func([ge],[le],["query"]),ve=t.Record({callback:ye,start:de,length:t.Nat64}),xe=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),blocks:t.Vec(De),chain_length:t.Nat64,first_block_index:de,archived_blocks:t.Vec(ve)}),Ie=t.Record({callback:t.Func([ge],[t.Variant({Ok:t.Vec(t.Vec(t.Nat8)),Err:se})],["query"]),start:t.Nat64,length:t.Nat64}),te=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),blocks:t.Vec(t.Vec(t.Nat8)),chain_length:t.Nat64,first_block_index:t.Nat64,archived_blocks:t.Vec(Ie)}),L=t.Record({to:o,fee:i,memo:Z,from_subaccount:t.Opt(e),created_at_time:t.Opt(we),amount:i}),U=t.Record({to:c,fee:i,memo:Z,from_subaccount:t.Opt(e),created_at_time:t.Opt(we),amount:i}),re=t.Variant({TxTooOld:t.Record({allowed_window_nanos:t.Nat64}),BadFee:t.Record({expected_fee:i}),TxDuplicate:t.Record({duplicate_of:de}),TxCreatedInFuture:t.Null,InsufficientFunds:t.Record({balance:i})}),q=t.Variant({Ok:de,Err:re}),ie=t.Record({}),me=t.Record({transfer_fee:i});return t.Service({account_balance:t.Func([d],[i],["query"]),account_balance_dfx:t.Func([h],[i],["query"]),account_identifier:t.Func([n],[c],["query"]),archives:t.Func([],[m],["query"]),decimals:t.Func([],[t.Record({decimals:t.Nat32})],["query"]),icrc10_supported_standards:t.Func([],[t.Vec(t.Record({url:t.Text,name:t.Text}))],["query"]),icrc1_balance_of:t.Func([n],[g],["query"]),icrc1_decimals:t.Func([],[t.Nat8],["query"]),icrc1_fee:t.Func([],[g],["query"]),icrc1_metadata:t.Func([],[t.Vec(t.Tuple(t.Text,x))],["query"]),icrc1_minting_account:t.Func([],[t.Opt(n)],["query"]),icrc1_name:t.Func([],[t.Text],["query"]),icrc1_supported_standards:t.Func([],[t.Vec(t.Record({url:t.Text,name:t.Text}))],["query"]),icrc1_symbol:t.Func([],[t.Text],["query"]),icrc1_total_supply:t.Func([],[g],["query"]),icrc1_transfer:t.Func([b],[T],[]),icrc21_canister_call_consent_message:t.Func([I],[R],[]),icrc2_allowance:t.Func([z],[B],["query"]),icrc2_approve:t.Func([V],[K],[]),icrc2_transfer_from:t.Func([ne],[ee],[]),is_ledger_ready:t.Func([],[t.Bool],["query"]),name:t.Func([],[t.Record({name:t.Text})],["query"]),query_blocks:t.Func([ge],[xe],["query"]),query_encoded_blocks:t.Func([ge],[te],["query"]),send_dfx:t.Func([L],[de],[]),symbol:t.Func([],[t.Record({symbol:t.Text})],["query"]),transfer:t.Func([U],[q],[]),transfer_fee:t.Func([ie],[me],["query"])})};BigInt(1095062083);BigInt(1347768404);var xD=BigInt(1e4);BigInt(1e8);var QB=t=>({e8s:t}),Zhe=({to:t,amount:e,memo:n,fee:r,fromSubAccount:s,createdAt:i})=>({to:t.toUint8Array(),fee:QB(r??xD),amount:QB(e),memo:n??BigInt(0),created_at_time:i!==void 0?[{timestamp_nanos:i}]:[],from_subaccount:s===void 0?[]:[qG(s)]}),Qhe=({fromSubAccount:t,to:e,amount:n,fee:r,icrc1Memo:s,createdAt:i})=>({to:e,fee:Po(r??xD),amount:n,memo:Po(s),created_at_time:Po(i),from_subaccount:Po(t)}),Jhe=({fee:t,createdAt:e,icrc1Memo:n,fromSubAccount:r,expected_allowance:s,expires_at:i,amount:o,...a})=>({...a,fee:Po(t??xD),memo:Po(n),from_subaccount:Po(r),created_at_time:Po(e),amount:o,expected_allowance:Po(s),expires_at:Po(i)}),efe=({userPreferences:{metadata:{utcOffsetMinutes:t,language:e},deriveSpec:n},...r})=>({...r,user_preferences:{metadata:{language:e,utc_offset_minutes:Po(t)},device_spec:KG(n)?Po():Po("GenericDisplay"in n?{GenericDisplay:null}:{LineDisplay:{characters_per_line:n.LineDisplay.charactersPerLine,lines_per_page:n.LineDisplay.linesPerPage}})}}),MN=class extends Error{},d0=class extends MN{},Th=class extends MN{},DN=class extends MN{},wD=class extends d0{constructor(e){super(),this.balance=e}},JG=class extends d0{constructor(e){super(),this.allowed_window_secs=e}},e7=class extends d0{},t7=class extends d0{constructor(e){super(),this.duplicateOf=e}},bD=class extends MN{constructor(t){super(),this.expectedFee=t}},n7=class extends Th{constructor(e,n){super(),this.message=e,this.error_code=n}},tfe=class extends Th{},nfe=class extends Th{constructor(e){super(),this.duplicateOf=e}},rfe=class extends Th{constructor(e){super(),this.currentAllowance=e}},sfe=class extends Th{},ife=class extends Th{},ofe=class extends Th{constructor(e){super(),this.ledgerTime=e}},afe=class extends DN{},lfe=class extends DN{},ufe=class extends DN{},cfe=t=>"TxDuplicate"in t?new t7(t.TxDuplicate.duplicate_of):"InsufficientFunds"in t?new wD(t.InsufficientFunds.balance.e8s):"TxCreatedInFuture"in t?new e7:"TxTooOld"in t?new JG(Number(t.TxTooOld.allowed_window_nanos)):"BadFee"in t?new bD(t.BadFee.expected_fee.e8s):new d0(`Unknown error type ${JSON.stringify(t)}`),dfe=t=>"Duplicate"in t?new t7(t.Duplicate.duplicate_of):"InsufficientFunds"in t?new wD(t.InsufficientFunds.balance):"CreatedInFuture"in t?new e7:"TooOld"in t?new JG:"BadFee"in t?new bD(t.BadFee.expected_fee):new d0(`Unknown error type ${JSON.stringify(t)}`),hfe=t=>"GenericError"in t?new n7(t.GenericError.message,t.GenericError.error_code):"TemporarilyUnavailable"in t?new tfe:"Duplicate"in t?new nfe(t.Duplicate.duplicate_of):"BadFee"in t?new bD(t.BadFee.expected_fee):"AllowanceChanged"in t?new rfe(t.AllowanceChanged.current_allowance):"CreatedInFuture"in t?new sfe:"TooOld"in t?new ife:"Expired"in t?new ofe(t.Expired.ledger_time):"InsufficientFunds"in t?new wD(t.InsufficientFunds.balance):new Th(`Unknown error type ${JSON.stringify(t)}`),ffe=t=>"GenericError"in t?new n7(t.GenericError.description,t.GenericError.error_code):"InsufficientPayment"in t?new afe(t.InsufficientPayment.description):"UnsupportedCanisterCall"in t?new lfe(t.UnsupportedCanisterCall.description):"ConsentMessageUnavailable"in t?new ufe(t.ConsentMessageUnavailable.description):new DN(`Unknown error type ${JSON.stringify(t)}`),pfe=class r7 extends xhe{constructor(){super(...arguments),this.accountBalance=async({accountIdentifier:e,certified:n=!0})=>{let r=Khe(e);return(await(n?this.certifiedService:this.service).account_balance({account:r.toUint8Array()})).e8s},this.metadata=e=>{let{icrc1_metadata:n}=this.caller(e);return n()},this.transactionFee=async(e={certified:!1})=>{let{transfer_fee:n}=this.caller(e),{transfer_fee:{e8s:r}}=await n({});return r},this.transfer=async e=>{let n=Zhe(e),r=await this.certifiedService.transfer(n);if("Err"in r)throw cfe(r.Err);return r.Ok},this.icrc1Transfer=async e=>{let n=Qhe(e),r=await this.certifiedService.icrc1_transfer(n);if("Err"in r)throw dfe(r.Err);return r.Ok},this.icrc2Approve=async e=>{let{icrc2_approve:n}=this.caller({certified:!0}),r=await n(Jhe(e));if("Err"in r)throw hfe(r.Err);return r.Ok},this.icrc21ConsentMessage=async e=>{let{icrc21_canister_call_consent_message:n}=this.caller({certified:!0}),r=await n(efe(e));if("Err"in r)throw ffe(r.Err);return r.Ok}}static create(e={}){let n=e.canisterId??Yhe,{service:r,certifiedService:s}=vhe({options:{...e,canisterId:n},idlFactory:Xhe,certifiedIdlFactory:qhe});return new r7(n,r,s)}},mfe=gD(t=>{t.byteLength=l,t.toByteArray=c,t.fromByteArray=f;var e=[],n=[],r=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(i=0,o=s.length;i<o;++i)e[i]=s[i],n[s.charCodeAt(i)]=i;var i,o;n[45]=62,n[95]=63;function a(m){var g=m.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=m.indexOf("=");x===-1&&(x=g);var w=x===g?0:4-x%4;return[x,w]}function l(m){var g=a(m),x=g[0],w=g[1];return(x+w)*3/4-w}function u(m,g,x){return(g+x)*3/4-x}function c(m){var g,x=a(m),w=x[0],b=x[1],S=new r(u(m,w,b)),C=0,T=b>0?w-4:w,D;for(D=0;D<T;D+=4)g=n[m.charCodeAt(D)]<<18|n[m.charCodeAt(D+1)]<<12|n[m.charCodeAt(D+2)]<<6|n[m.charCodeAt(D+3)],S[C++]=g>>16&255,S[C++]=g>>8&255,S[C++]=g&255;return b===2&&(g=n[m.charCodeAt(D)]<<2|n[m.charCodeAt(D+1)]>>4,S[C++]=g&255),b===1&&(g=n[m.charCodeAt(D)]<<10|n[m.charCodeAt(D+1)]<<4|n[m.charCodeAt(D+2)]>>2,S[C++]=g>>8&255,S[C++]=g&255),S}function d(m){return e[m>>18&63]+e[m>>12&63]+e[m>>6&63]+e[m&63]}function h(m,g,x){for(var w,b=[],S=g;S<x;S+=3)w=(m[S]<<16&16711680)+(m[S+1]<<8&65280)+(m[S+2]&255),b.push(d(w));return b.join("")}function f(m){for(var g,x=m.length,w=x%3,b=[],S=16383,C=0,T=x-w;C<T;C+=S)b.push(h(m,C,C+S>T?T:C+S));return w===1?(g=m[x-1],b.push(e[g>>2]+e[g<<4&63]+"==")):w===2&&(g=(m[x-2]<<8)+m[x-1],b.push(e[g>>10]+e[g>>4&63]+e[g<<2&63]+"=")),b.join("")}}),gfe=gD(t=>{t.read=function(e,n,r,s,i){var o,a,l=i*8-s-1,u=(1<<l)-1,c=u>>1,d=-7,h=r?i-1:0,f=r?-1:1,m=e[n+h];for(h+=f,o=m&(1<<-d)-1,m>>=-d,d+=l;d>0;o=o*256+e[n+h],h+=f,d-=8);for(a=o&(1<<-d)-1,o>>=-d,d+=s;d>0;a=a*256+e[n+h],h+=f,d-=8);if(o===0)o=1-c;else{if(o===u)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,s),o=o-c}return(m?-1:1)*a*Math.pow(2,o-s)},t.write=function(e,n,r,s,i,o){var a,l,u,c=o*8-i-1,d=(1<<c)-1,h=d>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=s?0:o-1,g=s?1:-1,x=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(l=isNaN(n)?1:0,a=d):(a=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-a))<1&&(a--,u*=2),a+h>=1?n+=f/u:n+=f*Math.pow(2,1-h),n*u>=2&&(a++,u/=2),a+h>=d?(l=0,a=d):a+h>=1?(l=(n*u-1)*Math.pow(2,i),a=a+h):(l=n*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+m]=l&255,m+=g,l/=256,i-=8);for(a=a<<i|l,c+=i;c>0;e[r+m]=a&255,m+=g,a/=256,c-=8);e[r+m-g]|=x*128}}),yfe=gD(t=>{var e=mfe(),n=gfe(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50;var s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{let N=new Uint8Array(1),k={foo:function(){return 42}};return Object.setPrototypeOf(k,Uint8Array.prototype),Object.setPrototypeOf(N,k),N.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(N){if(N>s)throw new RangeError('The value "'+N+'" is invalid for option "size"');let k=new Uint8Array(N);return Object.setPrototypeOf(k,a.prototype),k}function a(N,k,$){if(typeof N=="number"){if(typeof k=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(N)}return l(N,k,$)}a.poolSize=8192;function l(N,k,$){if(typeof N=="string")return h(N,k);if(ArrayBuffer.isView(N))return m(N);if(N==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N);if(me(N,ArrayBuffer)||N&&me(N.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(me(N,SharedArrayBuffer)||N&&me(N.buffer,SharedArrayBuffer)))return g(N,k,$);if(typeof N=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let J=N.valueOf&&N.valueOf();if(J!=null&&J!==N)return a.from(J,k,$);let ce=x(N);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof N[Symbol.toPrimitive]=="function")return a.from(N[Symbol.toPrimitive]("string"),k,$);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N)}a.from=function(N,k,$){return l(N,k,$)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function u(N){if(typeof N!="number")throw new TypeError('"size" argument must be of type number');if(N<0)throw new RangeError('The value "'+N+'" is invalid for option "size"')}function c(N,k,$){return u(N),N<=0?o(N):k!==void 0?typeof $=="string"?o(N).fill(k,$):o(N).fill(k):o(N)}a.alloc=function(N,k,$){return c(N,k,$)};function d(N){return u(N),o(N<0?0:w(N)|0)}a.allocUnsafe=function(N){return d(N)},a.allocUnsafeSlow=function(N){return d(N)};function h(N,k){if((typeof k!="string"||k==="")&&(k="utf8"),!a.isEncoding(k))throw new TypeError("Unknown encoding: "+k);let $=S(N,k)|0,J=o($),ce=J.write(N,k);return ce!==$&&(J=J.slice(0,ce)),J}function f(N){let k=N.length<0?0:w(N.length)|0,$=o(k);for(let J=0;J<k;J+=1)$[J]=N[J]&255;return $}function m(N){if(me(N,Uint8Array)){let k=new Uint8Array(N);return g(k.buffer,k.byteOffset,k.byteLength)}return f(N)}function g(N,k,$){if(k<0||N.byteLength<k)throw new RangeError('"offset" is outside of buffer bounds');if(N.byteLength<k+($||0))throw new RangeError('"length" is outside of buffer bounds');let J;return k===void 0&&$===void 0?J=new Uint8Array(N):$===void 0?J=new Uint8Array(N,k):J=new Uint8Array(N,k,$),Object.setPrototypeOf(J,a.prototype),J}function x(N){if(a.isBuffer(N)){let k=w(N.length)|0,$=o(k);return $.length===0||N.copy($,0,0,k),$}if(N.length!==void 0)return typeof N.length!="number"||je(N.length)?o(0):f(N);if(N.type==="Buffer"&&Array.isArray(N.data))return f(N.data)}function w(N){if(N>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return N|0}function b(N){return+N!=N&&(N=0),a.alloc(+N)}a.isBuffer=function(N){return N!=null&&N._isBuffer===!0&&N!==a.prototype},a.compare=function(N,k){if(me(N,Uint8Array)&&(N=a.from(N,N.offset,N.byteLength)),me(k,Uint8Array)&&(k=a.from(k,k.offset,k.byteLength)),!a.isBuffer(N)||!a.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===k)return 0;let $=N.length,J=k.length;for(let ce=0,be=Math.min($,J);ce<be;++ce)if(N[ce]!==k[ce]){$=N[ce],J=k[ce];break}return $<J?-1:J<$?1:0},a.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(N,k){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(N.length===0)return a.alloc(0);let $;if(k===void 0)for(k=0,$=0;$<N.length;++$)k+=N[$].length;let J=a.allocUnsafe(k),ce=0;for($=0;$<N.length;++$){let be=N[$];if(me(be,Uint8Array))ce+be.length>J.length?(a.isBuffer(be)||(be=a.from(be)),be.copy(J,ce)):Uint8Array.prototype.set.call(J,be,ce);else if(a.isBuffer(be))be.copy(J,ce);else throw new TypeError('"list" argument must be an Array of Buffers');ce+=be.length}return J};function S(N,k){if(a.isBuffer(N))return N.length;if(ArrayBuffer.isView(N)||me(N,ArrayBuffer))return N.byteLength;if(typeof N!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof N);let $=N.length,J=arguments.length>2&&arguments[2]===!0;if(!J&&$===0)return 0;let ce=!1;for(;;)switch(k){case"ascii":case"latin1":case"binary":return $;case"utf8":case"utf-8":return L(N).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $*2;case"hex":return $>>>1;case"base64":return q(N).length;default:if(ce)return J?-1:L(N).length;k=(""+k).toLowerCase(),ce=!0}}a.byteLength=S;function C(N,k,$){let J=!1;if((k===void 0||k<0)&&(k=0),k>this.length||(($===void 0||$>this.length)&&($=this.length),$<=0)||($>>>=0,k>>>=0,$<=k))return"";for(N||(N="utf8");;)switch(N){case"hex":return ne(this,k,$);case"utf8":case"utf-8":return z(this,k,$);case"ascii":return H(this,k,$);case"latin1":case"binary":return K(this,k,$);case"base64":return R(this,k,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,k,$);default:if(J)throw new TypeError("Unknown encoding: "+N);N=(N+"").toLowerCase(),J=!0}}a.prototype._isBuffer=!0;function T(N,k,$){let J=N[k];N[k]=N[$],N[$]=J}a.prototype.swap16=function(){let N=this.length;if(N%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let k=0;k<N;k+=2)T(this,k,k+1);return this},a.prototype.swap32=function(){let N=this.length;if(N%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let k=0;k<N;k+=4)T(this,k,k+3),T(this,k+1,k+2);return this},a.prototype.swap64=function(){let N=this.length;if(N%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let k=0;k<N;k+=8)T(this,k,k+7),T(this,k+1,k+6),T(this,k+2,k+5),T(this,k+3,k+4);return this},a.prototype.toString=function(){let N=this.length;return N===0?"":arguments.length===0?z(this,0,N):C.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(N){if(!a.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N?!0:a.compare(this,N)===0},a.prototype.inspect=function(){let N="",k=t.INSPECT_MAX_BYTES;return N=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(N+=" ... "),"<Buffer "+N+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(N,k,$,J,ce){if(me(N,Uint8Array)&&(N=a.from(N,N.offset,N.byteLength)),!a.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(k===void 0&&(k=0),$===void 0&&($=N?N.length:0),J===void 0&&(J=0),ce===void 0&&(ce=this.length),k<0||$>N.length||J<0||ce>this.length)throw new RangeError("out of range index");if(J>=ce&&k>=$)return 0;if(J>=ce)return-1;if(k>=$)return 1;if(k>>>=0,$>>>=0,J>>>=0,ce>>>=0,this===N)return 0;let be=ce-J,Ne=$-k,at=Math.min(be,Ne),St=this.slice(J,ce),mt=N.slice(k,$);for(let dt=0;dt<at;++dt)if(St[dt]!==mt[dt]){be=St[dt],Ne=mt[dt];break}return be<Ne?-1:Ne<be?1:0};function D(N,k,$,J,ce){if(N.length===0)return-1;if(typeof $=="string"?(J=$,$=0):$>2147483647?$=2147483647:$<-2147483648&&($=-2147483648),$=+$,je($)&&($=ce?0:N.length-1),$<0&&($=N.length+$),$>=N.length){if(ce)return-1;$=N.length-1}else if($<0)if(ce)$=0;else return-1;if(typeof k=="string"&&(k=a.from(k,J)),a.isBuffer(k))return k.length===0?-1:P(N,k,$,J,ce);if(typeof k=="number")return k=k&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(N,k,$):Uint8Array.prototype.lastIndexOf.call(N,k,$):P(N,[k],$,J,ce);throw new TypeError("val must be string, number or Buffer")}function P(N,k,$,J,ce){let be=1,Ne=N.length,at=k.length;if(J!==void 0&&(J=String(J).toLowerCase(),J==="ucs2"||J==="ucs-2"||J==="utf16le"||J==="utf-16le")){if(N.length<2||k.length<2)return-1;be=2,Ne/=2,at/=2,$/=2}function St(dt,_t){return be===1?dt[_t]:dt.readUInt16BE(_t*be)}let mt;if(ce){let dt=-1;for(mt=$;mt<Ne;mt++)if(St(N,mt)===St(k,dt===-1?0:mt-dt)){if(dt===-1&&(dt=mt),mt-dt+1===at)return dt*be}else dt!==-1&&(mt-=mt-dt),dt=-1}else for($+at>Ne&&($=Ne-at),mt=$;mt>=0;mt--){let dt=!0;for(let _t=0;_t<at;_t++)if(St(N,mt+_t)!==St(k,_t)){dt=!1;break}if(dt)return mt}return-1}a.prototype.includes=function(N,k,$){return this.indexOf(N,k,$)!==-1},a.prototype.indexOf=function(N,k,$){return D(this,N,k,$,!0)},a.prototype.lastIndexOf=function(N,k,$){return D(this,N,k,$,!1)};function I(N,k,$,J){$=Number($)||0;let ce=N.length-$;J?(J=Number(J),J>ce&&(J=ce)):J=ce;let be=k.length;J>be/2&&(J=be/2);let Ne;for(Ne=0;Ne<J;++Ne){let at=parseInt(k.substr(Ne*2,2),16);if(je(at))return Ne;N[$+Ne]=at}return Ne}function E(N,k,$,J){return ie(L(k,N.length-$),N,$,J)}function M(N,k,$,J){return ie(U(k),N,$,J)}function O(N,k,$,J){return ie(q(k),N,$,J)}function j(N,k,$,J){return ie(re(k,N.length-$),N,$,J)}a.prototype.write=function(N,k,$,J){if(k===void 0)J="utf8",$=this.length,k=0;else if($===void 0&&typeof k=="string")J=k,$=this.length,k=0;else if(isFinite(k))k=k>>>0,isFinite($)?($=$>>>0,J===void 0&&(J="utf8")):(J=$,$=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let ce=this.length-k;if(($===void 0||$>ce)&&($=ce),N.length>0&&($<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");let be=!1;for(;;)switch(J){case"hex":return I(this,N,k,$);case"utf8":case"utf-8":return E(this,N,k,$);case"ascii":case"latin1":case"binary":return M(this,N,k,$);case"base64":return O(this,N,k,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,N,k,$);default:if(be)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase(),be=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(N,k,$){return k===0&&$===N.length?e.fromByteArray(N):e.fromByteArray(N.slice(k,$))}function z(N,k,$){$=Math.min(N.length,$);let J=[],ce=k;for(;ce<$;){let be=N[ce],Ne=null,at=be>239?4:be>223?3:be>191?2:1;if(ce+at<=$){let St,mt,dt,_t;switch(at){case 1:be<128&&(Ne=be);break;case 2:St=N[ce+1],(St&192)===128&&(_t=(be&31)<<6|St&63,_t>127&&(Ne=_t));break;case 3:St=N[ce+1],mt=N[ce+2],(St&192)===128&&(mt&192)===128&&(_t=(be&15)<<12|(St&63)<<6|mt&63,_t>2047&&(_t<55296||_t>57343)&&(Ne=_t));break;case 4:St=N[ce+1],mt=N[ce+2],dt=N[ce+3],(St&192)===128&&(mt&192)===128&&(dt&192)===128&&(_t=(be&15)<<18|(St&63)<<12|(mt&63)<<6|dt&63,_t>65535&&_t<1114112&&(Ne=_t))}}Ne===null?(Ne=65533,at=1):Ne>65535&&(Ne-=65536,J.push(Ne>>>10&1023|55296),Ne=56320|Ne&1023),J.push(Ne),ce+=at}return V(J)}var B=4096;function V(N){let k=N.length;if(k<=B)return String.fromCharCode.apply(String,N);let $="",J=0;for(;J<k;)$+=String.fromCharCode.apply(String,N.slice(J,J+=B));return $}function H(N,k,$){let J="";$=Math.min(N.length,$);for(let ce=k;ce<$;++ce)J+=String.fromCharCode(N[ce]&127);return J}function K(N,k,$){let J="";$=Math.min(N.length,$);for(let ce=k;ce<$;++ce)J+=String.fromCharCode(N[ce]);return J}function ne(N,k,$){let J=N.length;(!k||k<0)&&(k=0),(!$||$<0||$>J)&&($=J);let ce="";for(let be=k;be<$;++be)ce+=He[N[be]];return ce}function fe(N,k,$){let J=N.slice(k,$),ce="";for(let be=0;be<J.length-1;be+=2)ce+=String.fromCharCode(J[be]+J[be+1]*256);return ce}a.prototype.slice=function(N,k){let $=this.length;N=~~N,k=k===void 0?$:~~k,N<0?(N+=$,N<0&&(N=0)):N>$&&(N=$),k<0?(k+=$,k<0&&(k=0)):k>$&&(k=$),k<N&&(k=N);let J=this.subarray(N,k);return Object.setPrototypeOf(J,a.prototype),J};function ee(N,k,$){if(N%1!==0||N<0)throw new RangeError("offset is not uint");if(N+k>$)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(N,k,$){N=N>>>0,k=k>>>0,$||ee(N,k,this.length);let J=this[N],ce=1,be=0;for(;++be<k&&(ce*=256);)J+=this[N+be]*ce;return J},a.prototype.readUintBE=a.prototype.readUIntBE=function(N,k,$){N=N>>>0,k=k>>>0,$||ee(N,k,this.length);let J=this[N+--k],ce=1;for(;k>0&&(ce*=256);)J+=this[N+--k]*ce;return J},a.prototype.readUint8=a.prototype.readUInt8=function(N,k){return N=N>>>0,k||ee(N,1,this.length),this[N]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(N,k){return N=N>>>0,k||ee(N,2,this.length),this[N]|this[N+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(N,k){return N=N>>>0,k||ee(N,2,this.length),this[N]<<8|this[N+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(N,k){return N=N>>>0,k||ee(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+this[N+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(N,k){return N=N>>>0,k||ee(N,4,this.length),this[N]*16777216+(this[N+1]<<16|this[N+2]<<8|this[N+3])},a.prototype.readBigUInt64LE=Ge(function(N){N=N>>>0,ve(N,"offset");let k=this[N],$=this[N+7];(k===void 0||$===void 0)&&xe(N,this.length-8);let J=k+this[++N]*2**8+this[++N]*2**16+this[++N]*2**24,ce=this[++N]+this[++N]*2**8+this[++N]*2**16+$*2**24;return BigInt(J)+(BigInt(ce)<<BigInt(32))}),a.prototype.readBigUInt64BE=Ge(function(N){N=N>>>0,ve(N,"offset");let k=this[N],$=this[N+7];(k===void 0||$===void 0)&&xe(N,this.length-8);let J=k*2**24+this[++N]*2**16+this[++N]*2**8+this[++N],ce=this[++N]*2**24+this[++N]*2**16+this[++N]*2**8+$;return(BigInt(J)<<BigInt(32))+BigInt(ce)}),a.prototype.readIntLE=function(N,k,$){N=N>>>0,k=k>>>0,$||ee(N,k,this.length);let J=this[N],ce=1,be=0;for(;++be<k&&(ce*=256);)J+=this[N+be]*ce;return ce*=128,J>=ce&&(J-=Math.pow(2,8*k)),J},a.prototype.readIntBE=function(N,k,$){N=N>>>0,k=k>>>0,$||ee(N,k,this.length);let J=k,ce=1,be=this[N+--J];for(;J>0&&(ce*=256);)be+=this[N+--J]*ce;return ce*=128,be>=ce&&(be-=Math.pow(2,8*k)),be},a.prototype.readInt8=function(N,k){return N=N>>>0,k||ee(N,1,this.length),this[N]&128?(255-this[N]+1)*-1:this[N]},a.prototype.readInt16LE=function(N,k){N=N>>>0,k||ee(N,2,this.length);let $=this[N]|this[N+1]<<8;return $&32768?$|4294901760:$},a.prototype.readInt16BE=function(N,k){N=N>>>0,k||ee(N,2,this.length);let $=this[N+1]|this[N]<<8;return $&32768?$|4294901760:$},a.prototype.readInt32LE=function(N,k){return N=N>>>0,k||ee(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},a.prototype.readInt32BE=function(N,k){return N=N>>>0,k||ee(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},a.prototype.readBigInt64LE=Ge(function(N){N=N>>>0,ve(N,"offset");let k=this[N],$=this[N+7];(k===void 0||$===void 0)&&xe(N,this.length-8);let J=this[N+4]+this[N+5]*2**8+this[N+6]*2**16+($<<24);return(BigInt(J)<<BigInt(32))+BigInt(k+this[++N]*2**8+this[++N]*2**16+this[++N]*2**24)}),a.prototype.readBigInt64BE=Ge(function(N){N=N>>>0,ve(N,"offset");let k=this[N],$=this[N+7];(k===void 0||$===void 0)&&xe(N,this.length-8);let J=(k<<24)+this[++N]*2**16+this[++N]*2**8+this[++N];return(BigInt(J)<<BigInt(32))+BigInt(this[++N]*2**24+this[++N]*2**16+this[++N]*2**8+$)}),a.prototype.readFloatLE=function(N,k){return N=N>>>0,k||ee(N,4,this.length),n.read(this,N,!0,23,4)},a.prototype.readFloatBE=function(N,k){return N=N>>>0,k||ee(N,4,this.length),n.read(this,N,!1,23,4)},a.prototype.readDoubleLE=function(N,k){return N=N>>>0,k||ee(N,8,this.length),n.read(this,N,!0,52,8)},a.prototype.readDoubleBE=function(N,k){return N=N>>>0,k||ee(N,8,this.length),n.read(this,N,!1,52,8)};function de(N,k,$,J,ce,be){if(!a.isBuffer(N))throw new TypeError('"buffer" argument must be a Buffer instance');if(k>ce||k<be)throw new RangeError('"value" argument is out of bounds');if($+J>N.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(N,k,$,J){if(N=+N,k=k>>>0,$=$>>>0,!J){let Ne=Math.pow(2,8*$)-1;de(this,N,k,$,Ne,0)}let ce=1,be=0;for(this[k]=N&255;++be<$&&(ce*=256);)this[k+be]=N/ce&255;return k+$},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(N,k,$,J){if(N=+N,k=k>>>0,$=$>>>0,!J){let Ne=Math.pow(2,8*$)-1;de(this,N,k,$,Ne,0)}let ce=$-1,be=1;for(this[k+ce]=N&255;--ce>=0&&(be*=256);)this[k+ce]=N/be&255;return k+$},a.prototype.writeUint8=a.prototype.writeUInt8=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,1,255,0),this[k]=N&255,k+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,2,65535,0),this[k]=N&255,this[k+1]=N>>>8,k+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,2,65535,0),this[k]=N>>>8,this[k+1]=N&255,k+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,4,4294967295,0),this[k+3]=N>>>24,this[k+2]=N>>>16,this[k+1]=N>>>8,this[k]=N&255,k+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,4,4294967295,0),this[k]=N>>>24,this[k+1]=N>>>16,this[k+2]=N>>>8,this[k+3]=N&255,k+4};function ge(N,k,$,J,ce){ye(k,J,ce,N,$,7);let be=Number(k&BigInt(4294967295));N[$++]=be,be=be>>8,N[$++]=be,be=be>>8,N[$++]=be,be=be>>8,N[$++]=be;let Ne=Number(k>>BigInt(32)&BigInt(4294967295));return N[$++]=Ne,Ne=Ne>>8,N[$++]=Ne,Ne=Ne>>8,N[$++]=Ne,Ne=Ne>>8,N[$++]=Ne,$}function Z(N,k,$,J,ce){ye(k,J,ce,N,$,7);let be=Number(k&BigInt(4294967295));N[$+7]=be,be=be>>8,N[$+6]=be,be=be>>8,N[$+5]=be,be=be>>8,N[$+4]=be;let Ne=Number(k>>BigInt(32)&BigInt(4294967295));return N[$+3]=Ne,Ne=Ne>>8,N[$+2]=Ne,Ne=Ne>>8,N[$+1]=Ne,Ne=Ne>>8,N[$]=Ne,$+8}a.prototype.writeBigUInt64LE=Ge(function(N,k=0){return ge(this,N,k,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Ge(function(N,k=0){return Z(this,N,k,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(N,k,$,J){if(N=+N,k=k>>>0,!J){let at=Math.pow(2,8*$-1);de(this,N,k,$,at-1,-at)}let ce=0,be=1,Ne=0;for(this[k]=N&255;++ce<$&&(be*=256);)N<0&&Ne===0&&this[k+ce-1]!==0&&(Ne=1),this[k+ce]=(N/be>>0)-Ne&255;return k+$},a.prototype.writeIntBE=function(N,k,$,J){if(N=+N,k=k>>>0,!J){let at=Math.pow(2,8*$-1);de(this,N,k,$,at-1,-at)}let ce=$-1,be=1,Ne=0;for(this[k+ce]=N&255;--ce>=0&&(be*=256);)N<0&&Ne===0&&this[k+ce+1]!==0&&(Ne=1),this[k+ce]=(N/be>>0)-Ne&255;return k+$},a.prototype.writeInt8=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,1,127,-128),N<0&&(N=255+N+1),this[k]=N&255,k+1},a.prototype.writeInt16LE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,2,32767,-32768),this[k]=N&255,this[k+1]=N>>>8,k+2},a.prototype.writeInt16BE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,2,32767,-32768),this[k]=N>>>8,this[k+1]=N&255,k+2},a.prototype.writeInt32LE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,4,2147483647,-2147483648),this[k]=N&255,this[k+1]=N>>>8,this[k+2]=N>>>16,this[k+3]=N>>>24,k+4},a.prototype.writeInt32BE=function(N,k,$){return N=+N,k=k>>>0,$||de(this,N,k,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[k]=N>>>24,this[k+1]=N>>>16,this[k+2]=N>>>8,this[k+3]=N&255,k+4},a.prototype.writeBigInt64LE=Ge(function(N,k=0){return ge(this,N,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Ge(function(N,k=0){return Z(this,N,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function we(N,k,$,J,ce,be){if($+J>N.length)throw new RangeError("Index out of range");if($<0)throw new RangeError("Index out of range")}function Ee(N,k,$,J,ce){return k=+k,$=$>>>0,ce||we(N,k,$,4),n.write(N,k,$,J,23,4),$+4}a.prototype.writeFloatLE=function(N,k,$){return Ee(this,N,k,!0,$)},a.prototype.writeFloatBE=function(N,k,$){return Ee(this,N,k,!1,$)};function Le(N,k,$,J,ce){return k=+k,$=$>>>0,ce||we(N,k,$,8),n.write(N,k,$,J,52,8),$+8}a.prototype.writeDoubleLE=function(N,k,$){return Le(this,N,k,!0,$)},a.prototype.writeDoubleBE=function(N,k,$){return Le(this,N,k,!1,$)},a.prototype.copy=function(N,k,$,J){if(!a.isBuffer(N))throw new TypeError("argument should be a Buffer");if($||($=0),!J&&J!==0&&(J=this.length),k>=N.length&&(k=N.length),k||(k=0),J>0&&J<$&&(J=$),J===$||N.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if($<0||$>=this.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length),N.length-k<J-$&&(J=N.length-k+$);let ce=J-$;return this===N&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(k,$,J):Uint8Array.prototype.set.call(N,this.subarray($,J),k),ce},a.prototype.fill=function(N,k,$,J){if(typeof N=="string"){if(typeof k=="string"?(J=k,k=0,$=this.length):typeof $=="string"&&(J=$,$=this.length),J!==void 0&&typeof J!="string")throw new TypeError("encoding must be a string");if(typeof J=="string"&&!a.isEncoding(J))throw new TypeError("Unknown encoding: "+J);if(N.length===1){let be=N.charCodeAt(0);(J==="utf8"&&be<128||J==="latin1")&&(N=be)}}else typeof N=="number"?N=N&255:typeof N=="boolean"&&(N=Number(N));if(k<0||this.length<k||this.length<$)throw new RangeError("Out of range index");if($<=k)return this;k=k>>>0,$=$===void 0?this.length:$>>>0,N||(N=0);let ce;if(typeof N=="number")for(ce=k;ce<$;++ce)this[ce]=N;else{let be=a.isBuffer(N)?N:a.from(N,J),Ne=be.length;if(Ne===0)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(ce=0;ce<$-k;++ce)this[ce+k]=be[ce%Ne]}return this};var De={};function Be(N,k,$){De[N]=class extends ${constructor(){super(),Object.defineProperty(this,"message",{value:k.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${N}]`,this.stack,delete this.name}get code(){return N}set code(J){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:J,writable:!0})}toString(){return`${this.name} [${N}]: ${this.message}`}}}Be("ERR_BUFFER_OUT_OF_BOUNDS",function(N){return N?`${N} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Be("ERR_INVALID_ARG_TYPE",function(N,k){return`The "${N}" argument must be of type number. Received type ${typeof k}`},TypeError),Be("ERR_OUT_OF_RANGE",function(N,k,$){let J=`The value of "${N}" is out of range.`,ce=$;return Number.isInteger($)&&Math.abs($)>2**32?ce=se(String($)):typeof $=="bigint"&&(ce=String($),($>BigInt(2)**BigInt(32)||$<-(BigInt(2)**BigInt(32)))&&(ce=se(ce)),ce+="n"),J+=` It must be ${k}. Received ${ce}`,J},RangeError);function se(N){let k="",$=N.length,J=N[0]==="-"?1:0;for(;$>=J+4;$-=3)k=`_${N.slice($-3,$)}${k}`;return`${N.slice(0,$)}${k}`}function le(N,k,$){ve(k,"offset"),(N[k]===void 0||N[k+$]===void 0)&&xe(k,N.length-($+1))}function ye(N,k,$,J,ce,be){if(N>$||N<k){let Ne=typeof k=="bigint"?"n":"",at;throw k===0||k===BigInt(0)?at=`>= 0${Ne} and < 2${Ne} ** ${(be+1)*8}${Ne}`:at=`>= -(2${Ne} ** ${(be+1)*8-1}${Ne}) and < 2 ** ${(be+1)*8-1}${Ne}`,new De.ERR_OUT_OF_RANGE("value",at,N)}le(J,ce,be)}function ve(N,k){if(typeof N!="number")throw new De.ERR_INVALID_ARG_TYPE(k,"number",N)}function xe(N,k,$){throw Math.floor(N)!==N?(ve(N,$),new De.ERR_OUT_OF_RANGE("offset","an integer",N)):k<0?new De.ERR_BUFFER_OUT_OF_BOUNDS:new De.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${k}`,N)}var Ie=/[^+/0-9A-Za-z-_]/g;function te(N){if(N=N.split("=")[0],N=N.trim().replace(Ie,""),N.length<2)return"";for(;N.length%4!==0;)N=N+"=";return N}function L(N,k){k=k||1/0;let $,J=N.length,ce=null,be=[];for(let Ne=0;Ne<J;++Ne){if($=N.charCodeAt(Ne),$>55295&&$<57344){if(!ce){if($>56319){(k-=3)>-1&&be.push(239,191,189);continue}else if(Ne+1===J){(k-=3)>-1&&be.push(239,191,189);continue}ce=$;continue}if($<56320){(k-=3)>-1&&be.push(239,191,189),ce=$;continue}$=(ce-55296<<10|$-56320)+65536}else ce&&(k-=3)>-1&&be.push(239,191,189);if(ce=null,$<128){if((k-=1)<0)break;be.push($)}else if($<2048){if((k-=2)<0)break;be.push($>>6|192,$&63|128)}else if($<65536){if((k-=3)<0)break;be.push($>>12|224,$>>6&63|128,$&63|128)}else if($<1114112){if((k-=4)<0)break;be.push($>>18|240,$>>12&63|128,$>>6&63|128,$&63|128)}else throw new Error("Invalid code point")}return be}function U(N){let k=[];for(let $=0;$<N.length;++$)k.push(N.charCodeAt($)&255);return k}function re(N,k){let $,J,ce,be=[];for(let Ne=0;Ne<N.length&&!((k-=2)<0);++Ne)$=N.charCodeAt(Ne),J=$>>8,ce=$%256,be.push(ce),be.push(J);return be}function q(N){return e.toByteArray(te(N))}function ie(N,k,$,J){let ce;for(ce=0;ce<J&&!(ce+$>=k.length||ce>=N.length);++ce)k[ce+$]=N[ce];return ce}function me(N,k){return N instanceof k||N!=null&&N.constructor!=null&&N.constructor.name!=null&&N.constructor.name===k.name}function je(N){return N!==N}var He=function(){let N="0123456789abcdef",k=new Array(256);for(let $=0;$<16;++$){let J=$*16;for(let ce=0;ce<16;++ce)k[J+ce]=N[$]+N[ce]}return k}();function Ge(N){return typeof BigInt>"u"?Je:N}function Je(){throw new Error("BigInt not supported")}});Mhe(yfe());/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/var aI=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Fd=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},nC,rC,ig,og;function JB(t){return t!==null&&typeof t=="object"}class yc{constructor(e){if(nC.set(this,void 0),rC.set(this,void 0),e.byteLength!==yc.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");aI(this,nC,e,"f"),aI(this,rC,yc.derEncode(e),"f")}static from(e){if(typeof e=="string"){const n=gu(e);return this.fromRaw(n)}else if(JB(e)){const n=e;if(JB(n)&&Object.hasOwnProperty.call(n,"__derEncodedPublicKey__"))return this.fromDer(n);if(ArrayBuffer.isView(n)){const r=n;return this.fromRaw(sD(r.buffer))}else{if(n instanceof ArrayBuffer)return this.fromRaw(n);if("rawKey"in n)return this.fromRaw(n.rawKey);if("derKey"in n)return this.fromDer(n.derKey);if("toDer"in n)return this.fromDer(n.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new yc(e)}static fromDer(e){return new yc(this.derDecode(e))}static derEncode(e){const n=AG(e,oI).buffer;return n.__derEncodedPublicKey__=void 0,n}static derDecode(e){const n=$G(e,oI);if(n.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return n}get rawKey(){return Fd(this,nC,"f")}get derKey(){return Fd(this,rC,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}nC=new WeakMap,rC=new WeakMap;yc.RAW_KEY_LENGTH=32;class Vo extends uD{constructor(e,n){super(),ig.set(this,void 0),og.set(this,void 0),aI(this,ig,yc.from(e),"f"),aI(this,og,new Uint8Array(n),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=eg.utils.randomPrivateKey()),R1(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const n=new Uint8Array(32);for(let s=0;s<32;s++)n[s]=new Uint8Array(e)[s];const r=eg.getPublicKey(n);return Vo.fromKeyPair(r,n)}static fromParsedJson(e){const[n,r]=e;return new Vo(yc.fromDer(gu(n)),gu(r))}static fromJSON(e){const n=JSON.parse(e);if(Array.isArray(n)){if(typeof n[0]=="string"&&typeof n[1]=="string")return this.fromParsedJson([n[0],n[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,n){return new Vo(yc.fromRaw(e),n)}static fromSecretKey(e){const n=eg.getPublicKey(new Uint8Array(e));return Vo.fromKeyPair(n,e)}toJSON(){return[On(Fd(this,ig,"f").toDer()),On(Fd(this,og,"f"))]}getKeyPair(){return{secretKey:Fd(this,og,"f"),publicKey:Fd(this,ig,"f")}}getPublicKey(){return Fd(this,ig,"f")}async sign(e){const n=new Uint8Array(e),r=ww(eg.sign(n,Fd(this,og,"f").slice(0,32)));return Object.defineProperty(r,"__signature__",{enumerable:!1,value:void 0}),r}static verify(e,n,r){const[s,i,o]=[e,n,r].map(a=>(typeof a=="string"&&(a=gu(a)),a instanceof Uint8Array&&(a=a.buffer),new Uint8Array(a)));return eg.verify(i,s,o)}}ig=new WeakMap,og=new WeakMap;class vD extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,vD.prototype)}}function e5(t){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new vD("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class lh extends uD{constructor(e,n,r){super(),this._keyPair=e,this._derKey=n,this._subtleCrypto=r}static async generate(e){const{extractable:n=!1,keyUsages:r=["sign","verify"],subtleCrypto:s}=e??{},i=e5(s),o=await i.generateKey({name:"ECDSA",namedCurve:"P-256"},n,r),a=await i.exportKey("spki",o.publicKey);return new this(o,a,i)}static async fromKeyPair(e,n){const r=e5(n),s=await r.exportKey("spki",e.publicKey);return new lh(e,s,r)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,n=Object.create(this._keyPair.publicKey);return n.toDer=function(){return e},n}async sign(e){const n={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(n,this._keyPair.privateKey,e)}}var xfe=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},vx=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Td;class s7{constructor(e){Td.set(this,void 0),xfe(this,Td,e,"f")}get rawKey(){return vx(this,Td,"f").rawKey}get derKey(){return vx(this,Td,"f").derKey}toDer(){return vx(this,Td,"f").toDer()}getPublicKey(){return vx(this,Td,"f")}getPrincipal(){return zt.from(vx(this,Td,"f").rawKey)}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}Td=new WeakMap;var wfe=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},bfe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},vfe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n},sC;const Sfe=new TextEncoder().encode("ic-request-auth-delegation"),Cfe=new TextEncoder().encode(`
ic-request`);function OA(t){if(typeof t!="string"||t.length<64)throw new Error("Invalid public key.");return gu(t)}class h0{constructor(e,n,r){this.pubkey=e,this.expiration=n,this.targets=r}toCBOR(){return Lo.value.map(Object.assign({pubkey:Lo.value.bytes(this.pubkey),expiration:Lo.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:Lo.value.array(this.targets.map(e=>Lo.value.bytes(e.toUint8Array())))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:On(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function Ife(t,e,n,r){const s=new h0(e.toDer(),BigInt(+n)*BigInt(1e6),r),i=new Uint8Array([...Sfe,...new Uint8Array(cp(Object.assign({},s)))]),o=await t.sign(i);return{delegation:s,signature:o}}class vl{constructor(e,n){this.delegations=e,this.publicKey=n}static async create(e,n,r=new Date(Date.now()+15*60*1e3),s={}){var i,o;const a=await Ife(e,n,r,s.targets);return new vl([...((i=s.previous)===null||i===void 0?void 0:i.delegations)||[],a],((o=s.previous)===null||o===void 0?void 0:o.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:n,delegations:r}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(r))throw new Error("Invalid delegations.");const s=r.map(i=>{const{delegation:o,signature:a}=i,{pubkey:l,expiration:u,targets:c}=o;if(c!==void 0&&!Array.isArray(c))throw new Error("Invalid targets.");return{delegation:new h0(OA(l),BigInt("0x"+u),c&&c.map(d=>{if(typeof d!="string")throw new Error("Invalid target.");return zt.fromHex(d)})),signature:OA(a)}});return new this(s,OA(n))}static fromDelegations(e,n){return new this(e,n)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:n,signature:r}=e,{targets:s}=n;return{delegation:Object.assign({expiration:n.expiration.toString(16),pubkey:On(n.pubkey)},s&&{targets:s.map(i=>i.toHex())}),signature:On(r)}}),publicKey:On(this.publicKey)}}}class lI extends uD{constructor(e,n){super(),this._inner=e,this._delegation=n}static fromDelegation(e,n){return new this(e,n)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:n}=e,r=vfe(e,["body"]),s=await cp(n);return Object.assign(Object.assign({},r),{body:{content:n,sender_sig:await this.sign(new Uint8Array([...Cfe,...new Uint8Array(s)])),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Yw extends s7{constructor(e,n){super(e),sC.set(this,void 0),wfe(this,sC,n,"f")}get delegation(){return bfe(this,sC,"f")}static fromDelegation(e,n){return new Yw(e,n)}}sC=new WeakMap;function ON(t,e){for(const{delegation:r}of t.delegations)if(+new Date(Number(r.expiration/BigInt(1e6)))<=+Date.now())return!1;const n=[];for(const r of n){const s=r.toText();for(const{delegation:i}of t.delegations){if(i.targets===void 0)continue;let o=!0;for(const a of i.targets)if(a.toText()===s){o=!1;break}if(o)return!1}}return!0}var t5;(function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(t5||(t5={}));function PN(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function i7(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const r=PN(n);return(s,i)=>r.then(o=>i(o.transaction(e,s).objectStore(e)))}let PA;function SD(){return PA||(PA=i7("keyval-store","keyval")),PA}function Nfe(t,e=SD()){return e("readonly",n=>PN(n.get(t)))}function kfe(t,e,n=SD()){return n("readwrite",r=>(r.put(e,t),PN(r.transaction)))}function Tfe(t,e=SD()){return e("readwrite",n=>(n.delete(t),PN(n.transaction)))}let CD=class{get store(){return this._store||(this._store=i7("signer-db","signer-store")),this._store}async get(e){return Nfe(e,this.store)}async set(e,n){return kfe(e,n,this.store)}async remove(e){return Tfe(e,this.store)}};const o7=async(t,e)=>{const n=await e.get(`identity-${t}`);if(n)return typeof n=="string"?Vo.fromJSON(n):lh.fromKeyPair(n)},a7=async(t,e,n)=>{const r=e instanceof Vo?JSON.stringify(e.toJSON()):e.getKeyPair();return n.set(`identity-${t}`,r)},Efe=async(t,e)=>e.remove(`identity-${t}`),z$=async(t,e)=>{const n=await e.get(`delegation-${t}`);if(!(!n||typeof n!="string"))return vl.fromJSON(n)},l7=async(t,e,n)=>n.set(`delegation-${t}`,JSON.stringify(e.toJSON())),u7=async(t,e)=>e.remove(`delegation-${t}`),c7=-32600,d7=2e3,ID=4e3,FA=1e5,Fo=t=>{if(typeof globalThis.Buffer<"u")return globalThis.Buffer.from(t,"base64").buffer;if(typeof globalThis.atob<"u")return Uint8Array.from(globalThis.atob(t),e=>e.charCodeAt(0)).buffer;throw Error("Could not decode base64 string")},uo=t=>{if(typeof globalThis.Buffer<"u")return globalThis.Buffer.from(t).toString("base64");if(typeof globalThis.btoa<"u")return btoa(Array.from({length:Math.ceil(t.byteLength/FA)}).map((e,n)=>String.fromCharCode(...new Uint8Array(t.slice(n*FA,(n+1)*FA)))).join(""));throw Error("Could not encode base64 string")};var zm=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Yr=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ai,sc,ag,iC;class jg extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,jg.prototype),this.code=e.code,this.data=e.data}}const n5=t=>new jg({code:ID,message:t instanceof Error?t.message:"Network error"}),Bm=t=>{if("error"in t)throw new jg(t.error);if("result"in t)return t.result;throw new jg({code:ID,message:"Invalid response"})};class r5{constructor(e){Ai.set(this,void 0),sc.set(this,void 0),ag.set(this,void 0),iC.set(this,void 0),zm(this,Ai,Object.assign({autoCloseTransportChannel:!0,closeTransportChannelAfter:200,crypto:globalThis.crypto},e),"f")}get transport(){return Yr(this,Ai,"f").transport}async openChannel(){if(clearTimeout(Yr(this,iC,"f")),Yr(this,ag,"f")&&await Yr(this,ag,"f"),Yr(this,sc,"f")&&!Yr(this,sc,"f").closed)return Yr(this,sc,"f");const e=Yr(this,Ai,"f").transport.establishChannel();return zm(this,ag,e.then(()=>{}).catch(()=>{}),"f"),zm(this,sc,void 0,"f"),zm(this,sc,await e.catch(n=>{throw n5(n)}),"f"),zm(this,ag,void 0,"f"),Yr(this,sc,"f")}async closeChannel(){var e;await((e=Yr(this,sc,"f"))===null||e===void 0?void 0:e.close())}async transformRequest(e){return Yr(this,Ai,"f").derivationOrigin?Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},e.params),{icrc95DerivationOrigin:Yr(this,Ai,"f").derivationOrigin})}):e}async sendRequest(e){const n=await this.openChannel();return new Promise(async(r,s)=>{const i=n.addEventListener("response",async a=>{a.id===e.id&&(i(),o(),r(a),Yr(this,Ai,"f").autoCloseTransportChannel&&zm(this,iC,setTimeout(()=>{n.closed||n.close()},Yr(this,Ai,"f").closeTransportChannelAfter),"f"))}),o=n.addEventListener("close",()=>{i(),o(),s(new jg({code:ID,message:"Channel was closed before a response was received"}))});try{await n.send(await this.transformRequest(e))}catch(a){i(),o(),s(n5(a))}})}async supportedStandards(){const e=await this.sendRequest({id:Yr(this,Ai,"f").crypto.randomUUID(),jsonrpc:"2.0",method:"icrc25_supported_standards"});return Bm(e).supportedStandards}async requestPermissions(e){const n=await this.sendRequest({id:Yr(this,Ai,"f").crypto.randomUUID(),jsonrpc:"2.0",method:"icrc25_request_permissions",params:{scopes:e}});return Bm(n).scopes}async permissions(){const e=await this.sendRequest({id:Yr(this,Ai,"f").crypto.randomUUID(),jsonrpc:"2.0",method:"icrc25_permissions"});return Bm(e).scopes}async accounts(){const e=await this.sendRequest({id:Yr(this,Ai,"f").crypto.randomUUID(),jsonrpc:"2.0",method:"icrc27_accounts"});return Bm(e).accounts.map(({owner:r,subaccount:s})=>({owner:zt.fromText(r),subaccount:s===void 0?void 0:Fo(s)}))}async delegation(e){var n;const r=await this.sendRequest({id:Yr(this,Ai,"f").crypto.randomUUID(),jsonrpc:"2.0",method:"icrc34_delegation",params:{publicKey:uo(e.publicKey),targets:(n=e.targets)===null||n===void 0?void 0:n.map(i=>i.toText()),maxTimeToLive:e.maxTimeToLive===void 0?void 0:String(e.maxTimeToLive)}}),s=Bm(r);return vl.fromDelegations(s.signerDelegation.map(i=>{var o;return{delegation:new h0(Fo(i.delegation.pubkey),BigInt(i.delegation.expiration),(o=i.delegation.targets)===null||o===void 0?void 0:o.map(a=>zt.fromText(a))),signature:Fo(i.signature)}}),Fo(s.publicKey))}async callCanister(e){const n=await this.sendRequest({id:Yr(this,Ai,"f").crypto.randomUUID(),jsonrpc:"2.0",method:"icrc49_call_canister",params:{canisterId:e.canisterId.toText(),sender:e.sender.toText(),method:e.method,arg:uo(e.arg)}}),r=Bm(n),s=Fo(r.contentMap),i=Fo(r.certificate);return{contentMap:s,certificate:i}}}Ai=new WeakMap,sc=new WeakMap,ag=new WeakMap,iC=new WeakMap;const h7=t=>typeof t=="object"&&!!t&&"jsonrpc"in t&&t.jsonrpc==="2.0",f7=t=>h7(t)&&"method"in t&&typeof t.method=="string",p7=t=>h7(t)&&"id"in t&&(typeof t.id=="string"||typeof t.id=="number");var _fe=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,LA=Math.ceil,ha=Math.floor,io="[BigNumber Error] ",s5=io+"Number primitive has more than 15 significant digits: ",Ja=1e14,tn=14,i5=9007199254740991,zA=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Cd=1e7,Ro=1e9;function m7(t){var e,n,r,s=b.prototype={constructor:b,toString:null,valueOf:null},i=new b(1),o=20,a=4,l=-7,u=21,c=-1e7,d=1e7,h=!1,f=1,m=0,g={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},x="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function b(I,E){var M,O,j,R,z,B,V,H,K=this;if(!(K instanceof b))return new b(I,E);if(E==null){if(I&&I._isBigNumber===!0){K.s=I.s,!I.c||I.e>d?K.c=K.e=null:I.e<c?K.c=[K.e=0]:(K.e=I.e,K.c=I.c.slice());return}if((B=typeof I=="number")&&I*0==0){if(K.s=1/I<0?(I=-I,-1):1,I===~~I){for(R=0,z=I;z>=10;z/=10,R++);R>d?K.c=K.e=null:(K.e=R,K.c=[I]);return}H=String(I)}else{if(!_fe.test(H=String(I)))return r(K,H,B);K.s=H.charCodeAt(0)==45?(H=H.slice(1),-1):1}(R=H.indexOf("."))>-1&&(H=H.replace(".","")),(z=H.search(/e/i))>0?(R<0&&(R=z),R+=+H.slice(z+1),H=H.substring(0,z)):R<0&&(R=H.length)}else{if(yr(E,2,x.length,"Base"),E==10&&w)return K=new b(I),D(K,o+K.e+1,a);if(H=String(I),B=typeof I=="number"){if(I*0!=0)return r(K,H,B,E);if(K.s=1/I<0?(H=H.slice(1),-1):1,b.DEBUG&&H.replace(/^0\.0*|\./,"").length>15)throw Error(s5+I)}else K.s=H.charCodeAt(0)===45?(H=H.slice(1),-1):1;for(M=x.slice(0,E),R=z=0,V=H.length;z<V;z++)if(M.indexOf(O=H.charAt(z))<0){if(O=="."){if(z>R){R=V;continue}}else if(!j&&(H==H.toUpperCase()&&(H=H.toLowerCase())||H==H.toLowerCase()&&(H=H.toUpperCase()))){j=!0,z=-1,R=0;continue}return r(K,String(I),B,E)}B=!1,H=n(H,E,10,K.s),(R=H.indexOf("."))>-1?H=H.replace(".",""):R=H.length}for(z=0;H.charCodeAt(z)===48;z++);for(V=H.length;H.charCodeAt(--V)===48;);if(H=H.slice(z,++V)){if(V-=z,B&&b.DEBUG&&V>15&&(I>i5||I!==ha(I)))throw Error(s5+K.s*I);if((R=R-z-1)>d)K.c=K.e=null;else if(R<c)K.c=[K.e=0];else{if(K.e=R,K.c=[],z=(R+1)%tn,R<0&&(z+=tn),z<V){for(z&&K.c.push(+H.slice(0,z)),V-=tn;z<V;)K.c.push(+H.slice(z,z+=tn));z=tn-(H=H.slice(z)).length}else z-=V;for(;z--;H+="0");K.c.push(+H)}}else K.c=[K.e=0]}b.clone=m7,b.ROUND_UP=0,b.ROUND_DOWN=1,b.ROUND_CEIL=2,b.ROUND_FLOOR=3,b.ROUND_HALF_UP=4,b.ROUND_HALF_DOWN=5,b.ROUND_HALF_EVEN=6,b.ROUND_HALF_CEIL=7,b.ROUND_HALF_FLOOR=8,b.EUCLID=9,b.config=b.set=function(I){var E,M;if(I!=null)if(typeof I=="object"){if(I.hasOwnProperty(E="DECIMAL_PLACES")&&(M=I[E],yr(M,0,Ro,E),o=M),I.hasOwnProperty(E="ROUNDING_MODE")&&(M=I[E],yr(M,0,8,E),a=M),I.hasOwnProperty(E="EXPONENTIAL_AT")&&(M=I[E],M&&M.pop?(yr(M[0],-1e9,0,E),yr(M[1],0,Ro,E),l=M[0],u=M[1]):(yr(M,-1e9,Ro,E),l=-(u=M<0?-M:M))),I.hasOwnProperty(E="RANGE"))if(M=I[E],M&&M.pop)yr(M[0],-1e9,-1,E),yr(M[1],1,Ro,E),c=M[0],d=M[1];else if(yr(M,-1e9,Ro,E),M)c=-(d=M<0?-M:M);else throw Error(io+E+" cannot be zero: "+M);if(I.hasOwnProperty(E="CRYPTO"))if(M=I[E],M===!!M)if(M)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))h=M;else throw h=!M,Error(io+"crypto unavailable");else h=M;else throw Error(io+E+" not true or false: "+M);if(I.hasOwnProperty(E="MODULO_MODE")&&(M=I[E],yr(M,0,9,E),f=M),I.hasOwnProperty(E="POW_PRECISION")&&(M=I[E],yr(M,0,Ro,E),m=M),I.hasOwnProperty(E="FORMAT"))if(M=I[E],typeof M=="object")g=M;else throw Error(io+E+" not an object: "+M);if(I.hasOwnProperty(E="ALPHABET"))if(M=I[E],typeof M=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(M))w=M.slice(0,10)=="0123456789",x=M;else throw Error(io+E+" invalid: "+M)}else throw Error(io+"Object expected: "+I);return{DECIMAL_PLACES:o,ROUNDING_MODE:a,EXPONENTIAL_AT:[l,u],RANGE:[c,d],CRYPTO:h,MODULO_MODE:f,POW_PRECISION:m,FORMAT:g,ALPHABET:x}},b.isBigNumber=function(I){if(!I||I._isBigNumber!==!0)return!1;if(!b.DEBUG)return!0;var E,M,O=I.c,j=I.e,R=I.s;e:if({}.toString.call(O)=="[object Array]"){if((R===1||R===-1)&&j>=-1e9&&j<=Ro&&j===ha(j)){if(O[0]===0){if(j===0&&O.length===1)return!0;break e}if(E=(j+1)%tn,E<1&&(E+=tn),String(O[0]).length==E){for(E=0;E<O.length;E++)if(M=O[E],M<0||M>=Ja||M!==ha(M))break e;if(M!==0)return!0}}}else if(O===null&&j===null&&(R===null||R===1||R===-1))return!0;throw Error(io+"Invalid BigNumber: "+I)},b.maximum=b.max=function(){return C(arguments,-1)},b.minimum=b.min=function(){return C(arguments,1)},b.random=function(){var I=9007199254740992,E=Math.random()*I&2097151?function(){return ha(Math.random()*I)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(M){var O,j,R,z,B,V=0,H=[],K=new b(i);if(M==null?M=o:yr(M,0,Ro),z=LA(M/tn),h)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(z*=2));V<z;)B=O[V]*131072+(O[V+1]>>>11),B>=9e15?(j=crypto.getRandomValues(new Uint32Array(2)),O[V]=j[0],O[V+1]=j[1]):(H.push(B%1e14),V+=2);V=z/2}else if(crypto.randomBytes){for(O=crypto.randomBytes(z*=7);V<z;)B=(O[V]&31)*281474976710656+O[V+1]*1099511627776+O[V+2]*4294967296+O[V+3]*16777216+(O[V+4]<<16)+(O[V+5]<<8)+O[V+6],B>=9e15?crypto.randomBytes(7).copy(O,V):(H.push(B%1e14),V+=7);V=z/7}else throw h=!1,Error(io+"crypto unavailable");if(!h)for(;V<z;)B=E(),B<9e15&&(H[V++]=B%1e14);for(z=H[--V],M%=tn,z&&M&&(B=zA[tn-M],H[V]=ha(z/B)*B);H[V]===0;H.pop(),V--);if(V<0)H=[R=0];else{for(R=-1;H[0]===0;H.splice(0,1),R-=tn);for(V=1,B=H[0];B>=10;B/=10,V++);V<tn&&(R-=tn-V)}return K.e=R,K.c=H,K}}(),b.sum=function(){for(var I=1,E=arguments,M=new b(E[0]);I<E.length;)M=M.plus(E[I++]);return M},n=function(){var I="0123456789";function E(M,O,j,R){for(var z,B=[0],V,H=0,K=M.length;H<K;){for(V=B.length;V--;B[V]*=O);for(B[0]+=R.indexOf(M.charAt(H++)),z=0;z<B.length;z++)B[z]>j-1&&(B[z+1]==null&&(B[z+1]=0),B[z+1]+=B[z]/j|0,B[z]%=j)}return B.reverse()}return function(M,O,j,R,z){var B,V,H,K,ne,fe,ee,de,ge=M.indexOf("."),Z=o,we=a;for(ge>=0&&(K=m,m=0,M=M.replace(".",""),de=new b(O),fe=de.pow(M.length-ge),m=K,de.c=E(ec(la(fe.c),fe.e,"0"),10,j,I),de.e=de.c.length),ee=E(M,O,j,z?(B=x,I):(B=I,x)),H=K=ee.length;ee[--K]==0;ee.pop());if(!ee[0])return B.charAt(0);if(ge<0?--H:(fe.c=ee,fe.e=H,fe.s=R,fe=e(fe,de,Z,we,j),ee=fe.c,ne=fe.r,H=fe.e),V=H+Z+1,ge=ee[V],K=j/2,ne=ne||V<0||ee[V+1]!=null,ne=we<4?(ge!=null||ne)&&(we==0||we==(fe.s<0?3:2)):ge>K||ge==K&&(we==4||ne||we==6&&ee[V-1]&1||we==(fe.s<0?8:7)),V<1||!ee[0])M=ne?ec(B.charAt(1),-Z,B.charAt(0)):B.charAt(0);else{if(ee.length=V,ne)for(--j;++ee[--V]>j;)ee[V]=0,V||(++H,ee=[1].concat(ee));for(K=ee.length;!ee[--K];);for(ge=0,M="";ge<=K;M+=B.charAt(ee[ge++]));M=ec(M,H,B.charAt(0))}return M}}(),e=function(){function I(O,j,R){var z,B,V,H,K=0,ne=O.length,fe=j%Cd,ee=j/Cd|0;for(O=O.slice();ne--;)V=O[ne]%Cd,H=O[ne]/Cd|0,z=ee*V+H*fe,B=fe*V+z%Cd*Cd+K,K=(B/R|0)+(z/Cd|0)+ee*H,O[ne]=B%R;return K&&(O=[K].concat(O)),O}function E(O,j,R,z){var B,V;if(R!=z)V=R>z?1:-1;else for(B=V=0;B<R;B++)if(O[B]!=j[B]){V=O[B]>j[B]?1:-1;break}return V}function M(O,j,R,z){for(var B=0;R--;)O[R]-=B,B=O[R]<j[R]?1:0,O[R]=B*z+O[R]-j[R];for(;!O[0]&&O.length>1;O.splice(0,1));}return function(O,j,R,z,B){var V,H,K,ne,fe,ee,de,ge,Z,we,Ee,Le,De,Be,se,le,ye,ve=O.s==j.s?1:-1,xe=O.c,Ie=j.c;if(!xe||!xe[0]||!Ie||!Ie[0])return new b(!O.s||!j.s||(xe?Ie&&xe[0]==Ie[0]:!Ie)?NaN:xe&&xe[0]==0||!Ie?ve*0:ve/0);for(ge=new b(ve),Z=ge.c=[],H=O.e-j.e,ve=R+H+1,B||(B=Ja,H=fa(O.e/tn)-fa(j.e/tn),ve=ve/tn|0),K=0;Ie[K]==(xe[K]||0);K++);if(Ie[K]>(xe[K]||0)&&H--,ve<0)Z.push(1),ne=!0;else{for(Be=xe.length,le=Ie.length,K=0,ve+=2,fe=ha(B/(Ie[0]+1)),fe>1&&(Ie=I(Ie,fe,B),xe=I(xe,fe,B),le=Ie.length,Be=xe.length),De=le,we=xe.slice(0,le),Ee=we.length;Ee<le;we[Ee++]=0);ye=Ie.slice(),ye=[0].concat(ye),se=Ie[0],Ie[1]>=B/2&&se++;do{if(fe=0,V=E(Ie,we,le,Ee),V<0){if(Le=we[0],le!=Ee&&(Le=Le*B+(we[1]||0)),fe=ha(Le/se),fe>1)for(fe>=B&&(fe=B-1),ee=I(Ie,fe,B),de=ee.length,Ee=we.length;E(ee,we,de,Ee)==1;)fe--,M(ee,le<de?ye:Ie,de,B),de=ee.length,V=1;else fe==0&&(V=fe=1),ee=Ie.slice(),de=ee.length;if(de<Ee&&(ee=[0].concat(ee)),M(we,ee,Ee,B),Ee=we.length,V==-1)for(;E(Ie,we,le,Ee)<1;)fe++,M(we,le<Ee?ye:Ie,Ee,B),Ee=we.length}else V===0&&(fe++,we=[0]);Z[K++]=fe,we[0]?we[Ee++]=xe[De]||0:(we=[xe[De]],Ee=1)}while((De++<Be||we[0]!=null)&&ve--);ne=we[0]!=null,Z[0]||Z.splice(0,1)}if(B==Ja){for(K=1,ve=Z[0];ve>=10;ve/=10,K++);D(ge,R+(ge.e=K+H*tn-1)+1,z,ne)}else ge.e=H,ge.r=+ne;return ge}}();function S(I,E,M,O){var j,R,z,B,V;if(M==null?M=a:yr(M,0,8),!I.c)return I.toString();if(j=I.c[0],z=I.e,E==null)V=la(I.c),V=O==1||O==2&&(z<=l||z>=u)?z2(V,z):ec(V,z,"0");else if(I=D(new b(I),E,M),R=I.e,V=la(I.c),B=V.length,O==1||O==2&&(E<=R||R<=l)){for(;B<E;V+="0",B++);V=z2(V,R)}else if(E-=z,V=ec(V,R,"0"),R+1>B){if(--E>0)for(V+=".";E--;V+="0");}else if(E+=R-B,E>0)for(R+1==B&&(V+=".");E--;V+="0");return I.s<0&&j?"-"+V:V}function C(I,E){for(var M,O,j=1,R=new b(I[0]);j<I.length;j++)O=new b(I[j]),(!O.s||(M=mf(R,O))===E||M===0&&R.s===E)&&(R=O);return R}function T(I,E,M){for(var O=1,j=E.length;!E[--j];E.pop());for(j=E[0];j>=10;j/=10,O++);return(M=O+M*tn-1)>d?I.c=I.e=null:M<c?I.c=[I.e=0]:(I.e=M,I.c=E),I}r=function(){var I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,E=/^([^.]+)\.$/,M=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,j=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,z,B,V){var H,K=B?z:z.replace(j,"");if(O.test(K))R.s=isNaN(K)?null:K<0?-1:1;else{if(!B&&(K=K.replace(I,function(ne,fe,ee){return H=(ee=ee.toLowerCase())=="x"?16:ee=="b"?2:8,!V||V==H?fe:ne}),V&&(H=V,K=K.replace(E,"$1").replace(M,"0.$1")),z!=K))return new b(K,H);if(b.DEBUG)throw Error(io+"Not a"+(V?" base "+V:"")+" number: "+z);R.s=null}R.c=R.e=null}}();function D(I,E,M,O){var j,R,z,B,V,H,K,ne=I.c,fe=zA;if(ne){e:{for(j=1,B=ne[0];B>=10;B/=10,j++);if(R=E-j,R<0)R+=tn,z=E,V=ne[H=0],K=ha(V/fe[j-z-1]%10);else if(H=LA((R+1)/tn),H>=ne.length)if(O){for(;ne.length<=H;ne.push(0));V=K=0,j=1,R%=tn,z=R-tn+1}else break e;else{for(V=B=ne[H],j=1;B>=10;B/=10,j++);R%=tn,z=R-tn+j,K=z<0?0:ha(V/fe[j-z-1]%10)}if(O=O||E<0||ne[H+1]!=null||(z<0?V:V%fe[j-z-1]),O=M<4?(K||O)&&(M==0||M==(I.s<0?3:2)):K>5||K==5&&(M==4||O||M==6&&(R>0?z>0?V/fe[j-z]:0:ne[H-1])%10&1||M==(I.s<0?8:7)),E<1||!ne[0])return ne.length=0,O?(E-=I.e+1,ne[0]=fe[(tn-E%tn)%tn],I.e=-E||0):ne[0]=I.e=0,I;if(R==0?(ne.length=H,B=1,H--):(ne.length=H+1,B=fe[tn-R],ne[H]=z>0?ha(V/fe[j-z]%fe[z])*B:0),O)for(;;)if(H==0){for(R=1,z=ne[0];z>=10;z/=10,R++);for(z=ne[0]+=B,B=1;z>=10;z/=10,B++);R!=B&&(I.e++,ne[0]==Ja&&(ne[0]=1));break}else{if(ne[H]+=B,ne[H]!=Ja)break;ne[H--]=0,B=1}for(R=ne.length;ne[--R]===0;ne.pop());}I.e>d?I.c=I.e=null:I.e<c&&(I.c=[I.e=0])}return I}function P(I){var E,M=I.e;return M===null?I.toString():(E=la(I.c),E=M<=l||M>=u?z2(E,M):ec(E,M,"0"),I.s<0?"-"+E:E)}return s.absoluteValue=s.abs=function(){var I=new b(this);return I.s<0&&(I.s=1),I},s.comparedTo=function(I,E){return mf(this,new b(I,E))},s.decimalPlaces=s.dp=function(I,E){var M,O,j,R=this;if(I!=null)return yr(I,0,Ro),E==null?E=a:yr(E,0,8),D(new b(R),I+R.e+1,E);if(!(M=R.c))return null;if(O=((j=M.length-1)-fa(this.e/tn))*tn,j=M[j])for(;j%10==0;j/=10,O--);return O<0&&(O=0),O},s.dividedBy=s.div=function(I,E){return e(this,new b(I,E),o,a)},s.dividedToIntegerBy=s.idiv=function(I,E){return e(this,new b(I,E),0,1)},s.exponentiatedBy=s.pow=function(I,E){var M,O,j,R,z,B,V,H,K,ne=this;if(I=new b(I),I.c&&!I.isInteger())throw Error(io+"Exponent not an integer: "+P(I));if(E!=null&&(E=new b(E)),B=I.e>14,!ne.c||!ne.c[0]||ne.c[0]==1&&!ne.e&&ne.c.length==1||!I.c||!I.c[0])return K=new b(Math.pow(+P(ne),B?I.s*(2-L2(I)):+P(I))),E?K.mod(E):K;if(V=I.s<0,E){if(E.c?!E.c[0]:!E.s)return new b(NaN);O=!V&&ne.isInteger()&&E.isInteger(),O&&(ne=ne.mod(E))}else{if(I.e>9&&(ne.e>0||ne.e<-1||(ne.e==0?ne.c[0]>1||B&&ne.c[1]>=24e7:ne.c[0]<8e13||B&&ne.c[0]<=9999975e7)))return R=ne.s<0&&L2(I)?-0:0,ne.e>-1&&(R=1/R),new b(V?1/R:R);m&&(R=LA(m/tn+2))}for(B?(M=new b(.5),V&&(I.s=1),H=L2(I)):(j=Math.abs(+P(I)),H=j%2),K=new b(i);;){if(H){if(K=K.times(ne),!K.c)break;R?K.c.length>R&&(K.c.length=R):O&&(K=K.mod(E))}if(j){if(j=ha(j/2),j===0)break;H=j%2}else if(I=I.times(M),D(I,I.e+1,1),I.e>14)H=L2(I);else{if(j=+P(I),j===0)break;H=j%2}ne=ne.times(ne),R?ne.c&&ne.c.length>R&&(ne.c.length=R):O&&(ne=ne.mod(E))}return O?K:(V&&(K=i.div(K)),E?K.mod(E):R?D(K,m,a,z):K)},s.integerValue=function(I){var E=new b(this);return I==null?I=a:yr(I,0,8),D(E,E.e+1,I)},s.isEqualTo=s.eq=function(I,E){return mf(this,new b(I,E))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(I,E){return mf(this,new b(I,E))>0},s.isGreaterThanOrEqualTo=s.gte=function(I,E){return(E=mf(this,new b(I,E)))===1||E===0},s.isInteger=function(){return!!this.c&&fa(this.e/tn)>this.c.length-2},s.isLessThan=s.lt=function(I,E){return mf(this,new b(I,E))<0},s.isLessThanOrEqualTo=s.lte=function(I,E){return(E=mf(this,new b(I,E)))===-1||E===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(I,E){var M,O,j,R,z=this,B=z.s;if(I=new b(I,E),E=I.s,!B||!E)return new b(NaN);if(B!=E)return I.s=-E,z.plus(I);var V=z.e/tn,H=I.e/tn,K=z.c,ne=I.c;if(!V||!H){if(!K||!ne)return K?(I.s=-E,I):new b(ne?z:NaN);if(!K[0]||!ne[0])return ne[0]?(I.s=-E,I):new b(K[0]?z:a==3?-0:0)}if(V=fa(V),H=fa(H),K=K.slice(),B=V-H){for((R=B<0)?(B=-B,j=K):(H=V,j=ne),j.reverse(),E=B;E--;j.push(0));j.reverse()}else for(O=(R=(B=K.length)<(E=ne.length))?B:E,B=E=0;E<O;E++)if(K[E]!=ne[E]){R=K[E]<ne[E];break}if(R&&(j=K,K=ne,ne=j,I.s=-I.s),E=(O=ne.length)-(M=K.length),E>0)for(;E--;K[M++]=0);for(E=Ja-1;O>B;){if(K[--O]<ne[O]){for(M=O;M&&!K[--M];K[M]=E);--K[M],K[O]+=Ja}K[O]-=ne[O]}for(;K[0]==0;K.splice(0,1),--H);return K[0]?T(I,K,H):(I.s=a==3?-1:1,I.c=[I.e=0],I)},s.modulo=s.mod=function(I,E){var M,O,j=this;return I=new b(I,E),!j.c||!I.s||I.c&&!I.c[0]?new b(NaN):!I.c||j.c&&!j.c[0]?new b(j):(f==9?(O=I.s,I.s=1,M=e(j,I,0,3),I.s=O,M.s*=O):M=e(j,I,0,f),I=j.minus(M.times(I)),!I.c[0]&&f==1&&(I.s=j.s),I)},s.multipliedBy=s.times=function(I,E){var M,O,j,R,z,B,V,H,K,ne,fe,ee,de,ge,Z,we=this,Ee=we.c,Le=(I=new b(I,E)).c;if(!Ee||!Le||!Ee[0]||!Le[0])return!we.s||!I.s||Ee&&!Ee[0]&&!Le||Le&&!Le[0]&&!Ee?I.c=I.e=I.s=null:(I.s*=we.s,!Ee||!Le?I.c=I.e=null:(I.c=[0],I.e=0)),I;for(O=fa(we.e/tn)+fa(I.e/tn),I.s*=we.s,V=Ee.length,ne=Le.length,V<ne&&(de=Ee,Ee=Le,Le=de,j=V,V=ne,ne=j),j=V+ne,de=[];j--;de.push(0));for(ge=Ja,Z=Cd,j=ne;--j>=0;){for(M=0,fe=Le[j]%Z,ee=Le[j]/Z|0,z=V,R=j+z;R>j;)H=Ee[--z]%Z,K=Ee[z]/Z|0,B=ee*H+K*fe,H=fe*H+B%Z*Z+de[R]+M,M=(H/ge|0)+(B/Z|0)+ee*K,de[R--]=H%ge;de[R]=M}return M?++O:de.splice(0,1),T(I,de,O)},s.negated=function(){var I=new b(this);return I.s=-I.s||null,I},s.plus=function(I,E){var M,O=this,j=O.s;if(I=new b(I,E),E=I.s,!j||!E)return new b(NaN);if(j!=E)return I.s=-E,O.minus(I);var R=O.e/tn,z=I.e/tn,B=O.c,V=I.c;if(!R||!z){if(!B||!V)return new b(j/0);if(!B[0]||!V[0])return V[0]?I:new b(B[0]?O:j*0)}if(R=fa(R),z=fa(z),B=B.slice(),j=R-z){for(j>0?(z=R,M=V):(j=-j,M=B),M.reverse();j--;M.push(0));M.reverse()}for(j=B.length,E=V.length,j-E<0&&(M=V,V=B,B=M,E=j),j=0;E;)j=(B[--E]=B[E]+V[E]+j)/Ja|0,B[E]=Ja===B[E]?0:B[E]%Ja;return j&&(B=[j].concat(B),++z),T(I,B,z)},s.precision=s.sd=function(I,E){var M,O,j,R=this;if(I!=null&&I!==!!I)return yr(I,1,Ro),E==null?E=a:yr(E,0,8),D(new b(R),I,E);if(!(M=R.c))return null;if(j=M.length-1,O=j*tn+1,j=M[j]){for(;j%10==0;j/=10,O--);for(j=M[0];j>=10;j/=10,O++);}return I&&R.e+1>O&&(O=R.e+1),O},s.shiftedBy=function(I){return yr(I,-9007199254740991,i5),this.times("1e"+I)},s.squareRoot=s.sqrt=function(){var I,E,M,O,j,R=this,z=R.c,B=R.s,V=R.e,H=o+4,K=new b("0.5");if(B!==1||!z||!z[0])return new b(!B||B<0&&(!z||z[0])?NaN:z?R:1/0);if(B=Math.sqrt(+P(R)),B==0||B==1/0?(E=la(z),(E.length+V)%2==0&&(E+="0"),B=Math.sqrt(+E),V=fa((V+1)/2)-(V<0||V%2),B==1/0?E="5e"+V:(E=B.toExponential(),E=E.slice(0,E.indexOf("e")+1)+V),M=new b(E)):M=new b(B+""),M.c[0]){for(V=M.e,B=V+H,B<3&&(B=0);;)if(j=M,M=K.times(j.plus(e(R,j,H,1))),la(j.c).slice(0,B)===(E=la(M.c)).slice(0,B))if(M.e<V&&--B,E=E.slice(B-3,B+1),E=="9999"||!O&&E=="4999"){if(!O&&(D(j,j.e+o+2,0),j.times(j).eq(R))){M=j;break}H+=4,B+=4,O=1}else{(!+E||!+E.slice(1)&&E.charAt(0)=="5")&&(D(M,M.e+o+2,1),I=!M.times(M).eq(R));break}}return D(M,M.e+o+1,a,I)},s.toExponential=function(I,E){return I!=null&&(yr(I,0,Ro),I++),S(this,I,E,1)},s.toFixed=function(I,E){return I!=null&&(yr(I,0,Ro),I=I+this.e+1),S(this,I,E)},s.toFormat=function(I,E,M){var O,j=this;if(M==null)I!=null&&E&&typeof E=="object"?(M=E,E=null):I&&typeof I=="object"?(M=I,I=E=null):M=g;else if(typeof M!="object")throw Error(io+"Argument not an object: "+M);if(O=j.toFixed(I,E),j.c){var R,z=O.split("."),B=+M.groupSize,V=+M.secondaryGroupSize,H=M.groupSeparator||"",K=z[0],ne=z[1],fe=j.s<0,ee=fe?K.slice(1):K,de=ee.length;if(V&&(R=B,B=V,V=R,de-=R),B>0&&de>0){for(R=de%B||B,K=ee.substr(0,R);R<de;R+=B)K+=H+ee.substr(R,B);V>0&&(K+=H+ee.slice(R)),fe&&(K="-"+K)}O=ne?K+(M.decimalSeparator||"")+((V=+M.fractionGroupSize)?ne.replace(new RegExp("\\d{"+V+"}\\B","g"),"$&"+(M.fractionGroupSeparator||"")):ne):K}return(M.prefix||"")+O+(M.suffix||"")},s.toFraction=function(I){var E,M,O,j,R,z,B,V,H,K,ne,fe,ee=this,de=ee.c;if(I!=null&&(B=new b(I),!B.isInteger()&&(B.c||B.s!==1)||B.lt(i)))throw Error(io+"Argument "+(B.isInteger()?"out of range: ":"not an integer: ")+P(B));if(!de)return new b(ee);for(E=new b(i),H=M=new b(i),O=V=new b(i),fe=la(de),R=E.e=fe.length-ee.e-1,E.c[0]=zA[(z=R%tn)<0?tn+z:z],I=!I||B.comparedTo(E)>0?R>0?E:H:B,z=d,d=1/0,B=new b(fe),V.c[0]=0;K=e(B,E,0,1),j=M.plus(K.times(O)),j.comparedTo(I)!=1;)M=O,O=j,H=V.plus(K.times(j=H)),V=j,E=B.minus(K.times(j=E)),B=j;return j=e(I.minus(M),O,0,1),V=V.plus(j.times(H)),M=M.plus(j.times(O)),V.s=H.s=ee.s,R=R*2,ne=e(H,O,R,a).minus(ee).abs().comparedTo(e(V,M,R,a).minus(ee).abs())<1?[H,O]:[V,M],d=z,ne},s.toNumber=function(){return+P(this)},s.toPrecision=function(I,E){return I!=null&&yr(I,1,Ro),S(this,I,E,2)},s.toString=function(I){var E,M=this,O=M.s,j=M.e;return j===null?O?(E="Infinity",O<0&&(E="-"+E)):E="NaN":(I==null?E=j<=l||j>=u?z2(la(M.c),j):ec(la(M.c),j,"0"):I===10&&w?(M=D(new b(M),o+j+1,a),E=ec(la(M.c),M.e,"0")):(yr(I,2,x.length,"Base"),E=n(ec(la(M.c),j,"0"),10,I,O,!0)),O<0&&M.c[0]&&(E="-"+E)),E},s.valueOf=s.toJSON=function(){return P(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,t!=null&&b.set(t),b}function fa(t){var e=t|0;return t>0||t===e?e:e-1}function la(t){for(var e,n,r=1,s=t.length,i=t[0]+"";r<s;){for(e=t[r++]+"",n=tn-e.length;n--;e="0"+e);i+=e}for(s=i.length;i.charCodeAt(--s)===48;);return i.slice(0,s+1||1)}function mf(t,e){var n,r,s=t.c,i=e.c,o=t.s,a=e.s,l=t.e,u=e.e;if(!o||!a)return null;if(n=s&&!s[0],r=i&&!i[0],n||r)return n?r?0:-a:o;if(o!=a)return o;if(n=o<0,r=l==u,!s||!i)return r?0:!s^n?1:-1;if(!r)return l>u^n?1:-1;for(a=(l=s.length)<(u=i.length)?l:u,o=0;o<a;o++)if(s[o]!=i[o])return s[o]>i[o]^n?1:-1;return l==u?0:l>u^n?1:-1}function yr(t,e,n,r){if(t<e||t>n||t!==ha(t))throw Error(io+(r||"Argument")+(typeof t=="number"?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function L2(t){var e=t.c.length-1;return fa(t.e/tn)==e&&t.c[e]%2!=0}function z2(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function ec(t,e,n){var r,s;if(e<0){for(s=n+".";++e;s+=n);t=s+t}else if(r=t.length,++e>r){for(s=n,e-=r;--e;s+=n);t+=s}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}m7();const Afe=t=>{const e=du(t),n=new Ux(0);return n._value=BigInt(e.ingress_expiry.toString(10)),Object.assign(Object.assign({},e),{canister_id:zt.from(e.canister_id),ingress_expiry:n})};var $fe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Rfe=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},oC;class Mfe{constructor(){oC.set(this,Promise.resolve())}async schedule(e){return new Promise((n,r)=>{Rfe(this,oC,$fe(this,oC,"f").finally(async()=>{try{n(await e())}catch(s){r(s)}}),"f")})}}oC=new WeakMap;var ri=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},B2=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},nl,Kx,Mo,lg,B$;const o5=5,Sx="Received invalid response from signer";class ol extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ol.prototype)}}class g7{constructor(e){Mo.set(this,void 0),lg.set(this,new Map),B$.set(this,new Mfe);const n=!ri(nl,nl,"f",Kx);if(B2(nl,nl,!1,"f",Kx),n)throw new ol("SignerAgent is not constructable");B2(this,Mo,e,"f")}get rootKey(){return ri(this,Mo,"f").agent.rootKey}get signer(){return ri(this,Mo,"f").signer}static async create(e){var n;return B2(nl,nl,!0,"f",Kx),new nl(Object.assign(Object.assign({},e),{agent:(n=e.agent)!==null&&n!==void 0?n:await po.create()}))}static createSync(e){var n;return B2(nl,nl,!0,"f",Kx),new nl(Object.assign(Object.assign({},e),{agent:(n=e.agent)!==null&&n!==void 0?n:po.createSync()}))}async call(e,n){e=zt.from(e),await ri(this,Mo,"f").signer.openChannel();const r=await ri(this,B$,"f").schedule(()=>ri(this,Mo,"f").signer.callCanister({canisterId:e,sender:ri(this,Mo,"f").account,method:n.methodName,arg:n.arg})),s=Afe(r.contentMap);if(!(tI.Call===s.request_type&&e.compareTo(s.canister_id)==="eq"&&n.methodName===s.method_name&&rD(n.arg,s.arg)===0&&ri(this,Mo,"f").account.compareTo(zt.from(s.sender))==="eq"))throw new ol(Sx);const o=cp(s),a=await vc.create({certificate:r.certificate,rootKey:this.rootKey,canisterId:e,maxAgeInMinutes:o5}).catch(()=>{throw new ol(Sx)});if(!(a.lookup(["request_status",o,"status"]).status===kr.Found))throw new ol(Sx);const u=uo(o);if(ri(this,lg,"f").has(u))throw new ol(Sx);ri(this,lg,"f").set(u,r.certificate);const c=Date.now(),d=Bo(a.lookup(["time"]));if(!d)throw new ol(Sx);const f=Number(ps(new Lp(d)))/1e6-c+o5*60*1e3;return setTimeout(()=>ri(this,lg,"f").delete(u),f),{requestId:o,response:{ok:!0,status:202,statusText:"Call has been sent over ICRC-25 JSON-RPC",body:null,headers:[]}}}async fetchRootKey(){return ri(this,Mo,"f").agent.fetchRootKey()}async getPrincipal(){return ri(this,Mo,"f").account}async query(e,n){e=zt.from(e);const r=await this.call(e,n),s=await this.readState(e,{paths:[[new TextEncoder().encode("request_status"),r.requestId]]}),i=await vc.create({certificate:s.certificate,rootKey:this.rootKey,canisterId:e}),o=i.lookup(["request_status",r.requestId,"status"]),a=i.lookup(["request_status",r.requestId,"reply"]);if(o.status!==kr.Found||new TextDecoder().decode(o.value)!=="replied"||a.status!==kr.Found)throw new ol("Certificate is missing reply");return{requestId:r.requestId,status:"replied",reply:{arg:a.value},httpDetails:{ok:!0,status:202,statusText:"Certificate with reply has been received over ICRC-25 JSON-RPC",headers:[]}}}async createReadStateRequest(e){return{body:{content:{}}}}async readState(e,n,r,s){if(n.paths.length!==1||n.paths[0].length!==2||new TextDecoder().decode(n.paths[0][0])!=="request_status")throw new ol("Given paths are not supported");const i=n.paths[0][1],o=uo(i),a=ri(this,lg,"f").get(o);if(!a)throw new ol("Certificate could not be found");return{certificate:a}}async status(){return ri(this,Mo,"f").agent.status()}replaceAccount(e){ri(this,Mo,"f").account=e}}nl=g7,Mo=new WeakMap,lg=new WeakMap,B$=new WeakMap;Kx={value:!1};var a5=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ls=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},qx,so,ug;class Dfe{constructor(e){qx.set(this,new Set),so.set(this,void 0),ug.set(this,!1),a5(this,so,Object.assign({window:globalThis.window,manageFocus:!0},e),"f")}get closed(){return Ls(this,ug,"f")}addEventListener(...[e,n]){switch(e){case"close":return Ls(this,qx,"f").add(n),()=>{Ls(this,qx,"f").delete(n)};case"response":const r=async s=>{s.source!==Ls(this,so,"f").signerWindow||s.origin!==Ls(this,so,"f").signerOrigin||!p7(s.data)||n(s.data)};return Ls(this,so,"f").window.addEventListener("message",r),()=>{Ls(this,so,"f").window.removeEventListener("message",r)}}}async send(e){if(Ls(this,ug,"f"))throw new Wf("Communication channel is closed");Ls(this,so,"f").signerWindow.postMessage(e,Ls(this,so,"f").signerOrigin),Ls(this,so,"f").manageFocus&&Ls(this,so,"f").signerWindow.focus()}async close(){Ls(this,ug,"f")||(a5(this,ug,!0,"f"),Ls(this,so,"f").signerWindow.close(),Ls(this,so,"f").manageFocus&&Ls(this,so,"f").window.focus(),Ls(this,qx,"f").forEach(e=>e()))}}qx=new WeakMap,so=new WeakMap,ug=new WeakMap;const Ofe=t=>{try{const e=new URL(t);return e.protocol==="https:"||e.hostname==="127.0.0.1"||e.hostname.split(".").slice(-1)[0]==="localhost"}catch{return!1}};var Pfe=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Kr=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ld,zs,y7,l5,BA,UA;class Ffe{constructor(e){Ld.add(this),zs.set(this,void 0),Pfe(this,zs,Object.assign({establishTimeout:1e4,disconnectTimeout:2e3,statusPollingRate:300,window:globalThis.window,crypto:globalThis.crypto},e),"f"),Kr(this,Ld,"m",y7).call(this)}}zs=new WeakMap,Ld=new WeakSet,y7=function(){const e=setTimeout(()=>{n(),clearInterval(r),Kr(this,zs,"f").onEstablishTimeout()},Kr(this,zs,"f").establishTimeout),n=Kr(this,Ld,"m",BA).call(this,s=>{n(),clearInterval(r),clearTimeout(e),Kr(this,zs,"f").onEstablish(s.origin),Kr(this,Ld,"m",l5).call(this,s.origin)}),r=setInterval(()=>Kr(this,Ld,"m",UA).call(this,Kr(this,zs,"f").crypto.randomUUID()),Kr(this,zs,"f").statusPollingRate)},l5=function(e){let n,r;const s=Kr(this,Ld,"m",BA).call(this,o=>{r&&o.data.id===r&&o.origin===e&&(clearTimeout(n),setTimeout(i,Kr(this,zs,"f").statusPollingRate))}),i=()=>{r=Kr(this,zs,"f").crypto.randomUUID(),n=setTimeout(()=>{s(),Kr(this,zs,"f").onDisconnect()},Kr(this,zs,"f").disconnectTimeout),Kr(this,Ld,"m",UA).call(this,r)};setTimeout(i,Kr(this,zs,"f").statusPollingRate)},BA=function(e){const n=r=>{r.source===Kr(this,zs,"f").signerWindow&&p7(r.data)&&"result"in r.data&&r.data.result==="ready"&&e(r)};return Kr(this,zs,"f").window.addEventListener("message",n),()=>Kr(this,zs,"f").window.removeEventListener("message",n)},UA=function(e){Kr(this,zs,"f").signerWindow.postMessage({jsonrpc:"2.0",id:e,method:"icrc29_status"},"*")};var Lfe=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},gf=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Jl;const zfe="https://github.com/slide-computer/signer-js/blob/main/packages/signer-web/README.md#channels-must-be-established-in-a-click-handler";class Wf extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Wf.prototype)}}let U$=!1;globalThis.window&&(globalThis.window.addEventListener("click",()=>U$=!0,!0),globalThis.window.addEventListener("click",()=>U$=!1));class Bfe{constructor(e){if(Jl.set(this,void 0),!Ofe(e.url))throw new Wf("Invalid signer RPC url");Lfe(this,Jl,Object.assign({windowOpenerFeatures:"",window:globalThis.window,establishTimeout:1e4,disconnectTimeout:2e3,statusPollingRate:300,crypto:globalThis.crypto,manageFocus:!0,closeOnEstablishTimeout:!0,detectNonClickEstablishment:!0},e),"f")}async establishChannel(){if(gf(this,Jl,"f").detectNonClickEstablishment&&!U$)throw new Wf(`Signer window should not be opened outside of click handler, see: ${zfe}`);const e=gf(this,Jl,"f").window.open(gf(this,Jl,"f").url,"signerWindow",gf(this,Jl,"f").windowOpenerFeatures);if(!e)throw new Wf("Signer window could not be opened");return new Promise((n,r)=>{let s;new Ffe(Object.assign(Object.assign({},gf(this,Jl,"f")),{signerWindow:e,onEstablish:i=>{s=new Dfe(Object.assign(Object.assign({},gf(this,Jl,"f")),{signerOrigin:i,signerWindow:e})),n(s)},onEstablishTimeout:()=>{gf(this,Jl,"f").closeOnEstablishTimeout&&e.close(),r(new Wf("Communication channel could not be established within a reasonable time"))},onDisconnect:()=>s.close()}))})}}Jl=new WeakMap;class ND extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ND.prototype)}}class Ufe{async establishChannel(){return new Vfe}}var Cx=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},aC,Xx;class Vfe{constructor(){aC.set(this,new Set),Xx.set(this,new Set)}get closed(){return!("ic"in window)||typeof window.ic!="object"||!window.ic||!("plug"in window.ic)||typeof window.ic.plug!="object"||!window.ic.plug||!("request"in window.ic.plug)||typeof window.ic.plug.request!="function"}addEventListener(...[e,n]){switch(e){case"close":return Cx(this,aC,"f").add(n),()=>{Cx(this,aC,"f").delete(n)};case"response":return Cx(this,Xx,"f").add(n),()=>{Cx(this,Xx,"f").delete(n)}}}async send(e){if(this.closed)throw new ND("Plug wallet cannot be found");const n=await window.ic.plug.request(e);e.id!==void 0&&Cx(this,Xx,"f").forEach(r=>r(n))}async close(){}}aC=new WeakMap,Xx=new WeakMap;const u5=["mousedown","mousemove","keydown","touchstart","wheel"];let c5=class{constructor(e={}){var n;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:r,idleTimeout:s=10*60*1e3}=e||{};this.callbacks=r?[r]:[],this.idleTimeout=s;const i=this._resetTimer.bind(this);window.addEventListener("load",i,!0),u5.forEach(function(a){document.addEventListener(a,i,!0)});const o=(a,l)=>{let u;return(...c)=>{const d=this,h=function(){u=void 0,a.apply(d,c)};clearTimeout(u),u=window.setTimeout(h,l)}};if(e!=null&&e.captureScroll){const a=o(i,(n=e==null?void 0:e.scrollDebounce)!==null&&n!==void 0?n:100);window.addEventListener("scroll",a,!0)}i()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);u5.forEach(function(n){document.removeEventListener(n,e,!0)}),this.callbacks.forEach(n=>n())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}};const jfe=(t,e)=>e.some(n=>t instanceof n);let d5,h5;function Wfe(){return d5||(d5=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Gfe(){return h5||(h5=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x7=new WeakMap,V$=new WeakMap,w7=new WeakMap,VA=new WeakMap,kD=new WeakMap;function Hfe(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(eh(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&x7.set(n,t)}).catch(()=>{}),kD.set(e,t),e}function Yfe(t){if(V$.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});V$.set(t,e)}let j$={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return V$.get(t);if(e==="objectStoreNames")return t.objectStoreNames||w7.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return eh(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Kfe(t){j$=t(j$)}function qfe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(jA(this),e,...n);return w7.set(r,e.sort?e.sort():[e]),eh(r)}:Gfe().includes(t)?function(...e){return t.apply(jA(this),e),eh(x7.get(this))}:function(...e){return eh(t.apply(jA(this),e))}}function Xfe(t){return typeof t=="function"?qfe(t):(t instanceof IDBTransaction&&Yfe(t),jfe(t,Wfe())?new Proxy(t,j$):t)}function eh(t){if(t instanceof IDBRequest)return Hfe(t);if(VA.has(t))return VA.get(t);const e=Xfe(t);return e!==t&&(VA.set(t,e),kD.set(e,t)),e}const jA=t=>kD.get(t);function Zfe(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=eh(o);return r&&o.addEventListener("upgradeneeded",l=>{r(eh(o.result),l.oldVersion,l.newVersion,eh(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const Qfe=["get","getKey","getAll","getAllKeys","count"],Jfe=["put","add","delete","clear"],WA=new Map;function f5(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(WA.get(e))return WA.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Jfe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Qfe.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return WA.set(e,i),i}Kfe(t=>({...t,get:(e,n,r)=>f5(e,n)||t.get(e,n,r),has:(e,n)=>!!f5(e,n)||t.has(e,n)}));const b7="auth-client-db",v7="ic-keyval",epe=async(t=b7,e=v7,n)=>(S7&&(localStorage!=null&&localStorage.getItem(Wd))&&(localStorage.removeItem(Wd),localStorage.removeItem(zd)),await Zfe(t,n,{upgrade:r=>{r.objectStoreNames.contains(e)&&r.clear(e),r.createObjectStore(e)}}));async function tpe(t,e,n){return await t.get(e,n)}async function npe(t,e,n,r){return await t.put(e,r,n)}async function rpe(t,e,n){return await t.delete(e,n)}class TD{constructor(e,n){this._db=e,this._storeName=n}static async create(e){const{dbName:n=b7,storeName:r=v7,version:s=ape}=e??{},i=await epe(n,r,s);return new TD(i,r)}async set(e,n){return await npe(this._db,this._storeName,e,n)}async get(e){var n;return(n=await tpe(this._db,this._storeName,e))!==null&&n!==void 0?n:null}async remove(e){return await rpe(this._db,this._storeName,e)}}var spe=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ipe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},lC;const zd="identity",Wd="delegation",ope="iv",ape=1,S7=typeof window<"u";class lpe{constructor(e="ic-",n){this.prefix=e,this._localStorage=n}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,n){return this._getLocalStorage().setItem(this.prefix+e,n),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class upe{constructor(e){lC.set(this,void 0),spe(this,lC,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}TD.create(ipe(this,lC,"f")).then(n=>{this.initializedDb=n,e(n)})})}async get(e){return await(await this._db).get(e)}async set(e,n){await(await this._db).set(e,n)}async remove(e){await(await this._db).remove(e)}}lC=new WeakMap;const cpe="https://identity.ic0.app",dpe="#authorize",GA="ECDSA",HA="Ed25519",hpe=500,fpe="UserInterrupt";class ppe{constructor(e,n,r,s,i,o,a,l){this._identity=e,this._key=n,this._chain=r,this._storage=s,this.idleManager=i,this._createOptions=o,this._idpWindow=a,this._eventHandler=l,this._registerDefaultIdleCallback()}static async create(e={}){var n,r,s;const i=(n=e.storage)!==null&&n!==void 0?n:new upe,o=(r=e.keyType)!==null&&r!==void 0?r:GA;let a=null;if(e.identity)a=e.identity;else{let d=await i.get(zd);if(!d&&S7)try{const h=new lpe,f=await h.get(Wd),m=await h.get(zd);f&&m&&o===GA&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await i.set(Wd,f),await i.set(zd,m),d=f,await h.remove(Wd),await h.remove(zd))}catch(h){console.error("error while attempting to recover localstorage: "+h)}if(d)try{typeof d=="object"?o===HA&&typeof d=="string"?a=await Vo.fromJSON(d):a=await lh.fromKeyPair(d):typeof d=="string"&&(a=Vo.fromJSON(d))}catch{}}let l=new Jd,u=null;if(a)try{const d=await i.get(Wd);if(typeof d=="object"&&d!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?l=e.identity:d&&(u=vl.fromJSON(d),ON(u)?"toDer"in a?l=Yw.fromDelegation(a,u):l=lI.fromDelegation(a,u):(await YA(i),a=null))}catch(d){console.error(d),await YA(i),a=null}let c;return!((s=e.idleOptions)===null||s===void 0)&&s.disableIdle?c=void 0:(u||e.identity)&&(c=c5.create(e.idleOptions)),a||(o===HA?(a=await Vo.generate(),await i.set(zd,JSON.stringify(a.toJSON()))):(e.storage&&o===GA&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${HA}' as the key type, as it can serialize to a string`),a=await lh.generate(),await i.set(zd,a.getKeyPair()))),new this(l,a,u,i,c,e)}_registerDefaultIdleCallback(){var e,n;const r=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!(r!=null&&r.onIdle)&&!(r!=null&&r.disableDefaultIdleCallback)&&((n=this.idleManager)===null||n===void 0||n.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,n){var r,s;const i=e.delegations.map(u=>({delegation:new h0(u.delegation.pubkey,u.delegation.expiration,u.delegation.targets),signature:u.signature.buffer})),o=vl.fromDelegations(i,e.userPublicKey.buffer),a=this._key;if(!a)return;this._chain=o,"toDer"in a?this._identity=Yw.fromDelegation(a,this._chain):this._identity=lI.fromDelegation(a,this._chain),(r=this._idpWindow)===null||r===void 0||r.close();const l=(s=this._createOptions)===null||s===void 0?void 0:s.idleOptions;!this.idleManager&&!(l!=null&&l.disableIdle)&&(this.idleManager=c5.create(l),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Wd,JSON.stringify(this._chain.toJSON())),n==null||n(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var n,r,s,i;const o=BigInt(8)*BigInt(36e11),a=new URL(((n=e==null?void 0:e.identityProvider)===null||n===void 0?void 0:n.toString())||cpe);a.hash=dpe,(r=this._idpWindow)===null||r===void 0||r.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(a,Object.assign({maxTimeToLive:(s=e==null?void 0:e.maxTimeToLive)!==null&&s!==void 0?s:o},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(i=window.open(a.toString(),"idpWindow",e==null?void 0:e.windowOpenerFeatures))!==null&&i!==void 0?i:void 0;const l=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(fpe,e==null?void 0:e.onError):setTimeout(l,hpe))};l()}_getEventHandler(e,n){return async r=>{var s,i,o;if(r.origin!==e.origin)return;const a=r.data;switch(a.kind){case"authorize-ready":{const l=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((s=this._key)===null||s===void 0?void 0:s.getPublicKey().toDer()),maxTimeToLive:n==null?void 0:n.maxTimeToLive,allowPinAuthentication:n==null?void 0:n.allowPinAuthentication,derivationOrigin:(i=n==null?void 0:n.derivationOrigin)===null||i===void 0?void 0:i.toString()},n==null?void 0:n.customValues);(o=this._idpWindow)===null||o===void 0||o.postMessage(l,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(a,n==null?void 0:n.onSuccess)}catch(l){this._handleFailure(l.message,n==null?void 0:n.onError)}break;case"authorize-client-failure":this._handleFailure(a.text,n==null?void 0:n.onError);break}}}_handleFailure(e,n){var r;(r=this._idpWindow)===null||r===void 0||r.close(),n==null||n(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await YA(this._storage),this._identity=new Jd,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function YA(t){await t.remove(zd),await t.remove(Wd),await t.remove(ope)}var C7=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Oo=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},uC,Bd,Ig,Iw,W$;class mpe{constructor(e){uC.add(this),Bd.set(this,void 0),Ig.set(this,new Set),Iw.set(this,void 0),C7(this,Bd,Object.assign({authClientLoginOptions:{},authClientDisconnectMonitoringInterval:3e3},e),"f"),this.connected&&Oo(this,uC,"m",W$).call(this)}get connected(){const e=Oo(this,Bd,"f").authClient.getIdentity();return e.getPrincipal().isAnonymous()?!1:ON(e.getDelegation())}async connect(){return new Promise((e,n)=>{Oo(this,Bd,"f").authClient.login(Object.assign(Object.assign({},Oo(this,Bd,"f").authClientLoginOptions),{onSuccess:()=>{Oo(this,uC,"m",W$).call(this),e()},onError:r=>n(new hp(r??"AuthClient login failed"))}))})}async disconnect(){clearInterval(Oo(this,Iw,"f")),await Oo(this,Bd,"f").authClient.logout(),Oo(this,Ig,"f").forEach(e=>e())}addEventListener(e,n){switch(e){case"disconnect":return Oo(this,Ig,"f").add(n),()=>{Oo(this,Ig,"f").delete(n)}}}}Bd=new WeakMap,Ig=new WeakMap,Iw=new WeakMap,uC=new WeakSet,W$=function(){C7(this,Iw,setInterval(()=>{this.connected||(Oo(this,Ig,"f").forEach(e=>e()),clearInterval(Oo(this,Iw,"f")))},Oo(this,Bd,"f").authClientDisconnectMonitoringInterval),"f")};var Ix=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},U2=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ed,cC,cg,dC;class hp extends Error{constructor(e){super(e),Object.setPrototypeOf(this,hp.prototype)}}class I7{constructor(e,n){cg.set(this,void 0),dC.set(this,void 0);const r=!Ix(Ed,Ed,"f",cC);if(U2(Ed,Ed,!1,"f",cC),r)throw new hp("AuthClientTransport is not constructable");U2(this,dC,e,"f"),U2(this,cg,n,"f")}get connection(){return Ix(this,cg,"f")}static async create(e){const n=await ppe.create(e.authClientCreateOptions),r=new mpe({authClient:n,authClientLoginOptions:e.authClientLoginOptions,authClientDisconnectMonitoringInterval:e.authClientDisconnectMonitoringInterval});return U2(Ed,Ed,!0,"f",cC),new Ed(n,r)}async establishChannel(){if(!Ix(this,cg,"f").connected)throw new hp("AuthClientTransport is not connected");return new xpe({authClient:Ix(this,dC,"f"),connection:Ix(this,cg,"f")})}}Ed=I7,cg=new WeakMap,dC=new WeakMap;cC={value:!1};const gpe=[{name:"ICRC-25",url:"https://github.com/dfinity/ICRC/blob/main/ICRCs/ICRC-25/ICRC-25.md"},{name:"ICRC-34",url:"https://github.com/dfinity/ICRC/blob/main/ICRCs/ICRC-34/ICRC-34.md"}],ype=[{scope:{method:"icrc34_delegation"},state:"granted"}];var KA=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},rl=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},G$,Ng,Zx,Qx,Jx,N7;class xpe{constructor(e){G$.add(this),Ng.set(this,void 0),Zx.set(this,!1),Qx.set(this,new Set),Jx.set(this,new Set),KA(this,Ng,e,"f"),rl(this,Ng,"f").connection.addEventListener("disconnect",()=>KA(this,Zx,!0,"f"))}get closed(){return rl(this,Zx,"f")||!rl(this,Ng,"f").connection.connected}addEventListener(...[e,n]){switch(e){case"close":return rl(this,Qx,"f").add(n),()=>{rl(this,Qx,"f").delete(n)};case"response":return rl(this,Jx,"f").add(n),()=>{rl(this,Jx,"f").delete(n)}}}async send(e){if(this.closed)throw new hp("Communication channel is closed");const n=e.id;if(n===void 0)return;const r=await rl(this,G$,"m",N7).call(this,Object.assign({id:n},e));rl(this,Jx,"f").forEach(s=>s(r))}async close(){KA(this,Zx,!0,"f"),rl(this,Qx,"f").forEach(e=>e())}}Ng=new WeakMap,Zx=new WeakMap,Qx=new WeakMap,Jx=new WeakMap,G$=new WeakSet,N7=async function(e){const n=e.id;if(!f7(e))return{id:n,jsonrpc:"2.0",error:{code:c7,message:"Invalid request"}};switch(e.method){case"icrc25_supported_standards":return{id:n,jsonrpc:"2.0",result:{supportedStandards:gpe}};case"icrc25_permissions":case"icrc25_request_permissions":return{id:n,jsonrpc:"2.0",result:{scopes:ype}};case"icrc34_delegation":const r=e;if(!r.params)throw new hp("Required params missing in request");const s=rl(this,Ng,"f").authClient.getIdentity(),i=Fo(r.params.publicKey),o=r.params.maxTimeToLive?new Date(Date.now()+Number(BigInt(r.params.maxTimeToLive)/BigInt(1e6))):void 0,a=await vl.create(s,{toDer:()=>i},o,{previous:s.getDelegation()});return{id:n,jsonrpc:"2.0",result:{publicKey:uo(a.publicKey),signerDelegation:a.delegations.map(({delegation:l,signature:u})=>({delegation:Object.assign({pubkey:uo(l.pubkey),expiration:l.expiration.toString()},l.targets?{targets:l.targets.map(c=>c.toText())}:{}),signature:uo(u)}))}};default:return{id:n,jsonrpc:"2.0",error:{code:d7,message:"Not supported"}}}};var tc={};const wpe=v8(Xue);var p5;function bpe(){if(p5)return tc;p5=1;var t=tc&&tc.__classPrivateFieldSet||function(i,o,a,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof o=="function"?i!==o||!u:!o.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(i,a):u?u.value=a:o.set(i,a),a},e=tc&&tc.__classPrivateFieldGet||function(i,o,a,l){if(a==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?i!==o||!l:!o.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?l:a==="a"?l.call(i):l?l.value:o.get(i)},n;Object.defineProperty(tc,"__esModule",{value:!0}),tc.PartialIdentity=void 0;const r=wpe;class s{constructor(o){n.set(this,void 0),t(this,n,o,"f")}get rawKey(){return e(this,n,"f").rawKey}get derKey(){return e(this,n,"f").derKey}toDer(){return e(this,n,"f").toDer()}getPublicKey(){return e(this,n,"f")}getPrincipal(){return r.Principal.from(e(this,n,"f").rawKey)}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}return tc.PartialIdentity=s,n=new WeakMap,tc}bpe();var Gn=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},sl=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},hC,_d,fC,Do,il,Ad,kg,Nw,H$;const vpe="ECDSA",m5="stoic-base-identity",qA="stoic-delegation-chain",XA="stoic-account-count",Um="https://www.stoicwallet.com",Spe="stoic";class k7{constructor(e,n,r){hC.add(this),Do.set(this,void 0),il.set(this,void 0),Ad.set(this,void 0),kg.set(this,new Set),Nw.set(this,void 0);const s=!Gn(_d,_d,"f",fC);if(sl(_d,_d,!1,"f",fC),s)throw new hu("StoicTransport is not constructable");sl(this,Do,e,"f"),sl(this,il,n,"f"),sl(this,Ad,r,"f"),this.connected&&Gn(this,hC,"m",H$).call(this)}get connected(){return Gn(this,il,"f")?ON(Gn(this,il,"f")):!1}get identity(){return Gn(this,Do,"f").identity}get delegationChain(){return Gn(this,il,"f")}get accounts(){return Gn(this,Ad,"f")}static async create(e){var n,r,s,i,o,a;const l=(n=e==null?void 0:e.maxTimeToLive)!==null&&n!==void 0?n:BigInt(8)*BigInt(36e11),u=(r=e==null?void 0:e.keyType)!==null&&r!==void 0?r:vpe,c=(s=e==null?void 0:e.storage)!==null&&s!==void 0?s:new CD,d=(i=e==null?void 0:e.crypto)!==null&&i!==void 0?i:globalThis.crypto,h=(o=e==null?void 0:e.disconnectMonitoringInterval)!==null&&o!==void 0?o:3e3;let f=(a=e==null?void 0:e.identity)!==null&&a!==void 0?a:await o7(m5,c);if(!f){const x=await(u==="Ed25519"?Vo.generate(d.getRandomValues(new Uint8Array(32))):lh.generate());await a7(m5,x,c),f=x}const m=await z$(qA,c),g=await c.get(XA);return sl(_d,_d,!0,"f",fC),new _d({maxTimeToLive:l,keyType:u,identity:f,storage:c,crypto:d,disconnectMonitoringInterval:h},m,g?Number(g):void 0)}async connect(){return new Promise(async(e,n)=>{sl(this,il,void 0,"f");const r={current:await Gn(this,Do,"f").crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-384"},!1,["sign","verify"])},s=On(await Gn(this,Do,"f").crypto.subtle.exportKey("spki",r.current.publicKey)),i=document.createElement("iframe");i.width="0",i.height="0",i.style.borderWidth="0";const o=new h0(Gn(this,Do,"f").identity.getPublicKey().toDer(),BigInt(Date.now())*BigInt(1e6)+Gn(this,Do,"f").maxTimeToLive);let a;const l=async()=>{window.removeEventListener("message",u),document.body.removeChild(i),await l7(qA,Gn(this,il,"f"),Gn(this,Do,"f").storage),await Gn(this,Do,"f").storage.set(XA,`${Gn(this,Ad,"f")}`),Gn(this,hC,"m",H$).call(this),e()},u=d=>{var h;if(!(!c||d.origin!==Um)){if(d.source===i.contentWindow&&d.data.target==="STOIC-EXT"){if(!d.data.success){window.removeEventListener("message",u),document.body.removeChild(i),n(new hu(d.data.data));return}switch(d.data.action){case"accounts":sl(this,Ad,JSON.parse(d.data.data).length,"f"),Gn(this,il,"f")&&l();break;case"sign":const f=JSON.parse(d.data.data),m=gu(f.signed),g=f.chain&&vl.fromJSON(f.chain);sl(this,il,vl.fromDelegations([...(h=g==null?void 0:g.delegations)!==null&&h!==void 0?h:[],{delegation:o,signature:m}],a),"f"),Gn(this,Ad,"f")&&l();break}return}if(d.source===c)switch(d.data.action){case"initiateStoicConnect":c.postMessage({action:"requestAuthorization",apikey:s},Um);break;case"rejectAuthorization":c.close(),window.removeEventListener("message",u),n(new hu("Connection is rejected"));break;case"confirmAuthorization":a=new Uint8Array(Object.values(d.data.key)).buffer;const f=zt.selfAuthenticating(new Uint8Array(a)).toText();c.close(),document.body.appendChild(i),i.onload=async()=>{if(!i.contentWindow){n(new hu("Tunnel could not be established"));return}i.contentWindow.postMessage({target:"STOIC-IFRAME",action:"accounts",payload:"accounts",principal:f,apikey:s,sig:On(await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-384"}},r.current.privateKey,new TextEncoder().encode("accounts")))},Um);const m=On(new Uint8Array([...new TextEncoder().encode("ic-request-auth-delegation"),...new Uint8Array(cp(o))]).buffer);i.contentWindow.postMessage({target:"STOIC-IFRAME",action:"sign",payload:m,principal:f,apikey:s,sig:On(await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-384"}},r.current.privateKey,new TextEncoder().encode(m)))},Um),delete r.current},i.src=new URL("?stoicTunnel",Um).href;break}}};window.addEventListener("message",u);const c=window.open(new URL("?authorizeApp",Um),Spe)})}async disconnect(){clearInterval(Gn(this,Nw,"f")),await u7(qA,Gn(this,Do,"f").storage),await Gn(this,Do,"f").storage.remove(XA),sl(this,il,void 0,"f"),sl(this,Ad,void 0,"f"),Gn(this,kg,"f").forEach(e=>e())}addEventListener(e,n){switch(e){case"disconnect":return Gn(this,kg,"f").add(n),()=>{Gn(this,kg,"f").delete(n)}}}}_d=k7,Do=new WeakMap,il=new WeakMap,Ad=new WeakMap,kg=new WeakMap,Nw=new WeakMap,hC=new WeakSet,H$=function(){sl(this,Nw,setInterval(()=>{this.connected||(Gn(this,kg,"f").forEach(e=>e()),clearInterval(Gn(this,Nw,"f")))},Gn(this,Do,"f").disconnectMonitoringInterval),"f")};fC={value:!1};var Nx=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},V2=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},$d,pC,dg,mC;class hu extends Error{constructor(e){super(e),Object.setPrototypeOf(this,hu.prototype)}}class T7{constructor(e,n){dg.set(this,void 0),mC.set(this,void 0);const r=!Nx($d,$d,"f",pC);if(V2($d,$d,!1,"f",pC),r)throw new hu("StoicTransport is not constructable");V2(this,dg,e,"f"),V2(this,mC,n,"f")}get connection(){return Nx(this,dg,"f")}static async create(e){const n=await k7.create(e);return V2($d,$d,!0,"f",pC),new $d(n,e==null?void 0:e.agent)}async establishChannel(){if(!Nx(this,dg,"f").connected)throw new hu("StoicTransport is not connected");return new Npe(Nx(this,dg,"f"),Nx(this,mC,"f"))}}$d=T7,dg=new WeakMap,mC=new WeakMap;pC={value:!1};const Cpe=[{name:"ICRC-25",url:"https://github.com/dfinity/ICRC/blob/main/ICRCs/ICRC-25/ICRC-25.md"},{name:"ICRC-27",url:"https://github.com/dfinity/ICRC/blob/main/ICRCs/ICRC-27/ICRC-27.md"},{name:"ICRC-34",url:"https://github.com/dfinity/ICRC/blob/main/ICRCs/ICRC-34/ICRC-34.md"},{name:"ICRC-49",url:"https://github.com/dfinity/ICRC/blob/main/ICRCs/ICRC-49/ICRC-49.md"}],Ipe=[{scope:{method:"icrc27_accounts"},state:"granted"},{scope:{method:"icrc34_delegation"},state:"granted"},{scope:{method:"icrc49_call_canister"},state:"granted"}];var j2=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Vs=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Y$,cl,uI,ew,tw,nw,E7;class Npe{constructor(e,n){Y$.add(this),cl.set(this,void 0),uI.set(this,void 0),ew.set(this,new Set),tw.set(this,new Set),nw.set(this,!1),j2(this,cl,e,"f"),j2(this,uI,n,"f"),Vs(this,cl,"f").addEventListener("disconnect",()=>j2(this,nw,!0,"f"))}get closed(){return Vs(this,nw,"f")||!Vs(this,cl,"f").connected}addEventListener(...[e,n]){switch(e){case"close":return Vs(this,ew,"f").add(n),()=>{Vs(this,ew,"f").delete(n)};case"response":return Vs(this,tw,"f").add(n),()=>{Vs(this,tw,"f").delete(n)}}}async send(e){if(this.closed)throw new hu("Communication channel is closed");const n=e.id;if(n===void 0)return;const r=await Vs(this,Y$,"m",E7).call(this,Object.assign({id:n},e));Vs(this,tw,"f").forEach(s=>s(r))}async close(){j2(this,nw,!0,"f"),Vs(this,ew,"f").forEach(e=>e())}}cl=new WeakMap,uI=new WeakMap,ew=new WeakMap,tw=new WeakMap,nw=new WeakMap,Y$=new WeakSet,E7=async function(e){var n,r,s,i;const o=e.id;if(!f7(e))return{id:o,jsonrpc:"2.0",error:{code:c7,message:"Invalid request"}};switch(e.method){case"icrc25_supported_standards":return{id:o,jsonrpc:"2.0",result:{supportedStandards:Cpe}};case"icrc25_permissions":case"icrc25_request_permissions":return{id:o,jsonrpc:"2.0",result:{scopes:Ipe}};case"icrc27_accounts":const a=zt.selfAuthenticating(new Uint8Array(Vs(this,cl,"f").delegationChain.publicKey)).toText();return{id:o,jsonrpc:"2.0",result:{accounts:Array.from({length:(n=Vs(this,cl,"f").accounts)!==null&&n!==void 0?n:0}).map((D,P)=>{const I=new ArrayBuffer(32);return new DataView(I).setBigUint64(24,BigInt(P),!1),{owner:a,subaccount:uo(I)}})}};case"icrc34_delegation":const l=e,u=Vs(this,cl,"f").identity,c=Vs(this,cl,"f").delegationChain,d=new Date(Date.now()+Number(l.params.maxTimeToLive?BigInt(l.params.maxTimeToLive)/BigInt(1e6):BigInt(8)*BigInt(36e5))),h=await vl.create(u,{toDer:()=>Fo(l.params.publicKey)},d,{previous:c,targets:(r=l.params.targets)===null||r===void 0?void 0:r.map(D=>zt.fromText(D))});return{id:o,jsonrpc:"2.0",result:{publicKey:uo(h.publicKey),signerDelegation:h.delegations.map(({delegation:D,signature:P})=>({delegation:Object.assign({pubkey:uo(D.pubkey),expiration:D.expiration.toString()},D.targets?{targets:D.targets.map(I=>I.toText())}:{}),signature:uo(P)}))}};case"icrc49_call_canister":const f=e,{pollForResponse:m,defaultStrategy:g}=fhe,x=zt.fromText(f.params.canisterId),w=lI.fromDelegation(Vs(this,cl,"f").identity,Vs(this,cl,"f").delegationChain);if(((s=f.params)===null||s===void 0?void 0:s.sender)!==w.getPrincipal().toString())throw new hu("Sender does not match Stoic identity");const b=await po.from((i=Vs(this,uI,"f"))!==null&&i!==void 0?i:await po.create());b.replaceIdentity(w);let S;b.addTransform("update",async D=>(S=FS(D.body),D));const C=await b.call(x,{effectiveCanisterId:x,methodName:f.params.method,arg:Fo(f.params.arg)});await m(b,x,C.requestId,g());const{certificate:T}=await b.readState(x,{paths:[[new TextEncoder().encode("request_status"),C.requestId]]});return{id:o,jsonrpc:"2.0",result:{contentMap:uo(S),certificate:uo(T)}};default:return{id:o,jsonrpc:"2.0",error:{code:d7,message:"Not supported"}}}};function co(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function g5(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function _7(...t){return e=>{let n=!1;const r=t.map(s=>{const i=g5(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():g5(t[s],null)}}}}function $l(...t){return W.useCallback(_7(...t),t)}function kpe(t,e){const n=W.createContext(e),r=i=>{const{children:o,...a}=i,l=W.useMemo(()=>a,Object.values(a));return he.jsx(n.Provider,{value:l,children:o})};r.displayName=t+"Provider";function s(i){const o=W.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function ED(t,e=[]){let n=[];function r(i,o){const a=W.createContext(o),l=n.length;n=[...n,o];const u=d=>{var w;const{scope:h,children:f,...m}=d,g=((w=h==null?void 0:h[t])==null?void 0:w[l])||a,x=W.useMemo(()=>m,Object.values(m));return he.jsx(g.Provider,{value:x,children:f})};u.displayName=i+"Provider";function c(d,h){var g;const f=((g=h==null?void 0:h[t])==null?void 0:g[l])||a,m=W.useContext(f);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[u,c]}const s=()=>{const i=n.map(o=>W.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return W.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,Tpe(s,...e)]}function Tpe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:u})=>{const d=l(i)[`__scope${u}`];return{...a,...d}},{});return W.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var _D=W.forwardRef((t,e)=>{const{children:n,...r}=t,s=W.Children.toArray(n),i=s.find(Epe);if(i){const o=i.props.children,a=s.map(l=>l===i?W.Children.count(o)>1?W.Children.only(null):W.isValidElement(o)?o.props.children:null:l);return he.jsx(K$,{...r,ref:e,children:W.isValidElement(o)?W.cloneElement(o,void 0,a):null})}return he.jsx(K$,{...r,ref:e,children:n})});_D.displayName="Slot";var K$=W.forwardRef((t,e)=>{const{children:n,...r}=t;if(W.isValidElement(n)){const s=Ape(n),i=_pe(r,n.props);return n.type!==W.Fragment&&(i.ref=e?_7(e,s):s),W.cloneElement(n,i)}return W.Children.count(n)>1?W.Children.only(null):null});K$.displayName="SlotClone";var A7=({children:t})=>he.jsx(he.Fragment,{children:t});function Epe(t){return W.isValidElement(t)&&t.type===A7}function _pe(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{i(...a),s(...a)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Ape(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var $pe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],So=$pe.reduce((t,e)=>{const n=W.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?_D:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),he.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Rpe(t,e){t&&Ea.flushSync(()=>t.dispatchEvent(e))}function uh(t){const e=W.useRef(t);return W.useEffect(()=>{e.current=t}),W.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Mpe(t,e=globalThis==null?void 0:globalThis.document){const n=uh(t);W.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Dpe="DismissableLayer",q$="dismissableLayer.update",Ope="dismissableLayer.pointerDownOutside",Ppe="dismissableLayer.focusOutside",y5,$7=W.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),AD=W.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,u=W.useContext($7),[c,d]=W.useState(null),h=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=W.useState({}),m=$l(e,P=>d(P)),g=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=g.indexOf(x),b=c?g.indexOf(c):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,C=b>=w,T=zpe(P=>{const I=P.target,E=[...u.branches].some(M=>M.contains(I));!C||E||(s==null||s(P),o==null||o(P),P.defaultPrevented||a==null||a())},h),D=Bpe(P=>{const I=P.target;[...u.branches].some(M=>M.contains(I))||(i==null||i(P),o==null||o(P),P.defaultPrevented||a==null||a())},h);return Mpe(P=>{b===u.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&a&&(P.preventDefault(),a()))},h),W.useEffect(()=>{if(c)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(y5=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),x5(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=y5)}},[c,h,n,u]),W.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),x5())},[c,u]),W.useEffect(()=>{const P=()=>f({});return document.addEventListener(q$,P),()=>document.removeEventListener(q$,P)},[]),he.jsx(So.div,{...l,ref:m,style:{pointerEvents:S?C?"auto":"none":void 0,...t.style},onFocusCapture:co(t.onFocusCapture,D.onFocusCapture),onBlurCapture:co(t.onBlurCapture,D.onBlurCapture),onPointerDownCapture:co(t.onPointerDownCapture,T.onPointerDownCapture)})});AD.displayName=Dpe;var Fpe="DismissableLayerBranch",Lpe=W.forwardRef((t,e)=>{const n=W.useContext($7),r=W.useRef(null),s=$l(e,r);return W.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),he.jsx(So.div,{...t,ref:s})});Lpe.displayName=Fpe;function zpe(t,e=globalThis==null?void 0:globalThis.document){const n=uh(t),r=W.useRef(!1),s=W.useRef(()=>{});return W.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){R7(Ope,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Bpe(t,e=globalThis==null?void 0:globalThis.document){const n=uh(t),r=W.useRef(!1);return W.useEffect(()=>{const s=i=>{i.target&&!r.current&&R7(Ppe,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function x5(){const t=new CustomEvent(q$);document.dispatchEvent(t)}function R7(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?Rpe(s,i):s.dispatchEvent(i)}var fp=globalThis!=null&&globalThis.document?W.useLayoutEffect:()=>{},Upe=UC.useId||(()=>{}),Vpe=0;function gC(t){const[e,n]=W.useState(Upe());return fp(()=>{n(r=>r??String(Vpe++))},[t]),t||(e?`radix-${e}`:"")}const jpe=["top","right","bottom","left"],_c=Math.min,hi=Math.max,Kw=Math.round,W2=Math.floor,yu=t=>({x:t,y:t}),Wpe={left:"right",right:"left",bottom:"top",top:"bottom"},Gpe={start:"end",end:"start"};function X$(t,e,n){return hi(t,_c(e,n))}function Iu(t,e){return typeof t=="function"?t(e):t}function Ac(t){return t.split("-")[0]}function f0(t){return t.split("-")[1]}function $D(t){return t==="x"?"y":"x"}function RD(t){return t==="y"?"height":"width"}function ch(t){return["top","bottom"].includes(Ac(t))?"y":"x"}function MD(t){return $D(ch(t))}function Hpe(t,e,n){n===void 0&&(n=!1);const r=f0(t),s=MD(t),i=RD(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=cI(o)),[o,cI(o)]}function Ype(t){const e=cI(t);return[Z$(t),e,Z$(e)]}function Z$(t){return t.replace(/start|end/g,e=>Gpe[e])}function Kpe(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function qpe(t,e,n,r){const s=f0(t);let i=Kpe(Ac(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(Z$)))),i}function cI(t){return t.replace(/left|right|bottom|top/g,e=>Wpe[e])}function Xpe(t){return{top:0,right:0,bottom:0,left:0,...t}}function M7(t){return typeof t!="number"?Xpe(t):{top:t,right:t,bottom:t,left:t}}function dI(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function w5(t,e,n){let{reference:r,floating:s}=t;const i=ch(e),o=MD(e),a=RD(o),l=Ac(e),u=i==="y",c=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[a]/2-s[a]/2;let f;switch(l){case"top":f={x:c,y:r.y-s.height};break;case"bottom":f={x:c,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-s.width,y:d};break;default:f={x:r.x,y:r.y}}switch(f0(e)){case"start":f[o]-=h*(n&&u?-1:1);break;case"end":f[o]+=h*(n&&u?-1:1);break}return f}const Zpe=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:c,y:d}=w5(u,r,l),h=r,f={},m=0;for(let g=0;g<a.length;g++){const{name:x,fn:w}=a[g],{x:b,y:S,data:C,reset:T}=await w({x:c,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:f,rects:u,platform:o,elements:{reference:t,floating:e}});c=b??c,d=S??d,f={...f,[x]:{...f[x],...C}},T&&m<=50&&(m++,typeof T=="object"&&(T.placement&&(h=T.placement),T.rects&&(u=T.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):T.rects),{x:c,y:d}=w5(u,h,l)),g=-1)}return{x:c,y:d,placement:h,strategy:s,middlewareData:f}};async function Wg(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Iu(e,t),m=M7(f),x=a[h?d==="floating"?"reference":"floating":d],w=dI(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(x)))==null||n?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),b=d==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),C=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},T=dI(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:S,strategy:l}):b);return{top:(w.top-T.top+m.top)/C.y,bottom:(T.bottom-w.bottom+m.bottom)/C.y,left:(w.left-T.left+m.left)/C.x,right:(T.right-w.right+m.right)/C.x}}const Qpe=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:c=0}=Iu(t,e)||{};if(u==null)return{};const d=M7(c),h={x:n,y:r},f=MD(s),m=RD(f),g=await o.getDimensions(u),x=f==="y",w=x?"top":"left",b=x?"bottom":"right",S=x?"clientHeight":"clientWidth",C=i.reference[m]+i.reference[f]-h[f]-i.floating[m],T=h[f]-i.reference[f],D=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let P=D?D[S]:0;(!P||!await(o.isElement==null?void 0:o.isElement(D)))&&(P=a.floating[S]||i.floating[m]);const I=C/2-T/2,E=P/2-g[m]/2-1,M=_c(d[w],E),O=_c(d[b],E),j=M,R=P-g[m]-O,z=P/2-g[m]/2+I,B=X$(j,z,R),V=!l.arrow&&f0(s)!=null&&z!==B&&i.reference[m]/2-(z<j?M:O)-g[m]/2<0,H=V?z<j?z-j:z-R:0;return{[f]:h[f]+H,data:{[f]:B,centerOffset:z-B-H,...V&&{alignmentOffset:H}},reset:V}}}),Jpe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...x}=Iu(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const w=Ac(s),b=ch(a),S=Ac(a)===a,C=await(l.isRTL==null?void 0:l.isRTL(u.floating)),T=h||(S||!g?[cI(a)]:Ype(a)),D=m!=="none";!h&&D&&T.push(...qpe(a,g,m,C));const P=[a,...T],I=await Wg(e,x),E=[];let M=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&E.push(I[w]),d){const z=Hpe(s,o,C);E.push(I[z[0]],I[z[1]])}if(M=[...M,{placement:s,overflows:E}],!E.every(z=>z<=0)){var O,j;const z=(((O=i.flip)==null?void 0:O.index)||0)+1,B=P[z];if(B)return{data:{index:z,overflows:M},reset:{placement:B}};let V=(j=M.filter(H=>H.overflows[0]<=0).sort((H,K)=>H.overflows[1]-K.overflows[1])[0])==null?void 0:j.placement;if(!V)switch(f){case"bestFit":{var R;const H=(R=M.filter(K=>{if(D){const ne=ch(K.placement);return ne===b||ne==="y"}return!0}).map(K=>[K.placement,K.overflows.filter(ne=>ne>0).reduce((ne,fe)=>ne+fe,0)]).sort((K,ne)=>K[1]-ne[1])[0])==null?void 0:R[0];H&&(V=H);break}case"initialPlacement":V=a;break}if(s!==V)return{reset:{placement:V}}}return{}}}};function b5(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function v5(t){return jpe.some(e=>t[e]>=0)}const eme=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=Iu(t,e);switch(r){case"referenceHidden":{const i=await Wg(e,{...s,elementContext:"reference"}),o=b5(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:v5(o)}}}case"escaped":{const i=await Wg(e,{...s,altBoundary:!0}),o=b5(i,n.floating);return{data:{escapedOffsets:o,escaped:v5(o)}}}default:return{}}}}};async function tme(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=Ac(n),a=f0(n),l=ch(n)==="y",u=["left","top"].includes(o)?-1:1,c=i&&l?-1:1,d=Iu(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof m=="number"&&(f=a==="end"?m*-1:m),l?{x:f*c,y:h*u}:{x:h*u,y:f*c}}const nme=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await tme(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},rme=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:x=>{let{x:w,y:b}=x;return{x:w,y:b}}},...l}=Iu(t,e),u={x:n,y:r},c=await Wg(e,l),d=ch(Ac(s)),h=$D(d);let f=u[h],m=u[d];if(i){const x=h==="y"?"top":"left",w=h==="y"?"bottom":"right",b=f+c[x],S=f-c[w];f=X$(b,f,S)}if(o){const x=d==="y"?"top":"left",w=d==="y"?"bottom":"right",b=m+c[x],S=m-c[w];m=X$(b,m,S)}const g=a.fn({...e,[h]:f,[d]:m});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[h]:i,[d]:o}}}}}},sme=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=Iu(t,e),c={x:n,y:r},d=ch(s),h=$D(d);let f=c[h],m=c[d];const g=Iu(a,e),x=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const S=h==="y"?"height":"width",C=i.reference[h]-i.floating[S]+x.mainAxis,T=i.reference[h]+i.reference[S]-x.mainAxis;f<C?f=C:f>T&&(f=T)}if(u){var w,b;const S=h==="y"?"width":"height",C=["top","left"].includes(Ac(s)),T=i.reference[d]-i.floating[S]+(C&&((w=o.offset)==null?void 0:w[d])||0)+(C?0:x.crossAxis),D=i.reference[d]+i.reference[S]+(C?0:((b=o.offset)==null?void 0:b[d])||0)-(C?x.crossAxis:0);m<T?m=T:m>D&&(m=D)}return{[h]:f,[d]:m}}}},ime=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...u}=Iu(t,e),c=await Wg(e,u),d=Ac(s),h=f0(s),f=ch(s)==="y",{width:m,height:g}=i.floating;let x,w;d==="top"||d==="bottom"?(x=d,w=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(w=d,x=h==="end"?"top":"bottom");const b=g-c.top-c.bottom,S=m-c.left-c.right,C=_c(g-c[x],b),T=_c(m-c[w],S),D=!e.middlewareData.shift;let P=C,I=T;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(P=b),D&&!h){const M=hi(c.left,0),O=hi(c.right,0),j=hi(c.top,0),R=hi(c.bottom,0);f?I=m-2*(M!==0||O!==0?M+O:hi(c.left,c.right)):P=g-2*(j!==0||R!==0?j+R:hi(c.top,c.bottom))}await l({...e,availableWidth:I,availableHeight:P});const E=await o.getDimensions(a.floating);return m!==E.width||g!==E.height?{reset:{rects:!0}}:{}}}};function FN(){return typeof window<"u"}function p0(t){return D7(t)?(t.nodeName||"").toLowerCase():"#document"}function Wo(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ru(t){var e;return(e=(D7(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function D7(t){return FN()?t instanceof Node||t instanceof Wo(t).Node:!1}function Li(t){return FN()?t instanceof Element||t instanceof Wo(t).Element:!1}function Nu(t){return FN()?t instanceof HTMLElement||t instanceof Wo(t).HTMLElement:!1}function S5(t){return!FN()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Wo(t).ShadowRoot}function P1(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Sl(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function ome(t){return["table","td","th"].includes(p0(t))}function LN(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function DD(t){const e=OD(),n=Li(t)?Sl(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function ame(t){let e=dh(t);for(;Nu(e)&&!Gg(e);){if(DD(e))return e;if(LN(e))return null;e=dh(e)}return null}function OD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Gg(t){return["html","body","#document"].includes(p0(t))}function Sl(t){return Wo(t).getComputedStyle(t)}function zN(t){return Li(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function dh(t){if(p0(t)==="html")return t;const e=t.assignedSlot||t.parentNode||S5(t)&&t.host||Ru(t);return S5(e)?e.host:e}function O7(t){const e=dh(t);return Gg(e)?t.ownerDocument?t.ownerDocument.body:t.body:Nu(e)&&P1(e)?e:O7(e)}function qw(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=O7(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Wo(s);if(i){const a=Q$(o);return e.concat(o,o.visualViewport||[],P1(s)?s:[],a&&n?qw(a):[])}return e.concat(s,qw(s,[],n))}function Q$(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function P7(t){const e=Sl(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Nu(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,a=Kw(n)!==i||Kw(r)!==o;return a&&(n=i,r=o),{width:n,height:r,$:a}}function PD(t){return Li(t)?t:t.contextElement}function Eg(t){const e=PD(t);if(!Nu(e))return yu(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=P7(e);let o=(i?Kw(n.width):n.width)/r,a=(i?Kw(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const lme=yu(0);function F7(t){const e=Wo(t);return!OD()||!e.visualViewport?lme:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ume(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Wo(t)?!1:e}function pp(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=PD(t);let o=yu(1);e&&(r?Li(r)&&(o=Eg(r)):o=Eg(t));const a=ume(i,n,r)?F7(i):yu(0);let l=(s.left+a.x)/o.x,u=(s.top+a.y)/o.y,c=s.width/o.x,d=s.height/o.y;if(i){const h=Wo(i),f=r&&Li(r)?Wo(r):r;let m=h,g=Q$(m);for(;g&&r&&f!==m;){const x=Eg(g),w=g.getBoundingClientRect(),b=Sl(g),S=w.left+(g.clientLeft+parseFloat(b.paddingLeft))*x.x,C=w.top+(g.clientTop+parseFloat(b.paddingTop))*x.y;l*=x.x,u*=x.y,c*=x.x,d*=x.y,l+=S,u+=C,m=Wo(g),g=Q$(m)}}return dI({width:c,height:d,x:l,y:u})}function FD(t,e){const n=zN(t).scrollLeft;return e?e.left+n:pp(Ru(t)).left+n}function L7(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:FD(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function cme(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=Ru(r),a=e?LN(e.floating):!1;if(r===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},u=yu(1);const c=yu(0),d=Nu(r);if((d||!d&&!i)&&((p0(r)!=="body"||P1(o))&&(l=zN(r)),Nu(r))){const f=pp(r);u=Eg(r),c.x=f.x+r.clientLeft,c.y=f.y+r.clientTop}const h=o&&!d&&!i?L7(o,l,!0):yu(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x+h.x,y:n.y*u.y-l.scrollTop*u.y+c.y+h.y}}function dme(t){return Array.from(t.getClientRects())}function hme(t){const e=Ru(t),n=zN(t),r=t.ownerDocument.body,s=hi(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=hi(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+FD(t);const a=-n.scrollTop;return Sl(r).direction==="rtl"&&(o+=hi(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}function fme(t,e){const n=Wo(t),r=Ru(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const u=OD();(!u||u&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function pme(t,e){const n=pp(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=Nu(t)?Eg(t):yu(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,u=r*i.y;return{width:o,height:a,x:l,y:u}}function C5(t,e,n){let r;if(e==="viewport")r=fme(t,n);else if(e==="document")r=hme(Ru(t));else if(Li(e))r=pme(e,n);else{const s=F7(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return dI(r)}function z7(t,e){const n=dh(t);return n===e||!Li(n)||Gg(n)?!1:Sl(n).position==="fixed"||z7(n,e)}function mme(t,e){const n=e.get(t);if(n)return n;let r=qw(t,[],!1).filter(a=>Li(a)&&p0(a)!=="body"),s=null;const i=Sl(t).position==="fixed";let o=i?dh(t):t;for(;Li(o)&&!Gg(o);){const a=Sl(o),l=DD(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||P1(o)&&!l&&z7(t,o))?r=r.filter(c=>c!==o):s=a,o=dh(o)}return e.set(t,r),r}function gme(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?LN(e)?[]:mme(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((u,c)=>{const d=C5(e,c,s);return u.top=hi(d.top,u.top),u.right=_c(d.right,u.right),u.bottom=_c(d.bottom,u.bottom),u.left=hi(d.left,u.left),u},C5(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function yme(t){const{width:e,height:n}=P7(t);return{width:e,height:n}}function xme(t,e,n){const r=Nu(e),s=Ru(e),i=n==="fixed",o=pp(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=yu(0);if(r||!r&&!i)if((p0(e)!=="body"||P1(s))&&(a=zN(e)),r){const h=pp(e,!0,i,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else s&&(l.x=FD(s));const u=s&&!r&&!i?L7(s,a):yu(0),c=o.left+a.scrollLeft-l.x-u.x,d=o.top+a.scrollTop-l.y-u.y;return{x:c,y:d,width:o.width,height:o.height}}function ZA(t){return Sl(t).position==="static"}function I5(t,e){if(!Nu(t)||Sl(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Ru(t)===n&&(n=n.ownerDocument.body),n}function B7(t,e){const n=Wo(t);if(LN(t))return n;if(!Nu(t)){let s=dh(t);for(;s&&!Gg(s);){if(Li(s)&&!ZA(s))return s;s=dh(s)}return n}let r=I5(t,e);for(;r&&ome(r)&&ZA(r);)r=I5(r,e);return r&&Gg(r)&&ZA(r)&&!DD(r)?n:r||ame(t)||n}const wme=async function(t){const e=this.getOffsetParent||B7,n=this.getDimensions,r=await n(t.floating);return{reference:xme(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function bme(t){return Sl(t).direction==="rtl"}const vme={convertOffsetParentRelativeRectToViewportRelativeRect:cme,getDocumentElement:Ru,getClippingRect:gme,getOffsetParent:B7,getElementRects:wme,getClientRects:dme,getDimensions:yme,getScale:Eg,isElement:Li,isRTL:bme};function U7(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Sme(t,e){let n=null,r;const s=Ru(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const u=t.getBoundingClientRect(),{left:c,top:d,width:h,height:f}=u;if(a||e(),!h||!f)return;const m=W2(d),g=W2(s.clientWidth-(c+h)),x=W2(s.clientHeight-(d+f)),w=W2(c),S={rootMargin:-m+"px "+-g+"px "+-x+"px "+-w+"px",threshold:hi(0,_c(1,l))||1};let C=!0;function T(D){const P=D[0].intersectionRatio;if(P!==l){if(!C)return o();P?o(!1,P):r=setTimeout(()=>{o(!1,1e-7)},1e3)}P===1&&!U7(u,t.getBoundingClientRect())&&o(),C=!1}try{n=new IntersectionObserver(T,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(T,S)}n.observe(t)}return o(!0),i}function V7(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=PD(t),c=s||i?[...u?qw(u):[],...qw(e)]:[];c.forEach(w=>{s&&w.addEventListener("scroll",n,{passive:!0}),i&&w.addEventListener("resize",n)});const d=u&&a?Sme(u,n):null;let h=-1,f=null;o&&(f=new ResizeObserver(w=>{let[b]=w;b&&b.target===u&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=f)==null||S.observe(e)})),n()}),u&&!l&&f.observe(u),f.observe(e));let m,g=l?pp(t):null;l&&x();function x(){const w=pp(t);g&&!U7(g,w)&&n(),g=w,m=requestAnimationFrame(x)}return n(),()=>{var w;c.forEach(b=>{s&&b.removeEventListener("scroll",n),i&&b.removeEventListener("resize",n)}),d==null||d(),(w=f)==null||w.disconnect(),f=null,l&&cancelAnimationFrame(m)}}const QA=Wg,Cme=nme,Ime=rme,Nme=Jpe,kme=ime,Tme=eme,N5=Qpe,Eme=sme,_me=(t,e,n)=>{const r=new Map,s={platform:vme,...n},i={...s.platform,_c:r};return Zpe(t,e,{...s,platform:i})};var yC=typeof document<"u"?W.useLayoutEffect:W.useEffect;function hI(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!hI(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!hI(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function j7(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function k5(t,e){const n=j7(t);return Math.round(e*n)/n}function JA(t){const e=W.useRef(t);return yC(()=>{e.current=t}),e}function W7(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[c,d]=W.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=W.useState(r);hI(h,r)||f(r);const[m,g]=W.useState(null),[x,w]=W.useState(null),b=W.useCallback(K=>{K!==D.current&&(D.current=K,g(K))},[]),S=W.useCallback(K=>{K!==P.current&&(P.current=K,w(K))},[]),C=i||m,T=o||x,D=W.useRef(null),P=W.useRef(null),I=W.useRef(c),E=l!=null,M=JA(l),O=JA(s),j=JA(u),R=W.useCallback(()=>{if(!D.current||!P.current)return;const K={placement:e,strategy:n,middleware:h};O.current&&(K.platform=O.current),_me(D.current,P.current,K).then(ne=>{const fe={...ne,isPositioned:j.current!==!1};z.current&&!hI(I.current,fe)&&(I.current=fe,Ea.flushSync(()=>{d(fe)}))})},[h,e,n,O,j]);yC(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,d(K=>({...K,isPositioned:!1})))},[u]);const z=W.useRef(!1);yC(()=>(z.current=!0,()=>{z.current=!1}),[]),yC(()=>{if(C&&(D.current=C),T&&(P.current=T),C&&T){if(M.current)return M.current(C,T,R);R()}},[C,T,R,M,E]);const B=W.useMemo(()=>({reference:D,floating:P,setReference:b,setFloating:S}),[b,S]),V=W.useMemo(()=>({reference:C,floating:T}),[C,T]),H=W.useMemo(()=>{const K={position:n,left:0,top:0};if(!V.floating)return K;const ne=k5(V.floating,c.x),fe=k5(V.floating,c.y);return a?{...K,transform:"translate("+ne+"px, "+fe+"px)",...j7(V.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ne,top:fe}},[n,a,V.floating,c.x,c.y]);return W.useMemo(()=>({...c,update:R,refs:B,elements:V,floatingStyles:H}),[c,R,B,V,H])}const Ame=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?N5({element:r.current,padding:s}).fn(n):{}:r?N5({element:r,padding:s}).fn(n):{}}}},LD=(t,e)=>({...Cme(t),options:[t,e]}),G7=(t,e)=>({...Ime(t),options:[t,e]}),$me=(t,e)=>({...Eme(t),options:[t,e]}),H7=(t,e)=>({...Nme(t),options:[t,e]}),Y7=(t,e)=>({...kme(t),options:[t,e]}),Rme=(t,e)=>({...Tme(t),options:[t,e]}),Mme=(t,e)=>({...Ame(t),options:[t,e]});var Dme="Arrow",K7=W.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return he.jsx(So.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:he.jsx("polygon",{points:"0,0 30,0 15,10"})})});K7.displayName=Dme;var Ome=K7;function Pme(t){const[e,n]=W.useState(void 0);return fp(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var zD="Popper",[q7,X7]=ED(zD),[Fme,Z7]=q7(zD),Q7=t=>{const{__scopePopper:e,children:n}=t,[r,s]=W.useState(null);return he.jsx(Fme,{scope:e,anchor:r,onAnchorChange:s,children:n})};Q7.displayName=zD;var J7="PopperAnchor",eH=W.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=Z7(J7,n),o=W.useRef(null),a=$l(e,o);return W.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:he.jsx(So.div,{...s,ref:a})});eH.displayName=J7;var BD="PopperContent",[Lme,zme]=q7(BD),tH=W.forwardRef((t,e)=>{var Le,De,Be,se,le,ye;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:m,...g}=t,x=Z7(BD,n),[w,b]=W.useState(null),S=$l(e,ve=>b(ve)),[C,T]=W.useState(null),D=Pme(C),P=(D==null?void 0:D.width)??0,I=(D==null?void 0:D.height)??0,E=r+(i!=="center"?"-"+i:""),M=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},O=Array.isArray(u)?u:[u],j=O.length>0,R={padding:M,boundary:O.filter(Ume),altBoundary:j},{refs:z,floatingStyles:B,placement:V,isPositioned:H,middlewareData:K}=W7({strategy:"fixed",placement:E,whileElementsMounted:(...ve)=>V7(...ve,{animationFrame:f==="always"}),elements:{reference:x.anchor},middleware:[LD({mainAxis:s+I,alignmentAxis:o}),l&&G7({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?$me():void 0,...R}),l&&H7({...R}),Y7({...R,apply:({elements:ve,rects:xe,availableWidth:Ie,availableHeight:te})=>{const{width:L,height:U}=xe.reference,re=ve.floating.style;re.setProperty("--radix-popper-available-width",`${Ie}px`),re.setProperty("--radix-popper-available-height",`${te}px`),re.setProperty("--radix-popper-anchor-width",`${L}px`),re.setProperty("--radix-popper-anchor-height",`${U}px`)}}),C&&Mme({element:C,padding:a}),Vme({arrowWidth:P,arrowHeight:I}),h&&Rme({strategy:"referenceHidden",...R})]}),[ne,fe]=sH(V),ee=uh(m);fp(()=>{H&&(ee==null||ee())},[H,ee]);const de=(Le=K.arrow)==null?void 0:Le.x,ge=(De=K.arrow)==null?void 0:De.y,Z=((Be=K.arrow)==null?void 0:Be.centerOffset)!==0,[we,Ee]=W.useState();return fp(()=>{w&&Ee(window.getComputedStyle(w).zIndex)},[w]),he.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:H?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:we,"--radix-popper-transform-origin":[(se=K.transformOrigin)==null?void 0:se.x,(le=K.transformOrigin)==null?void 0:le.y].join(" "),...((ye=K.hide)==null?void 0:ye.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:he.jsx(Lme,{scope:n,placedSide:ne,onArrowChange:T,arrowX:de,arrowY:ge,shouldHideArrow:Z,children:he.jsx(So.div,{"data-side":ne,"data-align":fe,...g,ref:S,style:{...g.style,animation:H?void 0:"none"}})})})});tH.displayName=BD;var nH="PopperArrow",Bme={top:"bottom",right:"left",bottom:"top",left:"right"},rH=W.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=zme(nH,r),o=Bme[i.placedSide];return he.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:he.jsx(Ome,{...s,ref:n,style:{...s.style,display:"block"}})})});rH.displayName=nH;function Ume(t){return t!==null}var Vme=t=>({name:"transformOrigin",options:t,fn(e){var x,w,b;const{placement:n,rects:r,middlewareData:s}=e,o=((x=s.arrow)==null?void 0:x.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,c]=sH(n),d={start:"0%",center:"50%",end:"100%"}[c],h=(((w=s.arrow)==null?void 0:w.x)??0)+a/2,f=(((b=s.arrow)==null?void 0:b.y)??0)+l/2;let m="",g="";return u==="bottom"?(m=o?d:`${h}px`,g=`${-l}px`):u==="top"?(m=o?d:`${h}px`,g=`${r.floating.height+l}px`):u==="right"?(m=`${-l}px`,g=o?d:`${f}px`):u==="left"&&(m=`${r.floating.width+l}px`,g=o?d:`${f}px`),{data:{x:m,y:g}}}});function sH(t){const[e,n="center"]=t.split("-");return[e,n]}var jme=Q7,Wme=eH,Gme=tH,Hme=rH,Yme="Portal",UD=W.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=W.useState(!1);fp(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?zse.createPortal(he.jsx(So.div,{...r,ref:e}),o):null});UD.displayName=Yme;function Kme(t,e){return W.useReducer((n,r)=>e[n][r]??n,t)}var m0=t=>{const{present:e,children:n}=t,r=qme(e),s=typeof n=="function"?n({present:r.isPresent}):W.Children.only(n),i=$l(r.ref,Xme(s));return typeof n=="function"||r.isPresent?W.cloneElement(s,{ref:i}):null};m0.displayName="Presence";function qme(t){const[e,n]=W.useState(),r=W.useRef({}),s=W.useRef(t),i=W.useRef("none"),o=t?"mounted":"unmounted",[a,l]=Kme(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return W.useEffect(()=>{const u=G2(r.current);i.current=a==="mounted"?u:"none"},[a]),fp(()=>{const u=r.current,c=s.current;if(c!==t){const h=i.current,f=G2(u);t?l("MOUNT"):f==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&h!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),fp(()=>{if(e){let u;const c=e.ownerDocument.defaultView??window,d=f=>{const g=G2(r.current).includes(f.animationName);if(f.target===e&&g&&(l("ANIMATION_END"),!s.current)){const x=e.style.animationFillMode;e.style.animationFillMode="forwards",u=c.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=x)})}},h=f=>{f.target===e&&(i.current=G2(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{c.clearTimeout(u),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:W.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function G2(t){return(t==null?void 0:t.animationName)||"none"}function Xme(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function iH({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=Zme({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,a=uh(n),l=W.useCallback(u=>{if(i){const d=typeof u=="function"?u(t):u;d!==t&&a(d)}else s(u)},[i,t,s,a]);return[o,l]}function Zme({defaultProp:t,onChange:e}){const n=W.useState(t),[r]=n,s=W.useRef(r),i=uh(e);return W.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}var Qme="VisuallyHidden",oH=W.forwardRef((t,e)=>he.jsx(So.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));oH.displayName=Qme;var Jme=oH,[BN,Bit]=ED("Tooltip",[X7]),UN=X7(),aH="TooltipProvider",ege=700,J$="tooltip.open",[tge,VD]=BN(aH),lH=t=>{const{__scopeTooltip:e,delayDuration:n=ege,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=t,[o,a]=W.useState(!0),l=W.useRef(!1),u=W.useRef(0);return W.useEffect(()=>{const c=u.current;return()=>window.clearTimeout(c)},[]),he.jsx(tge,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:W.useCallback(()=>{window.clearTimeout(u.current),a(!1)},[]),onClose:W.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>a(!0),r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:W.useCallback(c=>{l.current=c},[]),disableHoverableContent:s,children:i})};lH.displayName=aH;var VN="Tooltip",[nge,F1]=BN(VN),uH=t=>{const{__scopeTooltip:e,children:n,open:r,defaultOpen:s=!1,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=VD(VN,t.__scopeTooltip),u=UN(e),[c,d]=W.useState(null),h=gC(),f=W.useRef(0),m=o??l.disableHoverableContent,g=a??l.delayDuration,x=W.useRef(!1),[w=!1,b]=iH({prop:r,defaultProp:s,onChange:P=>{P?(l.onOpen(),document.dispatchEvent(new CustomEvent(J$))):l.onClose(),i==null||i(P)}}),S=W.useMemo(()=>w?x.current?"delayed-open":"instant-open":"closed",[w]),C=W.useCallback(()=>{window.clearTimeout(f.current),f.current=0,x.current=!1,b(!0)},[b]),T=W.useCallback(()=>{window.clearTimeout(f.current),f.current=0,b(!1)},[b]),D=W.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{x.current=!0,b(!0),f.current=0},g)},[g,b]);return W.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),he.jsx(jme,{...u,children:he.jsx(nge,{scope:e,contentId:h,open:w,stateAttribute:S,trigger:c,onTriggerChange:d,onTriggerEnter:W.useCallback(()=>{l.isOpenDelayed?D():C()},[l.isOpenDelayed,D,C]),onTriggerLeave:W.useCallback(()=>{m?T():(window.clearTimeout(f.current),f.current=0)},[T,m]),onOpen:C,onClose:T,disableHoverableContent:m,children:n})})};uH.displayName=VN;var eR="TooltipTrigger",cH=W.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=F1(eR,n),i=VD(eR,n),o=UN(n),a=W.useRef(null),l=$l(e,a,s.onTriggerChange),u=W.useRef(!1),c=W.useRef(!1),d=W.useCallback(()=>u.current=!1,[]);return W.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),he.jsx(Wme,{asChild:!0,...o,children:he.jsx(So.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:co(t.onPointerMove,h=>{h.pointerType!=="touch"&&!c.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),c.current=!0)}),onPointerLeave:co(t.onPointerLeave,()=>{s.onTriggerLeave(),c.current=!1}),onPointerDown:co(t.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:co(t.onFocus,()=>{u.current||s.onOpen()}),onBlur:co(t.onBlur,s.onClose),onClick:co(t.onClick,s.onClose)})})});cH.displayName=eR;var jD="TooltipPortal",[rge,sge]=BN(jD,{forceMount:void 0}),dH=t=>{const{__scopeTooltip:e,forceMount:n,children:r,container:s}=t,i=F1(jD,e);return he.jsx(rge,{scope:e,forceMount:n,children:he.jsx(m0,{present:n||i.open,children:he.jsx(UD,{asChild:!0,container:s,children:r})})})};dH.displayName=jD;var Hg="TooltipContent",hH=W.forwardRef((t,e)=>{const n=sge(Hg,t.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=t,o=F1(Hg,t.__scopeTooltip);return he.jsx(m0,{present:r||o.open,children:o.disableHoverableContent?he.jsx(fH,{side:s,...i,ref:e}):he.jsx(ige,{side:s,...i,ref:e})})}),ige=W.forwardRef((t,e)=>{const n=F1(Hg,t.__scopeTooltip),r=VD(Hg,t.__scopeTooltip),s=W.useRef(null),i=$l(e,s),[o,a]=W.useState(null),{trigger:l,onClose:u}=n,c=s.current,{onPointerInTransitChange:d}=r,h=W.useCallback(()=>{a(null),d(!1)},[d]),f=W.useCallback((m,g)=>{const x=m.currentTarget,w={x:m.clientX,y:m.clientY},b=lge(w,x.getBoundingClientRect()),S=uge(w,b),C=cge(g.getBoundingClientRect()),T=hge([...S,...C]);a(T),d(!0)},[d]);return W.useEffect(()=>()=>h(),[h]),W.useEffect(()=>{if(l&&c){const m=x=>f(x,c),g=x=>f(x,l);return l.addEventListener("pointerleave",m),c.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",m),c.removeEventListener("pointerleave",g)}}},[l,c,f,h]),W.useEffect(()=>{if(o){const m=g=>{const x=g.target,w={x:g.clientX,y:g.clientY},b=(l==null?void 0:l.contains(x))||(c==null?void 0:c.contains(x)),S=!dge(w,o);b?h():S&&(h(),u())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,c,o,u,h]),he.jsx(fH,{...t,ref:i})}),[oge,age]=BN(VN,{isInside:!1}),fH=W.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=F1(Hg,n),u=UN(n),{onClose:c}=l;return W.useEffect(()=>(document.addEventListener(J$,c),()=>document.removeEventListener(J$,c)),[c]),W.useEffect(()=>{if(l.trigger){const d=h=>{const f=h.target;f!=null&&f.contains(l.trigger)&&c()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,c]),he.jsx(AD,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:c,children:he.jsxs(Gme,{"data-state":l.stateAttribute,...u,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[he.jsx(A7,{children:r}),he.jsx(oge,{scope:n,isInside:!0,children:he.jsx(Jme,{id:l.contentId,role:"tooltip",children:s||r})})]})})});hH.displayName=Hg;var pH="TooltipArrow",mH=W.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=UN(n);return age(pH,n).isInside?null:he.jsx(Hme,{...s,...r,ref:e})});mH.displayName=pH;function lge(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function uge(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function cge(t){const{top:e,right:n,bottom:r,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:r},{x:s,y:r}]}function dge(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,u=e[o].x,c=e[o].y;l>r!=c>r&&n<(u-a)*(r-l)/(c-l)+a&&(s=!s)}return s}function hge(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),fge(e)}function fge(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const s=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const s=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var pge=uH,mge=cH,gge=dH,yge=hH,xge=mH,e3="focusScope.autoFocusOnMount",t3="focusScope.autoFocusOnUnmount",T5={bubbles:!1,cancelable:!0},wge="FocusScope",gH=W.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=W.useState(null),u=uh(s),c=uh(i),d=W.useRef(null),h=$l(e,g=>l(g)),f=W.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;W.useEffect(()=>{if(r){let g=function(S){if(f.paused||!a)return;const C=S.target;a.contains(C)?d.current=C:Rd(d.current,{select:!0})},x=function(S){if(f.paused||!a)return;const C=S.relatedTarget;C!==null&&(a.contains(C)||Rd(d.current,{select:!0}))},w=function(S){if(document.activeElement===document.body)for(const T of S)T.removedNodes.length>0&&Rd(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",x);const b=new MutationObserver(w);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",x),b.disconnect()}}},[r,a,f.paused]),W.useEffect(()=>{if(a){_5.add(f);const g=document.activeElement;if(!a.contains(g)){const w=new CustomEvent(e3,T5);a.addEventListener(e3,u),a.dispatchEvent(w),w.defaultPrevented||(bge(Nge(yH(a)),{select:!0}),document.activeElement===g&&Rd(a))}return()=>{a.removeEventListener(e3,u),setTimeout(()=>{const w=new CustomEvent(t3,T5);a.addEventListener(t3,c),a.dispatchEvent(w),w.defaultPrevented||Rd(g??document.body,{select:!0}),a.removeEventListener(t3,c),_5.remove(f)},0)}}},[a,u,c,f]);const m=W.useCallback(g=>{if(!n&&!r||f.paused)return;const x=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,w=document.activeElement;if(x&&w){const b=g.currentTarget,[S,C]=vge(b);S&&C?!g.shiftKey&&w===C?(g.preventDefault(),n&&Rd(S,{select:!0})):g.shiftKey&&w===S&&(g.preventDefault(),n&&Rd(C,{select:!0})):w===b&&g.preventDefault()}},[n,r,f.paused]);return he.jsx(So.div,{tabIndex:-1,...o,ref:h,onKeyDown:m})});gH.displayName=wge;function bge(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Rd(r,{select:e}),document.activeElement!==n)return}function vge(t){const e=yH(t),n=E5(e,t),r=E5(e.reverse(),t);return[n,r]}function yH(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function E5(t,e){for(const n of t)if(!Sge(n,{upTo:e}))return n}function Sge(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Cge(t){return t instanceof HTMLInputElement&&"select"in t}function Rd(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Cge(t)&&e&&t.select()}}var _5=Ige();function Ige(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=A5(t,e),t.unshift(e)},remove(e){var n;t=A5(t,e),(n=t[0])==null||n.resume()}}}function A5(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function Nge(t){return t.filter(e=>e.tagName!=="A")}var n3=0;function kge(){W.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??$5()),document.body.insertAdjacentElement("beforeend",t[1]??$5()),n3++,()=>{n3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),n3--}},[])}function $5(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var cu=function(){return cu=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cu.apply(this,arguments)};function xH(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Tge(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var xC="right-scroll-bar-position",wC="width-before-scroll-bar",Ege="with-scroll-bars-hidden",_ge="--removed-body-scroll-bar-size";function r3(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Age(t,e){var n=W.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var $ge=typeof window<"u"?W.useLayoutEffect:W.useEffect,R5=new WeakMap;function Rge(t,e){var n=Age(null,function(r){return t.forEach(function(s){return r3(s,r)})});return $ge(function(){var r=R5.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(a){i.has(a)||r3(a,null)}),i.forEach(function(a){s.has(a)||r3(a,o)})}R5.set(n,t)},[t]),n}function Mge(t){return t}function Dge(t,e){e===void 0&&(e=Mge);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var c=o;o=[],c.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(c){o.push(c),u()},filter:function(c){return o=o.filter(c),n}}}};return s}function Oge(t){t===void 0&&(t={});var e=Dge(null);return e.options=cu({async:!0,ssr:!1},t),e}var wH=function(t){var e=t.sideCar,n=xH(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return W.createElement(r,cu({},n))};wH.isSideCarExport=!0;function Pge(t,e){return t.useMedium(e),wH}var bH=Oge(),s3=function(){},jN=W.forwardRef(function(t,e){var n=W.useRef(null),r=W.useState({onScrollCapture:s3,onWheelCapture:s3,onTouchMoveCapture:s3}),s=r[0],i=r[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,c=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,m=t.inert,g=t.allowPinchZoom,x=t.as,w=x===void 0?"div":x,b=t.gapMode,S=xH(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=h,T=Rge([n,e]),D=cu(cu({},S),s);return W.createElement(W.Fragment,null,c&&W.createElement(C,{sideCar:bH,removeScrollBar:u,shards:d,noIsolation:f,inert:m,setCallbacks:i,allowPinchZoom:!!g,lockRef:n,gapMode:b}),o?W.cloneElement(W.Children.only(a),cu(cu({},D),{ref:T})):W.createElement(w,cu({},D,{className:l,ref:T}),a))});jN.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};jN.classNames={fullWidth:wC,zeroRight:xC};var Fge=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Lge(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Fge();return e&&t.setAttribute("nonce",e),t}function zge(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Bge(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Uge=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Lge())&&(zge(e,n),Bge(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Vge=function(){var t=Uge();return function(e,n){W.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},vH=function(){var t=Vge(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},jge={left:0,top:0,right:0,gap:0},i3=function(t){return parseInt(t||"",10)||0},Wge=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[i3(n),i3(r),i3(s)]},Gge=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return jge;var e=Wge(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},Hge=vH(),_g="data-scroll-locked",Yge=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ege,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(_g,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(xC,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(wC,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(xC," .").concat(xC,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(wC," .").concat(wC,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(_g,`] {
    `).concat(_ge,": ").concat(a,`px;
  }
`)},M5=function(){var t=parseInt(document.body.getAttribute(_g)||"0",10);return isFinite(t)?t:0},Kge=function(){W.useEffect(function(){return document.body.setAttribute(_g,(M5()+1).toString()),function(){var t=M5()-1;t<=0?document.body.removeAttribute(_g):document.body.setAttribute(_g,t.toString())}},[])},qge=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;Kge();var i=W.useMemo(function(){return Gge(s)},[s]);return W.createElement(Hge,{styles:Yge(i,!e,s,n?"":"!important")})},tR=!1;if(typeof window<"u")try{var H2=Object.defineProperty({},"passive",{get:function(){return tR=!0,!0}});window.addEventListener("test",H2,H2),window.removeEventListener("test",H2,H2)}catch{tR=!1}var Vm=tR?{passive:!1}:!1,Xge=function(t){return t.tagName==="TEXTAREA"},SH=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Xge(t)&&n[e]==="visible")},Zge=function(t){return SH(t,"overflowY")},Qge=function(t){return SH(t,"overflowX")},D5=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=CH(t,r);if(s){var i=IH(t,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Jge=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},e0e=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},CH=function(t,e){return t==="v"?Zge(e):Qge(e)},IH=function(t,e){return t==="v"?Jge(e):e0e(e)},t0e=function(t,e){return t==="h"&&e==="rtl"?-1:1},n0e=function(t,e,n,r,s){var i=t0e(t,window.getComputedStyle(e).direction),o=i*r,a=n.target,l=e.contains(a),u=!1,c=o>0,d=0,h=0;do{var f=IH(t,a),m=f[0],g=f[1],x=f[2],w=g-x-i*m;(m||w)&&CH(t,a)&&(d+=w,h+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(c&&Math.abs(d)<1||!c&&Math.abs(h)<1)&&(u=!0),u},Y2=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},O5=function(t){return[t.deltaX,t.deltaY]},P5=function(t){return t&&"current"in t?t.current:t},r0e=function(t,e){return t[0]===e[0]&&t[1]===e[1]},s0e=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},i0e=0,jm=[];function o0e(t){var e=W.useRef([]),n=W.useRef([0,0]),r=W.useRef(),s=W.useState(i0e++)[0],i=W.useState(vH)[0],o=W.useRef(t);W.useEffect(function(){o.current=t},[t]),W.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var g=Tge([t.lockRef.current],(t.shards||[]).map(P5),!0).filter(Boolean);return g.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=W.useCallback(function(g,x){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var w=Y2(g),b=n.current,S="deltaX"in g?g.deltaX:b[0]-w[0],C="deltaY"in g?g.deltaY:b[1]-w[1],T,D=g.target,P=Math.abs(S)>Math.abs(C)?"h":"v";if("touches"in g&&P==="h"&&D.type==="range")return!1;var I=D5(P,D);if(!I)return!0;if(I?T=P:(T=P==="v"?"h":"v",I=D5(P,D)),!I)return!1;if(!r.current&&"changedTouches"in g&&(S||C)&&(r.current=T),!T)return!0;var E=r.current||T;return n0e(E,x,g,E==="h"?S:C)},[]),l=W.useCallback(function(g){var x=g;if(!(!jm.length||jm[jm.length-1]!==i)){var w="deltaY"in x?O5(x):Y2(x),b=e.current.filter(function(T){return T.name===x.type&&(T.target===x.target||x.target===T.shadowParent)&&r0e(T.delta,w)})[0];if(b&&b.should){x.cancelable&&x.preventDefault();return}if(!b){var S=(o.current.shards||[]).map(P5).filter(Boolean).filter(function(T){return T.contains(x.target)}),C=S.length>0?a(x,S[0]):!o.current.noIsolation;C&&x.cancelable&&x.preventDefault()}}},[]),u=W.useCallback(function(g,x,w,b){var S={name:g,delta:x,target:w,should:b,shadowParent:a0e(w)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(C){return C!==S})},1)},[]),c=W.useCallback(function(g){n.current=Y2(g),r.current=void 0},[]),d=W.useCallback(function(g){u(g.type,O5(g),g.target,a(g,t.lockRef.current))},[]),h=W.useCallback(function(g){u(g.type,Y2(g),g.target,a(g,t.lockRef.current))},[]);W.useEffect(function(){return jm.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Vm),document.addEventListener("touchmove",l,Vm),document.addEventListener("touchstart",c,Vm),function(){jm=jm.filter(function(g){return g!==i}),document.removeEventListener("wheel",l,Vm),document.removeEventListener("touchmove",l,Vm),document.removeEventListener("touchstart",c,Vm)}},[]);var f=t.removeScrollBar,m=t.inert;return W.createElement(W.Fragment,null,m?W.createElement(i,{styles:s0e(s)}):null,f?W.createElement(qge,{gapMode:t.gapMode}):null)}function a0e(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const l0e=Pge(bH,o0e);var NH=W.forwardRef(function(t,e){return W.createElement(jN,cu({},t,{ref:e,sideCar:l0e}))});NH.classNames=jN.classNames;var u0e=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Wm=new WeakMap,K2=new WeakMap,q2={},o3=0,kH=function(t){return t&&(t.host||kH(t.parentNode))},c0e=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=kH(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},d0e=function(t,e,n,r){var s=c0e(e,Array.isArray(t)?t:[t]);q2[n]||(q2[n]=new WeakMap);var i=q2[n],o=[],a=new Set,l=new Set(s),u=function(d){!d||a.has(d)||(a.add(d),u(d.parentNode))};s.forEach(u);var c=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))c(h);else try{var f=h.getAttribute(r),m=f!==null&&f!=="false",g=(Wm.get(h)||0)+1,x=(i.get(h)||0)+1;Wm.set(h,g),i.set(h,x),o.push(h),g===1&&m&&K2.set(h,!0),x===1&&h.setAttribute(n,"true"),m||h.setAttribute(r,"true")}catch(w){console.error("aria-hidden: cannot operate on ",h,w)}})};return c(e),a.clear(),o3++,function(){o.forEach(function(d){var h=Wm.get(d)-1,f=i.get(d)-1;Wm.set(d,h),i.set(d,f),h||(K2.has(d)||d.removeAttribute(r),K2.delete(d)),f||d.removeAttribute(n)}),o3--,o3||(Wm=new WeakMap,Wm=new WeakMap,K2=new WeakMap,q2={})}},h0e=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=u0e(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),d0e(r,s,n,"aria-hidden")):function(){return null}},WD="Dialog",[TH,Uit]=ED(WD),[f0e,Rl]=TH(WD),EH=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=W.useRef(null),l=W.useRef(null),[u=!1,c]=iH({prop:r,defaultProp:s,onChange:i});return he.jsx(f0e,{scope:e,triggerRef:a,contentRef:l,contentId:gC(),titleId:gC(),descriptionId:gC(),open:u,onOpenChange:c,onOpenToggle:W.useCallback(()=>c(d=>!d),[c]),modal:o,children:n})};EH.displayName=WD;var _H="DialogTrigger",p0e=W.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Rl(_H,n),i=$l(e,s.triggerRef);return he.jsx(So.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":YD(s.open),...r,ref:i,onClick:co(t.onClick,s.onOpenToggle)})});p0e.displayName=_H;var GD="DialogPortal",[m0e,AH]=TH(GD,{forceMount:void 0}),$H=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Rl(GD,e);return he.jsx(m0e,{scope:e,forceMount:n,children:W.Children.map(r,o=>he.jsx(m0,{present:n||i.open,children:he.jsx(UD,{asChild:!0,container:s,children:o})}))})};$H.displayName=GD;var fI="DialogOverlay",g0e=W.forwardRef((t,e)=>{const n=AH(fI,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Rl(fI,t.__scopeDialog);return i.modal?he.jsx(m0,{present:r||i.open,children:he.jsx(y0e,{...s,ref:e})}):null});g0e.displayName=fI;var y0e=W.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Rl(fI,n);return he.jsx(NH,{as:_D,allowPinchZoom:!0,shards:[s.contentRef],children:he.jsx(So.div,{"data-state":YD(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),mp="DialogContent",RH=W.forwardRef((t,e)=>{const n=AH(mp,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Rl(mp,t.__scopeDialog);return he.jsx(m0,{present:r||i.open,children:i.modal?he.jsx(x0e,{...s,ref:e}):he.jsx(w0e,{...s,ref:e})})});RH.displayName=mp;var x0e=W.forwardRef((t,e)=>{const n=Rl(mp,t.__scopeDialog),r=W.useRef(null),s=$l(e,n.contentRef,r);return W.useEffect(()=>{const i=r.current;if(i)return h0e(i)},[]),he.jsx(MH,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:co(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:co(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:co(t.onFocusOutside,i=>i.preventDefault())})}),w0e=W.forwardRef((t,e)=>{const n=Rl(mp,t.__scopeDialog),r=W.useRef(!1),s=W.useRef(!1);return he.jsx(MH,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,u;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),MH=W.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=Rl(mp,n),l=W.useRef(null),u=$l(e,l);return kge(),he.jsxs(he.Fragment,{children:[he.jsx(gH,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:he.jsx(AD,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":YD(a.open),...o,ref:u,onDismiss:()=>a.onOpenChange(!1)})}),he.jsxs(he.Fragment,{children:[he.jsx(C0e,{titleId:a.titleId}),he.jsx(N0e,{contentRef:l,descriptionId:a.descriptionId})]})]})}),HD="DialogTitle",b0e=W.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Rl(HD,n);return he.jsx(So.h2,{id:s.titleId,...r,ref:e})});b0e.displayName=HD;var DH="DialogDescription",v0e=W.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Rl(DH,n);return he.jsx(So.p,{id:s.descriptionId,...r,ref:e})});v0e.displayName=DH;var OH="DialogClose",S0e=W.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Rl(OH,n);return he.jsx(So.button,{type:"button",...r,ref:e,onClick:co(t.onClick,()=>s.onOpenChange(!1))})});S0e.displayName=OH;function YD(t){return t?"open":"closed"}var PH="DialogTitleWarning",[Vit,FH]=kpe(PH,{contentName:mp,titleName:HD,docsSlug:"dialog"}),C0e=({titleId:t})=>{const e=FH(PH),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return W.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},I0e="DialogDescriptionWarning",N0e=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${FH(I0e).contentName}}.`;return W.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},k0e=EH,T0e=$H,E0e=RH;function LH(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=LH(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function zr(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=LH(t))&&(r&&(r+=" "),r+=e);return r}var L1=t=>t.type==="checkbox",Gf=t=>t instanceof Date,Di=t=>t==null;const zH=t=>typeof t=="object";var Vr=t=>!Di(t)&&!Array.isArray(t)&&zH(t)&&!Gf(t),_0e=t=>Vr(t)&&t.target?L1(t.target)?t.target.checked:t.target.value:t,A0e=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,$0e=(t,e)=>t.has(A0e(e)),R0e=t=>{const e=t.constructor&&t.constructor.prototype;return Vr(e)&&e.hasOwnProperty("isPrototypeOf")},KD=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function oi(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(KD&&(t instanceof Blob||r))&&(n||Vr(t)))if(e=n?[]:{},!n&&!R0e(t))e=t;else for(const s in t)t.hasOwnProperty(s)&&(e[s]=oi(t[s]));else return t;return e}var WN=t=>/^\w*$/.test(t),Xr=t=>t===void 0,qD=t=>Array.isArray(t)?t.filter(Boolean):[],XD=t=>qD(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Ot=(t,e,n)=>{if(!e||!Vr(t))return n;const r=(WN(e)?[e]:XD(e)).reduce((s,i)=>Di(s)?s:s[i],t);return Xr(r)||r===t?Xr(t[e])?n:t[e]:r},ru=t=>typeof t=="boolean",sr=(t,e,n)=>{let r=-1;const s=WN(e)?[e]:XD(e),i=s.length,o=i-1;for(;++r<i;){const a=s[r];let l=n;if(r!==o){const u=t[a];l=Vr(u)||Array.isArray(u)?u:isNaN(+s[r+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;t[a]=l,t=t[a]}};const F5={BLUR:"blur",FOCUS_OUT:"focusout"},pl={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},nc={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},M0e=En.createContext(null);M0e.displayName="HookFormContext";var D0e=(t,e,n,r=!0)=>{const s={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(s,i,{get:()=>{const o=i;return e._proxyFormState[o]!==pl.all&&(e._proxyFormState[o]=!r||pl.all),t[o]}});return s};const O0e=typeof window<"u"?W.useLayoutEffect:W.useEffect;var fu=t=>typeof t=="string",P0e=(t,e,n,r,s)=>fu(t)?(r&&e.watch.add(t),Ot(n,t,s)):Array.isArray(t)?t.map(i=>(r&&e.watch.add(i),Ot(n,i))):(r&&(e.watchAll=!0),n),F0e=(t,e,n,r,s)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:s||!0}}:{},kw=t=>Array.isArray(t)?t:[t],L5=()=>{let t=[];return{get observers(){return t},next:s=>{for(const i of t)i.next&&i.next(s)},subscribe:s=>(t.push(s),{unsubscribe:()=>{t=t.filter(i=>i!==s)}}),unsubscribe:()=>{t=[]}}},nR=t=>Di(t)||!zH(t);function Gd(t,e){if(nR(t)||nR(e))return t===e;if(Gf(t)&&Gf(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const s of n){const i=t[s];if(!r.includes(s))return!1;if(s!=="ref"){const o=e[s];if(Gf(i)&&Gf(o)||Vr(i)&&Vr(o)||Array.isArray(i)&&Array.isArray(o)?!Gd(i,o):i!==o)return!1}}return!0}var ao=t=>Vr(t)&&!Object.keys(t).length,ZD=t=>t.type==="file",ml=t=>typeof t=="function",pI=t=>{if(!KD)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},BH=t=>t.type==="select-multiple",QD=t=>t.type==="radio",L0e=t=>QD(t)||L1(t),a3=t=>pI(t)&&t.isConnected;function z0e(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=Xr(t)?r++:t[e[r++]];return t}function B0e(t){for(const e in t)if(t.hasOwnProperty(e)&&!Xr(t[e]))return!1;return!0}function fs(t,e){const n=Array.isArray(e)?e:WN(e)?[e]:XD(e),r=n.length===1?t:z0e(t,n),s=n.length-1,i=n[s];return r&&delete r[i],s!==0&&(Vr(r)&&ao(r)||Array.isArray(r)&&B0e(r))&&fs(t,n.slice(0,-1)),t}var UH=t=>{for(const e in t)if(ml(t[e]))return!0;return!1};function mI(t,e={}){const n=Array.isArray(t);if(Vr(t)||n)for(const r in t)Array.isArray(t[r])||Vr(t[r])&&!UH(t[r])?(e[r]=Array.isArray(t[r])?[]:{},mI(t[r],e[r])):Di(t[r])||(e[r]=!0);return e}function VH(t,e,n){const r=Array.isArray(t);if(Vr(t)||r)for(const s in t)Array.isArray(t[s])||Vr(t[s])&&!UH(t[s])?Xr(e)||nR(n[s])?n[s]=Array.isArray(t[s])?mI(t[s],[]):{...mI(t[s])}:VH(t[s],Di(e)?{}:e[s],n[s]):n[s]=!Gd(t[s],e[s]);return n}var kx=(t,e)=>VH(t,e,mI(e));const z5={value:!1,isValid:!1},B5={value:!0,isValid:!0};var jH=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Xr(t[0].attributes.value)?Xr(t[0].value)||t[0].value===""?B5:{value:t[0].value,isValid:!0}:B5:z5}return z5},WH=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>Xr(t)?t:e?t===""?NaN:t&&+t:n&&fu(t)?new Date(t):r?r(t):t;const U5={isValid:!1,value:null};var GH=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,U5):U5;function V5(t){const e=t.ref;return ZD(e)?e.files:QD(e)?GH(t.refs).value:BH(e)?[...e.selectedOptions].map(({value:n})=>n):L1(e)?jH(t.refs).value:WH(Xr(e.value)?t.ref.value:e.value,t)}var U0e=(t,e,n,r)=>{const s={};for(const i of t){const o=Ot(e,i);o&&sr(s,i,o._f)}return{criteriaMode:n,names:[...t],fields:s,shouldUseNativeValidation:r}},gI=t=>t instanceof RegExp,Tx=t=>Xr(t)?t:gI(t)?t.source:Vr(t)?gI(t.value)?t.value.source:t.value:t,j5=t=>({isOnSubmit:!t||t===pl.onSubmit,isOnBlur:t===pl.onBlur,isOnChange:t===pl.onChange,isOnAll:t===pl.all,isOnTouch:t===pl.onTouched});const W5="AsyncFunction";var V0e=t=>!!t&&!!t.validate&&!!(ml(t.validate)&&t.validate.constructor.name===W5||Vr(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===W5)),j0e=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),G5=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const Tw=(t,e,n,r)=>{for(const s of n||Object.keys(t)){const i=Ot(t,s);if(i){const{_f:o,...a}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(Tw(a,e))break}else if(Vr(a)&&Tw(a,e))break}}};function H5(t,e,n){const r=Ot(t,n);if(r||WN(n))return{error:r,name:n};const s=n.split(".");for(;s.length;){const i=s.join("."),o=Ot(e,i),a=Ot(t,i);if(o&&!Array.isArray(o)&&n!==i)return{name:n};if(a&&a.type)return{name:i,error:a};if(a&&a.root&&a.root.type)return{name:`${i}.root`,error:a.root};s.pop()}return{name:n}}var W0e=(t,e,n,r)=>{n(t);const{name:s,...i}=t;return ao(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!r||pl.all))},G0e=(t,e,n)=>!t||!e||t===e||kw(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),H0e=(t,e,n,r,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(e||t):(n?r.isOnBlur:s.isOnBlur)?!t:(n?r.isOnChange:s.isOnChange)?t:!0,Y0e=(t,e)=>!qD(Ot(t,e)).length&&fs(t,e),K0e=(t,e,n)=>{const r=kw(Ot(t,n));return sr(r,"root",e[n]),sr(t,n,r),t},bC=t=>fu(t);function Y5(t,e,n="validate"){if(bC(t)||Array.isArray(t)&&t.every(bC)||ru(t)&&!t)return{type:n,message:bC(t)?t:"",ref:e}}var Gm=t=>Vr(t)&&!gI(t)?t:{value:t,message:""},K5=async(t,e,n,r,s,i)=>{const{ref:o,refs:a,required:l,maxLength:u,minLength:c,min:d,max:h,pattern:f,validate:m,name:g,valueAsNumber:x,mount:w}=t._f,b=Ot(n,g);if(!w||e.has(g))return{};const S=a?a[0]:o,C=j=>{s&&S.reportValidity&&(S.setCustomValidity(ru(j)?"":j||""),S.reportValidity())},T={},D=QD(o),P=L1(o),I=D||P,E=(x||ZD(o))&&Xr(o.value)&&Xr(b)||pI(o)&&o.value===""||b===""||Array.isArray(b)&&!b.length,M=F0e.bind(null,g,r,T),O=(j,R,z,B=nc.maxLength,V=nc.minLength)=>{const H=j?R:z;T[g]={type:j?B:V,message:H,ref:o,...M(j?B:V,H)}};if(i?!Array.isArray(b)||!b.length:l&&(!I&&(E||Di(b))||ru(b)&&!b||P&&!jH(a).isValid||D&&!GH(a).isValid)){const{value:j,message:R}=bC(l)?{value:!!l,message:l}:Gm(l);if(j&&(T[g]={type:nc.required,message:R,ref:S,...M(nc.required,R)},!r))return C(R),T}if(!E&&(!Di(d)||!Di(h))){let j,R;const z=Gm(h),B=Gm(d);if(!Di(b)&&!isNaN(b)){const V=o.valueAsNumber||b&&+b;Di(z.value)||(j=V>z.value),Di(B.value)||(R=V<B.value)}else{const V=o.valueAsDate||new Date(b),H=fe=>new Date(new Date().toDateString()+" "+fe),K=o.type=="time",ne=o.type=="week";fu(z.value)&&b&&(j=K?H(b)>H(z.value):ne?b>z.value:V>new Date(z.value)),fu(B.value)&&b&&(R=K?H(b)<H(B.value):ne?b<B.value:V<new Date(B.value))}if((j||R)&&(O(!!j,z.message,B.message,nc.max,nc.min),!r))return C(T[g].message),T}if((u||c)&&!E&&(fu(b)||i&&Array.isArray(b))){const j=Gm(u),R=Gm(c),z=!Di(j.value)&&b.length>+j.value,B=!Di(R.value)&&b.length<+R.value;if((z||B)&&(O(z,j.message,R.message),!r))return C(T[g].message),T}if(f&&!E&&fu(b)){const{value:j,message:R}=Gm(f);if(gI(j)&&!b.match(j)&&(T[g]={type:nc.pattern,message:R,ref:o,...M(nc.pattern,R)},!r))return C(R),T}if(m){if(ml(m)){const j=await m(b,n),R=Y5(j,S);if(R&&(T[g]={...R,...M(nc.validate,R.message)},!r))return C(R.message),T}else if(Vr(m)){let j={};for(const R in m){if(!ao(j)&&!r)break;const z=Y5(await m[R](b,n),S,R);z&&(j={...z,...M(R,z.message)},C(z.message),r&&(T[g]=j))}if(!ao(j)&&(T[g]={ref:S,...j},!r))return T}}return C(!0),T};const q0e={mode:pl.onSubmit,reValidateMode:pl.onChange,shouldFocusError:!0};function X0e(t={}){let e={...q0e,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:ml(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const r={};let s=Vr(e.defaultValues)||Vr(e.values)?oi(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:oi(s),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,u=0;const c={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...c};const h={array:L5(),state:L5()},f=e.criteriaMode===pl.all,m=q=>ie=>{clearTimeout(u),u=setTimeout(q,ie)},g=async q=>{if(!e.disabled&&(c.isValid||d.isValid||q)){const ie=e.resolver?ao((await P()).errors):await E(r,!0);ie!==n.isValid&&h.state.next({isValid:ie})}},x=(q,ie)=>{!e.disabled&&(c.isValidating||c.validatingFields||d.isValidating||d.validatingFields)&&((q||Array.from(a.mount)).forEach(me=>{me&&(ie?sr(n.validatingFields,me,ie):fs(n.validatingFields,me))}),h.state.next({validatingFields:n.validatingFields,isValidating:!ao(n.validatingFields)}))},w=(q,ie=[],me,je,He=!0,Ge=!0)=>{if(je&&me&&!e.disabled){if(o.action=!0,Ge&&Array.isArray(Ot(r,q))){const Je=me(Ot(r,q),je.argA,je.argB);He&&sr(r,q,Je)}if(Ge&&Array.isArray(Ot(n.errors,q))){const Je=me(Ot(n.errors,q),je.argA,je.argB);He&&sr(n.errors,q,Je),Y0e(n.errors,q)}if((c.touchedFields||d.touchedFields)&&Ge&&Array.isArray(Ot(n.touchedFields,q))){const Je=me(Ot(n.touchedFields,q),je.argA,je.argB);He&&sr(n.touchedFields,q,Je)}(c.dirtyFields||d.dirtyFields)&&(n.dirtyFields=kx(s,i)),h.state.next({name:q,isDirty:O(q,ie),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else sr(i,q,ie)},b=(q,ie)=>{sr(n.errors,q,ie),h.state.next({errors:n.errors})},S=q=>{n.errors=q,h.state.next({errors:n.errors,isValid:!1})},C=(q,ie,me,je)=>{const He=Ot(r,q);if(He){const Ge=Ot(i,q,Xr(me)?Ot(s,q):me);Xr(Ge)||je&&je.defaultChecked||ie?sr(i,q,ie?Ge:V5(He._f)):z(q,Ge),o.mount&&g()}},T=(q,ie,me,je,He)=>{let Ge=!1,Je=!1;const N={name:q};if(!e.disabled){if(!me||je){(c.isDirty||d.isDirty)&&(Je=n.isDirty,n.isDirty=N.isDirty=O(),Ge=Je!==N.isDirty);const k=Gd(Ot(s,q),ie);Je=!!Ot(n.dirtyFields,q),k?fs(n.dirtyFields,q):sr(n.dirtyFields,q,!0),N.dirtyFields=n.dirtyFields,Ge=Ge||(c.dirtyFields||d.dirtyFields)&&Je!==!k}if(me){const k=Ot(n.touchedFields,q);k||(sr(n.touchedFields,q,me),N.touchedFields=n.touchedFields,Ge=Ge||(c.touchedFields||d.touchedFields)&&k!==me)}Ge&&He&&h.state.next(N)}return Ge?N:{}},D=(q,ie,me,je)=>{const He=Ot(n.errors,q),Ge=(c.isValid||d.isValid)&&ru(ie)&&n.isValid!==ie;if(e.delayError&&me?(l=m(()=>b(q,me)),l(e.delayError)):(clearTimeout(u),l=null,me?sr(n.errors,q,me):fs(n.errors,q)),(me?!Gd(He,me):He)||!ao(je)||Ge){const Je={...je,...Ge&&ru(ie)?{isValid:ie}:{},errors:n.errors,name:q};n={...n,...Je},h.state.next(Je)}},P=async q=>{x(q,!0);const ie=await e.resolver(i,e.context,U0e(q||a.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return x(q),ie},I=async q=>{const{errors:ie}=await P(q);if(q)for(const me of q){const je=Ot(ie,me);je?sr(n.errors,me,je):fs(n.errors,me)}else n.errors=ie;return ie},E=async(q,ie,me={valid:!0})=>{for(const je in q){const He=q[je];if(He){const{_f:Ge,...Je}=He;if(Ge){const N=a.array.has(Ge.name),k=He._f&&V0e(He._f);k&&c.validatingFields&&x([je],!0);const $=await K5(He,a.disabled,i,f,e.shouldUseNativeValidation&&!ie,N);if(k&&c.validatingFields&&x([je]),$[Ge.name]&&(me.valid=!1,ie))break;!ie&&(Ot($,Ge.name)?N?K0e(n.errors,$,Ge.name):sr(n.errors,Ge.name,$[Ge.name]):fs(n.errors,Ge.name))}!ao(Je)&&await E(Je,ie,me)}}return me.valid},M=()=>{for(const q of a.unMount){const ie=Ot(r,q);ie&&(ie._f.refs?ie._f.refs.every(me=>!a3(me)):!a3(ie._f.ref))&&Le(q)}a.unMount=new Set},O=(q,ie)=>!e.disabled&&(q&&ie&&sr(i,q,ie),!Gd(fe(),s)),j=(q,ie,me)=>P0e(q,a,{...o.mount?i:Xr(ie)?s:fu(q)?{[q]:ie}:ie},me,ie),R=q=>qD(Ot(o.mount?i:s,q,e.shouldUnregister?Ot(s,q,[]):[])),z=(q,ie,me={})=>{const je=Ot(r,q);let He=ie;if(je){const Ge=je._f;Ge&&(!Ge.disabled&&sr(i,q,WH(ie,Ge)),He=pI(Ge.ref)&&Di(ie)?"":ie,BH(Ge.ref)?[...Ge.ref.options].forEach(Je=>Je.selected=He.includes(Je.value)):Ge.refs?L1(Ge.ref)?Ge.refs.forEach(Je=>{(!Je.defaultChecked||!Je.disabled)&&(Array.isArray(He)?Je.checked=!!He.find(N=>N===Je.value):Je.checked=He===Je.value||!!He)}):Ge.refs.forEach(Je=>Je.checked=Je.value===He):ZD(Ge.ref)?Ge.ref.value="":(Ge.ref.value=He,Ge.ref.type||h.state.next({name:q,values:oi(i)})))}(me.shouldDirty||me.shouldTouch)&&T(q,He,me.shouldTouch,me.shouldDirty,!0),me.shouldValidate&&ne(q)},B=(q,ie,me)=>{for(const je in ie){if(!ie.hasOwnProperty(je))return;const He=ie[je],Ge=q+"."+je,Je=Ot(r,Ge);(a.array.has(q)||Vr(He)||Je&&!Je._f)&&!Gf(He)?B(Ge,He,me):z(Ge,He,me)}},V=(q,ie,me={})=>{const je=Ot(r,q),He=a.array.has(q),Ge=oi(ie);sr(i,q,Ge),He?(h.array.next({name:q,values:oi(i)}),(c.isDirty||c.dirtyFields||d.isDirty||d.dirtyFields)&&me.shouldDirty&&h.state.next({name:q,dirtyFields:kx(s,i),isDirty:O(q,Ge)})):je&&!je._f&&!Di(Ge)?B(q,Ge,me):z(q,Ge,me),G5(q,a)&&h.state.next({...n}),h.state.next({name:o.mount?q:void 0,values:oi(i)})},H=async q=>{o.mount=!0;const ie=q.target;let me=ie.name,je=!0;const He=Ot(r,me),Ge=k=>{je=Number.isNaN(k)||Gf(k)&&isNaN(k.getTime())||Gd(k,Ot(i,me,k))},Je=j5(e.mode),N=j5(e.reValidateMode);if(He){let k,$;const J=ie.type?V5(He._f):_0e(q),ce=q.type===F5.BLUR||q.type===F5.FOCUS_OUT,be=!j0e(He._f)&&!e.resolver&&!Ot(n.errors,me)&&!He._f.deps||H0e(ce,Ot(n.touchedFields,me),n.isSubmitted,N,Je),Ne=G5(me,a,ce);sr(i,me,J),ce?(He._f.onBlur&&He._f.onBlur(q),l&&l(0)):He._f.onChange&&He._f.onChange(q);const at=T(me,J,ce),St=!ao(at)||Ne;if(!ce&&h.state.next({name:me,type:q.type,values:oi(i)}),be)return(c.isValid||d.isValid)&&(e.mode==="onBlur"?ce&&g():ce||g()),St&&h.state.next({name:me,...Ne?{}:at});if(!ce&&Ne&&h.state.next({...n}),e.resolver){const{errors:mt}=await P([me]);if(Ge(J),je){const dt=H5(n.errors,r,me),_t=H5(mt,r,dt.name||me);k=_t.error,me=_t.name,$=ao(mt)}}else x([me],!0),k=(await K5(He,a.disabled,i,f,e.shouldUseNativeValidation))[me],x([me]),Ge(J),je&&(k?$=!1:(c.isValid||d.isValid)&&($=await E(r,!0)));je&&(He._f.deps&&ne(He._f.deps),D(me,$,k,at))}},K=(q,ie)=>{if(Ot(n.errors,ie)&&q.focus)return q.focus(),1},ne=async(q,ie={})=>{let me,je;const He=kw(q);if(e.resolver){const Ge=await I(Xr(q)?q:He);me=ao(Ge),je=q?!He.some(Je=>Ot(Ge,Je)):me}else q?(je=(await Promise.all(He.map(async Ge=>{const Je=Ot(r,Ge);return await E(Je&&Je._f?{[Ge]:Je}:Je)}))).every(Boolean),!(!je&&!n.isValid)&&g()):je=me=await E(r);return h.state.next({...!fu(q)||(c.isValid||d.isValid)&&me!==n.isValid?{}:{name:q},...e.resolver||!q?{isValid:me}:{},errors:n.errors}),ie.shouldFocus&&!je&&Tw(r,K,q?He:a.mount),je},fe=q=>{const ie={...o.mount?i:s};return Xr(q)?ie:fu(q)?Ot(ie,q):q.map(me=>Ot(ie,me))},ee=(q,ie)=>({invalid:!!Ot((ie||n).errors,q),isDirty:!!Ot((ie||n).dirtyFields,q),error:Ot((ie||n).errors,q),isValidating:!!Ot(n.validatingFields,q),isTouched:!!Ot((ie||n).touchedFields,q)}),de=q=>{q&&kw(q).forEach(ie=>fs(n.errors,ie)),h.state.next({errors:q?n.errors:{}})},ge=(q,ie,me)=>{const je=(Ot(r,q,{_f:{}})._f||{}).ref,He=Ot(n.errors,q)||{},{ref:Ge,message:Je,type:N,...k}=He;sr(n.errors,q,{...k,...ie,ref:je}),h.state.next({name:q,errors:n.errors,isValid:!1}),me&&me.shouldFocus&&je&&je.focus&&je.focus()},Z=(q,ie)=>ml(q)?h.state.subscribe({next:me=>q(j(void 0,ie),me)}):j(q,ie,!0),we=q=>h.state.subscribe({next:ie=>{G0e(q.name,ie.name,q.exact)&&W0e(ie,q.formState||c,L,q.reRenderRoot)&&q.callback({values:{...i},...n,...ie})}}).unsubscribe,Ee=q=>(o.mount=!0,d={...d,...q.formState},we({...q,formState:d})),Le=(q,ie={})=>{for(const me of q?kw(q):a.mount)a.mount.delete(me),a.array.delete(me),ie.keepValue||(fs(r,me),fs(i,me)),!ie.keepError&&fs(n.errors,me),!ie.keepDirty&&fs(n.dirtyFields,me),!ie.keepTouched&&fs(n.touchedFields,me),!ie.keepIsValidating&&fs(n.validatingFields,me),!e.shouldUnregister&&!ie.keepDefaultValue&&fs(s,me);h.state.next({values:oi(i)}),h.state.next({...n,...ie.keepDirty?{isDirty:O()}:{}}),!ie.keepIsValid&&g()},De=({disabled:q,name:ie})=>{(ru(q)&&o.mount||q||a.disabled.has(ie))&&(q?a.disabled.add(ie):a.disabled.delete(ie))},Be=(q,ie={})=>{let me=Ot(r,q);const je=ru(ie.disabled)||ru(e.disabled);return sr(r,q,{...me||{},_f:{...me&&me._f?me._f:{ref:{name:q}},name:q,mount:!0,...ie}}),a.mount.add(q),me?De({disabled:ru(ie.disabled)?ie.disabled:e.disabled,name:q}):C(q,!0,ie.value),{...je?{disabled:ie.disabled||e.disabled}:{},...e.progressive?{required:!!ie.required,min:Tx(ie.min),max:Tx(ie.max),minLength:Tx(ie.minLength),maxLength:Tx(ie.maxLength),pattern:Tx(ie.pattern)}:{},name:q,onChange:H,onBlur:H,ref:He=>{if(He){Be(q,ie),me=Ot(r,q);const Ge=Xr(He.value)&&He.querySelectorAll&&He.querySelectorAll("input,select,textarea")[0]||He,Je=L0e(Ge),N=me._f.refs||[];if(Je?N.find(k=>k===Ge):Ge===me._f.ref)return;sr(r,q,{_f:{...me._f,...Je?{refs:[...N.filter(a3),Ge,...Array.isArray(Ot(s,q))?[{}]:[]],ref:{type:Ge.type,name:q}}:{ref:Ge}}}),C(q,!1,void 0,Ge)}else me=Ot(r,q,{}),me._f&&(me._f.mount=!1),(e.shouldUnregister||ie.shouldUnregister)&&!($0e(a.array,q)&&o.action)&&a.unMount.add(q)}}},se=()=>e.shouldFocusError&&Tw(r,K,a.mount),le=q=>{ru(q)&&(h.state.next({disabled:q}),Tw(r,(ie,me)=>{const je=Ot(r,me);je&&(ie.disabled=je._f.disabled||q,Array.isArray(je._f.refs)&&je._f.refs.forEach(He=>{He.disabled=je._f.disabled||q}))},0,!1))},ye=(q,ie)=>async me=>{let je;me&&(me.preventDefault&&me.preventDefault(),me.persist&&me.persist());let He=oi(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:Ge,values:Je}=await P();n.errors=Ge,He=Je}else await E(r);if(a.disabled.size)for(const Ge of a.disabled)sr(He,Ge,void 0);if(fs(n.errors,"root"),ao(n.errors)){h.state.next({errors:{}});try{await q(He,me)}catch(Ge){je=Ge}}else ie&&await ie({...n.errors},me),se(),setTimeout(se);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ao(n.errors)&&!je,submitCount:n.submitCount+1,errors:n.errors}),je)throw je},ve=(q,ie={})=>{Ot(r,q)&&(Xr(ie.defaultValue)?V(q,oi(Ot(s,q))):(V(q,ie.defaultValue),sr(s,q,oi(ie.defaultValue))),ie.keepTouched||fs(n.touchedFields,q),ie.keepDirty||(fs(n.dirtyFields,q),n.isDirty=ie.defaultValue?O(q,oi(Ot(s,q))):O()),ie.keepError||(fs(n.errors,q),c.isValid&&g()),h.state.next({...n}))},xe=(q,ie={})=>{const me=q?oi(q):s,je=oi(me),He=ao(q),Ge=He?s:je;if(ie.keepDefaultValues||(s=me),!ie.keepValues){if(ie.keepDirtyValues){const Je=new Set([...a.mount,...Object.keys(kx(s,i))]);for(const N of Array.from(Je))Ot(n.dirtyFields,N)?sr(Ge,N,Ot(i,N)):V(N,Ot(Ge,N))}else{if(KD&&Xr(q))for(const Je of a.mount){const N=Ot(r,Je);if(N&&N._f){const k=Array.isArray(N._f.refs)?N._f.refs[0]:N._f.ref;if(pI(k)){const $=k.closest("form");if($){$.reset();break}}}}for(const Je of a.mount)V(Je,Ot(Ge,Je))}i=oi(Ge),h.array.next({values:{...Ge}}),h.state.next({values:{...Ge}})}a={mount:ie.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!c.isValid||!!ie.keepIsValid||!!ie.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:ie.keepSubmitCount?n.submitCount:0,isDirty:He?!1:ie.keepDirty?n.isDirty:!!(ie.keepDefaultValues&&!Gd(q,s)),isSubmitted:ie.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:He?{}:ie.keepDirtyValues?ie.keepDefaultValues&&i?kx(s,i):n.dirtyFields:ie.keepDefaultValues&&q?kx(s,q):ie.keepDirty?n.dirtyFields:{},touchedFields:ie.keepTouched?n.touchedFields:{},errors:ie.keepErrors?n.errors:{},isSubmitSuccessful:ie.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},Ie=(q,ie)=>xe(ml(q)?q(i):q,ie),te=(q,ie={})=>{const me=Ot(r,q),je=me&&me._f;if(je){const He=je.refs?je.refs[0]:je.ref;He.focus&&(He.focus(),ie.shouldSelect&&ml(He.select)&&He.select())}},L=q=>{n={...n,...q}},re={control:{register:Be,unregister:Le,getFieldState:ee,handleSubmit:ye,setError:ge,_subscribe:we,_runSchema:P,_focusError:se,_getWatch:j,_getDirty:O,_setValid:g,_setFieldArray:w,_setDisabledField:De,_setErrors:S,_getFieldArray:R,_reset:xe,_resetDefaultValues:()=>ml(e.defaultValues)&&e.defaultValues().then(q=>{Ie(q,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:M,_disableForm:le,_subjects:h,_proxyFormState:c,get _fields(){return r},get _formValues(){return i},get _state(){return o},set _state(q){o=q},get _defaultValues(){return s},get _names(){return a},set _names(q){a=q},get _formState(){return n},get _options(){return e},set _options(q){e={...e,...q}}},subscribe:Ee,trigger:ne,register:Be,handleSubmit:ye,watch:Z,setValue:V,getValues:fe,reset:Ie,resetField:ve,clearErrors:de,unregister:Le,setError:ge,setFocus:te,getFieldState:ee};return{...re,formControl:re}}function Z0e(t={}){const e=En.useRef(void 0),n=En.useRef(void 0),[r,s]=En.useState({isDirty:!1,isValidating:!1,isLoading:ml(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:ml(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!ml(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...a}=X0e(t);e.current={...a,formState:r}}const i=e.current.control;return i._options=t,O0e(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>s({...i._formState}),reRenderRoot:!0});return s(a=>({...a,isReady:!0})),i._formState.isReady=!0,o},[i]),En.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),En.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),En.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),En.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),En.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==r.isDirty&&i._subjects.state.next({isDirty:o})}},[i,r.isDirty]),En.useEffect(()=>{t.values&&!Gd(t.values,n.current)?(i._reset(t.values,i._options.resetOptions),n.current=t.values,s(o=>({...o}))):i._resetDefaultValues()},[i,t.values]),En.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=D0e(r,i),e.current}const HH=typeof document<"u"?En.useLayoutEffect:()=>{};function Q0e(t){const e=W.useRef(null);return HH(()=>{e.current=t},[t]),W.useCallback((...n)=>{const r=e.current;return r==null?void 0:r(...n)},[])}const Eh=t=>{var e;return(e=t==null?void 0:t.ownerDocument)!==null&&e!==void 0?e:document},Hf=t=>t&&"window"in t&&t.window===t?t:Eh(t).defaultView||window;function J0e(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function eye(t){return J0e(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let tye=!1;function JD(){return tye}function YH(t,e){if(!JD())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let n=e;for(;n!==null;){if(n===t)return!0;n.tagName==="SLOT"&&n.assignedSlot?n=n.assignedSlot.parentNode:eye(n)?n=n.host:n=n.parentNode}return!1}const rR=(t=document)=>{var e;if(!JD())return t.activeElement;let n=t.activeElement;for(;n&&"shadowRoot"in n&&(!((e=n.shadowRoot)===null||e===void 0)&&e.activeElement);)n=n.shadowRoot.activeElement;return n};function KH(t){return JD()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}function nye(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(n=>t.test(n.brand)))||t.test(window.navigator.userAgent)}function rye(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function qH(t){let e=null;return()=>(e==null&&(e=t()),e)}const sye=qH(function(){return rye(/^Mac/i)}),iye=qH(function(){return nye(/Android/i)});function XH(){let t=W.useRef(new Map),e=W.useCallback((s,i,o,a)=>{let l=a!=null&&a.once?(...u)=>{t.current.delete(o),o(...u)}:o;t.current.set(o,{type:i,eventTarget:s,fn:l,options:a}),s.addEventListener(i,l,a)},[]),n=W.useCallback((s,i,o,a)=>{var l;let u=((l=t.current.get(o))===null||l===void 0?void 0:l.fn)||o;s.removeEventListener(i,u,a),t.current.delete(o)},[]),r=W.useCallback(()=>{t.current.forEach((s,i)=>{n(s.eventTarget,s.type,i,s.options)})},[n]);return W.useEffect(()=>r,[r]),{addGlobalListener:e,removeGlobalListener:n,removeAllGlobalListeners:r}}function oye(t){return t.mozInputSource===0&&t.isTrusted?!0:iye()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}class ZH{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}}function QH(t){let e=W.useRef({isFocused:!1,observer:null});HH(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=Q0e(r=>{t==null||t(r)});return W.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,i=o=>{e.current.isFocused=!1,s.disabled&&n(new ZH("blur",o)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",i,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var o;(o=e.current.observer)===null||o===void 0||o.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[n])}let aye=!1,z1=null,sR=new Set,Ew=new Map,gp=!1,iR=!1;const lye={Tab:!0,Escape:!0};function eO(t,e){for(let n of sR)n(t,e)}function uye(t){return!(t.metaKey||!sye()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function yI(t){gp=!0,uye(t)&&(z1="keyboard",eO("keyboard",t))}function wa(t){z1="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(gp=!0,eO("pointer",t))}function JH(t){oye(t)&&(gp=!0,z1="virtual")}function eY(t){t.target===window||t.target===document||aye||!t.isTrusted||(!gp&&!iR&&(z1="virtual",eO("virtual",t)),gp=!1,iR=!1)}function tY(){gp=!1,iR=!0}function oR(t){if(typeof window>"u"||Ew.get(Hf(t)))return;const e=Hf(t),n=Eh(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){gp=!0,r.apply(this,arguments)},n.addEventListener("keydown",yI,!0),n.addEventListener("keyup",yI,!0),n.addEventListener("click",JH,!0),e.addEventListener("focus",eY,!0),e.addEventListener("blur",tY,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",wa,!0),n.addEventListener("pointermove",wa,!0),n.addEventListener("pointerup",wa,!0)):(n.addEventListener("mousedown",wa,!0),n.addEventListener("mousemove",wa,!0),n.addEventListener("mouseup",wa,!0)),e.addEventListener("beforeunload",()=>{nY(t)},{once:!0}),Ew.set(e,{focus:r})}const nY=(t,e)=>{const n=Hf(t),r=Eh(t);e&&r.removeEventListener("DOMContentLoaded",e),Ew.has(n)&&(n.HTMLElement.prototype.focus=Ew.get(n).focus,r.removeEventListener("keydown",yI,!0),r.removeEventListener("keyup",yI,!0),r.removeEventListener("click",JH,!0),n.removeEventListener("focus",eY,!0),n.removeEventListener("blur",tY,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",wa,!0),r.removeEventListener("pointermove",wa,!0),r.removeEventListener("pointerup",wa,!0)):(r.removeEventListener("mousedown",wa,!0),r.removeEventListener("mousemove",wa,!0),r.removeEventListener("mouseup",wa,!0)),Ew.delete(n))};function cye(t){const e=Eh(t);let n;return e.readyState!=="loading"?oR(t):(n=()=>{oR(t)},e.addEventListener("DOMContentLoaded",n)),()=>nY(t,n)}typeof document<"u"&&cye();function rY(){return z1!=="pointer"}const dye=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function hye(t,e,n){let r=Eh(n==null?void 0:n.target);const s=typeof window<"u"?Hf(n==null?void 0:n.target).HTMLInputElement:HTMLInputElement,i=typeof window<"u"?Hf(n==null?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?Hf(n==null?void 0:n.target).HTMLElement:HTMLElement,a=typeof window<"u"?Hf(n==null?void 0:n.target).KeyboardEvent:KeyboardEvent;return t=t||r.activeElement instanceof s&&!dye.has(r.activeElement.type)||r.activeElement instanceof i||r.activeElement instanceof o&&r.activeElement.isContentEditable,!(t&&e==="keyboard"&&n instanceof a&&!lye[n.key])}function fye(t,e,n){oR(),W.useEffect(()=>{let r=(s,i)=>{hye(!!(n!=null&&n.isTextInput),s,i)&&t(rY())};return sR.add(r),()=>{sR.delete(r)}},e)}function pye(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:s}=t;const i=W.useCallback(l=>{if(l.target===l.currentTarget)return r&&r(l),s&&s(!1),!0},[r,s]),o=QH(i),a=W.useCallback(l=>{const u=Eh(l.target),c=u?rR(u):rR();l.target===l.currentTarget&&c===KH(l.nativeEvent)&&(n&&n(l),s&&s(!0),o(l))},[s,n,o]);return{focusProps:{onFocus:!e&&(n||s||r)?a:void 0,onBlur:!e&&(r||s)?i:void 0}}}function mye(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:s}=t,i=W.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:a}=XH(),l=W.useCallback(d=>{d.currentTarget.contains(d.target)&&i.current.isFocusWithin&&!d.currentTarget.contains(d.relatedTarget)&&(i.current.isFocusWithin=!1,a(),n&&n(d),s&&s(!1))},[n,s,i,a]),u=QH(l),c=W.useCallback(d=>{if(!d.currentTarget.contains(d.target))return;const h=Eh(d.target),f=rR(h);if(!i.current.isFocusWithin&&f===KH(d.nativeEvent)){r&&r(d),s&&s(!0),i.current.isFocusWithin=!0,u(d);let m=d.currentTarget;o(h,"focus",g=>{if(i.current.isFocusWithin&&!YH(m,g.target)){let x=new ZH("blur",new h.defaultView.FocusEvent("blur",{relatedTarget:g.target}));x.target=m,x.currentTarget=m,l(x)}},{capture:!0})}},[r,s,u,o,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:c,onBlur:l}}}let xI=!1,l3=0;function aR(){xI=!0,setTimeout(()=>{xI=!1},50)}function q5(t){t.pointerType==="touch"&&aR()}function gye(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",q5):document.addEventListener("touchend",aR),l3++,()=>{l3--,!(l3>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",q5):document.removeEventListener("touchend",aR))}}function yye(t){let{onHoverStart:e,onHoverChange:n,onHoverEnd:r,isDisabled:s}=t,[i,o]=W.useState(!1),a=W.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;W.useEffect(gye,[]);let{addGlobalListener:l,removeAllGlobalListeners:u}=XH(),{hoverProps:c,triggerHoverEnd:d}=W.useMemo(()=>{let h=(g,x)=>{if(a.pointerType=x,s||x==="touch"||a.isHovered||!g.currentTarget.contains(g.target))return;a.isHovered=!0;let w=g.currentTarget;a.target=w,l(Eh(g.target),"pointerover",b=>{a.isHovered&&a.target&&!YH(a.target,b.target)&&f(b,b.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:w,pointerType:x}),n&&n(!0),o(!0)},f=(g,x)=>{let w=a.target;a.pointerType="",a.target=null,!(x==="touch"||!a.isHovered||!w)&&(a.isHovered=!1,u(),r&&r({type:"hoverend",target:w,pointerType:x}),n&&n(!1),o(!1))},m={};return typeof PointerEvent<"u"?(m.onPointerEnter=g=>{xI&&g.pointerType==="mouse"||h(g,g.pointerType)},m.onPointerLeave=g=>{!s&&g.currentTarget.contains(g.target)&&f(g,g.pointerType)}):(m.onTouchStart=()=>{a.ignoreEmulatedMouseEvents=!0},m.onMouseEnter=g=>{!a.ignoreEmulatedMouseEvents&&!xI&&h(g,"mouse"),a.ignoreEmulatedMouseEvents=!1},m.onMouseLeave=g=>{!s&&g.currentTarget.contains(g.target)&&f(g,"mouse")}),{hoverProps:m,triggerHoverEnd:f}},[e,n,r,s,a,l,u]);return W.useEffect(()=>{s&&d({currentTarget:a.target},a.pointerType)},[s]),{hoverProps:c,isHovered:i}}function xye(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,s=W.useRef({isFocused:!1,isFocusVisible:e||rY()}),[i,o]=W.useState(!1),[a,l]=W.useState(()=>s.current.isFocused&&s.current.isFocusVisible),u=W.useCallback(()=>l(s.current.isFocused&&s.current.isFocusVisible),[]),c=W.useCallback(f=>{s.current.isFocused=f,o(f),u()},[u]);fye(f=>{s.current.isFocusVisible=f,u()},[],{isTextInput:n});let{focusProps:d}=pye({isDisabled:r,onFocusChange:c}),{focusWithinProps:h}=mye({isDisabled:!r,onFocusWithinChange:c});return{isFocused:i,isFocusVisible:a,focusProps:r?h:d}}var wye=Object.defineProperty,bye=(t,e,n)=>e in t?wye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,u3=(t,e,n)=>(bye(t,typeof e!="symbol"?e+"":e,n),n);let vye=class{constructor(){u3(this,"current",this.detect()),u3(this,"handoffState","pending"),u3(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},ep=new vye;function g0(t){return ep.isServer?null:t instanceof Node?t.ownerDocument:t!=null&&t.hasOwnProperty("current")&&t.current instanceof Node?t.current.ownerDocument:document}function sY(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function Mu(){let t=[],e={addEventListener(n,r,s,i){return n.addEventListener(r,s,i),e.add(()=>n.removeEventListener(r,s,i))},requestAnimationFrame(...n){let r=requestAnimationFrame(...n);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...n){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...n))},setTimeout(...n){let r=setTimeout(...n);return e.add(()=>clearTimeout(r))},microTask(...n){let r={current:!0};return sY(()=>{r.current&&n[0]()}),e.add(()=>{r.current=!1})},style(n,r,s){let i=n.style.getPropertyValue(r);return Object.assign(n.style,{[r]:s}),this.add(()=>{Object.assign(n.style,{[r]:i})})},group(n){let r=Mu();return n(r),this.add(()=>r.dispose())},add(n){return t.includes(n)||t.push(n),()=>{let r=t.indexOf(n);if(r>=0)for(let s of t.splice(r,1))s()}},dispose(){for(let n of t.splice(0))n()}};return e}function GN(){let[t]=W.useState(Mu);return W.useEffect(()=>()=>t.dispose(),[t]),t}let ts=(t,e)=>{ep.isServer?W.useEffect(t,e):W.useLayoutEffect(t,e)};function B1(t){let e=W.useRef(t);return ts(()=>{e.current=t},[t]),e}let hr=function(t){let e=B1(t);return En.useCallback((...n)=>e.current(...n),[e])};function Sye(t){let e=t.width/2,n=t.height/2;return{top:t.clientY-n,right:t.clientX+e,bottom:t.clientY+n,left:t.clientX-e}}function Cye(t,e){return!(!t||!e||t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function Iye({disabled:t=!1}={}){let e=W.useRef(null),[n,r]=W.useState(!1),s=GN(),i=hr(()=>{e.current=null,r(!1),s.dispose()}),o=hr(a=>{if(s.dispose(),e.current===null){e.current=a.currentTarget,r(!0);{let l=g0(a.currentTarget);s.addEventListener(l,"pointerup",i,!1),s.addEventListener(l,"pointermove",u=>{if(e.current){let c=Sye(u);r(Cye(c,e.current.getBoundingClientRect()))}},!1),s.addEventListener(l,"pointercancel",i,!1)}}});return{pressed:n,pressProps:t?{}:{onPointerDown:o,onPointerUp:i,onClick:i}}}let Nye=W.createContext(void 0);function iY(){return W.useContext(Nye)}function X5(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function U1(t,e,...n){if(t in e){let s=e[t];return typeof s=="function"?s(...n):s}let r=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,U1),r}var lR=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(lR||{}),kye=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(kye||{});function La({ourProps:t,theirProps:e,slot:n,defaultTag:r,features:s,visible:i=!0,name:o,mergeRefs:a}){a=a??Eye;let l=oY(e,t);if(i)return X2(l,n,r,o,a);let u=s??0;if(u&2){let{static:c=!1,...d}=l;if(c)return X2(d,n,r,o,a)}if(u&1){let{unmount:c=!0,...d}=l;return U1(c?0:1,{0(){return null},1(){return X2({...d,hidden:!0,style:{display:"none"}},n,r,o,a)}})}return X2(l,n,r,o,a)}function X2(t,e={},n,r,s){let{as:i=n,children:o,refName:a="ref",...l}=c3(t,["unmount","static"]),u=t.ref!==void 0?{[a]:t.ref}:{},c=typeof o=="function"?o(e):o;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(e)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let d={};if(e){let h=!1,f=[];for(let[m,g]of Object.entries(e))typeof g=="boolean"&&(h=!0),g===!0&&f.push(m.replace(/([A-Z])/g,x=>`-${x.toLowerCase()}`));if(h){d["data-headlessui-state"]=f.join(" ");for(let m of f)d[`data-${m}`]=""}}if(i===W.Fragment&&(Object.keys(Hm(l)).length>0||Object.keys(Hm(d)).length>0))if(!W.isValidElement(c)||Array.isArray(c)&&c.length>1){if(Object.keys(Hm(l)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Hm(l)).concat(Object.keys(Hm(d))).map(h=>`  - ${h}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(h=>`  - ${h}`).join(`
`)].join(`
`))}else{let h=c.props,f=h==null?void 0:h.className,m=typeof f=="function"?(...w)=>X5(f(...w),l.className):X5(f,l.className),g=m?{className:m}:{},x=oY(c.props,Hm(c3(l,["ref"])));for(let w in d)w in x&&delete d[w];return W.cloneElement(c,Object.assign({},x,d,u,{ref:s(c.ref,u.ref)},g))}return W.createElement(i,Object.assign({},c3(l,["ref"]),i!==W.Fragment&&u,i!==W.Fragment&&d),c)}function Tye(){let t=W.useRef([]),e=W.useCallback(n=>{for(let r of t.current)r!=null&&(typeof r=="function"?r(n):r.current=n)},[]);return(...n)=>{if(!n.every(r=>r==null))return t.current=n,e}}function Eye(...t){return t.every(e=>e==null)?void 0:e=>{for(let n of t)n!=null&&(typeof n=="function"?n(e):n.current=e)}}function oY(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let r of t)for(let s in r)s.startsWith("on")&&typeof r[s]=="function"?(n[s]!=null||(n[s]=[]),n[s].push(r[s])):e[s]=r[s];if(e.disabled||e["aria-disabled"])for(let r in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(n[r]=[s=>{var i;return(i=s==null?void 0:s.preventDefault)==null?void 0:i.call(s)}]);for(let r in n)Object.assign(e,{[r](s,...i){let o=n[r];for(let a of o){if((s instanceof Event||(s==null?void 0:s.nativeEvent)instanceof Event)&&s.defaultPrevented)return;a(s,...i)}}});return e}function aY(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let r of t)for(let s in r)s.startsWith("on")&&typeof r[s]=="function"?(n[s]!=null||(n[s]=[]),n[s].push(r[s])):e[s]=r[s];for(let r in n)Object.assign(e,{[r](...s){let i=n[r];for(let o of i)o==null||o(...s)}});return e}function za(t){var e;return Object.assign(W.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function Hm(t){let e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function c3(t,e=[]){let n=Object.assign({},t);for(let r of e)r in n&&delete n[r];return n}let _ye=W.createContext(void 0);function Aye(){return W.useContext(_ye)}function $ye(t){let e=t.parentElement,n=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(n=e),e=e.parentElement;let r=(e==null?void 0:e.getAttribute("disabled"))==="";return r&&Rye(n)?!1:r}function Rye(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}let lY=Symbol();function Mye(t,e=!0){return Object.assign(t,{[lY]:e})}function Oc(...t){let e=W.useRef(t);W.useEffect(()=>{e.current=t},[t]);let n=hr(r=>{for(let s of e.current)s!=null&&(typeof s=="function"?s(r):s.current=r)});return t.every(r=>r==null||(r==null?void 0:r[lY]))?void 0:n}let tO=W.createContext(null);tO.displayName="DescriptionContext";function uY(){let t=W.useContext(tO);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,uY),e}return t}function Dye(){let[t,e]=W.useState([]);return[t.length>0?t.join(" "):void 0,W.useMemo(()=>function(n){let r=hr(i=>(e(o=>[...o,i]),()=>e(o=>{let a=o.slice(),l=a.indexOf(i);return l!==-1&&a.splice(l,1),a}))),s=W.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props,value:n.value}),[r,n.slot,n.name,n.props,n.value]);return En.createElement(tO.Provider,{value:s},n.children)},[e])]}let Oye="p";function Pye(t,e){let n=W.useId(),r=iY(),{id:s=`headlessui-description-${n}`,...i}=t,o=uY(),a=Oc(e);ts(()=>o.register(s),[s,o.register]);let l=r||!1,u=W.useMemo(()=>({...o.slot,disabled:l}),[o.slot,l]),c={ref:a,...o.props,id:s};return La({ourProps:c,theirProps:i,slot:u,defaultTag:Oye,name:o.name||"Description"})}let Fye=za(Pye);Object.assign(Fye,{});var Bs=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(Bs||{});let HN=W.createContext(null);HN.displayName="LabelContext";function nO(){let t=W.useContext(HN);if(t===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,nO),e}return t}function Lye(t){var e,n,r;let s=(n=(e=W.useContext(HN))==null?void 0:e.value)!=null?n:void 0;return((r=void 0)!=null?r:0)>0?[s,...t].filter(Boolean).join(" "):s}function cY({inherit:t=!1}={}){let e=Lye(),[n,r]=W.useState([]),s=t?[e,...n].filter(Boolean):n;return[s.length>0?s.join(" "):void 0,W.useMemo(()=>function(i){let o=hr(l=>(r(u=>[...u,l]),()=>r(u=>{let c=u.slice(),d=c.indexOf(l);return d!==-1&&c.splice(d,1),c}))),a=W.useMemo(()=>({register:o,slot:i.slot,name:i.name,props:i.props,value:i.value}),[o,i.slot,i.name,i.props,i.value]);return En.createElement(HN.Provider,{value:a},i.children)},[r])]}let zye="label";function Bye(t,e){var n;let r=W.useId(),s=nO(),i=Aye(),o=iY(),{id:a=`headlessui-label-${r}`,htmlFor:l=i??((n=s.props)==null?void 0:n.htmlFor),passive:u=!1,...c}=t,d=Oc(e);ts(()=>s.register(a),[a,s.register]);let h=hr(x=>{let w=x.currentTarget;if(w instanceof HTMLLabelElement&&x.preventDefault(),s.props&&"onClick"in s.props&&typeof s.props.onClick=="function"&&s.props.onClick(x),w instanceof HTMLLabelElement){let b=document.getElementById(w.htmlFor);if(b){let S=b.getAttribute("disabled");if(S==="true"||S==="")return;let C=b.getAttribute("aria-disabled");if(C==="true"||C==="")return;(b instanceof HTMLInputElement&&(b.type==="radio"||b.type==="checkbox")||b.role==="radio"||b.role==="checkbox"||b.role==="switch")&&b.click(),b.focus({preventScroll:!0})}}}),f=o||!1,m=W.useMemo(()=>({...s.slot,disabled:f}),[s.slot,f]),g={ref:d,...s.props,id:a,htmlFor:l,onClick:h};return u&&("onClick"in g&&(delete g.htmlFor,delete g.onClick),"onClick"in c&&delete c.onClick),La({ourProps:g,theirProps:c,slot:m,defaultTag:l?zye:"div",name:s.name||"Label"})}let Uye=za(Bye);Object.assign(Uye,{});function Vye(t){if(t===null)return{width:0,height:0};let{width:e,height:n}=t.getBoundingClientRect();return{width:e,height:n}}function jye(t,e=!1){let[n,r]=W.useReducer(()=>({}),{}),s=W.useMemo(()=>Vye(t),[t,n]);return ts(()=>{if(!t)return;let i=new ResizeObserver(r);return i.observe(t),()=>{i.disconnect()}},[t]),e?{width:`${s.width}px`,height:`${s.height}px`}:s}let Wye=class extends Map{constructor(e){super(),this.factory=e}get(e){let n=super.get(e);return n===void 0&&(n=this.factory(e),this.set(e,n)),n}};function dY(t,e){let n=t(),r=new Set;return{getSnapshot(){return n},subscribe(s){return r.add(s),()=>r.delete(s)},dispatch(s,...i){let o=e[s].call(n,...i);o&&(n=o,r.forEach(a=>a()))}}}function hY(t){return W.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}let Gye=new Wye(()=>dY(()=>[],{ADD(t){return this.includes(t)?this:[...this,t]},REMOVE(t){let e=this.indexOf(t);if(e===-1)return this;let n=this.slice();return n.splice(e,1),n}}));function rO(t,e){let n=Gye.get(e),r=W.useId(),s=hY(n);if(ts(()=>{if(t)return n.dispatch("ADD",r),()=>n.dispatch("REMOVE",r)},[n,t]),!t)return!1;let i=s.indexOf(r),o=s.length;return i===-1&&(i=o,o+=1),i===o-1}let uR=new Map,_w=new Map;function Z5(t){var e;let n=(e=_w.get(t))!=null?e:0;return _w.set(t,n+1),n!==0?()=>Q5(t):(uR.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>Q5(t))}function Q5(t){var e;let n=(e=_w.get(t))!=null?e:1;if(n===1?_w.delete(t):_w.set(t,n-1),n!==1)return;let r=uR.get(t);r&&(r["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",r["aria-hidden"]),t.inert=r.inert,uR.delete(t))}function Hye(t,{allowed:e,disallowed:n}={}){let r=rO(t,"inert-others");ts(()=>{var s,i;if(!r)return;let o=Mu();for(let l of(s=n==null?void 0:n())!=null?s:[])l&&o.add(Z5(l));let a=(i=e==null?void 0:e())!=null?i:[];for(let l of a){if(!l)continue;let u=g0(l);if(!u)continue;let c=l.parentElement;for(;c&&c!==u.body;){for(let d of c.children)a.some(h=>d.contains(h))||o.add(Z5(d));c=c.parentElement}}return o.dispose},[r,e,n])}function Yye(t,e,n){let r=B1(s=>{let i=s.getBoundingClientRect();i.x===0&&i.y===0&&i.width===0&&i.height===0&&n()});W.useEffect(()=>{if(!t)return;let s=e===null?null:e instanceof HTMLElement?e:e.current;if(!s)return;let i=Mu();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>r.current(s));o.observe(s),i.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>r.current(s));o.observe(s),i.add(()=>o.disconnect())}return()=>i.dispose()},[e,r,t])}let cR=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),Kye=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var dR=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(dR||{}),qye=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(qye||{}),Xye=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(Xye||{});function fY(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(cR)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}function Zye(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(Kye)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var sO=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(sO||{});function iO(t,e=0){var n;return t===((n=g0(t))==null?void 0:n.body)?!1:U1(e,{0(){return t.matches(cR)},1(){let r=t;for(;r!==null;){if(r.matches(cR))return!0;r=r.parentElement}return!1}})}function pY(t){let e=g0(t);Mu().nextFrame(()=>{e&&!iO(e.activeElement,0)&&Jye(t)})}var Qye=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(Qye||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Jye(t){t==null||t.focus({preventScroll:!0})}let exe=["textarea","input"].join(",");function txe(t){var e,n;return(n=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,exe))!=null?n:!1}function mY(t,e=n=>n){return t.slice().sort((n,r)=>{let s=e(n),i=e(r);if(s===null||i===null)return 0;let o=s.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function nxe(t,e){return rxe(fY(),e,{relativeTo:t})}function rxe(t,e,{sorted:n=!0,relativeTo:r=null,skipElements:s=[]}={}){let i=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t.ownerDocument,o=Array.isArray(t)?n?mY(t):t:e&64?Zye(t):fY(t);s.length>0&&o.length>1&&(o=o.filter(f=>!s.some(m=>m!=null&&"current"in m?(m==null?void 0:m.current)===f:m===f))),r=r??i.activeElement;let a=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(r))-1;if(e&4)return Math.max(0,o.indexOf(r))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},c=0,d=o.length,h;do{if(c>=d||c+d<=0)return 0;let f=l+c;if(e&16)f=(f+d)%d;else{if(f<0)return 3;if(f>=d)return 1}h=o[f],h==null||h.focus(u),c+=a}while(h!==i.activeElement);return e&6&&txe(h)&&h.select(),2}function gY(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function sxe(){return/Android/gi.test(window.navigator.userAgent)}function ixe(){return gY()||sxe()}function Ex(t,e,n,r){let s=B1(n);W.useEffect(()=>{if(!t)return;function i(o){s.current(o)}return document.addEventListener(e,i,r),()=>document.removeEventListener(e,i,r)},[t,e,r])}function oxe(t,e,n,r){let s=B1(n);W.useEffect(()=>{if(!t)return;function i(o){s.current(o)}return window.addEventListener(e,i,r),()=>window.removeEventListener(e,i,r)},[t,e,r])}const J5=30;function axe(t,e,n){let r=rO(t,"outside-click"),s=B1(n),i=W.useCallback(function(l,u){if(l.defaultPrevented)return;let c=u(l);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let d=function h(f){return typeof f=="function"?h(f()):Array.isArray(f)||f instanceof Set?f:[f]}(e);for(let h of d)if(h!==null&&(h.contains(c)||l.composed&&l.composedPath().includes(h)))return;return!iO(c,sO.Loose)&&c.tabIndex!==-1&&l.preventDefault(),s.current(l,c)},[s,e]),o=W.useRef(null);Ex(r,"pointerdown",l=>{var u,c;o.current=((c=(u=l.composedPath)==null?void 0:u.call(l))==null?void 0:c[0])||l.target},!0),Ex(r,"mousedown",l=>{var u,c;o.current=((c=(u=l.composedPath)==null?void 0:u.call(l))==null?void 0:c[0])||l.target},!0),Ex(r,"click",l=>{ixe()||o.current&&(i(l,()=>o.current),o.current=null)},!0);let a=W.useRef({x:0,y:0});Ex(r,"touchstart",l=>{a.current.x=l.touches[0].clientX,a.current.y=l.touches[0].clientY},!0),Ex(r,"touchend",l=>{let u={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(u.x-a.current.x)>=J5||Math.abs(u.y-a.current.y)>=J5))return i(l,()=>l.target instanceof HTMLElement?l.target:null)},!0),oxe(r,"blur",l=>i(l,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function oO(...t){return W.useMemo(()=>g0(...t),[...t])}function lxe(t,e){return W.useMemo(()=>{var n;if(t.type)return t.type;let r=(n=t.as)!=null?n:"button";if(typeof r=="string"&&r.toLowerCase()==="button"||(e==null?void 0:e.tagName)==="BUTTON"&&!e.hasAttribute("type"))return"button"},[t.type,t.as,e])}function uxe(){let t;return{before({doc:e}){var n;let r=e.documentElement,s=(n=e.defaultView)!=null?n:window;t=Math.max(0,s.innerWidth-r.clientWidth)},after({doc:e,d:n}){let r=e.documentElement,s=Math.max(0,r.clientWidth-r.offsetWidth),i=Math.max(0,t-s);n.style(r,"paddingRight",`${i}px`)}}}function cxe(){return gY()?{before({doc:t,d:e,meta:n}){function r(s){return n.containers.flatMap(i=>i()).some(i=>i.contains(s))}e.microTask(()=>{var s;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let a=Mu();a.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>a.dispose()))}let i=(s=window.scrollY)!=null?s:window.pageYOffset,o=null;e.addEventListener(t,"click",a=>{if(a.target instanceof HTMLElement)try{let l=a.target.closest("a");if(!l)return;let{hash:u}=new URL(l.href),c=t.querySelector(u);c&&!r(c)&&(o=c)}catch{}},!0),e.addEventListener(t,"touchstart",a=>{if(a.target instanceof HTMLElement)if(r(a.target)){let l=a.target;for(;l.parentElement&&r(l.parentElement);)l=l.parentElement;e.style(l,"overscrollBehavior","contain")}else e.style(a.target,"touchAction","none")}),e.addEventListener(t,"touchmove",a=>{if(a.target instanceof HTMLElement){if(a.target.tagName==="INPUT")return;if(r(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()}},{passive:!1}),e.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;i!==l&&window.scrollTo(0,i),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function dxe(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function hxe(t){let e={};for(let n of t)Object.assign(e,n(e));return e}let Yf=dY(()=>new Map,{PUSH(t,e){var n;let r=(n=this.get(t))!=null?n:{doc:t,count:0,d:Mu(),meta:new Set};return r.count++,r.meta.add(e),this.set(t,r),this},POP(t,e){let n=this.get(t);return n&&(n.count--,n.meta.delete(e)),this},SCROLL_PREVENT({doc:t,d:e,meta:n}){let r={doc:t,d:e,meta:hxe(n)},s=[cxe(),uxe(),dxe()];s.forEach(({before:i})=>i==null?void 0:i(r)),s.forEach(({after:i})=>i==null?void 0:i(r))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});Yf.subscribe(()=>{let t=Yf.getSnapshot(),e=new Map;for(let[n]of t)e.set(n,n.documentElement.style.overflow);for(let n of t.values()){let r=e.get(n.doc)==="hidden",s=n.count!==0;(s&&!r||!s&&r)&&Yf.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&Yf.dispatch("TEARDOWN",n)}});function fxe(t,e,n=()=>({containers:[]})){let r=hY(Yf),s=e?r.get(e):void 0,i=s?s.count>0:!1;return ts(()=>{if(!(!e||!t))return Yf.dispatch("PUSH",e,n),()=>Yf.dispatch("POP",e,n)},[t,e]),i}function pxe(t,e,n=()=>[document.body]){let r=rO(t,"scroll-lock");fxe(r,e,s=>{var i;return{containers:[...(i=s.containers)!=null?i:[],n]}})}function eU(t){return[t.screenX,t.screenY]}function mxe(){let t=W.useRef([-1,-1]);return{wasMoved(e){let n=eU(e);return t.current[0]===n[0]&&t.current[1]===n[1]?!1:(t.current=n,!0)},update(e){t.current=eU(e)}}}function gxe(t=0){let[e,n]=W.useState(t),r=W.useCallback(l=>n(l),[e]),s=W.useCallback(l=>n(u=>u|l),[e]),i=W.useCallback(l=>(e&l)===l,[e]),o=W.useCallback(l=>n(u=>u&~l),[n]),a=W.useCallback(l=>n(u=>u^l),[n]);return{flags:e,setFlag:r,addFlag:s,hasFlag:i,removeFlag:o,toggleFlag:a}}var yxe={},tU;typeof process<"u"&&typeof globalThis<"u"&&((tU=process==null?void 0:yxe)==null?void 0:tU.NODE_ENV)==="test"&&typeof Element.prototype.getAnimations>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var xxe=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(xxe||{});function wxe(t){let e={};for(let n in t)t[n]===!0&&(e[`data-${n}`]="");return e}function bxe(t,e,n,r){let[s,i]=W.useState(n),{hasFlag:o,addFlag:a,removeFlag:l}=gxe(t&&s?3:0),u=W.useRef(!1),c=W.useRef(!1),d=GN();return ts(()=>{var h;if(t){if(n&&i(!0),!e){n&&a(3);return}return(h=void 0)==null||h.call(r,n),vxe(e,{inFlight:u,prepare(){c.current?c.current=!1:c.current=u.current,u.current=!0,!c.current&&(n?(a(3),l(4)):(a(4),l(2)))},run(){c.current?n?(l(3),a(4)):(l(4),a(3)):n?l(1):a(1)},done(){var f;c.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(u.current=!1,l(7),n||i(!1),(f=void 0)==null||f.call(r,n))}})}},[t,n,e,d]),t?[s,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function vxe(t,{prepare:e,run:n,done:r,inFlight:s}){let i=Mu();return Cxe(t,{prepare:e,inFlight:s}),i.nextFrame(()=>{n(),i.requestAnimationFrame(()=>{i.add(Sxe(t,r))})}),i.dispose}function Sxe(t,e){var n,r;let s=Mu();if(!t)return s.dispose;let i=!1;s.add(()=>{i=!0});let o=(r=(n=t.getAnimations)==null?void 0:n.call(t).filter(a=>a instanceof CSSTransition))!=null?r:[];return o.length===0?(e(),s.dispose):(Promise.allSettled(o.map(a=>a.finished)).then(()=>{i||e()}),s.dispose)}function Cxe(t,{inFlight:e,prepare:n}){if(e!=null&&e.current){n();return}let r=t.style.transition;t.style.transition="none",n(),t.offsetHeight,t.style.transition=r}function Ixe(t,{container:e,accept:n,walk:r}){let s=W.useRef(n),i=W.useRef(r);W.useEffect(()=>{s.current=n,i.current=r},[n,r]),ts(()=>{if(!e||!t)return;let o=g0(e);if(!o)return;let a=s.current,l=i.current,u=Object.assign(d=>a(d),{acceptNode:a}),c=o.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,u,!1);for(;c.nextNode();)l(c.currentNode)},[e,t,s,i])}function Nxe(){const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(e=>{let{brand:n,version:r}=e;return n+"/"+r}).join(" "):navigator.userAgent}const yY={...UC},kxe=yY.useInsertionEffect,Txe=kxe||(t=>t());function xY(t){const e=W.useRef(()=>{});return Txe(()=>{e.current=t}),W.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}var hR=typeof document<"u"?W.useLayoutEffect:W.useEffect;let nU=!1,Exe=0;const rU=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Exe++;function _xe(){const[t,e]=W.useState(()=>nU?rU():void 0);return hR(()=>{t==null&&e(rU())},[]),W.useEffect(()=>{nU=!0},[]),t}const Axe=yY.useId,$xe=Axe||_xe;function Rxe(){const t=new Map;return{emit(e,n){var r;(r=t.get(e))==null||r.forEach(s=>s(n))},on(e,n){t.set(e,[...t.get(e)||[],n])},off(e,n){var r;t.set(e,((r=t.get(e))==null?void 0:r.filter(s=>s!==n))||[])}}}const Mxe=W.createContext(null),Dxe=W.createContext(null),Oxe=()=>{var t;return((t=W.useContext(Mxe))==null?void 0:t.id)||null},Pxe=()=>W.useContext(Dxe),Fxe="data-floating-ui-focusable";function Lxe(t){const{open:e=!1,onOpenChange:n,elements:r}=t,s=$xe(),i=W.useRef({}),[o]=W.useState(()=>Rxe()),a=Oxe()!=null,[l,u]=W.useState(r.reference),c=xY((f,m,g)=>{i.current.openEvent=f?m:void 0,o.emit("openchange",{open:f,event:m,reason:g,nested:a}),n==null||n(f,m,g)}),d=W.useMemo(()=>({setPositionReference:u}),[]),h=W.useMemo(()=>({reference:l||r.reference||null,floating:r.floating||null,domReference:r.reference}),[l,r.reference,r.floating]);return W.useMemo(()=>({dataRef:i,open:e,onOpenChange:c,elements:h,events:o,floatingId:s,refs:d}),[e,c,h,o,s,d])}function zxe(t){t===void 0&&(t={});const{nodeId:e}=t,n=Lxe({...t,elements:{reference:null,floating:null,...t.elements}}),r=t.rootContext||n,s=r.elements,[i,o]=W.useState(null),[a,l]=W.useState(null),c=(s==null?void 0:s.domReference)||i,d=W.useRef(null),h=Pxe();hR(()=>{c&&(d.current=c)},[c]);const f=W7({...t,elements:{...s,...a&&{reference:a}}}),m=W.useCallback(S=>{const C=Li(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),contextElement:S}:S;l(C),f.refs.setReference(C)},[f.refs]),g=W.useCallback(S=>{(Li(S)||S===null)&&(d.current=S,o(S)),(Li(f.refs.reference.current)||f.refs.reference.current===null||S!==null&&!Li(S))&&f.refs.setReference(S)},[f.refs]),x=W.useMemo(()=>({...f.refs,setReference:g,setPositionReference:m,domReference:d}),[f.refs,g,m]),w=W.useMemo(()=>({...f.elements,domReference:c}),[f.elements,c]),b=W.useMemo(()=>({...f,...r,refs:x,elements:w,nodeId:e}),[f,x,w,e,r]);return hR(()=>{r.dataRef.current.floatingContext=b;const S=h==null?void 0:h.nodesRef.current.find(C=>C.id===e);S&&(S.context=b)}),W.useMemo(()=>({...f,context:b,refs:x,elements:w}),[f,x,w,b])}const sU="active",iU="selected";function d3(t,e,n){const r=new Map,s=n==="item";let i=t;if(s&&t){const{[sU]:o,[iU]:a,...l}=t;i=l}return{...n==="floating"&&{tabIndex:-1,[Fxe]:""},...i,...e.map(o=>{const a=o?o[n]:null;return typeof a=="function"?t?a(t):null:a}).concat(t).reduce((o,a)=>(a&&Object.entries(a).forEach(l=>{let[u,c]=l;if(!(s&&[sU,iU].includes(u)))if(u.indexOf("on")===0){if(r.has(u)||r.set(u,[]),typeof c=="function"){var d;(d=r.get(u))==null||d.push(c),o[u]=function(){for(var h,f=arguments.length,m=new Array(f),g=0;g<f;g++)m[g]=arguments[g];return(h=r.get(u))==null?void 0:h.map(x=>x(...m)).find(x=>x!==void 0)}}}else o[u]=c}),o),{})}}function Bxe(t){t===void 0&&(t=[]);const e=t.map(a=>a==null?void 0:a.reference),n=t.map(a=>a==null?void 0:a.floating),r=t.map(a=>a==null?void 0:a.item),s=W.useCallback(a=>d3(a,t,"reference"),e),i=W.useCallback(a=>d3(a,t,"floating"),n),o=W.useCallback(a=>d3(a,t,"item"),r);return W.useMemo(()=>({getReferenceProps:s,getFloatingProps:i,getItemProps:o}),[s,i,o])}function oU(t,e){return{...t,rects:{...t.rects,floating:{...t.rects.floating,height:e}}}}const Uxe=t=>({name:"inner",options:t,async fn(e){const{listRef:n,overflowRef:r,onFallbackChange:s,offset:i=0,index:o=0,minItemsVisible:a=4,referenceOverflowThreshold:l=0,scrollRef:u,...c}=Iu(t,e),{rects:d,elements:{floating:h}}=e,f=n.current[o],m=(u==null?void 0:u.current)||h,g=h.clientTop||m.clientTop,x=h.clientTop!==0,w=m.clientTop!==0,b=h===m;if(!f)return{};const S={...e,...await LD(-f.offsetTop-h.clientTop-d.reference.height/2-f.offsetHeight/2-i).fn(e)},C=await QA(oU(S,m.scrollHeight+g+h.clientTop),c),T=await QA(S,{...c,elementContext:"reference"}),D=hi(0,C.top),P=S.y+D,M=(m.scrollHeight>m.clientHeight?O=>O:Kw)(hi(0,m.scrollHeight+(x&&b||w?g*2:0)-D-hi(0,C.bottom)));if(m.style.maxHeight=M+"px",m.scrollTop=D,s){const O=m.offsetHeight<f.offsetHeight*_c(a,n.current.length)-1||T.top>=-l||T.bottom>=-l;Ea.flushSync(()=>s(O))}return r&&(r.current=await QA(oU({...S,y:P},m.offsetHeight+g+h.clientTop),c)),{y:P}}});function Vxe(t,e){const{open:n,elements:r}=t,{enabled:s=!0,overflowRef:i,scrollRef:o,onChange:a}=e,l=xY(a),u=W.useRef(!1),c=W.useRef(null),d=W.useRef(null);W.useEffect(()=>{if(!s)return;function f(g){if(g.ctrlKey||!m||i.current==null)return;const x=g.deltaY,w=i.current.top>=-.5,b=i.current.bottom>=-.5,S=m.scrollHeight-m.clientHeight,C=x<0?-1:1,T=x<0?"max":"min";m.scrollHeight<=m.clientHeight||(!w&&x>0||!b&&x<0?(g.preventDefault(),Ea.flushSync(()=>{l(D=>D+Math[T](x,S*C))})):/firefox/i.test(Nxe())&&(m.scrollTop+=x))}const m=(o==null?void 0:o.current)||r.floating;if(n&&m)return m.addEventListener("wheel",f),requestAnimationFrame(()=>{c.current=m.scrollTop,i.current!=null&&(d.current={...i.current})}),()=>{c.current=null,d.current=null,m.removeEventListener("wheel",f)}},[s,n,r.floating,i,o,l]);const h=W.useMemo(()=>({onKeyDown(){u.current=!0},onWheel(){u.current=!1},onPointerMove(){u.current=!1},onScroll(){const f=(o==null?void 0:o.current)||r.floating;if(!(!i.current||!f||!u.current)){if(c.current!==null){const m=f.scrollTop-c.current;(i.current.bottom<-.5&&m<-1||i.current.top<-.5&&m>1)&&Ea.flushSync(()=>l(g=>g+m))}requestAnimationFrame(()=>{c.current=f.scrollTop})}}}),[r.floating,l,i,o]);return W.useMemo(()=>s?{floating:h}:{},[s,h])}let y0=W.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});y0.displayName="FloatingContext";let aO=W.createContext(null);aO.displayName="PlacementContext";function jxe(t){return W.useMemo(()=>t?typeof t=="string"?{to:t}:t:null,[t])}function Wxe(){return W.useContext(y0).setReference}function Gxe(){return W.useContext(y0).getReferenceProps}function Hxe(){let{getFloatingProps:t,slot:e}=W.useContext(y0);return W.useCallback((...n)=>Object.assign({},t(...n),{"data-anchor":e.anchor}),[t,e])}function Yxe(t=null){t===!1&&(t=null),typeof t=="string"&&(t={to:t});let e=W.useContext(aO),n=W.useMemo(()=>t,[JSON.stringify(t,typeof HTMLElement<"u"?(s,i)=>i instanceof HTMLElement?i.outerHTML:i:void 0)]);ts(()=>{e==null||e(n??null)},[e,n]);let r=W.useContext(y0);return W.useMemo(()=>[r.setFloating,t?r.styles:{}],[r.setFloating,t,r.styles])}let aU=4;function Kxe({children:t,enabled:e=!0}){let[n,r]=W.useState(null),[s,i]=W.useState(0),o=W.useRef(null),[a,l]=W.useState(null);qxe(a);let u=e&&n!==null&&a!==null,{to:c="bottom",gap:d=0,offset:h=0,padding:f=0,inner:m}=Xxe(n,a),[g,x="center"]=c.split(" ");ts(()=>{u&&i(0)},[u]);let{refs:w,floatingStyles:b,context:S}=zxe({open:u,placement:g==="selection"?x==="center"?"bottom":`bottom-${x}`:x==="center"?`${g}`:`${g}-${x}`,strategy:"absolute",transform:!1,middleware:[LD({mainAxis:g==="selection"?0:d,crossAxis:h}),G7({padding:f}),g!=="selection"&&H7({padding:f}),g==="selection"&&m?Uxe({...m,padding:f,overflowRef:o,offset:s,minItemsVisible:aU,referenceOverflowThreshold:f,onFallbackChange(O){var j,R;if(!O)return;let z=S.elements.floating;if(!z)return;let B=parseFloat(getComputedStyle(z).scrollPaddingBottom)||0,V=Math.min(aU,z.childElementCount),H=0,K=0;for(let ne of(R=(j=S.elements.floating)==null?void 0:j.childNodes)!=null?R:[])if(ne instanceof HTMLElement){let fe=ne.offsetTop,ee=fe+ne.clientHeight+B,de=z.scrollTop,ge=de+z.clientHeight;if(fe>=de&&ee<=ge)V--;else{K=Math.max(0,Math.min(ee,ge)-Math.max(fe,de)),H=ne.clientHeight;break}}V>=1&&i(ne=>{let fe=H*V-K+B;return ne>=fe?ne:fe})}}):null,Y7({padding:f,apply({availableWidth:O,availableHeight:j,elements:R}){Object.assign(R.floating.style,{overflow:"auto",maxWidth:`${O}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${j}px)`})}})].filter(Boolean),whileElementsMounted:V7}),[C=g,T=x]=S.placement.split("-");g==="selection"&&(C="selection");let D=W.useMemo(()=>({anchor:[C,T].filter(Boolean).join(" ")}),[C,T]),P=Vxe(S,{overflowRef:o,onChange:i}),{getReferenceProps:I,getFloatingProps:E}=Bxe([P]),M=hr(O=>{l(O),w.setFloating(O)});return W.createElement(aO.Provider,{value:r},W.createElement(y0.Provider,{value:{setFloating:M,setReference:w.setReference,styles:b,getReferenceProps:I,getFloatingProps:E,slot:D}},t))}function qxe(t){ts(()=>{if(!t)return;let e=new MutationObserver(()=>{let n=window.getComputedStyle(t).maxHeight,r=parseFloat(n);if(isNaN(r))return;let s=parseInt(n);isNaN(s)||r!==s&&(t.style.maxHeight=`${Math.ceil(r)}px`)});return e.observe(t,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[t])}function Xxe(t,e){var n,r,s;let i=h3((n=t==null?void 0:t.gap)!=null?n:"var(--anchor-gap, 0)",e),o=h3((r=t==null?void 0:t.offset)!=null?r:"var(--anchor-offset, 0)",e),a=h3((s=t==null?void 0:t.padding)!=null?s:"var(--anchor-padding, 0)",e);return{...t,gap:i,offset:o,padding:a}}function h3(t,e,n=void 0){let r=GN(),s=hr((l,u)=>{if(l==null)return[n,null];if(typeof l=="number")return[l,null];if(typeof l=="string"){if(!u)return[n,null];let c=lU(l,u);return[c,d=>{let h=wY(l);{let f=h.map(m=>window.getComputedStyle(u).getPropertyValue(m));r.requestAnimationFrame(function m(){r.nextFrame(m);let g=!1;for(let[w,b]of h.entries()){let S=window.getComputedStyle(u).getPropertyValue(b);if(f[w]!==S){f[w]=S,g=!0;break}}if(!g)return;let x=lU(l,u);c!==x&&(d(x),c=x)})}return r.dispose}]}return[n,null]}),i=W.useMemo(()=>s(t,e)[0],[t,e]),[o=i,a]=W.useState();return ts(()=>{let[l,u]=s(t,e);if(a(l),!!u)return u(a)},[t,e]),o}function wY(t){let e=/var\((.*)\)/.exec(t);if(e){let n=e[1].indexOf(",");if(n===-1)return[e[1]];let r=e[1].slice(0,n).trim(),s=e[1].slice(n+1).trim();return s?[r,...wY(s)]:[r]}return[]}function lU(t,e){let n=document.createElement("div");e.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",t,"important");let r=parseFloat(window.getComputedStyle(n).marginTop)||0;return e.removeChild(n),r}let lO=W.createContext(null);lO.displayName="OpenClosedContext";var Xw=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(Xw||{});function Zxe(){return W.useContext(lO)}function Qxe({value:t,children:e}){return En.createElement(lO.Provider,{value:t},e)}function Jxe(t){throw new Error("Unexpected object: "+t)}var pi=(t=>(t[t.First=0]="First",t[t.Previous=1]="Previous",t[t.Next=2]="Next",t[t.Last=3]="Last",t[t.Specific=4]="Specific",t[t.Nothing=5]="Nothing",t))(pi||{});function f3(t,e){let n=e.resolveItems();if(n.length<=0)return null;let r=e.resolveActiveIndex(),s=r??-1;switch(t.focus){case 0:{for(let i=0;i<n.length;++i)if(!e.resolveDisabled(n[i],i,n))return i;return r}case 1:{s===-1&&(s=n.length);for(let i=s-1;i>=0;--i)if(!e.resolveDisabled(n[i],i,n))return i;return r}case 2:{for(let i=s+1;i<n.length;++i)if(!e.resolveDisabled(n[i],i,n))return i;return r}case 3:{for(let i=n.length-1;i>=0;--i)if(!e.resolveDisabled(n[i],i,n))return i;return r}case 4:{for(let i=0;i<n.length;++i)if(e.resolveId(n[i],i,n)===t.id)return i;return r}case 5:return null;default:Jxe(t)}}function ewe(t){let e=hr(t),n=W.useRef(!1);W.useEffect(()=>(n.current=!1,()=>{n.current=!0,sY(()=>{n.current&&e()})}),[e])}function twe(){let t=typeof document>"u";return"useSyncExternalStore"in UC?(e=>e.useSyncExternalStore)(UC)(()=>()=>{},()=>!1,()=>!t):!1}function nwe(){let t=twe(),[e,n]=W.useState(ep.isHandoffComplete);return e&&ep.isHandoffComplete===!1&&n(!1),W.useEffect(()=>{e!==!0&&n(!0)},[e]),W.useEffect(()=>ep.handoff(),[]),t?!1:e}let rwe=W.createContext(!1);function swe(){return W.useContext(rwe)}function iwe(t){let e=swe(),n=W.useContext(vY),r=oO(t),[s,i]=W.useState(()=>{var o;if(!e&&n!==null)return(o=n.current)!=null?o:null;if(ep.isServer)return null;let a=r==null?void 0:r.getElementById("headlessui-portal-root");if(a)return a;if(r===null)return null;let l=r.createElement("div");return l.setAttribute("id","headlessui-portal-root"),r.body.appendChild(l)});return W.useEffect(()=>{s!==null&&(r!=null&&r.body.contains(s)||r==null||r.body.appendChild(s))},[s,r]),W.useEffect(()=>{e||n!==null&&i(n.current)},[n,i,e]),s}let bY=W.Fragment,owe=za(function(t,e){let n=t,r=W.useRef(null),s=Oc(Mye(c=>{r.current=c}),e),i=oO(r),o=iwe(r),[a]=W.useState(()=>{var c;return ep.isServer?null:(c=i==null?void 0:i.createElement("div"))!=null?c:null}),l=W.useContext(cwe),u=nwe();return ts(()=>{!o||!a||o.contains(a)||(a.setAttribute("data-headlessui-portal",""),o.appendChild(a))},[o,a]),ts(()=>{if(a&&l)return l.register(a)},[l,a]),ewe(()=>{var c;!o||!a||(a instanceof Node&&o.contains(a)&&o.removeChild(a),o.childNodes.length<=0&&((c=o.parentElement)==null||c.removeChild(o)))}),u?!o||!a?null:Ea.createPortal(La({ourProps:{ref:s},theirProps:n,slot:{},defaultTag:bY,name:"Portal"}),a):null});function awe(t,e){let n=Oc(e),{enabled:r=!0,...s}=t;return r?En.createElement(owe,{...s,ref:n}):La({ourProps:{ref:n},theirProps:s,slot:{},defaultTag:bY,name:"Portal"})}let lwe=W.Fragment,vY=W.createContext(null);function uwe(t,e){let{target:n,...r}=t,s={ref:Oc(e)};return En.createElement(vY.Provider,{value:n},La({ourProps:s,theirProps:r,defaultTag:lwe,name:"Popover.Group"}))}let cwe=W.createContext(null),dwe=za(awe),hwe=za(uwe),fwe=Object.assign(dwe,{Group:hwe});function pwe(t,e){let n=W.useRef({left:0,top:0});if(ts(()=>{if(!e)return;let s=e.getBoundingClientRect();s&&(n.current=s)},[t,e]),e==null||!t||e===document.activeElement)return!1;let r=e.getBoundingClientRect();return r.top!==n.current.top||r.left!==n.current.left}let uU=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function cU(t){var e,n;let r=(e=t.innerText)!=null?e:"",s=t.cloneNode(!0);if(!(s instanceof HTMLElement))return r;let i=!1;for(let a of s.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))a.remove(),i=!0;let o=i?(n=s.innerText)!=null?n:"":r;return uU.test(o)&&(o=o.replace(uU,"")),o}function mwe(t){let e=t.getAttribute("aria-label");if(typeof e=="string")return e.trim();let n=t.getAttribute("aria-labelledby");if(n){let r=n.split(" ").map(s=>{let i=document.getElementById(s);if(i){let o=i.getAttribute("aria-label");return typeof o=="string"?o.trim():cU(i).trim()}return null}).filter(Boolean);if(r.length>0)return r.join(", ")}return cU(t).trim()}function gwe(t){let e=W.useRef(""),n=W.useRef("");return hr(()=>{let r=t.current;if(!r)return"";let s=r.innerText;if(e.current===s)return n.current;let i=mwe(r).trim().toLowerCase();return e.current=s,n.current=i,i})}var ywe=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(ywe||{}),xwe=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(xwe||{}),wwe=(t=>(t[t.OpenMenu=0]="OpenMenu",t[t.CloseMenu=1]="CloseMenu",t[t.GoToItem=2]="GoToItem",t[t.Search=3]="Search",t[t.ClearSearch=4]="ClearSearch",t[t.RegisterItem=5]="RegisterItem",t[t.UnregisterItem=6]="UnregisterItem",t[t.SetButtonElement=7]="SetButtonElement",t[t.SetItemsElement=8]="SetItemsElement",t))(wwe||{});function p3(t,e=n=>n){let n=t.activeItemIndex!==null?t.items[t.activeItemIndex]:null,r=mY(e(t.items.slice()),i=>i.dataRef.current.domRef.current),s=n?r.indexOf(n):null;return s===-1&&(s=null),{items:r,activeItemIndex:s}}let bwe={1(t){return t.menuState===1?t:{...t,activeItemIndex:null,menuState:1}},0(t){return t.menuState===0?t:{...t,__demoMode:!1,menuState:0}},2:(t,e)=>{var n,r,s,i,o;if(t.menuState===1)return t;let a={...t,searchQuery:"",activationTrigger:(n=e.trigger)!=null?n:1,__demoMode:!1};if(e.focus===pi.Nothing)return{...a,activeItemIndex:null};if(e.focus===pi.Specific)return{...a,activeItemIndex:t.items.findIndex(c=>c.id===e.id)};if(e.focus===pi.Previous){let c=t.activeItemIndex;if(c!==null){let d=t.items[c].dataRef.current.domRef,h=f3(e,{resolveItems:()=>t.items,resolveActiveIndex:()=>t.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});if(h!==null){let f=t.items[h].dataRef.current.domRef;if(((r=d.current)==null?void 0:r.previousElementSibling)===f.current||((s=f.current)==null?void 0:s.previousElementSibling)===null)return{...a,activeItemIndex:h}}}}else if(e.focus===pi.Next){let c=t.activeItemIndex;if(c!==null){let d=t.items[c].dataRef.current.domRef,h=f3(e,{resolveItems:()=>t.items,resolveActiveIndex:()=>t.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});if(h!==null){let f=t.items[h].dataRef.current.domRef;if(((i=d.current)==null?void 0:i.nextElementSibling)===f.current||((o=f.current)==null?void 0:o.nextElementSibling)===null)return{...a,activeItemIndex:h}}}}let l=p3(t),u=f3(e,{resolveItems:()=>l.items,resolveActiveIndex:()=>l.activeItemIndex,resolveId:c=>c.id,resolveDisabled:c=>c.dataRef.current.disabled});return{...a,...l,activeItemIndex:u}},3:(t,e)=>{let n=t.searchQuery!==""?0:1,r=t.searchQuery+e.value.toLowerCase(),s=(t.activeItemIndex!==null?t.items.slice(t.activeItemIndex+n).concat(t.items.slice(0,t.activeItemIndex+n)):t.items).find(o=>{var a;return((a=o.dataRef.current.textValue)==null?void 0:a.startsWith(r))&&!o.dataRef.current.disabled}),i=s?t.items.indexOf(s):-1;return i===-1||i===t.activeItemIndex?{...t,searchQuery:r}:{...t,searchQuery:r,activeItemIndex:i,activationTrigger:1}},4(t){return t.searchQuery===""?t:{...t,searchQuery:"",searchActiveItemIndex:null}},5:(t,e)=>{let n=p3(t,r=>[...r,{id:e.id,dataRef:e.dataRef}]);return{...t,...n}},6:(t,e)=>{let n=p3(t,r=>{let s=r.findIndex(i=>i.id===e.id);return s!==-1&&r.splice(s,1),r});return{...t,...n,activationTrigger:1}},7:(t,e)=>t.buttonElement===e.element?t:{...t,buttonElement:e.element},8:(t,e)=>t.itemsElement===e.element?t:{...t,itemsElement:e.element}},uO=W.createContext(null);uO.displayName="MenuContext";function YN(t){let e=W.useContext(uO);if(e===null){let n=new Error(`<${t} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,YN),n}return e}function vwe(t,e){return U1(e.type,bwe,t,e)}let Swe=W.Fragment;function Cwe(t,e){let{__demoMode:n=!1,...r}=t,s=W.useReducer(vwe,{__demoMode:n,menuState:n?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:i,itemsElement:o,buttonElement:a},l]=s,u=Oc(e);axe(i===0,[a,o],(f,m)=>{l({type:1}),iO(m,sO.Loose)||(f.preventDefault(),a==null||a.focus())});let c=hr(()=>{l({type:1})}),d=W.useMemo(()=>({open:i===0,close:c}),[i,c]),h={ref:u};return En.createElement(Kxe,null,En.createElement(uO.Provider,{value:s},En.createElement(Qxe,{value:U1(i,{0:Xw.Open,1:Xw.Closed})},La({ourProps:h,theirProps:r,slot:d,defaultTag:Swe,name:"Menu"}))))}let Iwe="button";function Nwe(t,e){var n;let r=W.useId(),{id:s=`headlessui-menu-button-${r}`,disabled:i=!1,autoFocus:o=!1,...a}=t,[l,u]=YN("Menu.Button"),c=Gxe(),d=Tye(),h=Oc(e,Wxe(),hr(I=>u({type:7,element:I}))),f=hr(I=>{switch(I.key){case Bs.Space:case Bs.Enter:case Bs.ArrowDown:I.preventDefault(),I.stopPropagation(),Ea.flushSync(()=>u({type:0})),u({type:2,focus:pi.First});break;case Bs.ArrowUp:I.preventDefault(),I.stopPropagation(),Ea.flushSync(()=>u({type:0})),u({type:2,focus:pi.Last});break}}),m=hr(I=>{switch(I.key){case Bs.Space:I.preventDefault();break}}),g=hr(I=>{var E;if($ye(I.currentTarget))return I.preventDefault();i||(l.menuState===0?(Ea.flushSync(()=>u({type:1})),(E=l.buttonElement)==null||E.focus({preventScroll:!0})):(I.preventDefault(),u({type:0})))}),{isFocusVisible:x,focusProps:w}=xye({autoFocus:o}),{isHovered:b,hoverProps:S}=yye({isDisabled:i}),{pressed:C,pressProps:T}=Iye({disabled:i}),D=W.useMemo(()=>({open:l.menuState===0,active:C||l.menuState===0,disabled:i,hover:b,focus:x,autofocus:o}),[l,b,x,C,i,o]),P=aY(c(),{ref:h,id:s,type:lxe(t,l.buttonElement),"aria-haspopup":"menu","aria-controls":(n=l.itemsElement)==null?void 0:n.id,"aria-expanded":l.menuState===0,disabled:i||void 0,autoFocus:o,onKeyDown:f,onKeyUp:m,onClick:g},w,S,T);return La({mergeRefs:d,ourProps:P,theirProps:a,slot:D,defaultTag:Iwe,name:"Menu.Button"})}let kwe="div",Twe=lR.RenderStrategy|lR.Static;function Ewe(t,e){var n,r;let s=W.useId(),{id:i=`headlessui-menu-items-${s}`,anchor:o,portal:a=!1,modal:l=!0,transition:u=!1,...c}=t,d=jxe(o),[h,f]=YN("Menu.Items"),[m,g]=Yxe(d),x=Hxe(),[w,b]=W.useState(null),S=Oc(e,d?m:null,hr(H=>f({type:8,element:H})),b),C=oO(h.itemsElement);d&&(a=!0);let T=Zxe(),[D,P]=bxe(u,w,T!==null?(T&Xw.Open)===Xw.Open:h.menuState===0);Yye(D,h.buttonElement,()=>{f({type:1})});let I=h.__demoMode?!1:l&&h.menuState===0;pxe(I,C);let E=h.__demoMode?!1:l&&h.menuState===0;Hye(E,{allowed:W.useCallback(()=>[h.buttonElement,h.itemsElement],[h.buttonElement,h.itemsElement])});let M=h.menuState!==0,O=pwe(M,h.buttonElement)?!1:D;W.useEffect(()=>{let H=h.itemsElement;H&&h.menuState===0&&H!==(C==null?void 0:C.activeElement)&&H.focus({preventScroll:!0})},[h.menuState,h.itemsElement,C]),Ixe(h.menuState===0,{container:h.itemsElement,accept(H){return H.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:H.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(H){H.setAttribute("role","none")}});let j=GN(),R=hr(H=>{var K,ne,fe;switch(j.dispose(),H.key){case Bs.Space:if(h.searchQuery!=="")return H.preventDefault(),H.stopPropagation(),f({type:3,value:H.key});case Bs.Enter:if(H.preventDefault(),H.stopPropagation(),f({type:1}),h.activeItemIndex!==null){let{dataRef:ee}=h.items[h.activeItemIndex];(ne=(K=ee.current)==null?void 0:K.domRef.current)==null||ne.click()}pY(h.buttonElement);break;case Bs.ArrowDown:return H.preventDefault(),H.stopPropagation(),f({type:2,focus:pi.Next});case Bs.ArrowUp:return H.preventDefault(),H.stopPropagation(),f({type:2,focus:pi.Previous});case Bs.Home:case Bs.PageUp:return H.preventDefault(),H.stopPropagation(),f({type:2,focus:pi.First});case Bs.End:case Bs.PageDown:return H.preventDefault(),H.stopPropagation(),f({type:2,focus:pi.Last});case Bs.Escape:H.preventDefault(),H.stopPropagation(),Ea.flushSync(()=>f({type:1})),(fe=h.buttonElement)==null||fe.focus({preventScroll:!0});break;case Bs.Tab:H.preventDefault(),H.stopPropagation(),Ea.flushSync(()=>f({type:1})),nxe(h.buttonElement,H.shiftKey?dR.Previous:dR.Next);break;default:H.key.length===1&&(f({type:3,value:H.key}),j.setTimeout(()=>f({type:4}),350));break}}),z=hr(H=>{switch(H.key){case Bs.Space:H.preventDefault();break}}),B=W.useMemo(()=>({open:h.menuState===0}),[h.menuState]),V=aY(d?x():{},{"aria-activedescendant":h.activeItemIndex===null||(n=h.items[h.activeItemIndex])==null?void 0:n.id,"aria-labelledby":(r=h.buttonElement)==null?void 0:r.id,id:i,onKeyDown:R,onKeyUp:z,role:"menu",tabIndex:h.menuState===0?0:void 0,ref:S,style:{...c.style,...g,"--button-width":jye(h.buttonElement,!0).width},...wxe(P)});return En.createElement(fwe,{enabled:a?t.static||D:!1},La({ourProps:V,theirProps:c,slot:B,defaultTag:kwe,features:Twe,visible:O,name:"Menu.Items"}))}let _we=W.Fragment;function Awe(t,e){let n=W.useId(),{id:r=`headlessui-menu-item-${n}`,disabled:s=!1,...i}=t,[o,a]=YN("Menu.Item"),l=o.activeItemIndex!==null?o.items[o.activeItemIndex].id===r:!1,u=W.useRef(null),c=Oc(e,u);ts(()=>{if(!o.__demoMode&&o.menuState===0&&l&&o.activationTrigger!==0)return Mu().requestAnimationFrame(()=>{var E,M;(M=(E=u.current)==null?void 0:E.scrollIntoView)==null||M.call(E,{block:"nearest"})})},[o.__demoMode,u,l,o.menuState,o.activationTrigger,o.activeItemIndex]);let d=gwe(u),h=W.useRef({disabled:s,domRef:u,get textValue(){return d()}});ts(()=>{h.current.disabled=s},[h,s]),ts(()=>(a({type:5,id:r,dataRef:h}),()=>a({type:6,id:r})),[h,r]);let f=hr(()=>{a({type:1})}),m=hr(E=>{if(s)return E.preventDefault();a({type:1}),pY(o.buttonElement)}),g=hr(()=>{if(s)return a({type:2,focus:pi.Nothing});a({type:2,focus:pi.Specific,id:r})}),x=mxe(),w=hr(E=>{x.update(E),!s&&(l||a({type:2,focus:pi.Specific,id:r,trigger:0}))}),b=hr(E=>{x.wasMoved(E)&&(s||l||a({type:2,focus:pi.Specific,id:r,trigger:0}))}),S=hr(E=>{x.wasMoved(E)&&(s||l&&a({type:2,focus:pi.Nothing}))}),[C,T]=cY(),[D,P]=Dye(),I=W.useMemo(()=>({active:l,focus:l,disabled:s,close:f}),[l,s,f]);return En.createElement(T,null,En.createElement(P,null,La({ourProps:{id:r,ref:c,role:"menuitem",tabIndex:s===!0?void 0:-1,"aria-disabled":s===!0?!0:void 0,"aria-labelledby":C,"aria-describedby":D,disabled:void 0,onClick:m,onFocus:g,onPointerEnter:w,onMouseEnter:w,onPointerMove:b,onMouseMove:b,onPointerLeave:S,onMouseLeave:S},theirProps:i,slot:I,defaultTag:_we,name:"Menu.Item"})))}let $we="div";function Rwe(t,e){let[n,r]=cY();return En.createElement(r,null,La({ourProps:{ref:e,"aria-labelledby":n,role:"group"},theirProps:t,slot:{},defaultTag:$we,name:"Menu.Section"}))}let Mwe="header";function Dwe(t,e){let n=W.useId(),{id:r=`headlessui-menu-heading-${n}`,...s}=t,i=nO();ts(()=>i.register(r),[r,i.register]);let o={id:r,ref:e,role:"presentation",...i.props};return La({ourProps:o,theirProps:s,slot:{},defaultTag:Mwe,name:"Menu.Heading"})}let Owe="div";function Pwe(t,e){return La({ourProps:{ref:e,role:"separator"},theirProps:t,slot:{},defaultTag:Owe,name:"Menu.Separator"})}let Fwe=za(Cwe),SY=za(Nwe),CY=za(Ewe),Lwe=za(Awe),zwe=za(Rwe),Bwe=za(Dwe),Uwe=za(Pwe),Vwe=Object.assign(Fwe,{Button:SY,Items:CY,Item:Lwe,Section:zwe,Heading:Bwe,Separator:Uwe});var m3={},g3={},Z2={exports:{}},dU;function jwe(){if(dU)return Z2.exports;dU=1;var t=String,e=function(){return{isColorSupported:!1,reset:t,bold:t,dim:t,italic:t,underline:t,inverse:t,hidden:t,strikethrough:t,black:t,red:t,green:t,yellow:t,blue:t,magenta:t,cyan:t,white:t,gray:t,bgBlack:t,bgRed:t,bgGreen:t,bgYellow:t,bgBlue:t,bgMagenta:t,bgCyan:t,bgWhite:t,blackBright:t,redBright:t,greenBright:t,yellowBright:t,blueBright:t,magentaBright:t,cyanBright:t,whiteBright:t,bgBlackBright:t,bgRedBright:t,bgGreenBright:t,bgYellowBright:t,bgBlueBright:t,bgMagentaBright:t,bgCyanBright:t,bgWhiteBright:t}};return Z2.exports=e(),Z2.exports.createColors=e,Z2.exports}var hU;function Wwe(){return hU||(hU=1,function(t){var e={};Object.defineProperty(t,"__esModule",{value:!0});function n(u,c){for(var d in c)Object.defineProperty(u,d,{enumerable:!0,get:c[d]})}n(t,{dim:function(){return a},default:function(){return l}});const r=s(jwe());function s(u){return u&&u.__esModule?u:{default:u}}let i=new Set;function o(u,c,d){typeof process<"u"&&e.JEST_WORKER_ID||d&&i.has(d)||(d&&i.add(d),console.warn(""),c.forEach(h=>console.warn(u,"-",h)))}function a(u){return r.default.dim(u)}const l={info(u,c){o(r.default.bold(r.default.cyan("info")),...Array.isArray(u)?[u]:[c,u])},warn(u,c){o(r.default.bold(r.default.yellow("warn")),...Array.isArray(u)?[u]:[c,u])},risk(u,c){o(r.default.bold(r.default.magenta("risk")),...Array.isArray(u)?[u]:[c,u])}}}(g3)),g3}var fU;function Gwe(){return fU||(fU=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});const e=n(Wwe());function n(i){return i&&i.__esModule?i:{default:i}}function r({version:i,from:o,to:a}){e.default.warn(`${o}-color-renamed`,[`As of Tailwind CSS ${i}, \`${o}\` has been renamed to \`${a}\`.`,"Update your configuration file to silence this warning."])}const s={inherit:"inherit",current:"currentColor",transparent:"transparent",black:"#000",white:"#fff",slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},get lightBlue(){return r({version:"v2.2",from:"lightBlue",to:"sky"}),this.sky},get warmGray(){return r({version:"v3.0",from:"warmGray",to:"stone"}),this.stone},get trueGray(){return r({version:"v3.0",from:"trueGray",to:"neutral"}),this.neutral},get coolGray(){return r({version:"v3.0",from:"coolGray",to:"gray"}),this.gray},get blueGray(){return r({version:"v3.0",from:"blueGray",to:"slate"}),this.slate}}}(m3)),m3}var y3,pU;function Hwe(){if(pU)return y3;pU=1;let t=Gwe();return y3=(t.__esModule?t:{default:t}).default,y3}var Ywe=Hwe();const gl=Dp(Ywe);var va;(function(t){t.LIGHT="light",t.DARK="dark",t.SYSTEM="system"})(va||(va={}));const mU=["mousedown","mousemove","keydown","touchstart","wheel"],gU=2147483647;class wI{constructor(e={}){Vt(this,"callbacks",[]);Vt(this,"idleTimeout",10*60*1e3);Vt(this,"timeoutID");const{onIdle:n,idleTimeout:r=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=r>gU?gU:r;const s=this._resetTimer.bind(this);window.addEventListener("load",s,!0),mU.forEach(function(o){document.addEventListener(o,s,!0)});const i=(o,a)=>{let l;return(...u)=>{const c=this,d=function(){l=void 0,o.apply(c,u)};clearTimeout(l),l=window.setTimeout(d,a)}};if(e!=null&&e.captureScroll){const o=i(s,(e==null?void 0:e.scrollDebounce)??100);window.addEventListener("scroll",o,!0)}s()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);mU.forEach(function(n){document.removeEventListener(n,e,!0)})}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(()=>{e(),this.callbacks.forEach(n=>n())},this.idleTimeout)}}const su="client",x3="connected-owner",w3="connected-subaccount";class fR{constructor(e){Vt(this,"options");Vt(this,"idleManager");Vt(this,"storage",new CD);Vt(this,"connectedUser");var n;this.options=e,(n=e==null?void 0:e.idleOptions)!=null&&n.disableIdle||(this.idleManager=wI.create(e.idleOptions),this.registerDefaultIdleCallback()),e.storage&&(this.storage=e.storage)}registerDefaultIdleCallback(){var e,n,r;(n=(e=this.options)==null?void 0:e.idleOptions)!=null&&n.disableDefaultIdleCallback||(r=this.idleManager)==null||r.registerCallback(async()=>{await this.logout()})}async logout(e){var n;if(await this.setConnectedUserToStorage(void 0),(n=this.idleManager)==null||n.exit(),this.idleManager=void 0,e!=null&&e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}async setConnectedUser(e){if(!e)this.connectedUser=void 0;else{let n;if(e.subAccount){const r=yD.fromBytes(new Uint8Array(e.subAccount));if(typeof r==typeof Error)throw n;n=r}this.connectedUser={principal:zt.from(e.owner),subAccount:n}}}async setConnectedUserToStorage(e){if(!e){await this.storage.remove(x3),await this.storage.remove(w3),localStorage.removeItem("connected"),this.setConnectedUser(void 0);return}await this.storage.set(x3,e.owner),localStorage.setItem("connected","1"),e.subAccount&&await this.storage.set(w3,new TextDecoder().decode(e.subAccount)),this.setConnectedUser({owner:e.owner,subAccount:e.subAccount})}static shouldCheckIsUserConnected(){return!!localStorage.getItem("connected")}async getConnectedUserFromStorage(){const e=await this.storage.get(x3);if(!e)return;const n=await this.storage.get(w3);return{owner:e.toString(),subAccount:n?new TextEncoder().encode(n.toString()):void 0}}get crypto(){return this.options.crypto??globalThis.crypto}}const Kwe="Ed25519";var bI;(function(t){t.GLOBAL="GLOBAL",t.ANONYMOUS="ANONYMOUS"})(bI||(bI={}));class Ag extends fR{constructor(n,r,s,i=[],o){super(n);Vt(this,"identity");Vt(this,"baseIdentity");Vt(this,"targets");Vt(this,"maxTimeToLive");this.identity=r,this.baseIdentity=s,this.targets=i,this.maxTimeToLive=o}static async create(n){const r=n.storage??new CD;let s=n.identity,i=new Jd;if(this.shouldCheckIsUserConnected()&&!s&&(s=await o7(su,r)),s||(s=await(!(n!=null&&n.keyType)||(n==null?void 0:n.keyType)===Kwe?Vo.generate(crypto.getRandomValues(new Uint8Array(32))):lh.generate())),this.shouldCheckIsUserConnected()){const a=await z$(su,r);i=s&&a&&ON(a)?Ag.createIdentity(s,a):new Jd}const o=new Ag(n,i,s,n.targets,n.maxTimeToLive);if(this.shouldCheckIsUserConnected()){const a=await o.getConnectedUserFromStorage();await o.setConnectedUser(a)}return o}static createIdentity(n,r){return n instanceof s7?Yw.fromDelegation(n,r):lI.fromDelegation(n,r)}async login(){var s,i;const n=await this.options.signer.sendRequest({id:this.crypto.randomUUID(),jsonrpc:"2.0",method:"icrc34_delegation",params:{publicKey:uo(this.baseIdentity.getPublicKey().toDer()),targets:this.targets,maxTimeToLive:this.maxTimeToLive===void 0?void 0:String(this.maxTimeToLive)}});if("error"in n)throw Error(n.error.message);const r=vl.fromDelegations(n.result.signerDelegation.map(o=>{var a;return{delegation:new h0(Fo(o.delegation.pubkey),BigInt(o.delegation.expiration),(a=o.delegation.targets)==null?void 0:a.map(l=>zt.fromText(l))),signature:Fo(o.signature)}}),Fo(n.result.publicKey));(this.baseIdentity instanceof Vo||this.baseIdentity instanceof lh)&&await a7(su,this.baseIdentity,this.storage),await l7(su,r,this.storage),this.identity=Ag.createIdentity(this.baseIdentity,r),await this.setConnectedUserToStorage({owner:this.identity.getPrincipal().toString()}),!((i=(s=this.options)==null?void 0:s.idleOptions)!=null&&i.disableIdle)&&!this.idleManager&&(this.idleManager=wI.create(this.options.idleOptions),this.registerDefaultIdleCallback())}async logout(n){await Promise.all([Efe(su,this.storage),u7(su,this.storage)]),this.identity=new Jd,super.logout(n)}getIdentity(){return this.identity}async getDelegationType(){var r;if(!this.connectedUser)throw new Error("Not authorized");const n=await z$(su,this.storage);if(!n)throw new Error("Not authorized");return(r=n.delegations[0].delegation.targets)!=null&&r.length?bI.GLOBAL:bI.ANONYMOUS}}class V1 extends fR{static async create(e){const n=new V1(e);if(fR.shouldCheckIsUserConnected()){const r=await n.getConnectedUserFromStorage();await n.setConnectedUser(r)}return n}async login(){var s,i,o,a;const e=await this.options.signer.sendRequest({method:"icrc27_accounts",id:this.crypto.randomUUID(),jsonrpc:"2.0",params:this.options.derivationOrigin?{derivationOrigin:this.options.derivationOrigin}:void 0});if("error"in e)throw Error(e.error.message);const n=e.result.accounts.map(({owner:l,subaccount:u})=>({owner:zt.fromText(l),subaccount:u===void 0?void 0:Fo(u)}));await this.setAccounts(n);const r=n[0];if(!r.subaccount){!((i=(s=this.options)==null?void 0:s.idleOptions)!=null&&i.disableIdle)&&!this.idleManager&&(this.idleManager=wI.create(this.options.idleOptions),this.registerDefaultIdleCallback()),await this.setConnectedUserToStorage({owner:r.owner.toString()});return}await this.setConnectedUserToStorage({owner:r.owner.toString(),subAccount:r.subaccount}),!((a=(o=this.options)==null?void 0:o.idleOptions)!=null&&a.disableIdle)&&!this.idleManager&&(this.idleManager=wI.create(this.options.idleOptions),this.registerDefaultIdleCallback())}async logout(e){await this.storage.remove(`accounts-${su}`),super.logout(e)}async setAccounts(e){return this.storage.set(`accounts-${su}`,JSON.stringify(e.map(n=>({owner:n.owner.toString(),subaccount:n.subaccount&&new TextDecoder().decode(n.subaccount)}))))}async getAccounts(){const e=await this.storage.get(`accounts-${su}`);if(!(!e||typeof e!="string"))return JSON.parse(e).map(({owner:n,subaccount:r})=>{let s;if(r){const i=yD.fromBytes(new Uint8Array(new TextEncoder().encode(r)));if(typeof i==typeof Error)throw s;s=i}return{principal:zt.from(n),subAccount:s}})}}const x0={DELEGATION:"DELEGATION",ACCOUNTS:"ACCOUNTS"};class qwe{constructor(e){Vt(this,"signerAgent");Vt(this,"signerClient");this.signerClient=e}clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}async createSignerAgent(e){const n=await g7.create(e);return this.signerAgent=n,n}async getIcpBalance(){const e=await this.signerClient.connectedUser;if(!e)throw new Error("Not authenticated");const n=(await pfe.create().accountBalance({accountIdentifier:F$.fromPrincipal({principal:e.principal,subAccount:e.subAccount}),certified:!1})).toString();return Number(n)/10**8}static async create({signerClientOptions:e,authType:n}){if(n===x0.DELEGATION){const r=await Ag.create(e);return new this(r)}else{const r=await V1.create(e);return new this(r)}}}var Sa;(function(t){t[t.NEW_TAB=0]="NEW_TAB",t[t.EXTENSION=1]="EXTENSION",t[t.INTERNET_IDENTITY=2]="INTERNET_IDENTITY",t[t.STOIC=3]="STOIC"})(Sa||(Sa={}));const Xwe={id:"NFIDW",description:"Quickly sign in or create an anonymous, self-sovereign wallet with your email address or passkey.",providerUrl:"https://nfid.one/rpc",transportType:Sa.NEW_TAB,label:"NFID Wallet",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTExLjc5NCAyLjQzM0ExLjE2MiAxLjE2MiAwIDAgMCAxMS41NDguMTJMOS4xNzQuMzc0Yy0xLjIxNi4xMy0yLjE5MS4yMzQtMi45ODMuMzc4LS44MTYuMTQ4LTEuNTE2LjM1LTIuMTY1LjcxNGE2LjY3NSA2LjY3NSAwIDAgMC0yLjUzIDIuNTA2Yy0uMzcuNjQ2LS41NzggMS4zNDMtLjczMiAyLjE1N0MuNjE0IDYuOTE5LjUgNy44OTMuMzYgOS4xMDZsLS4wMDYuMDUyLS4yMzMgMi4zMThhMS4xNjIgMS4xNjIgMCAxIDAgMi4zMTMuMjMybC4yMzEtMi4zYy4xNDYtMS4yNjQuMjQ5LTIuMTUuMzgxLTIuODQ1LjEzLS42ODIuMjc1LTEuMS40NjctMS40MzZhNC4zNSA0LjM1IDAgMCAxIDEuNjQ4LTEuNjMzYy4zMzgtLjE5Ljc2LS4zMzEgMS40NDMtLjQ1NS42OTktLjEyNyAxLjU5LS4yMjMgMi44Ni0uMzU4bDIuMzMtLjI0OFptMjIuNjEzLTEuMjhhMS4xNjIgMS4xNjIgMCAwIDAgMS4wMzMgMS4yOGwyLjMzLjI0OGMxLjI3LjEzNSAyLjE2LjIzMSAyLjg1OS4zNTguNjg0LjEyNCAxLjEwNS4yNjUgMS40NDMuNDU1YTQuMzUgNC4zNSAwIDAgMSAxLjY0OCAxLjYzM2MuMTkzLjMzNS4zMzcuNzU0LjQ2NyAxLjQzNi4xMzIuNjk1LjIzNSAxLjU4MS4zOCAyLjg0NGwuMjMyIDIuMzAyYTEuMTYyIDEuMTYyIDAgMSAwIDIuMzEzLS4yMzNsLS4yMzMtMi4zMTgtLjAwNi0uMDUyYy0uMTQtMS4yMTQtLjI1Mi0yLjE4Ny0uNDAyLTIuOTc3LS4xNTUtLjgxNC0uMzY0LTEuNTExLS43MzQtMi4xNTdhNi42NzUgNi42NzUgMCAwIDAtMi41MjktMi41MDZjLS42NS0uMzY0LTEuMzQ5LS41NjYtMi4xNjUtLjcxNC0uNzkyLS4xNDQtMS43NjctLjI0OC0yLjk4My0uMzc4TDM1LjY4Ni4xMjFhMS4xNjIgMS4xNjIgMCAwIDAtMS4yNzkgMS4wMzNabTAgNDQuOTIzYTEuMTYyIDEuMTYyIDAgMCAxIDEuMDMzLTEuMjhsMi4zMy0uMjQ4YzEuMjctLjEzNSAyLjE2LS4yMyAyLjg1OS0uMzU3LjY4NC0uMTI0IDEuMTA1LS4yNjYgMS40NDMtLjQ1NWE0LjM1IDQuMzUgMCAwIDAgMS42NDgtMS42MzNjLjE5My0uMzM2LjMzNy0uNzU1LjQ2Ny0xLjQzNy4xMzItLjY5NS4yMzUtMS41ODEuMzgtMi44NDRsLjIzMi0yLjMwMWExLjE2MiAxLjE2MiAwIDEgMSAyLjMxMy4yMzNsLS4yMzMgMi4zMTctLjAwNi4wNTNjLS4xNCAxLjIxMy0uMjUyIDIuMTg2LS40MDIgMi45NzYtLjE1NS44MTQtLjM2NCAxLjUxMi0uNzM0IDIuMTU4YTYuNjc1IDYuNjc1IDAgMCAxLTIuNTI5IDIuNTA2Yy0uNjUuMzY0LTEuMzQ5LjU2Ni0yLjE2NS43MTQtLjc5Mi4xNDMtMS43NjcuMjQ3LTIuOTgzLjM3N2wtMi4zNzQuMjUzYTEuMTYyIDEuMTYyIDAgMCAxLTEuMjc5LTEuMDMyWm0tMjEuNTggMGExLjE2MiAxLjE2MiAwIDAgMC0xLjAzMy0xLjI4bC0yLjMzLS4yNDhjLTEuMjctLjEzNS0yLjE2LS4yMy0yLjg1OS0uMzU3LS42ODQtLjEyNC0xLjEwNS0uMjY2LTEuNDQzLS40NTVhNC4zNSA0LjM1IDAgMCAxLTEuNjQ4LTEuNjMzYy0uMTkyLS4zMzYtLjMzNy0uNzU1LS40NjctMS40MzctLjEzMi0uNjk1LS4yMzUtMS41ODEtLjM4LTIuODQ0bC0uMjMyLTIuMzAxYTEuMTYyIDEuMTYyIDAgMCAwLTIuMzEzLjIzM2wuMjMzIDIuMzE3LjAwNi4wNTNjLjE0IDEuMjEzLjI1MiAyLjE4Ni40MDMgMi45NzYuMTU0LjgxNC4zNjMgMS41MTIuNzMzIDIuMTU4YTYuNjc0IDYuNjc0IDAgMCAwIDIuNTI5IDIuNTA2Yy42NS4zNjQgMS4zNDkuNTY2IDIuMTY1LjcxNC43OTIuMTQzIDEuNzY3LjI0NyAyLjk4My4zNzdsMi4zNzQuMjUzYTEuMTYyIDEuMTYyIDAgMCAwIDEuMjc5LTEuMDMyWm0tLjYzNi0zMS40MjJhMSAxIDAgMCAwLTEgMXYxNi4yNjRhMSAxIDAgMCAwIDEgMWgzLjE2NmExIDEgMCAwIDAgMS0xVjE1LjY1NGExIDEgMCAwIDAtMS0xaC0zLjE2NlptOC41NiAwYTEgMSAwIDAgMC0xIDF2MTYuMjY0YTEgMSAwIDAgMCAxIDFoNy42MzdjMiAwIDMuNzc0LS4zNzQgNS4zMjItMS4xMjIgMS41NDgtLjc0OCAyLjc0OS0xLjgwOSAzLjYwMS0zLjE4My44NTItMS4zNzQgMS4yNzktMi45ODMgMS4yNzktNC44MjcgMC0xLjg0NC0uNDI3LTMuNDUzLTEuMjc5LTQuODI3LS44NTItMS4zNzQtMi4wNTMtMi40MzUtMy42LTMuMTgzLTEuNTQ5LS43NDgtMy4zMjMtMS4xMjItNS4zMjMtMS4xMjJIMjAuNzVabTExLjE4NSAxMi44MTFjLS45NC44ODctMi4xOTIgMS4zMy0zLjc1NyAxLjMzaC0yLjk2MmEuMy4zIDAgMCAxLS4zLS4zdi05LjQxOWEuMy4zIDAgMCAxIC4zLS4zaDIuOTYyYzEuNTY1IDAgMi44MTguNDQ0IDMuNzU3IDEuMzMxLjk1Ny44ODcgMS40MzUgMi4xMTQgMS40MzUgMy42OCAwIDEuNTY1LS40NzggMi43OS0xLjQzNSAzLjY3OFoiIGZpbGw9InVybCgjYSkiIC8+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImEiIHgxPSIxMS40MTUiIHkxPSIxNS43NTYiIHgyPSIyNy41NDgiIHkyPSIzOS4yMDYiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iI0NDNUNEQyIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIuMjQ1IiBzdG9wLWNvbG9yPSIjN0I2NkZGIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9Ii41MjEiIHN0b3AtY29sb3I9IiMxRjhBRjAiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjc2IiBzdG9wLWNvbG9yPSIjMDBEMUZGIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMzREVERDciIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KPC9zdmc+Cg=="};Sa.NEW_TAB;const Zwe={id:"Plug",providerUrl:"",transportType:Sa.EXTENSION,label:"Plug",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjcwMSIgaGVpZ2h0PSIzOTI1IiB2aWV3Qm94PSIwIDAgMjcwMSAzOTI1IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMCAxMTIzLjc4QzAgMTAzNi42NCA3MC42NDIgOTY2IDE1Ny43ODMgOTY2SDI1NDIuMjhDMjYyOS40MyA5NjYgMjcwMC4wNyAxMDM2LjY0IDI3MDAuMDcgMTEyMy43OFYxOTA5Ljc0QzI3MDAuMDcgMjY1NS4zNCAyMDk1LjY0IDMyNTkuNzggMTM1MC4wMyAzMjU5Ljc4QzYwNC40MzEgMzI1OS43OCAwIDI2NTUuMzQgMCAxOTA5Ljc0VjExMjMuNzhaIiBmaWxsPSJ1cmwoI3BhaW50MF9saW5lYXIpIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjU5My4xNyAyNDM3LjNDMjM4Ny43NyAyOTIwLjgzIDE5MDguNSAzMjU5Ljk0IDEzNTAuMDMgMzI1OS45NEM2MDQuNDMxIDMyNTkuOTQgMCAyNjU1LjUxIDAgMTkwOS45VjEzNDIuMTZDMjU2LjQxNiAxMjAwLjU4IDU1MS4yMjMgMTEyMCA4NjQuODUgMTEyMEMxNjkwLjE3IDExMjAgMjM4NS4xNyAxNjc3Ljk5IDI1OTMuMTcgMjQzNy4zWiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyKSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyNzAuMzggMjg5OC41MkMyMDI5LjI0IDMxMjMuMyAxNzA1LjcgMzI2MC44NCAxMzUwLjAzIDMyNjAuODRDNjA0LjQzMSAzMjYwLjg0IDAgMjY1Ni40MSAwIDE5MTAuOFYxNzY2LjQ4QzIyOC40OTUgMTYyMy41OSA0OTguNTY4IDE1NDEgNzg3LjkzMSAxNTQxQzE1NjUuNzkgMTU0MSAyMjA0LjI1IDIxMzcuODIgMjI3MC4zOCAyODk4LjUyWiIgZmlsbD0idXJsKCNwYWludDJfbGluZWFyKSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MDQuMyAzMTg4LjcxQzE3NzYuMjIgMjU2NS41NiAxMjY0IDIwNjkgNjM2LjIyMiAyMDY5QzQxOC4wMzIgMjA2OSAyMTMuNzk5IDIxMjguOTggMzkgMjIzMy40MkMxNDcuNjg4IDI2NzguNzMgNDc1LjM0NCAzMDM3Ljc2IDkwMC44OTQgMzE4OC45OFYzMjY0LjQ0QzkwMC44OTQgMzM3My42OSA5NTkuNTkgMzQ2OS4xOCAxMDQ3LjA2IDM1MjAuODhWMzcyNi4zN0MxMDQ3LjA2IDM4MzUuODYgMTEzNS40OSAzOTI0LjYxIDEyNDQuNTcgMzkyNC42MUgxNDU5Ljg2QzE1NjguOTUgMzkyNC42MSAxNjU3LjM4IDM4MzUuODYgMTY1Ny4zOCAzNzI2LjM3VjM1MjAuODhDMTc0NC44NSAzNDY5LjE4IDE4MDMuNTQgMzM3My42OSAxODAzLjU0IDMyNjQuNDRWMzE4OC45OEMxODAzLjggMzE4OC44OSAxODA0LjA1IDMxODguOCAxODA0LjMgMzE4OC43MVoiIGZpbGw9InVybCgjcGFpbnQzX2xpbmVhcikiLz4KPHBhdGggZD0iTTUwNCA2MEM1MDQgMjYuODYyOSA1MzAuODYzIDAgNTY0IDBIODM4Qzg3MS4xMzcgMCA4OTggMjYuODYyOSA4OTggNjBWOTY2SDUwNFY2MFoiIGZpbGw9IiMwMzE1MTQiLz4KPHBhdGggZD0iTTE3OTIgNjBDMTc5MiAyNi44NjI5IDE4MTguODYgMCAxODUyIDBIMjEyNkMyMTU5LjE0IDAgMjE4NiAyNi44NjI5IDIxODYgNjBWOTY2SDE3OTJWNjBaIiBmaWxsPSIjMDMxNTE0Ii8+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2kpIj4KPHBhdGggZD0iTTY3Mi4xMzMgMjMzOS42QzY2NS43OTYgMjMzOC4zNiA2NTkuOTYgMjM0My4zOSA2NjAuMzY1IDIzNDkuODRDNjgwLjQyOCAyNjY5LjMxIDk4MS45ODcgMjkyMi45MyAxMzUxLjA1IDI5MjIuOTNDMTcxOS4yNyAyOTIyLjkzIDIwMjAuMjkgMjY3MC40OCAyMDQxLjYgMjM1Mi4wNUMyMDQyLjAzIDIzNDUuNiAyMDM2LjIxIDIzNDAuNTQgMjAyOS44NyAyMzQxLjc2QzE4MTUuMDkgMjM4My4xMiAxNTg0IDI0MjMuNDIgMTM1MS4wNSAyNDIzLjQyQzExMTQuMDIgMjQyMy40MiA4ODkuODcgMjM4Mi4zNCA2NzIuMTMzIDIzMzkuNloiIGZpbGw9InVybCgjcGFpbnQ0X2xpbmVhcikiLz4KPC9nPgo8cGF0aCBkPSJNNzAzLjEwOSAyMzkwLjQyQzcxNC45OTEgMjQ5MC43OSAxMDA3LjQyIDI2MTMuMjkgMTM1NS40OSAyNjEzLjI5QzE3MDIuNzcgMjYxMy4yOSAxOTg5Ljc4IDI0OTAuNDggMjAwMi44NSAyMzkwLjQyQzE3OTkuNjggMjQwMy40MyAxNzgyLjk0IDI0NjguMTQgMTM1NS40OSAyNDY4LjE0QzkwNi4yNTUgMjQ2OC4xNCA5MDkuNDA2IDI0MDMuODYgNzAzLjEwOSAyMzkwLjQyWiIgZmlsbD0idXJsKCNwYWludDVfbGluZWFyKSIvPgo8cGF0aCBkPSJNMTI5OSAxNzM0Ljk1QzExOTcuNDMgMTkyMS40MSAxMDM4LjY2IDIxMDkuODQgODU1LjIzNCAyMTA0LjkxQzY2Ny44OCAyMTA0LjkxIDUxNiAxOTM5LjI3IDUxNiAxNzM0Ljk1QzUxNiAxNTMwLjYzIDY2Ny44OCAxMzY1IDg1NS4yMzQgMTM2NUMxMDQyLjU5IDEzNjUgMTE4MC42NiAxNTI4Ljc3IDEyOTkgMTczNC45NVoiIGZpbGw9InVybCgjcGFpbnQ2X2xpbmVhcikiLz4KPHBhdGggZD0iTTEzOTkgMTczNS40OUMxNTAwLjU3IDE5MTguMjQgMTY1OS4zNCAyMTA5Ljc1IDE4NDIuNzcgMjEwNC45MUMyMDMwLjEyIDIxMDQuOTEgMjE4MiAxOTM1Ljc1IDIxODIgMTczNS40OUMyMTgyIDE1MzUuMjMgMjAzMS4xMSAxMzY1IDE4NDMuNzUgMTM2NUMxNjU2LjQgMTM2NSAxNTE3LjM0IDE1MzMuNCAxMzk5IDE3MzUuNDlaIiBmaWxsPSJ1cmwoI3BhaW50N19saW5lYXIpIi8+CjxjaXJjbGUgY3g9Ijk4Ny41NDIiIGN5PSIxNzk3LjE4IiByPSI4OS4xNzQzIiBmaWxsPSIjMDMxNTE0Ii8+CjxjaXJjbGUgY3g9IjEwMTguNyIgY3k9IjE4MzYuOTQiIHI9IjMwLjA4MjkiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE3MTEuMzciIGN5PSIxNzk3LjE4IiByPSI4OS4xNzQzIiBmaWxsPSIjMDMxNTE0Ii8+CjxjaXJjbGUgY3g9IjE3NDIuNTMiIGN5PSIxODM2Ljk0IiByPSIzMC4wODI5IiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTMwMC44NyAxNzM4LjU4TDUxNy45NzIgMTc3OUM1MTYuMjgzIDE3NjQuMjEgNTE1LjAyMSAxNzU3LjMxIDUxNS4wMTkgMTc0Ni40N0M1MTMuMDQ3IDE1MjguNjEgNjY1Ljg4MyAxMzYzIDg1OC4xNTUgMTM2M0MxMDUwLjQzIDEzNjMgMTIwMC4yOSAxNTUzLjI2IDEyOTguOSAxNzMzLjY1QzEyOTguMDcgMTczNS4xNyAxMzAxLjcxIDE3MzcuMDYgMTMwMC44NyAxNzM4LjU4WiIgZmlsbD0iIzAzMTUxNCIvPgo8cGF0aCBkPSJNMTM5Ny4xMyAxNzM4LjU4TDIxODAuODMgMTc3OUMyMTgyLjUyIDE3NjQuMjEgMjE4Mi43OCAxNzU3LjMxIDIxODIuNzggMTc0Ni40N0MyMTg5LjcxIDE1MzIuNTUgMjAzMS45NSAxMzYzIDE4MzkuNzMgMTM2M0MxNjQ3LjUxIDEzNjMgMTQ5Ny42OCAxNTUzLjI2IDEzOTkuMSAxNzMzLjY1QzEzOTkuOTMgMTczNS4xNyAxMzk2LjI5IDE3MzcuMDYgMTM5Ny4xMyAxNzM4LjU4WiIgZmlsbD0iIzAzMTUxNCIvPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMV9pKSI+CjxwYXRoIGQ9Ik0xODM4LjE3IDEyNzJDMTU5OS40OSAxMjcyIDE0MjUuNzYgMTUxMC4zMyAxMzUwIDE2MzcuNTJDMTI3NC4yNCAxNTEwLjMzIDExMDAuNTEgMTI3MiA4NjEuODMxIDEyNzJDNjIwLjkyNyAxMjcyIDQyNSAxNDc5LjQ5IDQyNSAxNzM0LjVDNDI1IDE5ODkuNTEgNjIwLjkyNyAyMTk3IDg2MS44MzEgMjE5N0MxMTAwLjQ4IDIxOTcgMTI3NC4yNCAxOTU4LjY3IDEzNTAgMTgzMS40NUMxNDI1Ljc2IDE5NTguNjcgMTU5OS40OSAyMTk3IDE4MzguMTcgMjE5N0MyMDc5LjA3IDIxOTcgMjI3NSAxOTg5LjUxIDIyNzUgMTczNC41QzIyNzUgMTQ3OS40OSAyMDc5LjA3IDEyNzIgMTgzOC4xNyAxMjcyWk04NjEuODMxIDIxMDQuNUM2NzEuOTc1IDIxMDQuNSA1MTcuNSAxOTM4LjUyIDUxNy41IDE3MzQuNUM1MTcuNSAxNTMwLjQ4IDY3MS45NzUgMTM2NC41IDg2MS44MzEgMTM2NC41QzEwODcuMzkgMTM2NC41IDEyNTYuMzEgMTY1NS4zMyAxMjk4LjE0IDE3MzQuNUMxMjU2LjMxIDE4MTMuNjcgMTA4Ny40MiAyMTA0LjUgODYxLjgzMSAyMTA0LjVaTTE4MzguMTcgMjEwNC41QzE2MTIuNjEgMjEwNC41IDE0NDMuNjkgMTgxMy42NyAxNDAxLjg2IDE3MzQuNUMxNDQzLjY5IDE2NTUuMzMgMTYxMi42MSAxMzY0LjUgMTgzOC4xNyAxMzY0LjVDMjAyOC4wMyAxMzY0LjUgMjE4Mi41IDE1MzAuNDggMjE4Mi41IDE3MzQuNUMyMTgyLjUgMTkzOC41MiAyMDI4LjAzIDIxMDQuNSAxODM4LjE3IDIxMDQuNVoiIGZpbGw9InVybCgjcGFpbnQ4X2xpbmVhcikiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9pIiB4PSI2NjAuMzQ1IiB5PSIyMzM5LjQxIiB3aWR0aD0iMTM4MS4yNyIgaGVpZ2h0PSI1ODMuNTIxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9InNoYXBlIi8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxNy41Ii8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9ImFyaXRobWV0aWMiIGsyPSItMSIgazM9IjEiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuNjQgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0ic2hhcGUiIHJlc3VsdD0iZWZmZWN0MV9pbm5lclNoYWRvdyIvPgo8L2ZpbHRlcj4KPGZpbHRlciBpZD0iZmlsdGVyMV9pIiB4PSI0MjUiIHk9IjEyNzIiIHdpZHRoPSIxODUwIiBoZWlnaHQ9IjkyNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJzaGFwZSIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTcuNSIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJhcml0aG1ldGljIiBrMj0iLTEiIGszPSIxIi8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjY0IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9InNoYXBlIiByZXN1bHQ9ImVmZmVjdDFfaW5uZXJTaGFkb3ciLz4KPC9maWx0ZXI+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQwX2xpbmVhciIgeDE9IjE4MDEuNjkiIHkxPSIxODE2LjA2IiB4Mj0iMjc3My4wNCIgeTI9Ijg0My43MTgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzQ2RkY0NyIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5Q0ZGOUQiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDFfbGluZWFyIiB4MT0iMTU2Ni45OSIgeTE9IjE3OTUuODEiIHgyPSIxODk2Ljc4IiB5Mj0iMTIyMy45IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiMxMEQ5RUQiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMTBEOUVEIiBzdG9wLW9wYWNpdHk9IjAuMyIvPgo8L2xpbmVhckdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50Ml9saW5lYXIiIHgxPSIxNDYwLjQ4IiB5MT0iMjAzOS41MiIgeDI9IjE2NDkuNzYiIHkyPSIxNTM1LjkxIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiNGQTUxRDMiLz4KPHN0b3Agb2Zmc2V0PSIwLjk1ODc3NCIgc3RvcC1jb2xvcj0iI0ZBNTFEMyIgc3RvcC1vcGFjaXR5PSIwIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQzX2xpbmVhciIgeDE9IjEwMDIuNSIgeTE9IjI4MjMiIHgyPSIxMzA2LjU0IiB5Mj0iMjAxMy4yNiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSIjRkZFNzAwIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI0ZGRTcwMCIgc3RvcC1vcGFjaXR5PSIwIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQ0X2xpbmVhciIgeDE9IjEzNTEuMDEiIHkxPSIyMzM3LjE2IiB4Mj0iMTM1MS4wMSIgeTI9IjI5MjIuOTMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3AvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3Atb3BhY2l0eT0iMC42NSIvPgo8L2xpbmVhckdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50NV9saW5lYXIiIHgxPSIxNTQwLjM1IiB5MT0iMjQyMS45NyIgeDI9IjE1NDAuMzUiIHkyPSIyNTc5Ljc2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIG9mZnNldD0iMC43NSIgc3RvcC1jb2xvcj0id2hpdGUiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjREVERURGIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQ2X2xpbmVhciIgeDE9IjEwMjAuMzgiIHkxPSIxNDY5Ljc4IiB4Mj0iMTAyMC4zNyIgeTI9IjE5OTMuNjciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjc1IiBzdG9wLWNvbG9yPSJ3aGl0ZSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNERURFREYiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDdfbGluZWFyIiB4MT0iMTY3Ny42MiIgeTE9IjE0NjkuNzgiIHgyPSIxNjc3LjYzIiB5Mj0iMTk5My42NyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBvZmZzZXQ9IjAuNzUiIHN0b3AtY29sb3I9IndoaXRlIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI0RFREVERiIvPgo8L2xpbmVhckdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50OF9saW5lYXIiIHgxPSIxMzUwIiB5MT0iMTI3MiIgeDI9IjEzNTAiIHkyPSIyMTk3IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9IjAuNjUiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4="},Qwe={id:"InternetIdentity",providerUrl:"",transportType:Sa.INTERNET_IDENTITY,label:"Internet Identity",icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI0LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAzNTguOCAxNzkuOCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzU4LjggMTc5Ljg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDp1cmwoI1NWR0lEXzFfKTt9Cgkuc3Qxe2ZpbGw6dXJsKCNTVkdJRF8yXyk7fQoJLnN0MntmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOiMyOUFCRTI7fQo8L3N0eWxlPgo8bGluZWFyR3JhZGllbnQgaWQ9IlNWR0lEXzFfIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjIyNC43ODUzIiB5MT0iMjU3Ljc1MzYiIHgyPSIzNDguMDY2MyIgeTI9IjEzMy40NTgxIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgMjcyKSI+Cgk8c3RvcCAgb2Zmc2V0PSIwLjIxIiBzdHlsZT0ic3RvcC1jb2xvcjojRjE1QTI0Ii8+Cgk8c3RvcCAgb2Zmc2V0PSIwLjY4NDEiIHN0eWxlPSJzdG9wLWNvbG9yOiNGQkIwM0IiLz4KPC9saW5lYXJHcmFkaWVudD4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI3MS42LDBjLTIwLDAtNDEuOSwxMC45LTY1LDMyLjRjLTEwLjksMTAuMS0yMC41LDIxLjEtMjcuNSwyOS44YzAsMCwxMS4yLDEyLjksMjMuNSwyNi44CgljNi43LTguNCwxNi4yLTE5LjgsMjcuMy0zMC4xYzIwLjUtMTkuMiwzMy45LTIzLjEsNDEuNi0yMy4xYzI4LjgsMCw1Mi4yLDI0LjIsNTIuMiw1NC4xYzAsMjkuNi0yMy40LDUzLjgtNTIuMiw1NC4xCgljLTEuNCwwLTMtMC4yLTUtMC42YzguNCwzLjksMTcuNSw2LjcsMjYsNi43YzUyLjgsMCw2My4yLTM2LjUsNjMuOC0zOS4xYzEuNS02LjcsMi40LTEzLjcsMi40LTIwLjlDMzU4LjYsNDAuNCwzMTkuNiwwLDI3MS42LDB6Ii8+CjxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMl8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTMzLjk0NjEiIHkxPSIxMDYuNDI2MiIgeDI9IjEwLjY2NTMiIHkyPSIyMzAuNzIxNSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDI3MikiPgoJPHN0b3AgIG9mZnNldD0iMC4yMSIgc3R5bGU9InN0b3AtY29sb3I6I0VEMUU3OSIvPgoJPHN0b3AgIG9mZnNldD0iMC44OTI5IiBzdHlsZT0ic3RvcC1jb2xvcjojNTIyNzg1Ii8+CjwvbGluZWFyR3JhZGllbnQ+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik04Ny4xLDE3OS44YzIwLDAsNDEuOS0xMC45LDY1LTMyLjRjMTAuOS0xMC4xLDIwLjUtMjEuMSwyNy41LTI5LjhjMCwwLTExLjItMTIuOS0yMy41LTI2LjgKCWMtNi43LDguNC0xNi4yLDE5LjgtMjcuMywzMC4xYy0yMC41LDE5LTM0LDIzLjEtNDEuNiwyMy4xYy0yOC44LDAtNTIuMi0yNC4yLTUyLjItNTQuMWMwLTI5LjYsMjMuNC01My44LDUyLjItNTQuMQoJYzEuNCwwLDMsMC4yLDUsMC42Yy04LjQtMy45LTE3LjUtNi43LTI2LTYuN0MxMy40LDI5LjYsMyw2Ni4xLDIuNCw2OC44QzAuOSw3NS41LDAsODIuNSwwLDg5LjdDMCwxMzkuNCwzOSwxNzkuOCw4Ny4xLDE3OS44eiIvPgo8cGF0aCBjbGFzcz0ic3QyIiBkPSJNMTI3LjMsNTkuN2MtNS44LTUuNi0zNC0yOC41LTYxLTI5LjNDMTguMSwyOS4yLDQsNjQuMiwyLjcsNjguN0MxMiwyOS41LDQ2LjQsMC4yLDg3LjIsMAoJYzMzLjMsMCw2NywzMi43LDkxLjksNjIuMmMwLDAsMC4xLTAuMSwwLjEtMC4xYzAsMCwxMS4yLDEyLjksMjMuNSwyNi44YzAsMCwxNCwxNi41LDI4LjgsMzFjNS44LDUuNiwzMy45LDI4LjIsNjAuOSwyOQoJYzQ5LjUsMS40LDYzLjItMzUuNiw2My45LTM4LjRjLTkuMSwzOS41LTQzLjYsNjguOS04NC42LDY5LjFjLTMzLjMsMC02Ny0zMi43LTkyLTYyLjJjMCwwLjEtMC4xLDAuMS0wLjEsMC4yCgljMCwwLTExLjItMTIuOS0yMy41LTI2LjhDMTU2LjIsOTAuOCwxNDIuMiw3NC4yLDEyNy4zLDU5Ljd6IE0yLjcsNjkuMWMwLTAuMSwwLTAuMiwwLjEtMC4zQzIuNyw2OC45LDIuNyw2OSwyLjcsNjkuMXoiLz4KPC9zdmc+Cg=="},Jwe={id:"Stoic",providerUrl:"",transportType:Sa.STOIC,label:"Stoic",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABnCAYAAADov9dJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAACu1SURBVHhe7V0HWBVn2j23wL303kFARRGs2BUVFUvEHjWml01PdrP7Z9dks5tkY3p2s8kmMcmmmZhNUewFsAuiiCAoCopKLyK9t1vmP994k1+FJBYucf05zwN37jAzd+53vve85/3mmwE96EEPuhAK0+u1QBEwavJgo4SJkoTBfNtboZDsuGxj+vv/WyigaJYgNXAxl++OK1RSYmHy3jS+l+QNrgFXTZRbyCRbrbXqQYUCT/Jtnwtre/BLIEMF/P1xa5Pxg4qs+EbT6ivGVRHlO2LKUu7wDknyNK3qwdWjgqQtK0rZ86Xp/RXhiojyGj7bWq1o+kShUNxpWtWD6wTJWqdRWD5w9nBcvWnVz+IXieoVHu4ktVrGMIrGmFb1oIvAPJau0+lmlB1NrDCt+kn8LFEXIql5dw9J5gPN11ELSRmRe2RXnWlVp1CaXjvFBbnrIcmcYPsO1SsMIl/9bNCoTK8d4Ddi6m08yHLT2x6YEwpFsKN3QGFdaX66aU0HdMqi75gxVkqD1Vn+2du0qgfmhiRVKXTGvgXH4mtNay5Bp9Kn0Fs/3ENSN0OhcDFaKB8zveuAzomC9IRpsQfdCAUUjwMv/gQnl8F3xKSBSoXquOntNUOyUKFtUjD0YQGAuz2UlmqouV6chUiM4ueSZRYWna6/6PUn973o/eXbiS/Y2fIP28nb8rN/+NvF63/uR2xv1BlQX9WA7PQCpMSfRHurjmuvD0ZIk4pT9iaY3v4IcW6XwMGn961kNsr09pqg93VGzd8Won18P8DRGgqVEgonG6hLa6Cws4KSy8riar5aQ2lvBamwCipXO6isLWEsqoaFlyNUJNpQXAMNj6Wkq9FxX6teLlAYjdCV18PazxlSmw76miZY+zjD2NwGQ3M7bLmvBY9jyZ/26ka08e9KpQJ2ng7yOugNaCyrg47bO/HYGhsNLLUWqOX5tDe1wdrBCrY8Py23ba5tQiP3F3DlccU6iZ9fXVaLNu7v4ecCVw8H9B/cC8PD+yE/+xzqa5vl7a8ZkqK4vjRvr+ndjxCd4xIo5AHWa4eBX7LyubkwuNnJ7+1e3gSLg2fkZfUHO6HIKJSXjX+PgZFfDOyFra9sgrGgEsa6ZtS9ymW+6s/Xo1ws8+9t/FsxlwWauU/+P2Lk5ZrDOTjLYwqcT8hGzteJ8nKbqbEs2QlyY49h759X4xj/ZmAEaNhRKnPOY/ebWxHzt/WoZ6Mr2BHEz95P9+LbZd/jtOl8rbl/+o7j+PKvaxC3MgE6dgwrWy3K2LFWvbUV/35xHcpLauRtHZxt8dAzc+DsZi+/vw6EmV4vQQeiCGrVtaNu6RgY2SvVbFwZrOi6GwVb03H8491QMipH/s8tGPrAJBTEn8Luv0SjpqACIbOHYeZLt8LA6Nr0XDSydp2AR5Anlry2BH1G9sb2j3YhZgU7AMmb+7sZiHp4CrKSzuCzv0ajhCSPnj4Ij76yWCZ3xfPRSIw7Jn+uFaNz7l3j5OVrBf0BZagjOhAlQeFoWrx6UOKax/SFJXu95ki+aWX3w3WoPyqOFmL/s6tRdbIU/pNDMPXVJbBgQ+56cT0yNx2BI6Vz9vJFCJ42EEmrEhH7923Qtegw+cEIzCa5RZklWMVILDhRjNDw/vgNSbR1tMGXL2/EvvUpcKHkPUJ5D79lCGK/S8Knr29GHaU2ZFgg1OoOGeVq4Gx6vQQdpU8BW9PiVcNoZQFJrYQ2rcC05teB80BfjH/jNtgydx16bTMyvz0IKxdbRLwwH6ELR+D4+lTsWL4RTVWNGHn7WMyiVNcwB64mMTmU08BhAbjnzdvgHuCG6Le2YBdl08bBGnc/Nw9TFo9G4pZ0fLZ8A6qZK6fx/cN/nY/aygbs4Xq2n5zLrhWSQvZcHdAxoiSpMzm8IkimnqSsb5Fffy3UZJVAzU4zclkUQu8NR96uTOx5fi3qaVRC5g3H9JdodGgcNv9lDU7vzYJXsDcWMWL8GYlx7+/ATsqmit9lPiNrxgMROJFwCl8wT5VRNsdGDcXDy2+FnvnuQ0rhIcqmP2XzKe7fu7+X/PnCvHQ1rpmUGxkVafk48Oc1qDlThoDIgYh4bbHsIncz+Z9i/nL2d8OsVxcjiOXDgS/iseOfsbLRmPLIFMxkTso/VoivGV3Fp0oxKGIA7qNsWtlosZLmYz9l041u8RHK5mjK5lbK5krKZisd5xDKvrlwUxLlP2sIrGj3DzGfnFqTDBs6sQjmk2CaiIzow9hFB9lKZznq7nDMoFOryq9ANPNZPgkWZuKO12+DC8mIpmzu++4g7Ojo7np+PiYuHImEDan4grIn8tGMpWPxIGWznLL57nNrkJVuvrx8UxKlYcOOZAMGM/8Iex7PSGqkDQ+5dSQiX1iAFtZHWxlxOfuz4c18tpDE+IT6IPadWOz9bJ9cV83/YxSm3DsBxyibq15YiwrWWePnhuE3dIsiej6ibKZSNgMom7/n/sGUzRQ6S3PhpiSqmHmjLqccgXRkE2ijBfbQmp/ZngHnPu64hfkkcFwQEj/Zgz3/2i6XEFOfmIbIxyORk5KL70hC6ekyDJkainsokWpLFb58YR2StqXDs5crHuW6sInB2LwyHl//Mwa6dj2WUDajGGHmwk1JVHtdC5IpT2doo8VIxURGQV+SlvHNQex7fYtsJEbdPxGRjJpyErKWslfEvBQ0NghLX18Ce0pl9KsbkUjZdODyXS8sxNg5w7CPsvnVa5vQyIL6FsrmfZTN0vxKvMv9s9Ly4OrpYDqDrsdNSVQgLXjQ4lHIoV0+8NJ6NFfUI3TJaETQRjdxOeYZ5iMWsD5DemEBbbgodmPf3oaElQnQ2mox/9k5mHj7OKSxkP0PZbP6XC0mMD/d+/wCNJGkj5iPjlI2e4f64imWAX0pm6veicNO5i9z4aYkStIbEUjjME6MPrQbsO+5aOQy17j088QMyp7fqN5IXLELCSt2yqMLkU/NQMRDU3CG5K2m7J2nbA6bORh3vnxBNr96PhopcRnwpmw+RNkbRNnc+OkefEfZNBokLKVs3s6fmgoxlc88uCmJyll7GLmb02Dn54wJrHkCI0Nx7Kv9SBSjD606jH4wAhGskc5llmADZasksxj9JvSXh5CsHW2w9uUNSKJsOlM27yLZI2YOwW66v2/e2IKWxlZE3TcRdz4dhaKzZXiPNj6bsims+aLfTDKdQdfjpiTKlgSdXZeCQ8s3orWmCaF3jEM4XWA9nVucyEc0DL5hAZhH2XIJdEPsm1tw8OtEWDtYY8Fz8zCWsplK2fyOsllHqZxI2bxLjD5w+d90iycYeUGUzSfp9noxSr+ibG6gbOr1BtMZdD1uSqK8wvtjNG14e0MLEphPCvadhNsAb0xjw3oP7YX9lKyDH++Ri+BIRlb4/ZOQnXAK0X+NRkVBBcKihuF20+jDKrrFdLpIX+axhxlxA1hnrftwF9aaZPMOFsiLHp6CoyRvHYtnc+GmJErAgfkknA3rM74fjn6+D0n/jIWRPX70o1MR/tvpKDlagM2MjrKTpQieHIJbX10iX5ta+7f1SNl0RC5471y+CEMom7tWJWI1ZbOtRYfZlM3bSW4uZfMDMTZI2Qxjx/i9+KwAN9Ondz1uWqIEVJZqDKINH0MbXpNXgR2UvdK0fPQa3QezacMdvJ0Q99pmJH+XBFsWyfOfn4+RC0bgMN3bmpc3oqG6ERF0f0spm5Ul1fiExJw8nIN+wwLwBN2iN4lZSdncQtm0o2xOZAlgLty0RLU3tKKYcladfQ4ezCeRlD23YG/sZ2Qlf7ZPvgocuSwKY+4Nx0lK2/oX1qKaOWzEvOFY8reFaGOt9TUdYMbeLPhxvwe5f18eZ+37O7Dh493ypYw7GVnzH4hAKj/nPXGtKv8XJ7xeM25KolqrGnHgme+R8cleHGRkpMr5BBjzu+my9BUyKsQQUvmZMgRHDsQCWm6Rr9a9sA7p247Czd8Nd7yyGAMnBmPHynisNw3azuW+iyibZ+jyVjC68k+VYkTEADwlD9pqsGvjEdMZdD1uSqLKDpxG+0WXWkqSzmIXZa/8RDECwvthFqPDxsUWcSTxyJpk2LnZY/6LCzFszjAcik7G+tc2obmuGZPvDsfiZ+agjJHyKfc/TdkcMKoPHhfR6eOMLyibsbTt4jL8o5TN8BnXNYvhZ2EeolRdfz3mamBhqzUt/R9aaNMTmE/SmU+09laYRhs+4vaxyIw9hk0vrkNdWS1GLhyJhfLoQxP+I0bDE7PhH+qLB0hMQKgPot+JxVbToO3df4rC7HsnIJmF9AeUzTLKZh86S3OhS4lS6I3yaz3rlvaBvvLyrwEvSpYbbXgHSMDp7ccRS8tdLeZOMPnPeXmRuFiKdcwxGdsz4EG3eDulLHhsEOI+2YPN722X/z7viWmY/3gkTrIG+5i5q/B0GUZNDcWTlE0LSxVWUDYPswwwF7qUKCWrdte3Y+UpWToWggJifl93Q6lWIoxOL5Q9Xji/y1FfWoO4F9cjQ8yd8HHC/JcWYRBl6+A3B7HpjS1opZGYQre44OkolJCQlcKGMy+FkrxH6BYdKZUrX92InZRNJy4/+sJCRFA2s48XmT6h69Hl0mdFHXd/ZjU0fBVo+v0MGHq7y8vdDf9pAzGBPd4xsGN9YzQYkR59GDHLN6KRNnzUbWMw7y/zUF9ej2+Zj7IPnUUgXd59b9CG9/XEmre3Ie7LBHm62D3PzsF02vaDccfwMWWz8lwtIimbt5Jcc8EsOUrMmXBkZNl+ug8SbbDBFF1QmicldoZzB87gzLoU2LjbY6K4ujt/OBSdzGUQzm8DpeyUmDvR3wtLWbj2HhGIWDrFbfwR8x/mPzUDsx+aghMHz+BTymZJTjnGzhyMx0yDtu/LU8YyYN1JbuwqmLXltNRs+2fXQEX5END9aRYTyLXPRrtSFNBiZ3y0Sx7nE6MRYqZuyKJRmPzCAth6dLxmJAZqE76IRyxtuL5dj8iHJmP2UzNRmFmClYyugsxiDJrQHw+RRBtHa3zx8gbsXZ8iz5599KVbET5zCGLo/jZ+td90xK6H2bu4klJi88omWK5OhsTeLfX1MP3hwos5IFHWwliMDnowArrmdiSTgNydJ+DMz57x2mL0nRJi2vJS5Kfn4zsSk0fZ7suoupduz93fFavpFnfSLdqSpHvlKWOj5Cljny5fj5qKesxYMhqP/GU+1GbMx13fXOy9HcCGs9icBks6IwX1XEBJe6twuuYphD+LgLlhcAsLwLnkHCSwsK0vrIK934V5jWqNBUY9MAmTn54FKwcred3FaGlowVba8J1i9EKjxkJuN+P+SchIOIXPKHtlhZUYHzVMnjKmazfgA647tDsT/pT32XS75kKXEmW01qBo5UOoe2AiJDbI5VDkV0L1/DqAeg72bkVvJnmRNrq47NIzisSU5vT3d8B9qD8m0xC4Bnsjd08Wtjz1NcooZT7D/DHvjaXoNTzQtNelyIw/iVXMXcL1DZkcggdeWQwN8+3nNA/72encfZ3xmJgyFhmKzZS8lf/Ydv03CPwMupQoifWEiKgm1hdVry+G/geZuxgt7VB8fQDSa1sgiTslrCyhZXTBRmPa4PqRuyFVntIcRhMw9NEpMDDvHHw7Bmkr4+E7ojfc+3nJtZEYNpr6h5mY+OBkWLCIvRx1lO3vacMTxNwJVzv5UvzEBSPkKc2fv7wR9XSLt9D9PfTcXJxnwftfl6M0J0thdLFD7YsL0MIk3pkcSuzV+mWrYUg6CxVtsKqXizyfuivgFOyF8W/eBs+RvVF2JA97mXfqCqowkbZ62N3j0cKev/PVzdhEWRQTXfpNCpZnynqRwMshGSUc2pKGLxlJVWLuxLzhePDFhWhpaqXsrUEqDVMgo/UPzGcDmdfMBbMQZZWQDefn10LFwrJ1wXA00R4bvTtxe81t0H2wE238kbisdLGF3SNToLjOpOxGORO5KOPTvUh9Jw5uob6IfGMJ3Pmax1wT89watJKsSU9OgyUjWdRO1k42mPfXeRi7ZAxULJgvx/mCSnxOG55M2fZiXfbYK0vkKWMbv9iHVcIt0l2GifvBzASzENXIKl1izeT417XQxhyDgV+shYWnYcagTvORnlHVyCJZzyjT0AYrHaxNf7k21OeWy1Oaz6fmIeyJaRj+RCSdoISkf23HYZIXMD4Is+j+XPu4I5MNv+7Z75FA8yCu2Ibx3Bf/7VY4+ziZjvZ/EFd8d3xzAKve2IJmmo4oMWVs2Rz58sY/ef7Zpnu/zAGzEKVn9FQvpzxEDYXVd0mwfnUTFA2t0N8TDsMzc6hNHR9AJvJVAxugiTZYYoNY0KU5Lh3DM7x6OSxjYWrtYY8JYlRhbF+cZ74So+dVLG4n/jEKI++biPbGVux4fQtSvj2IgayDJrF2EjKXJ+bnUYbvpHkIY1HbWcfKY4dawY6QkXQGfQf6yjNl+4T64BDNirlgFqJsth+HmnLSzHqjgUWmkknXij1OtT8b0iBfSMwfCjZgB0j0Gty3mpZXx5xiN3sYlJ0k+V+Cz5RQjGA+EhcHj69MwKG3t8lTxaaTOC/mwwI28FYW4o2sgWaJq7qsgxq4vP6l9dj+/k4UkFhxN0fEneOx5Nm58tzzy9FKqY7+cBdWr7hwx+MdjNyZi0fLy+aAWYhSM+k6PxcN7Y4T0Ad5oOn1JTCM6Qu1mFBimkKsYH5QUZIUtPSXQ8/cVsnkXU8bLLbVBnnCadaVX+a2YUTX5ZxHohjuYXSFMe+NpgMUZiWJ+fDAil3oNao35vK83HlsccfhOm4rLg4uZn0UQOteTjnLOnAavUJ85MscIWODTEe/FBmHzuLdP6/GWUaZRydy2VXokLUdvAOfoFZf0ywNib2/gXKnG+gHZZsetmsPQ0250Q/uBSPzgqK3O1SMGAULRLAOUdGVqScwATN6JPboS0CC2jJL0JpVAivKij2JFr1Kx07QcCQfHswlzSSj6ex5eFGiGug02yob5EscZYnZOEoTYcvPGPPMbPkSfOWJYiS+uRWNjPRw9v5QcZ6Nbdj33g6c3HkCA2cMxownp8tDREfYQbazDhOzYvuGBcLKViPPPnLzdkI+z0fkqovR1qpDOklt4fEEWYk7jl/P1LG2+tL8N0zLP8IsRCmp9bohfjCEeMvjfZq445Dc7CGNpH2lFVbmVgDrUoDaFqiHB8By8gCobLQwnCxh1XzpPb/6qkY0xJ+Cyt4KVgFusKQMGepb4MBC9qeIKqc5cR8WgMEPREBtqUbWNwdxbNV+uA3wQcSy2XDhcYoO52D332OgY103jbVUCIvaJu4fQwd3mtI4hvXSjIcnQ6VS4QA7nIi2YNZgQ+jsygur5KGjy1GYU4792zOud35f9xHlSEOgqm6Cjr1QFzEA6vN1sIw+DAV7M9iACkEW6yxpazoMB85ARfdlyW01o/rAcOY8jJdV+GKKclNaPlrzK2HHHOM0uo8cXT9FlBMjyIW1VENBBQ6/uQVVp85hKA3EkNvHyh0h5fN9OMbzCeDnTXv6Fjh5OiJ7bxa2/ytOzk3zWID3ZwRXsYhd9/dtyDtWCG8W795UBC0L9KHh/eWR8nx2LONlHasL0H1EWZyvhwOrdDUjRz/EH/pwyhudlDo2A6q9JwF/VyhJjGocDUVGEXRiUojBCA0LRmtGlzBaOjHiflkbtFP26mhINF6OsOKP1s0OOnYIZ+aUi4kSdXPepjRkfLQbNh4OGEdj4cEaqpLbJNBZ1pfUYPxjUzFkXhj0jKh9zFkZcccQShNyy+9myOYhLSYdsVxv52yDJZTPvpTvEsr4Ftp7Vy8nhPL8B/KniB2l4bKOdZ3oPqLE0JG+vxesd2fRUByH0dMBRn4psCcq+cUUayl7bCAVC1MLEqNkL24nWbr0AlgyeVsxYqyY59pPlcLY1GY6+gUYmftqKW2CICfKpgvlSBB7MVF5lFVBVL9bR2II5ctSa4ms75OQTgfoSvMwWeQtRnEJo3TnW9vQSimd/tRMDIociGaWCTHvxuEkO8SouWGIenQqrGh49lP+tjESxdXdIex4IrJs7awwkuogorSQJDKtdgW6jyhL9nxxVbc9Ihjq0lpoKTNK5hqjGADlF1OIUetN6ZCSc6AioRZ0YJaURD0dVIu4s5yNYM11dtxfYr3TntdxvlwLZbCa29sIOXKxhRV7vo4922WQH1rL6tB34Uh4k/DGomokk4zy40UYwgI17O7xsmymfLkfR1jj+YUFYCZrK2cfZ5whOTHvxPKvEuY9HYUQ5qMafhchf2fT8zF16VjMooSqVErEUd73bUyVIyuE5x7EeiqPnaXlso51DeiUqA7lnN+IyZkkqvMLNr8AAx1T6Yp74fLvvVCxzmh6MAIKOy20bFDtFwkAe6bxsSlQkhwVG1OiNEkFlbBkz9eSYBVzUevqQ6ylMqChVLnQVluyOG47WoDyT/fBUNdRYsRVW2/WWwE8hpoNKHqeIEI836hgWzpOM7ocKLsjKXX2zEU1lNRkOrp2OrQx909EH9ZzehbjiZ/HI+9ILgZODsWEO8dBQxNylOeRyPNxodub+1gk3OnoymgYNnL/Rp5LFEkfPiEY+jYdNBoL+XXLfw4g+TomuUiQ6opS9nYYbzNLRClYaIqiV7srE0Z+SQN7nZFyoaaUqdhwCp0eCkqWWsgeG1S3PhV62mcLyp2WDaehGWhhLmtkQ6mZh2y5rQMlzUC5a2OCvwTcvyH7HGqY8N2Y48QYn5BAYc9LGCFBlK/hlC9LdpIsylfqZ/vku+Kn/pl5izJYwv3iaNubWJRPpz0fSmPSQincxnrvOA3GyFlDMefxSFnmEjekYjNzlBsJu4fy2ZsuMpf10xdvbMU5djhx600oIzSJ5Uc7Jfoa0X3SZ6SOt00aAIvCSlizcRSUJAPzCegAlTYaKDYcgZSaByWdmZryZEEnp088jTa6QCWj0orE2HB/gzAP61NYO9XBNswfjpQiLYlvYn0lhpkuRrv4DDaOeGpLHolvpDSO+OMs+HKfJspvEuXrHHPSkDvGYhTlS8noS12ViMPfHIAvO8gty6Lgxsg7y+jf+o8Y+fE78/8wC4PYQWrL67D27RicOpyLyYtHYc4Dk2CpUWP7t0nYStsfwO8x796JclQJidpPYyJqq2tE9xFlwxrF6G6P9gn9Ibk7QLvlKNQsCMEEDuYeBW2xIiUPxk10e/zCFiP7QEsSUdeCFhKrZwFsRSdnyyjUkJh6RlY9I0zj7wIH9lhnrm8rqkK7sPsXQcvP9OCxxRSxoEWjYMNozI/LQOr7O6BhHTaB7s+X+aSG8rWHtr2CxmY8G33UktHyI932MVpSGDX9x/XDvD/QttMxHmN0bGJ0WTJvLqVtD6E6iDrq67e2yjlpzj0TECWu7DKyT5BILz8XJMT+lxBlt+0Y7Flk6nnSeha5BvZqNaVNzZ4ubLiCEqUSNpzLBjpAIyVRTROgHRcESzrGVjZO087jsKDECNmzF8Qwt1SxEYULdAgLhCtNiXi2USMbSwymigdUBd0TLj9fwpo/OuaQ9He3o5Dy1ZfnNJrypaV8ZfEcDn2yFw40D9OfnQ2vAd44R/mKpfzVs6yYLkbbuX0bc1jMBzvkp4uFzRiEBU9Ogx2j/SDNzvqPdslPERM3WwsTIeagf8H9W5rbMZTyZw6izGImLKjxTkz+GjqltumD0MZCUxSSmhhGFh0g/JyhZMOpWAspWODq+cWlhjZY3zsBVmKoiY3U+EU8WhiZdlNC4MrkLnJPPRutnE7Nko0U8PhU2AW4Qc981EQSHYI85Ad/iJ5Xw9rs+Ac7YWmrwTCaCGHJW8pqkfLhbtQxEgfTeAyMGgYxUTSNtj2Lx/UfGiA/sMqGkZeXkos9/HwxZ2LWI1PhTzIbGL1baCJKc8sxacEITGLug0HC7rXJSIw5hiB2tCXc34Hm5+XffoVrvSz/U2aia4nilyz96D65scSPDd2PjbjsTuvc9kQklGxYNRtKxQYDXZ+KBFpMHwgV3ZLu64NoZ+/XsEfaM4dYsJFbmbdqmQNUjARPNriNqM+Yb0o+3IVWHsdr3nD4zh8OFZ3fD58pfs7SeYnn/IXSlVmQ4MJdJ5DJfCKmio3hcVyYi2rzK3CA59FMEzGa0iWGkAys7RKZt7ITszGAKjCFsmZFY3SC32MPc5kofhfQ/Ykb1ir4+evpWqvO1+EWfo9xrMGE2xQNuvzJr9DQiUO9EnSL6+N+qGe1b30kD2rmGzGEpKeLs2QPtxSyJ4YMRI6KCIGS5BiF7LFQVLPqt6TsWQS6o435qGVPlnw9yob72zFftFGaqmgqhGzaUzZdhWxS7sqY4+ro2hzovixttXJDiR97NqT32CDoGZlp7+1A/o4T6EP5GvPb6bBm1J/cnIaDbGR7EiceseNL+SqjfG1j3hH3SE0To+3sBPrWdmxbsQspsUcxbEooFv1uJhydbZHE9+tMoxb3L5uNYJohUfAWM9rEoOxuFtuXD9xeBcyfo8RNAs10SUZKmsvyjVAKstiwetGwaiUs1qVeeAImayQlI0cV4g0jTYI+7jiUlC0xhGQlbDi/cMO6wzCyoW3oFh1IrIr5r2rjETTSudmG+MCZbtGBbq364BmUUnpEBNqz+BVECZmsoGwe+XsM9KznRtEY9KaENlc04MDbsSjgPoMXjsB406hFKmulxJUJ8GDEzmXDe/bxkOf4rX9zG5op4/NJ0IhpA+XR9DUsiMUzJiZQ+haRUGvmyV08163/OYhZS8fItnzP5uu6T8r8RAkoKTmtJMHA6LCl3Fgm58LIAtdINyYGZFVsJAVtOFgIi8scYggJlI925i4jk7mG21iTLAsXOzRsSUNT0hn5epQdI9GepDXQWVUwIlSsi5y5v0cEC042YBGNRgMJdg71g5qkNlMixdDUyD/MhD07jjAVSe/GyesiaMUDeI51RdXYSdtewogfd9d4hN8dLgd9/Jf7kcjc1YcO89Y/0rb7OsvXptbQolOacMfTs+RR9CrmvVW08qfSC3AHazAff1fERifLo+jXge4hypL1i0FYc0aHbkwfWPJLaMWgKyNKYsOCuUDJSAFtuJRbAdUQf1iKYpgOsT02A63MBxb8wtbc1pay2cpGrCUJogXtuc6Z0SWx15Zx/0bKjSNl042yac+OUbYnE8Ussm08HeBJt+jJhhb11hHa8zN0Yr2nhmL8UzPk+3VP0tjsZ64Tk1puYfHai8cR89C30L1V8DtMe3AyxtN0iAeKbKOJSGKnGTIhGEu4v7iDI5kGZPV722HDDvcAo1A8s+8oO2HsmkOmlrhmdA9RAlrmKEWbgWT1hk6MPrCRNcxHShaqYD4Ql+HFMBJ2Z8HAL6wUT1DmtlrWXUa6wKZ1KZCY2K2HB8KB+wvHWM0c1UTZtA31gZMwHJTN6viTKGOdpGXDubJjiAHZpoJKueAVt4eK2UcWrH/E05uDZgxGX8qXmI++/504+clig+aEYRLNhZbRmUri4z/fx6LXFfNJnG8/LxTw89YybzXwWAsYMaPFqEVDK6JZVx1hpxg/ayiWmEYtdrMzbaXh6IKBWfPb88uhp7tqpo0Go8UirwJa9mBFTTOke8ZDxUYV44HGlfthYE+0YF1kQ+kRstXOOqqBdZiakenGhhCP0daRgPPcX8dG86JLcxfzxymzRV/tRyUb3Y22vp8YHaBLK4s/hdNfJ8pPaf7BnoseWUlTksTaSutghXAxdscCXNwrlUBjUMvX0Sx8h80cAmO7Hge+PYgMkhE0vDdmsii2ZeScOnQWseLWG+alWx+lbedxxaO1o2lMhJHoCnSL67scwkxo2GiSpVq+zCEJ2WtogXJNMlBYDeVQf6gpeypvJ+hoCNoTsqEOdIMVt7Ue3RdtTOh1dHbibgw7rnMSsseC9zx7fzNl05Gy6c5cYcuOcI6RdY6yaUfZ9OC2YvZRFSP4jCiSaXLcgr1gy0LYhrI3gvWanZsdsukwxaV4UQjPWjYHvSmVFWzwTZS/c2fPI/L+iZi4ZAwkgwExrAv3M6oH8fNupzlxdnfAYdp+8Twk8TzZLkT3Sd8loI1WHy+CSowgDPIFaJsVQvZ2ZsK48wSUPs6wGBkIDRtAjFA0CxvOHi3G++xJrIJSInJU84li2NDlOZIAu2BvVFE2y3cehxUttguJ8aBsNrJx88QQVIsOHpTNXhGUTQs1zpDsc2kFcKdb9KT0ilH2wyxoT2xJx8BZQzDl8WmwJllpzKW7P9kjz+lbKPIWbX8RozD6rW2ooeFZ8MR0jKPcyfLHgvoQZVvcENfF+JWIMkHJXqcST4hkHaNgw6rYiIqSGuiZfKXaFliwN4vxPuHmmtlgrcxzGhEFtOG2rFMaWfxW0wBYcH9Hkug2aQDauH8xiWmvbIQLifGmnGodbVBAV1iWnANndghvukUvOslS2vVsEmPB44uJl14kLYDH6RtOguk2t7+9Dbl0lKMXj8IU06DrfrrWXSy4/UnY7cK2M1pP8rjf0f2Vs+A1E35domToDVAcyYeisAqKYf5QmWTPQLuuIxFqNqCWJFqxcdtS89DASFCywWxH9oEjTYWRUlpOYlq5v5jc4sb9rbn/OcpmOWXTjrIpZM+TbrOSbjNnYyqUKhW8ua43O4G47J7JmqeShsWHLs+Rtl2s2/rSBiiUSsz+UxT6ctsqHn8jTUQxVSDyvkmIYH0k7rmKodmI5/7iZjcz4gYg6gewxpFIjJKNrGbDCHtuPHUOreISPaXSig7OVhTJtNa1lMJWSqLNID840IaLYaRqWvBKyqYVJUpcinfn/g3cpoDbCiPgTgPQy+Q2T3OdmCrmQdnsRbfoTtnMZS7L3n4cdjQrYkZSv3H9MHD6QPlGtXR2mh00LY4ejlj07Bz4M/IKs0qwhsQViX9RYX7cQEQJ0LEZ6fYkFqsWLGQ1Eyl7tlq00Fq3MRo0bCAbNqwNc0rj/lOoicmABY2AA4l1ocSJsb5SRpd8+Z37ezFixIT/AspmBWXTmbLpzSLbk5FXzE5xmgRoSYQfiQ2ibNafq8VRdozG8gb4U3YtaHhKSYi4M37k/OGsoyJk+Uv47hB2fpWANlr8bsINRpQJEm27gbZX1dsdGpKgZU5qp+w1bqDsMZ+I8T4HkmCkLa8U+YjRaM/Gd6V5sKLzKtt2FBUHTsOO+7tzW0+SU8H9cymbKja0F4kJ4P7iSS6Z3L+2oEq+ia0Po9CJEZ0VdwzZzJ2uAa7wZecYSnvuK8wK5W89oyiHzrObcWMSJSAst461ECh1WjasDW24+PdDddGH0cZ8Yj3YD/Z0hdaUqRoxN31PFqz8nOUhJHfKVj2dmRhCEnnEnbLpS9kDLbl4uGIVJdGDstmLbtO1rydyWKOdplt0oGz6CzPB41acLpMnYvpRHsU9CWmMvjjKXzNz4q+AG5coGbTheuaA9qMFsGSPtmZkWdPtNbG314lBVzd7eQjJiZHUyig8J5J6YxucKXueJFYMxBZS9irT8uHMyPDi/m5s+GLKZg5lU8xS8uX+fSib4kmYYgKmuKHNn/sHU3YFSWK6s5gpe4qdRtyR+CvhBifKBDFLtjX+JBSULRu6PXshe1xX+X0S2mmj7ZlPRI4SD6Evo92uTjoDuyBPuNEpurHRK2mx82nP1ZRNLxLjz/1bq5twksSIiZc+tOp9SLa4xNFMW+8j6iq16seZsuKmtl8Z/x1EyaDza2OR3MYIs6Js2VO2rElGbVwGavZkwor1jBNJcKXZqM8oQjFlj+cMN67zYXSJSZriAcC1Z8vgRhvei27RJdAdZymbOZRNZ+YjP1EQk/QfZ8rGHpNHMG4A/BcRZYKhogGNCaegdrK9MIQ0KRjtTPJl3x+CkQ3szHzkIWy4SokiusWa44VwDvVhHdUXriHeKKYNz487DmvKpg+3DWQkGtt08oN/xc3VJXSH4jJHVYHpn5LdGLgyohx9eot/MfrrPLyoE4jLFE10ce3FNbCjbDnRrVl5OeD8xjR5pqxdfy+40um58G8VlMHCrUflq73iRmsxhNR8vg6nKHvinl0/EuglRu953JSVCUgj4fprn39nLlwZUfbegfdQRX69Z7j9BNqZX+oTs6H1cZaHkFxJWCPdXgklTgzaihzlTdkz0GDk0GjU03C4D/GHH12dk7g0T6nTkMAqymn8m1txnjXTjQiFhKa60vy3TG9/RMeI8g5YRME33z9Cug6ICSt1jBo9bbMj5cudEaO2tpTH+2qY05zp3DzH9oUTo6xkdxaKmM98RL1EosQl98zoZBz5PF5+ZMENjBIS9b5p+Ud0lqPE9egRprc3JFoYLbWHc2DLIleMnLvSHdZlFCKfdZPG0Voe7/NjPvOgHNq626ORdjyJxWtJSq5cBtzIkKA4VF+a963p7Y/oKH0+gb2u9//wdgeExFXRaIgi14VGwZPEeFHmxOQWQZYwC+KRpPmxGTjywU75yu5/CVZ39n94O1zh7ar/bN2d0LIm8poSAsdgL5kcQ0Mr6s+cRwlro4bLbyq4wfFT/9m6A1ECvUZMPk356/w28B6YDxKKC1Mn+AMvdSjohFJ0AHVyhWmxB90ICdKHnZEk0DlR6uZP+LvU9LYH3QFJqlLqjB+Z3nVAp0QVHzrUIknK/zG97UE3gDloWcGx+AtPnewEHVzfD6DzyLT3DghSKBTmezx+Dy5AkjYWpu79s+ldp+g0on6AXrJ5WJJw3VM/e/DTYPseVUuq+8TihTWdo1PXdzF6hYc7Sa2WMQoFxphW9aCLQPOQrtPpZpQdTfzFf5PzsxElUJiYWKOXrKdKkvSNaVUPugAMn3UahSbiSkgS+MWIuhi+I6Ys5Q7vMLpMT5zvwTWggiQtK0rZ86Xp/RXhqogScAuZZKu1Vj1Isp7k2z4X1vbgl0ByCvj749Ym4wcVWfGNptVXjKsm6iIoAkZNHmyUMJEJUTwqsrdCIdlxuePjLf+fQQFFM/OPmJCey3fHFSopsTB5bxrf3+BDwj3oQQ960IMeXC2A/wUW2l+G9AEKWgAAAABJRU5ErkJggg=="},e1e=144e5;function t1e({selectedSigner:t,clearSigner:e,signerClientOptions:n={},authType:r,agentOptions:s,onConnectFailure:i,onConnectSuccess:o,onDisconnect:a,realConnectDisabled:l}){const[u,c]=W.useState(null),[d,h]=W.useState(),[f,m]=W.useState(),[g,x]=W.useState(null),w=W.useCallback(async()=>{var C;const S=async()=>{var T;await((T=t==null?void 0:t.transport.connection)==null?void 0:T.disconnect()),await e(),h(void 0),m(void 0),x(null),a==null||a()};u!=null&&u.signerClient?(C=u==null?void 0:u.signerClient)==null||C.logout().then(S):await S()},[u==null?void 0:u.signerClient,e,h,m,a,x]),b=W.useCallback(()=>u==null?void 0:u.getIcpBalance().then(m),[u,m]);return W.useEffect(()=>{c(null),t&&!(u!=null&&u.signerClient)&&qwe.create({authType:r,signerClientOptions:{...n,crypto,signer:t,idleOptions:{idleTimeout:e1e,...n.idleOptions,onIdle:async()=>{var S,C;(C=(S=n.idleOptions)==null?void 0:S.onIdle)==null||C.call(S),await w()}}}}).then(async S=>{if(!l)if(S.signerClient.connectedUser)h(S.signerClient.connectedUser);else try{await S.signerClient.login(),h(S.signerClient.connectedUser),o==null||o()}catch(C){await e(),i==null||i(C)}c(S)})},[t,l]),W.useEffect(()=>{f===void 0&&d&&b()},[f,d,b]),W.useEffect(()=>{if(u&&d){const S=C=>u.createSignerAgent({...s,signer:t,account:d.principal,agent:C}).then(T=>{x(T)});s!=null&&s.agent?S(s==null?void 0:s.agent):po.create({host:"https://icp-api.io/"}).then(S)}},[u,d]),{agent:g,user:d,disconnect:w,icpBalance:f,signerClient:u==null?void 0:u.signerClient,fetchIcpBalance:d?b:void 0}}function n1e(t){const[e,n]=W.useState(t??va.SYSTEM);return W.useEffect(()=>{e===va.SYSTEM&&n(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?va.DARK:va.LIGHT)},[e]),e}async function r1e({url:t,crypto:e}){return new Bfe({url:t,crypto:e??globalThis.crypto,statusTimeout:15e3})}async function s1e({id:t}){switch(t){case"Plug":return new Ufe;default:throw Error("The extension wallet is not supported.")}}async function i1e(){return await I7.create({authClientCreateOptions:{idleOptions:{disableIdle:!0}}})}async function o1e(){return await T7.create({})}const cN=class cN{static async build(e){return await cN.builders[e.transportType](e)}};Vt(cN,"builders",{[Sa.NEW_TAB]:r1e,[Sa.EXTENSION]:s1e,[Sa.INTERNET_IDENTITY]:i1e,[Sa.STOIC]:o1e});let vI=cN;function a1e({signers:t,transports:e,closeModal:n,crypto:r,...s}){const[i,o]=W.useState(void 0),[a,l]=W.useState(void 0),u={...s.options??{},crypto:r},c=W.useCallback(async(h,f)=>{var w,b;if(!e)throw new Error("Identitykit not initialized yet");if(!f)return localStorage.removeItem("signerId"),h(void 0);const m=t.find(S=>S.id===f);if(!m)throw new Error(`Signer with id ${f} not found`);const g=e==null?void 0:e.find(S=>S.signerId===f);(w=g==null?void 0:g.transport.connection)!=null&&w.connected||await((b=g==null?void 0:g.transport.connection)==null?void 0:b.connect());const x=new r5({...u,transport:g.transport});return h(x),localStorage.setItem("signerId",f),n(),m},[t,i,n]),d=W.useCallback(async h=>{const f=await vI.build({transportType:Sa.NEW_TAB,url:h,crypto:r}),m=new r5({...u,transport:f});o(m),n()},[]);return W.useEffect(()=>{async function h(){!i&&localStorage.getItem("signerId")&&!a&&await c(l,localStorage.getItem("signerId"))}h()},[i,c,l,a]),{selectSigner:async h=>{await c(o,h)},clearSigner:async()=>{await c(o),await c(l)},selectCustomSigner:d,selectedSigner:i??a}}function l1e(){const{signerClient:t,authType:e}=W.useContext(Ba);return{identity:e===x0.ACCOUNTS||t instanceof V1||t==null?void 0:t.getIdentity()}}function u1e(){const{authType:t,signerClient:e,user:n}=W.useContext(Ba),[r,s]=W.useState();return W.useEffect(()=>{n?t===x0.ACCOUNTS&&!r&&e instanceof V1&&(e==null||e.getAccounts().then(s)):s(void 0)},[n,t,e]),{accounts:r}}function c1e(){const[t,e]=W.useState(),{signerClient:n,authType:r,user:s}=W.useContext(Ba);return W.useEffect(()=>{s?r===x0.DELEGATION&&n instanceof Ag&&(n==null||n.getDelegationType().then(e)):e(void 0)},[s,n]),{delegationType:t}}const d1e={signers:[],selectedSigner:void 0,isModalOpen:!1,toggleModal:()=>{throw new Error("toggleModal not implemented")},selectSigner:()=>{throw new Error("selectSigner not implemented")},selectCustomSigner:()=>{throw new Error("signer is not available on this url")},theme:va.SYSTEM,disconnect:()=>{throw new Error("disconnect not implemented")},connect:()=>{throw new Error("connect not implemented")},agent:null,authType:x0.ACCOUNTS,initializing:!0},Ba=W.createContext(d1e);function yU(){const{selectedSigner:t,agent:e,user:n,icpBalance:r,authType:s,initializing:i,connect:o,disconnect:a,fetchIcpBalance:l}=W.useContext(Ba),{identity:u}=l1e(),{delegationType:c}=c1e(),{accounts:d}=u1e();return{signer:t,agent:e,user:n,icpBalance:r,authType:s,accounts:d,delegationType:c,identity:u,connect:i?void 0:o,disconnect:a,fetchIcpBalance:l}}const h1e=({tip:t,children:e,className:n,...r})=>he.jsxs(pge,{children:[he.jsx(mge,{asChild:!0,children:e}),he.jsx(gge,{children:he.jsxs(yge,{sideOffset:5,className:zr("ik-text-white ik-text-sm ik-font-light ik-bg-black ik-py-2 ik-px-6 ik-rounded",n,["left","right"].includes(r.side||"top")?"ik-my-2":"ik-mx-2"),...r,children:[t,he.jsx(xge,{className:"ik-fill-current ik-text-black"})]})})]}),f1e=({onBack:t,isViewAll:e})=>he.jsxs("div",{className:"ik-flex ik-items-center ik-justify-between",children:[he.jsxs("div",{className:"ik-flex ik-items-center ik-gap-[10px]",children:[e&&he.jsxs("svg",{"data-testid":"svg",onClick:t,className:"ik-text-black ik-cursor-pointer dark:ik-text-white",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[he.jsx("path",{d:"M18.7272 11.864L4.99932 11.864",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),he.jsx("path",{d:"M11.6562 18.5207L4.9994 11.8639L11.6562 5.20703",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),he.jsx("p",{className:zr("ik-font-bold ik-text-black dark:ik-text-white"),children:"Connect your wallet"})]}),he.jsx(h1e,{align:"end",side:"bottom",tip:he.jsxs("div",{className:"ik-text-white ik-leading-[16px]",children:[he.jsx("div",{className:"ik-text-sm ik-font-bold",children:"What is a Wallet?"}),he.jsx("div",{className:"ik-text-xs ik-font-bold ik-mt-[12px]",children:"A home for digital assets"}),he.jsx("p",{className:"ik-text-xs",children:"Wallets are used to send, receive, store, and display digital assets."}),he.jsx("div",{className:"ik-text-xs ik-font-bold ik-mt-[12px]",children:"A new way to sign in"}),he.jsx("p",{className:"ik-text-xs",children:"Instead of creating new accounts and passwords on every website, just connect your wallet instead."})]}),className:"ik-px-3 ik-bg-black ik-w-[320px] ik-z-[1011] -mr-[15px]",children:he.jsxs("svg",{className:"ik-cursor-pointer","data-testid":"info",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[he.jsx("path",{d:"M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"#9CA3AF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),he.jsx("path",{d:"M12 16.125V11.3125",stroke:"#9CA3AF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),he.jsx("path",{d:"M12 7.875H12.0092",stroke:"#9CA3AF",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),IY=({children:t,className:e,type:n="primary",disabled:r,icon:s,id:i,block:o,as:a="button",...l})=>{const u=n==="primary",c=n==="secondary";return he.jsx(a,{id:i,disabled:r,className:zr("ik-transition ik-duration-75","ik-text-center ik-text-sm first-letter:ik-capitalize hover:ik-no-underline","ik-font-bold","ik-rounded-md ik-outline-none ik-p-[15px] ik-leading-4","ik-cursor-pointer disabled:ik-cursor-not-allowed",u&&zr("ik-text-white ik-bg-[#146F68] ik-border-transparent","hover:ik-shadow-md hover:ik-shadow-[#0D9488]/40 hover:ik-bg-[#00A899]","active:ik-border-teal-700 active:ik-bg-teal-700","focus:ik-ring-0 focus:ik-ring-offset-0 focus:rik-ing-transparent","disabled:ik-shadow-none disabled:ik-bg-gray-300 disabled:ik-border-gray-300","dark:disabled:ik-bg-zinc-700 dark:disabled:ik-border-zinc-700"),c&&zr("ik-text-[#146F68] dark:ik-text-teal-500 ik-border-transparent","hover:ik-bg-gray-100 dark:hover:ik-bg-zinc-800","active:ik-bg-gray-200 dark:active:ik-bg-zinc-900","disabled:ik-text-gray-400","dark:disabled:ik-text-zinc-600"),o&&zr("ik-w-full ik-block"),e),...l,children:he.jsxs("div",{className:"ik-flex ik-items-center ik-justify-center ik-space-x-2",children:[s?he.jsx("div",{className:"ik-flex ik-items-center ik-justify-center ik-w-6 ik-h-6",children:s}):null,t?he.jsx("div",{className:"ik-text-center",children:t}):null]})})},p1e=t=>new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)?!0:"Invalid URL",xU=8;function m1e(t){if(Math.floor(t)===t)return 0;const e=t.toString();return e.indexOf(".")!==-1&&e.indexOf("-")!==-1?Number(e.split("-")[1]):e.indexOf(".")!==-1?Number(e.split(".")[1].length):Number(e.split("-")[1])}function g1e(t){if(!t)return t.toString();const e=m1e(t),n=t.toFixed(e>xU?xU:e);return Number(n)?n:"0"}const y1e=()=>{const{selectCustomSigner:t}=W.useContext(Ba),{register:e,formState:{errors:n},watch:r}=Z0e({mode:"all",defaultValues:{url:""}}),s=r("url"),i=async()=>{s&&await t(s)};return he.jsxs("div",{children:[he.jsx("div",{className:"ik-text-black dark:ik-text-white ik-font-bold ik-my-[20px]",children:"CustomConnect"}),he.jsxs("div",{className:"ik-flex ik-items-center ik-gap-[12px] ik-relative",children:[he.jsx("input",{className:"ik-rounded-xl ik-border ik-border-gray-400 ik-px-[10px] ik-h-[48px] ik-flex-1 ik-flex-shrink ik-text-sm ik-text-gray-400 focus:ik-border-gray-400 dark:ik-text-white [&:has(:focus-visible)]:ik-outline-none",placeholder:"https://wallet.url",type:"text",...e("url",{required:!0,validate:p1e}),name:"url"}),he.jsx(IY,{disabled:!!n.url||!s,className:"ik-w-[110px]",onClick:i,children:"Connect"}),n.url&&he.jsx("p",{className:"ik-absolute ik-text-xs ik-text-red-500 ik-top-[100%]",children:n.url.message})]})]})},x1e=({signers:t,onSelectSigner:e,isViewAll:n,onViewAll:r,featuredSigner:s})=>he.jsxs("div",{children:[he.jsx("div",{className:"ik-flex ik-flex-col ik-gap-2.5 ik-relative ik-overflow-auto ik-max-h-[420px]",children:t.map(i=>{var o;return he.jsx("div",{className:zr("ik-shadow-[0px_2px_10px_rgba(0,0,0,0.03)] ik-rounded-[13px]",(s==null?void 0:s.id)===i.id?"ik-gradient-border":"ik-border ik-border-black/5 dark:ik-border-white/5"),children:he.jsxs("div",{id:`signer_${i.id}`,className:zr("ik-bg-white dark:ik-bg-zinc-800 ik-rounded-[12px] ik-cursor-pointer","hover:ik-bg-gray-50 dark:hover:ik-bg-signerDarkHoverBg","ik-flex ik-items-center ik-space-x-3 ik-w-full ik-p-5",(s==null?void 0:s.id)===i.id&&((o=i==null?void 0:i.description)==null?void 0:o.length)&&"!ik-items-start"),onClick:async()=>await e(i.id),children:[he.jsx("img",{src:i.icon,alt:i.label,className:"ik-w-8 ik-h-8"}),he.jsxs("div",{className:"ik-text-black dark:ik-text-white",children:[he.jsx("p",{className:"ik-text-sm ik-font-bold ik-leading-[25px]",children:i.label}),(s==null?void 0:s.id)===i.id&&i.description&&he.jsx("p",{className:"ik-text-xs ik-text-gray-400 dark:ik-text-zinc-400 ik-leading-[20px]",children:i.description})]})]},`signer_${i.id}`)})})}),n?he.jsx(y1e,{}):he.jsx(IY,{className:"ik-mt-2.5",block:!0,type:"secondary",onClick:r,children:"View all"})]});function w1e(t){const e=W.useRef(null);return W.useEffect(()=>{const n=r=>{const s=e==null?void 0:e.current;!s||s.contains(r.target)||t(r)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}},[e,t]),e}const b1e=()=>{const{isModalOpen:t,toggleModal:e,signers:n,selectSigner:r,theme:s,featuredSigner:i}=W.useContext(Ba),[o,a]=W.useState(!1),l=w1e(()=>{t&&e()});W.useEffect(()=>{setTimeout(()=>{t||document.body.removeAttribute("data-scroll-locked"),document.body.style.pointerEvents=t?"none":"",document.body.style.userSelect=t?"none":"",document.body.style.overflow=t?"hidden":""},0)},[t]);const u=W.useMemo(()=>n.sort((c,d)=>c.id===(i==null?void 0:i.id)?-1:d.id===(i==null?void 0:i.id)?1:0),[n,i]);return he.jsx(lH,{children:he.jsx(k0e,{open:!0,children:he.jsxs(T0e,{children:[he.jsx("div",{className:zr(t?"ik-block":"ik-hidden","ik-component ik-bg-black ik-bg-opacity-25 ik-backdrop-blur-[2px]","ik-fixed ik-inset-0 ik-z-[1009]")}),he.jsx(E0e,{ref:l,id:"ik-identity-kit-modal","data-identity-kit-theme":s,"aria-describedby":void 0,className:zr("ik-component ik-flex-col ik-fixed ik-p-0 focus:ik-outline-none ik-z-[1010]","ik-shadow-[hsl(206_22%_7%_/_35%)_0px_10px_38px_-10px,_hsl(206_22%_7%_/_20%)_0px_10px_20px_-15px]","ik-top-[50%] ik-left-[50%] ik-max-h-[85vh] ik-w-[90vw] ik-max-w-[490px] ik-translate-x-[-50%] ik-translate-y-[-50%]",t?"ik-flex":"ik-hidden"),children:he.jsxs("div",{className:zr("ik-flex ik-flex-col ik-rounded-xl ik-h-full","ik-bg-[#FAFAFA] dark:ik-bg-black","ik-p-[20px] ik-gap-[10px]"),children:[he.jsx(f1e,{onBack:()=>a(!1),isViewAll:o}),he.jsx(x1e,{signers:u,featuredSigner:i,onSelectSigner:r,isViewAll:o,onViewAll:()=>a(!0)})]})})]})})})};globalThis.global=globalThis;const v1e=({children:t,signerClientOptions:e={},signerOptions:n={},crypto:r=globalThis.crypto,agent:s,authType:i=x0.ACCOUNTS,featuredSigner:o,realConnectDisabled:a,...l})=>{const[u,c]=W.useState(!1),d=W.useCallback(()=>{c(D=>!D)},[]),[h,f]=W.useState(),m=!l.signers||!l.signers.length?[Xwe,Zwe,Qwe,Jwe]:l.signers;W.useEffect(()=>{Promise.all(m.map(async D=>({transport:await vI.build({id:D.id,transportType:D.transportType,url:D.providerUrl,crypto:r}),signerId:D.id}))).then(f)},[m]);const{selectSigner:g,clearSigner:x,selectedSigner:w,selectCustomSigner:b}=a1e({signers:m,transports:h,closeModal:()=>c(!1),crypto:r,options:n}),S=t1e({selectedSigner:w,clearSigner:x,signerClientOptions:{...e,crypto:r},agentOptions:{agent:s},authType:i,onConnectSuccess:l.onConnectSuccess,onConnectFailure:l.onConnectFailure,onDisconnect:l.onDisconnect,realConnectDisabled:a}),C=W.useCallback(()=>{c(!0)},[c]),T=n1e(l.theme);return he.jsxs(Ba.Provider,{value:{signers:m,selectedSigner:w,isModalOpen:u,theme:T,featuredSigner:o===!1?void 0:o??m[0],agent:S.agent,user:S.user,icpBalance:S.icpBalance,authType:i,signerClient:S.signerClient,initializing:!(h!=null&&h.length),toggleModal:d,selectSigner:g,selectCustomSigner:b,connect:C,disconnect:S.disconnect,fetchIcpBalance:S.fetchIcpBalance},children:[he.jsx(b1e,{}),t]})};function S1e({onClick:t,className:e,disabled:n,children:r}){const{initializing:s}=W.useContext(Ba);return he.jsx("button",{id:"connect",type:"button",disabled:n||s,onClick:t,className:zr("ik-component ik-border-transparent","ik-bg-primary ik-text-white hover:ik-bg-teal-600 active:ik-bg-teal-700 active:ik-border-primary","hover:ik-shadow-md","ik-font-bold ik-px-[10px] ik-min-w-[140px] ik-h-[40px] ik-flex ik-items-center ik-justify-center","ik-px-[15px] ik-rounded-xl border",e),children:r??he.jsx("small",{children:"Connect wallet"})})}function NY({className:t,children:e,...n}){return he.jsx("div",{className:zr("ik-component ik-flex ik-justify-between ik-w-full ik-p-2.5 ik-text-black dark:ik-text-white ik-cursor-pointer",t),...n,children:e})}function kY(t){return he.jsx("small",{...t,className:zr("ik-component ik-font-semibold ik-text-black dark:ik-text-white",t.className)})}function C1e({className:t,innerClassName:e,children:n,...r}){const s=Array.isArray(n)?n:[n],{theme:i}=W.useContext(Ba);return he.jsx(CY,{anchor:"bottom end",transition:!0,"data-identity-kit-theme":i,className:zr("ik-min-w-[320px] ik-rounded-3xl ik-bg-white dark:ik-bg-zinc-900 ik-shadow-lg ik-transition focus:ik-outline-none data-[closed]:ik-scale-95 data-[closed]:ik-transform data-[closed]:ik-opacity-0 data-[enter]:ik-duration-100 data-[leave]:ik-duration-75 data-[enter]:ik-ease-out data-[leave]:ik-ease-in ik-p-2.5 [--anchor-gap:8px] ik-z-[999]",t),...r,children:he.jsx("div",{className:zr("ik-py-1",e),children:s})})}function I1e({component:t,onCopied:e,onCopiedTimeout:n,value:r}){const[s,i]=W.useState(!1);return he.jsx(t,{onClick:()=>{s||(i(!0),setTimeout(()=>{i(!1),n==null||n()},1e3),navigator.clipboard.writeText(r),e==null||e())}})}function N1e(t){const{theme:e}=W.useContext(Ba);return he.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:[he.jsx("path",{d:"M11.7795 5.55534V5.55534C11.7795 4.727 11.7795 4.31283 11.6442 3.98612C11.4638 3.55052 11.1177 3.20443 10.6821 3.024C10.3554 2.88867 9.94119 2.88867 9.11285 2.88867H6.44618C4.77008 2.88867 3.93202 2.88867 3.41132 3.40937C2.89062 3.93007 2.89062 4.76812 2.89062 6.44423V9.1109C2.89062 9.93924 2.89062 10.3534 3.02595 10.6801C3.20638 11.1157 3.55247 11.4618 3.98808 11.6422C4.31478 11.7776 4.72895 11.7776 5.55729 11.7776V11.7776",stroke:e===va.DARK?gl.white:gl.black,strokeWidth:"1.8"}),he.jsx("rect",{x:"8.22266",y:"8.22266",width:"8.88889",height:"8.88889",rx:"1.77778",stroke:e===va.DARK?gl.white:gl.black,strokeWidth:"1.8"})]})}function k1e(t){const{theme:e}=W.useContext(Ba);return he.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:[he.jsx("path",{d:"M9.99996 2.5L9.16663 2.5C6.8096 2.5 5.63109 2.5 4.89886 3.23223C4.16663 3.96447 4.16663 5.14298 4.16663 7.5L4.16663 12.5C4.16663 14.857 4.16663 16.0355 4.89886 16.7678C5.63109 17.5 6.8096 17.5 9.16663 17.5L9.99996 17.5",stroke:e===va.DARK?gl.white:gl.black,strokeWidth:"1.8",strokeLinecap:"round"}),he.jsx("path",{d:"M13.0209 6.25L16.7709 10M16.7709 10L13.0209 13.75M16.7709 10L9.27087 10",stroke:e===va.DARK?gl.white:gl.black,strokeWidth:"1.8",strokeLinecap:"round"})]})}function T1e(t){return he.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:[he.jsx("path",{d:"M11.7795 5.55534V5.55534C11.7795 4.727 11.7795 4.31283 11.6442 3.98612C11.4638 3.55052 11.1177 3.20443 10.6821 3.024C10.3554 2.88867 9.94119 2.88867 9.11285 2.88867H6.44618C4.77008 2.88867 3.93202 2.88867 3.41132 3.40937C2.89062 3.93007 2.89062 4.76812 2.89062 6.44423V9.1109C2.89062 9.93924 2.89062 10.3534 3.02595 10.6801C3.20638 11.1157 3.55247 11.4618 3.98808 11.6422C4.31478 11.7776 4.72895 11.7776 5.55729 11.7776V11.7776",stroke:gl.green[500],strokeWidth:"1.8"}),he.jsx("path",{d:"M11.332 12.2222L13.2544 14L17.1098 10",stroke:gl.green[500],strokeWidth:"1.8",strokeLinecap:"round"}),he.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.0131 13.4522V13.6147C18.0132 14.4022 18.0132 15.0818 17.94 15.6262C17.8615 16.2101 17.6843 16.7714 17.2288 17.2269C16.7734 17.6823 16.2121 17.8595 15.6282 17.938C15.0837 18.0112 14.4041 18.0112 13.6167 18.0112H11.7207C10.9332 18.0112 10.2536 18.0112 9.70915 17.938C9.12524 17.8595 8.56397 17.6823 8.10853 17.2269C7.65308 16.7714 7.47584 16.2101 7.39734 15.6262C7.32414 15.0818 7.32418 14.4022 7.32422 13.6147L7.32422 13.5556V11.7778L7.32422 11.7187C7.32418 10.9312 7.32414 10.2516 7.39734 9.7072C7.47584 9.12328 7.65308 8.56201 8.10853 8.10657C8.56397 7.65113 9.12524 7.47389 9.70915 7.39538C10.2536 7.32218 10.9332 7.32222 11.7207 7.32227L11.7798 7.32227H13.5576L13.6167 7.32227C14.3298 7.32223 14.9545 7.32219 15.4705 7.37656L13.7581 9.12233C13.6932 9.12228 13.6263 9.12227 13.5576 9.12227H11.7798C10.9163 9.12227 10.3592 9.12418 9.949 9.17933C9.56468 9.231 9.44658 9.31411 9.38132 9.37936C9.31606 9.44462 9.23295 9.56273 9.18129 9.94704C9.12613 10.3572 9.12422 10.9143 9.12422 11.7778V13.5556C9.12422 14.4191 9.12613 14.9762 9.18129 15.3864C9.23295 15.7707 9.31606 15.8888 9.38132 15.9541C9.44658 16.0193 9.56468 16.1024 9.949 16.1541C10.3592 16.2092 10.9163 16.2112 11.7798 16.2112H13.5576C14.4211 16.2112 14.9781 16.2092 15.3883 16.1541C15.7727 16.1024 15.8908 16.0193 15.956 15.9541C16.0213 15.8888 16.1044 15.7707 16.1561 15.3864C16.1569 15.3799 16.1578 15.3733 16.1586 15.3668L16.3425 15.1756L17.3496 14.1286L18.0131 13.4522Z",fill:gl.green[500]})]})}const wU=5;function E1e({value:t,onClick:e,...n}){const[r,s]=W.useState(!1);return he.jsx(I1e,{value:t,onCopied:()=>s(!0),onCopiedTimeout:()=>s(!1),component:i=>he.jsxs(NY,{onClick:o=>{i.onClick(),e==null||e(o)},...n,className:zr("ik-component",n.className),children:[he.jsx(kY,{children:"Wallet address"}),he.jsxs("div",{className:"ik-flex",children:[he.jsx("small",{className:"ik-font-semibold",children:`${t.substring(0,wU)}...${t.substring(t.length-wU)}`}),r?he.jsx(T1e,{className:"ik-ml-2"}):he.jsx(N1e,{className:"ik-ml-2"})]})]})})}function _1e(t){return he.jsxs(NY,{...t,className:zr("ik-component",t.className),children:[he.jsx(kY,{children:"Disconnect"}),he.jsx(k1e,{})]})}function A1e({className:t,children:e,...n}){return he.jsx(Vwe,{as:"div",className:zr("ik-component ik-inline-block ik-text-left",t),...n,children:e})}function $1e({className:t,...e}){return he.jsx(SY,{...e,className:zr("ik-component",t)})}function R1e({connectedAccount:t,icpBalance:e,className:n,children:r,...s}){return he.jsx($1e,{id:"connect",type:"button",...s,className:zr("ik-component ik-border-transparent","ik-bg-gray-200 ik-text-black hover:ik-bg-gray-100 active:ik-bg-gray-300 active:ik-border-gray-200","hover:ik-shadow-md","ik-font-bold ik-px-[10px] ik-min-w-[140px] ik-h-[40px] ik-flex ik-items-center ik-justify-center","ik-px-[15px] ik-rounded-xl ik-border",n),children:r||he.jsxs(he.Fragment,{children:[he.jsxs("small",{className:"ik-mr-2",children:[t.substring(0,5),"...",t.substring(t.length-5)]}),he.jsx("div",{className:"ik-bg-white ik-px-[5px] ik-rounded-md",children:he.jsx("small",{className:"ik-text-black ik-font-normal ik-text-xs",children:e!==void 0&&`${g1e(e)} ICP`})})]})})}function M1e({connectButtonComponent:t,connectedButtonComponent:e,dropdownMenuComponent:n}){const{toggleModal:r,user:s,icpBalance:i,disconnect:o,selectedSigner:a}=W.useContext(Ba),l=t??S1e,u=e??R1e,c=n??A1e;if(!s)return he.jsx(l,{onClick:()=>{r()},disabled:a&&!s});const d=s.principal.toString();return he.jsx(he.Fragment,{children:he.jsxs(c,{disconnect:o,icpBalance:i,connectedAccount:d,children:[he.jsx(u,{connectedAccount:d,icpBalance:i}),he.jsxs(C1e,{children:[he.jsx(E1e,{value:d}),he.jsx(_1e,{onClick:o})]})]})})}const D1e=({IDL:t})=>{const e=t.Variant({REP_COIN_REWARD:t.Record({multiplier:t.Nat,reason:t.Text}),MARKETPLACE_PURCHASE:t.Record({itemId:t.Text,price:t.Nat}),CURRENCY_EXCHANGE:t.Record({externalTxId:t.Text,exchangeRate:t.Nat,currencyType:t.Text}),EXERCISE_RECORD:t.Record({duration:t.Int,reps:t.Nat,caloriesBurned:t.Nat}),CHALLENGE_CREATE:t.Record({reward:t.Nat,duration:t.Int,name:t.Text,challengeId:t.Text,targetReps:t.Nat}),CHALLENGE_COMPLETE:t.Record({totalReps:t.Nat,challengeId:t.Text}),CHALLENGE_JOIN:t.Record({challengeId:t.Text})}),n=t.Record({id:t.Text,signature:t.Text,transactionType:e,recipient:t.Principal,sender:t.Principal,timestamp:t.Int,priority:t.Nat,amount:t.Nat}),r=t.Variant({ok:n,err:t.Text}),s=t.Record({id:t.Text,startTime:t.Int,status:t.Text,creator:t.Principal,participants:t.Vec(t.Principal),endTime:t.Int,name:t.Text,description:t.Text,currentReps:t.Nat,targetReps:t.Nat,rewards:t.Nat}),i=t.Variant({ok:s,err:t.Text}),o=t.Record({hash:t.Text,nonce:t.Nat,timestamp:t.Int,index:t.Nat,transactions:t.Vec(n),previousHash:t.Text}),a=t.Record({id:t.Principal,streak:t.Nat,username:t.Text,totalCaloriesBurned:t.Nat,level:t.Nat,repCoins:t.Nat,achievements:t.Vec(t.Text),lastExerciseTime:t.Int}),l=t.Variant({ok:a,err:t.Text});return t.Service({addTransaction:t.Func([t.Principal,t.Nat,e],[r],[]),completeChallenge:t.Func([t.Text,t.Principal],[i],[]),createChallenge:t.Func([t.Text,t.Text,t.Text,t.Nat,t.Int,t.Nat,t.Principal],[i],[]),exchangeRepCoinsForCurrency:t.Func([t.Nat,t.Text,t.Nat,t.Text],[r],[]),getActiveChallenges:t.Func([],[t.Vec(s)],["query"]),getChain:t.Func([],[t.Vec(o)],["query"]),getChallenges:t.Func([],[t.Vec(s)],["query"]),getExchangeRates:t.Func([],[t.Vec(t.Tuple(t.Text,t.Nat))],["query"]),getLatestBlock:t.Func([],[t.Opt(o)],["query"]),getLeaderboard:t.Func([t.Nat],[t.Vec(a)],["query"]),getPendingTransactions:t.Func([],[t.Vec(n)],["query"]),getUser:t.Func([],[l],["query"]),getUserByPrincipal:t.Func([t.Principal],[l],["query"]),joinChallenge:t.Func([t.Text,t.Principal],[i],[]),registerUser:t.Func([t.Text],[l],[])})},O1e="rgnbd-eqaaa-aaaal-qspgq-cai",vC=(t,e={})=>{const n=e.agent||new po({...e.agentOptions});return e.agent&&e.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),Sc.createActor(D1e,{agent:n,canisterId:t,...e.actorOptions})};vC(O1e);const b3=({IDL:t})=>{const e=t.Rec(),n=t.Nat,r=t.Record({start:n,length:t.Nat}),s=t.Vec(t.Tuple(t.Text,e));e.fill(t.Variant({Int:t.Int,Map:s,Nat:t.Nat,Nat64:t.Nat64,Blob:t.Vec(t.Nat8),Text:t.Text,Array:t.Vec(e)}));const i=e,o=t.Record({blocks:t.Vec(i)}),a=t.Func([r],[o],["query"]),l=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),first_index:n,blocks:t.Vec(i),chain_length:t.Nat64,archived_blocks:t.Vec(t.Record({callback:a,start:n,length:t.Nat}))}),u=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),hash_tree:t.Vec(t.Nat8)}),c=t.Nat,d=t.Record({start:c,length:t.Nat}),h=t.Vec(t.Nat8),f=t.Record({owner:t.Principal,subaccount:t.Opt(h)}),m=t.Nat64,g=t.Record({from:f,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(m),amount:t.Nat,spender:t.Opt(f)}),x=t.Record({to:f,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(m),amount:t.Nat}),w=t.Record({fee:t.Opt(t.Nat),from:f,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(m),amount:t.Nat,expected_allowance:t.Opt(t.Nat),expires_at:t.Opt(m),spender:f}),b=t.Record({to:f,fee:t.Opt(t.Nat),from:f,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(m),amount:t.Nat,spender:t.Opt(f)}),S=t.Record({burn:t.Opt(g),kind:t.Text,mint:t.Opt(x),approve:t.Opt(w),timestamp:m,transfer:t.Opt(b)}),C=t.Record({transactions:t.Vec(S)}),T=t.Func([d],[C],["query"]),D=t.Record({first_index:c,log_length:t.Nat,transactions:t.Vec(S),archived_transactions:t.Vec(t.Record({callback:T,start:c,length:t.Nat}))}),P=t.Nat,I=t.Variant({Int:t.Int,Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text}),E=t.Record({url:t.Text,name:t.Text}),M=t.Record({to:f,fee:t.Opt(P),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(h),created_at_time:t.Opt(m),amount:P}),O=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,BadBurn:t.Record({min_burn_amount:P}),Duplicate:t.Record({duplicate_of:n}),BadFee:t.Record({expected_fee:P}),CreatedInFuture:t.Record({ledger_time:m}),TooOld:t.Null,InsufficientFunds:t.Record({balance:P})}),j=t.Variant({Ok:n,Err:O}),R=t.Record({account:f,spender:f}),z=t.Record({allowance:t.Nat,expires_at:t.Opt(m)}),B=t.Record({fee:t.Opt(t.Nat),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(m),amount:t.Nat,expected_allowance:t.Opt(t.Nat),expires_at:t.Opt(m),spender:f}),V=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,Duplicate:t.Record({duplicate_of:n}),BadFee:t.Record({expected_fee:t.Nat}),AllowanceChanged:t.Record({current_allowance:t.Nat}),CreatedInFuture:t.Record({ledger_time:m}),TooOld:t.Null,Expired:t.Record({ledger_time:m}),InsufficientFunds:t.Record({balance:t.Nat})}),H=t.Variant({Ok:n,Err:V}),K=t.Record({to:f,fee:t.Opt(P),spender_subaccount:t.Opt(h),from:f,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(m),amount:P}),ne=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,InsufficientAllowance:t.Record({allowance:P}),BadBurn:t.Record({min_burn_amount:P}),Duplicate:t.Record({duplicate_of:n}),BadFee:t.Record({expected_fee:P}),CreatedInFuture:t.Record({ledger_time:m}),TooOld:t.Null,InsufficientFunds:t.Record({balance:P})}),fe=t.Variant({Ok:n,Err:ne});return t.Service({get_blocks:t.Func([r],[l],["query"]),get_data_certificate:t.Func([],[u],["query"]),get_transactions:t.Func([d],[D],["query"]),icrc1_balance_of:t.Func([f],[P],["query"]),icrc1_decimals:t.Func([],[t.Nat8],["query"]),icrc1_fee:t.Func([],[P],["query"]),icrc1_metadata:t.Func([],[t.Vec(t.Tuple(t.Text,I))],["query"]),icrc1_minting_account:t.Func([],[t.Opt(f)],["query"]),icrc1_name:t.Func([],[t.Text],["query"]),icrc1_supported_standards:t.Func([],[t.Vec(E)],["query"]),icrc1_symbol:t.Func([],[t.Text],["query"]),icrc1_total_supply:t.Func([],[P],["query"]),icrc1_transfer:t.Func([M],[j],[]),icrc2_allowance:t.Func([R],[z],["query"]),icrc2_approve:t.Func([B],[H],[]),icrc2_transfer_from:t.Func([K],[fe],[])})};var bU={};const TY=W.createContext(),Q2="rgnbd-eqaaa-aaaal-qspgq-cai",P1e=()=>{yU();const[t,e]=W.useState(!1),[n,r]=W.useState(null),[s,i]=W.useState(vC(Q2)),[o,a]=W.useState(!1),[l,u]=W.useState(null),[c,d]=W.useState(null),[h,f]=W.useState(!0),{agent:m,user:g,identity:x,connect:w,disconnect:b}=yU();W.useEffect(()=>{(async()=>{if(m){console.log("Authenticated Agent Identity:",m),f(!0);const P=new po({host:bU.HOST||"https://ic0.app"});console.log(" agent created:",c);const I=Sc.createActor(b3,{agent:P,canisterId:Q2});d(m),i(I),console.log("Actor and Agent initialized successfully.")}else f(!1),console.error("Failed to initialize agent and actor:",error)})()},[m]),W.useEffect(()=>{c&&(async()=>{try{const P=vC(bU.CANISTER_ID_ICPLAUNCHPAD_BACKEND,{agent:c});console.log("Authenticated actor initialized.")}catch(P){console.error("Failed to create actor:",P)}})()},[c]),W.useEffect(()=>{(async()=>{if(g){e(!0);try{const P=await g.principal;r(P)}catch(P){console.error("Error fetching principal:",P),r(null)}}else e(!1),r(null)})()},[g]),W.useEffect(()=>{(async()=>{const P=Sc.createActor(b3,{agent:c,canisterId:Q2});i(P)})(),u(x),console.log("delegation is ",l)},[c]);const S=W.useCallback(()=>{w()},[w]),C="http://127.0.0.1:4943/";return{isAuthenticated:t,login:S,logout:b,principal:n,agent:c||null,createCustomActor:async D=>{try{console.log("Identity value before agent creation:",x),console.log("Creating actor for canister ID:",D);const P=new po({identity:x,host:C}),I=Sc.createActor(b3,{agent:P,canisterId:D});return console.log("Created ledger actor:",I),I}catch(P){console.error("Error creating ledger actor:",P)}},identity:x,orderPlacementLoad:o,setOrderPlacementLoad:a,actor:vC(Q2,{agentOptions:{identity:x,verifyQuerySignatures:!1}})}},F1e=({children:t})=>{const e=P1e();return W.useEffect(()=>{e&&console.log("Auth is ",e)},[e]),console.log("Auth is ",e),he.jsx(TY.Provider,{value:e,children:t})},L1e=()=>W.useContext(TY),z1e=({onClick:t})=>he.jsx("button",{onClick:t,className:" bg-white",children:he.jsx("div",{className:" w-full h-full  rounded-xl flex items-center justify-center  ",children:"Connect Wallet"})}),B1e=()=>{const[t,e]=W.useState(!1),{isAuthenticated:n,principal:r}=L1e(),s=[{to:"/dashboard",icon:Xse,label:"Dashboard"},{to:"/workouts",icon:z8,label:"Workouts"},{to:"/ai-trainer",icon:WL,label:"AI Trainer"},{to:"/wallet",icon:aie,label:"RepCoins"}];return he.jsxs("nav",{className:"bg-gray-800/50 backdrop-blur-md border-b border-gray-700/50 sticky top-0 z-50",children:[he.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:he.jsxs("div",{className:"flex items-center justify-between h-16",children:[he.jsxs(gg,{to:"/",className:"flex items-center space-x-2",children:[he.jsx(WL,{className:"h-8 w-8 text-purple-500"}),he.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent",children:"FitnFrame"})]}),he.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[s.map(i=>he.jsxs(gg,{to:i.to,className:"flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium hover:bg-purple-500/10 transition-colors",children:[he.jsx(i.icon,{className:"h-4 w-4"}),he.jsx("span",{children:i.label})]},i.label)),!n&&he.jsx("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md text-base font-medium bg-purple-600 hover:bg-purple-700 transition-colors",children:he.jsx("div",{className:"wallet",children:he.jsx(M1e,{connectButtonComponent:z1e})})})]}),he.jsx("div",{className:"md:hidden",children:he.jsx("button",{onClick:()=>e(!t),className:"p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700",children:t?he.jsx(lie,{className:"h-6 w-6"}):he.jsx(Jse,{className:"h-6 w-6"})})})]})}),he.jsx(Nue,{children:t&&he.jsx(xi.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden bg-gray-800/50 backdrop-blur-md",children:he.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[s.map(i=>he.jsxs(gg,{to:i.to,className:"flex items-center space-x-2 px-3 py-2 rounded-md text-base font-medium hover:bg-purple-500/10 transition-colors",onClick:()=>e(!1),children:[he.jsx(i.icon,{className:"h-5 w-5"}),he.jsx("span",{children:i.label})]},i.label)),he.jsxs(gg,{to:"/auth",className:"flex items-center space-x-2 px-3 py-2 rounded-md text-base font-medium bg-purple-600 hover:bg-purple-700 transition-colors",onClick:()=>e(!1),children:[he.jsx(Yse,{className:"h-5 w-5"}),he.jsx("span",{children:"Sign In"})]})]})})})]})},U1e=()=>he.jsx("div",{className:"relative",children:he.jsxs("div",{className:"relative h-screen",children:[he.jsx("video",{autoPlay:!0,loop:!0,muted:!0,className:"absolute inset-0 w-full h-full object-cover",style:{filter:"brightness(0.4)"},children:he.jsx("source",{src:"https://player.vimeo.com/external/477743905.sd.mp4?s=4c6d085d7d3c8ea8d14abf4dfbc4cb6a2a08c1a7&profile_id=164&oauth2_token_id=57447761",type:"video/mp4"})}),he.jsx("div",{className:"relative z-10 h-full flex items-center",children:he.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:he.jsxs(xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[he.jsx("h1",{className:"text-5xl md:text-7xl font-bold mb-6 bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent",children:"Transform Your Fitness Journey with AI"}),he.jsx("p",{className:"text-xl md:text-2xl mb-8 text-gray-300",children:"Get personalized workouts and real-time form correction powered by artificial intelligence"}),he.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[he.jsxs(xi.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center px-8 py-4 bg-purple-600 rounded-full text-lg font-semibold hover:bg-purple-700 transition-colors",children:[he.jsx($M,{className:"h-5 w-5 mr-2"}),"Start Training"]}),he.jsxs(xi.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center px-8 py-4 border-2 border-white rounded-full text-lg font-semibold hover:bg-white hover:text-gray-900 transition-colors",children:["Learn More",he.jsx(Hse,{className:"h-5 w-5 ml-2"})]})]})]})})})]})}),V1e=()=>{const[t,e]=W.useState(!0);return he.jsx("div",{className:"min-h-[calc(100vh-4rem)] flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:he.jsxs(xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full space-y-8 bg-gray-800 p-8 rounded-xl shadow-xl",children:[he.jsx("div",{children:he.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:t?"Sign in to your account":"Create your account"})}),he.jsxs("form",{className:"mt-8 space-y-6",children:[!t&&he.jsxs("div",{children:[he.jsx("label",{htmlFor:"name",className:"sr-only",children:"Full Name"}),he.jsxs("div",{className:"relative",children:[he.jsx(oie,{className:"h-5 w-5 text-gray-400 absolute left-3 top-3"}),he.jsx("input",{id:"name",name:"name",type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-10 py-3 border border-gray-700 bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Full Name"})]})]}),he.jsxs("div",{children:[he.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),he.jsxs("div",{className:"relative",children:[he.jsx(Qse,{className:"h-5 w-5 text-gray-400 absolute left-3 top-3"}),he.jsx("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none rounded-lg relative block w-full px-10 py-3 border border-gray-700 bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Email address"})]})]}),he.jsxs("div",{children:[he.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),he.jsxs("div",{className:"relative",children:[he.jsx(Zse,{className:"h-5 w-5 text-gray-400 absolute left-3 top-3"}),he.jsx("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none rounded-lg relative block w-full px-10 py-3 border border-gray-700 bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Password"})]})]}),he.jsx("div",{children:he.jsx(xi.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:t?"Sign in":"Sign up"})})]}),he.jsx("div",{className:"text-center",children:he.jsx("button",{onClick:()=>e(!t),className:"text-purple-400 hover:text-purple-300",children:t?"Don't have an account? Sign up":"Already have an account? Sign in"})})]})})};var SC={exports:{}},j1e=SC.exports,vU;function W1e(){return vU||(vU=1,function(t,e){(function(r,s){t.exports=s(dN())})(j1e,function(n){return function(r){var s={};function i(o){if(s[o])return s[o].exports;var a=s[o]={i:o,l:!1,exports:{}};return r[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=r,i.c=s,i.d=function(o,a,l){i.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:l})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,a){if(a&1&&(o=i(o)),a&8||a&4&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),a&2&&typeof o!="string")for(var u in o)i.d(l,u,(function(c){return o[c]}).bind(null,u));return l},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,s,i){i.r(s);var o=i("react"),a=function(){var h=function(f,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,x){g.__proto__=x}||function(g,x){for(var w in x)x.hasOwnProperty(w)&&(g[w]=x[w])},h(f,m)};return function(f,m){h(f,m);function g(){this.constructor=f}f.prototype=m===null?Object.create(m):(g.prototype=m.prototype,new g)}}(),l=function(){return l=Object.assign||function(h){for(var f,m=1,g=arguments.length;m<g;m++){f=arguments[m];for(var x in f)Object.prototype.hasOwnProperty.call(f,x)&&(h[x]=f[x])}return h},l.apply(this,arguments)},u=function(h,f){var m={};for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&f.indexOf(g)<0&&(m[g]=h[g]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var x=0,g=Object.getOwnPropertySymbols(h);x<g.length;x++)f.indexOf(g[x])<0&&Object.prototype.propertyIsEnumerable.call(h,g[x])&&(m[g[x]]=h[g[x]]);return m};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(f){var m=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return m?new Promise(function(g,x){m.call(navigator,f,g,x)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function c(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var d=function(h){a(f,h);function f(m){var g=h.call(this,m)||this;return g.canvas=null,g.ctx=null,g.requestUserMediaId=0,g.unmounted=!1,g.state={hasUserMedia:!1},g}return f.prototype.componentDidMount=function(){var m=this,g=m.state,x=m.props;if(this.unmounted=!1,!c()){x.onUserMediaError("getUserMedia not supported");return}g.hasUserMedia||this.requestUserMedia(),x.children&&typeof x.children!="function"&&console.warn("children must be a function")},f.prototype.componentDidUpdate=function(m){var g=this.props;if(!c()){g.onUserMediaError("getUserMedia not supported");return}var x=JSON.stringify(m.audioConstraints)!==JSON.stringify(g.audioConstraints),w=JSON.stringify(m.videoConstraints)!==JSON.stringify(g.videoConstraints),b=m.minScreenshotWidth!==g.minScreenshotWidth,S=m.minScreenshotHeight!==g.minScreenshotHeight;(w||b||S)&&(this.canvas=null,this.ctx=null),(x||w)&&(this.stopAndCleanup(),this.requestUserMedia())},f.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},f.stopMediaStream=function(m){m&&(m.getVideoTracks&&m.getAudioTracks?(m.getVideoTracks().map(function(g){m.removeTrack(g),g.stop()}),m.getAudioTracks().map(function(g){m.removeTrack(g),g.stop()})):m.stop())},f.prototype.stopAndCleanup=function(){var m=this.state;m.hasUserMedia&&(f.stopMediaStream(this.stream),m.src&&window.URL.revokeObjectURL(m.src))},f.prototype.getScreenshot=function(m){var g=this,x=g.state,w=g.props;if(!x.hasUserMedia)return null;var b=this.getCanvas(m);return b&&b.toDataURL(w.screenshotFormat,w.screenshotQuality)},f.prototype.getCanvas=function(m){var g=this,x=g.state,w=g.props;if(!this.video||!x.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var b=this.video.videoWidth,S=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var C=b/S;b=w.minScreenshotWidth||this.video.clientWidth,S=b/C,w.minScreenshotHeight&&S<w.minScreenshotHeight&&(S=w.minScreenshotHeight,b=S*C)}this.canvas=document.createElement("canvas"),this.canvas.width=(m==null?void 0:m.width)||b,this.canvas.height=(m==null?void 0:m.height)||S,this.ctx=this.canvas.getContext("2d")}var T=this,D=T.ctx,P=T.canvas;return D&&P&&(P.width=(m==null?void 0:m.width)||P.width,P.height=(m==null?void 0:m.height)||P.height,w.mirrored&&(D.translate(P.width,0),D.scale(-1,1)),D.imageSmoothingEnabled=w.imageSmoothing,D.drawImage(this.video,0,0,(m==null?void 0:m.width)||P.width,(m==null?void 0:m.height)||P.height),w.mirrored&&(D.scale(-1,1),D.translate(-P.width,0))),P},f.prototype.requestUserMedia=function(){var m=this,g=this.props,x=function(S,C){var T={video:typeof C<"u"?C:!0};g.audio&&(T.audio=typeof S<"u"?S:!0),m.requestUserMediaId++;var D=m.requestUserMediaId;navigator.mediaDevices.getUserMedia(T).then(function(P){m.unmounted||D!==m.requestUserMediaId?f.stopMediaStream(P):m.handleUserMedia(null,P)}).catch(function(P){m.handleUserMedia(P)})};if("mediaDevices"in navigator)x(g.audioConstraints,g.videoConstraints);else{var w=function(S){return{optional:[{sourceId:S}]}},b=function(S){var C=S.deviceId;return typeof C=="string"?C:Array.isArray(C)&&C.length>0?C[0]:typeof C=="object"&&C.ideal?C.ideal:null};MediaStreamTrack.getSources(function(S){var C=null,T=null;S.forEach(function(I){I.kind==="audio"?C=I.id:I.kind==="video"&&(T=I.id)});var D=b(g.audioConstraints);D&&(C=D);var P=b(g.videoConstraints);P&&(T=P),x(w(C),w(T))})}},f.prototype.handleUserMedia=function(m,g){var x=this.props;if(m||!g){this.setState({hasUserMedia:!1}),x.onUserMediaError(m);return}this.stream=g;try{this.video&&(this.video.srcObject=g),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(g)})}x.onUserMedia(g)},f.prototype.render=function(){var m=this,g=this,x=g.state,w=g.props,b=w.audio;w.forceScreenshotSourceSize;var S=w.disablePictureInPicture;w.onUserMedia,w.onUserMediaError,w.screenshotFormat,w.screenshotQuality,w.minScreenshotWidth,w.minScreenshotHeight,w.audioConstraints,w.videoConstraints,w.imageSmoothing;var C=w.mirrored,T=w.style,D=T===void 0?{}:T,P=w.children,I=u(w,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),E=C?l(l({},D),{transform:(D.transform||"")+" scaleX(-1)"}):D,M={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",l({autoPlay:!0,disablePictureInPicture:S,src:x.src,muted:!b,playsInline:!0,ref:function(O){m.video=O},style:E},I)),P&&P(M))},f.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},f}(o.Component);s.default=d},react:function(r,s){r.exports=n}}).default})}(SC)),SC.exports}var G1e=W1e();const H1e=Dp(G1e);var v3={},SU;function Y1e(){return SU||(SU=1,(function(){var t;function e(_){var G=0;return function(){return G<_.length?{done:!1,value:_[G++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,G,Q){return _==Array.prototype||_==Object.prototype||(_[G]=Q.value),_};function r(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof u$=="object"&&u$];for(var G=0;G<_.length;++G){var Q=_[G];if(Q&&Q.Math==Math)return Q}throw Error("Cannot find global object")}var s=r(this);function i(_,G){if(G)e:{var Q=s;_=_.split(".");for(var oe=0;oe<_.length-1;oe++){var Se=_[oe];if(!(Se in Q))break e;Q=Q[Se]}_=_[_.length-1],oe=Q[_],G=G(oe),G!=oe&&G!=null&&n(Q,_,{configurable:!0,writable:!0,value:G})}}i("Symbol",function(_){function G(ke){if(this instanceof G)throw new TypeError("Symbol is not a constructor");return new Q(oe+(ke||"")+"_"+Se++,ke)}function Q(ke,Ce){this.h=ke,n(this,"description",{configurable:!0,writable:!0,value:Ce})}if(_)return _;Q.prototype.toString=function(){return this.h};var oe="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Se=0;return G}),i("Symbol.iterator",function(_){if(_)return _;_=Symbol("Symbol.iterator");for(var G="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Q=0;Q<G.length;Q++){var oe=s[G[Q]];typeof oe=="function"&&typeof oe.prototype[_]!="function"&&n(oe.prototype,_,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return _});function o(_){return _={next:_},_[Symbol.iterator]=function(){return this},_}function a(_){var G=typeof Symbol<"u"&&Symbol.iterator&&_[Symbol.iterator];return G?G.call(_):{next:e(_)}}function l(_){if(!(_ instanceof Array)){_=a(_);for(var G,Q=[];!(G=_.next()).done;)Q.push(G.value);_=Q}return _}var u=typeof Object.assign=="function"?Object.assign:function(_,G){for(var Q=1;Q<arguments.length;Q++){var oe=arguments[Q];if(oe)for(var Se in oe)Object.prototype.hasOwnProperty.call(oe,Se)&&(_[Se]=oe[Se])}return _};i("Object.assign",function(_){return _||u});var c=typeof Object.create=="function"?Object.create:function(_){function G(){}return G.prototype=_,new G},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var h;e:{var f={a:!0},m={};try{m.__proto__=f,h=m.a;break e}catch{}h=!1}d=h?function(_,G){if(_.__proto__=G,_.__proto__!==G)throw new TypeError(_+" is not extensible");return _}:null}var g=d;function x(_,G){if(_.prototype=c(G.prototype),_.prototype.constructor=_,g)g(_,G);else for(var Q in G)if(Q!="prototype")if(Object.defineProperties){var oe=Object.getOwnPropertyDescriptor(G,Q);oe&&Object.defineProperty(_,Q,oe)}else _[Q]=G[Q];_.za=G.prototype}function w(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function b(_){if(_.m)throw new TypeError("Generator is already running");_.m=!0}w.prototype.u=function(_){this.i=_};function S(_,G){_.l={ma:G,na:!0},_.h=_.s||_.v}w.prototype.return=function(_){this.l={return:_},this.h=this.v};function C(_,G,Q){return _.h=Q,{value:G}}function T(_){this.h=new w,this.i=_}function D(_,G){b(_.h);var Q=_.h.j;return Q?P(_,"return"in Q?Q.return:function(oe){return{value:oe,done:!0}},G,_.h.return):(_.h.return(G),I(_))}function P(_,G,Q,oe){try{var Se=G.call(_.h.j,Q);if(!(Se instanceof Object))throw new TypeError("Iterator result "+Se+" is not an object");if(!Se.done)return _.h.m=!1,Se;var ke=Se.value}catch(Ce){return _.h.j=null,S(_.h,Ce),I(_)}return _.h.j=null,oe.call(_.h,ke),I(_)}function I(_){for(;_.h.h;)try{var G=_.i(_.h);if(G)return _.h.m=!1,{value:G.value,done:!1}}catch(Q){_.h.i=void 0,S(_.h,Q)}if(_.h.m=!1,_.h.l){if(G=_.h.l,_.h.l=null,G.na)throw G.ma;return{value:G.return,done:!0}}return{value:void 0,done:!0}}function E(_){this.next=function(G){return b(_.h),_.h.j?G=P(_,_.h.j.next,G,_.h.u):(_.h.u(G),G=I(_)),G},this.throw=function(G){return b(_.h),_.h.j?G=P(_,_.h.j.throw,G,_.h.u):(S(_.h,G),G=I(_)),G},this.return=function(G){return D(_,G)},this[Symbol.iterator]=function(){return this}}function M(_){function G(oe){return _.next(oe)}function Q(oe){return _.throw(oe)}return new Promise(function(oe,Se){function ke(Ce){Ce.done?oe(Ce.value):Promise.resolve(Ce.value).then(G,Q).then(ke,Se)}ke(_.next())})}function O(_){return M(new E(new T(_)))}i("Promise",function(_){function G(Ce){this.i=0,this.j=void 0,this.h=[],this.u=!1;var Fe=this.l();try{Ce(Fe.resolve,Fe.reject)}catch(qe){Fe.reject(qe)}}function Q(){this.h=null}function oe(Ce){return Ce instanceof G?Ce:new G(function(Fe){Fe(Ce)})}if(_)return _;Q.prototype.i=function(Ce){if(this.h==null){this.h=[];var Fe=this;this.j(function(){Fe.m()})}this.h.push(Ce)};var Se=s.setTimeout;Q.prototype.j=function(Ce){Se(Ce,0)},Q.prototype.m=function(){for(;this.h&&this.h.length;){var Ce=this.h;this.h=[];for(var Fe=0;Fe<Ce.length;++Fe){var qe=Ce[Fe];Ce[Fe]=null;try{qe()}catch(rt){this.l(rt)}}}this.h=null},Q.prototype.l=function(Ce){this.j(function(){throw Ce})},G.prototype.l=function(){function Ce(rt){return function(ft){qe||(qe=!0,rt.call(Fe,ft))}}var Fe=this,qe=!1;return{resolve:Ce(this.I),reject:Ce(this.m)}},G.prototype.I=function(Ce){if(Ce===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(Ce instanceof G)this.L(Ce);else{e:switch(typeof Ce){case"object":var Fe=Ce!=null;break e;case"function":Fe=!0;break e;default:Fe=!1}Fe?this.F(Ce):this.s(Ce)}},G.prototype.F=function(Ce){var Fe=void 0;try{Fe=Ce.then}catch(qe){this.m(qe);return}typeof Fe=="function"?this.M(Fe,Ce):this.s(Ce)},G.prototype.m=function(Ce){this.v(2,Ce)},G.prototype.s=function(Ce){this.v(1,Ce)},G.prototype.v=function(Ce,Fe){if(this.i!=0)throw Error("Cannot settle("+Ce+", "+Fe+"): Promise already settled in state"+this.i);this.i=Ce,this.j=Fe,this.i===2&&this.K(),this.H()},G.prototype.K=function(){var Ce=this;Se(function(){if(Ce.D()){var Fe=s.console;typeof Fe<"u"&&Fe.error(Ce.j)}},1)},G.prototype.D=function(){if(this.u)return!1;var Ce=s.CustomEvent,Fe=s.Event,qe=s.dispatchEvent;return typeof qe>"u"?!0:(typeof Ce=="function"?Ce=new Ce("unhandledrejection",{cancelable:!0}):typeof Fe=="function"?Ce=new Fe("unhandledrejection",{cancelable:!0}):(Ce=s.document.createEvent("CustomEvent"),Ce.initCustomEvent("unhandledrejection",!1,!0,Ce)),Ce.promise=this,Ce.reason=this.j,qe(Ce))},G.prototype.H=function(){if(this.h!=null){for(var Ce=0;Ce<this.h.length;++Ce)ke.i(this.h[Ce]);this.h=null}};var ke=new Q;return G.prototype.L=function(Ce){var Fe=this.l();Ce.T(Fe.resolve,Fe.reject)},G.prototype.M=function(Ce,Fe){var qe=this.l();try{Ce.call(Fe,qe.resolve,qe.reject)}catch(rt){qe.reject(rt)}},G.prototype.then=function(Ce,Fe){function qe(Ft,gt){return typeof Ft=="function"?function(Ut){try{rt(Ft(Ut))}catch(on){ft(on)}}:gt}var rt,ft,Ht=new G(function(Ft,gt){rt=Ft,ft=gt});return this.T(qe(Ce,rt),qe(Fe,ft)),Ht},G.prototype.catch=function(Ce){return this.then(void 0,Ce)},G.prototype.T=function(Ce,Fe){function qe(){switch(rt.i){case 1:Ce(rt.j);break;case 2:Fe(rt.j);break;default:throw Error("Unexpected state: "+rt.i)}}var rt=this;this.h==null?ke.i(qe):this.h.push(qe),this.u=!0},G.resolve=oe,G.reject=function(Ce){return new G(function(Fe,qe){qe(Ce)})},G.race=function(Ce){return new G(function(Fe,qe){for(var rt=a(Ce),ft=rt.next();!ft.done;ft=rt.next())oe(ft.value).T(Fe,qe)})},G.all=function(Ce){var Fe=a(Ce),qe=Fe.next();return qe.done?oe([]):new G(function(rt,ft){function Ht(Ut){return function(on){Ft[Ut]=on,gt--,gt==0&&rt(Ft)}}var Ft=[],gt=0;do Ft.push(void 0),gt++,oe(qe.value).T(Ht(Ft.length-1),ft),qe=Fe.next();while(!qe.done)})},G});function j(_,G){_ instanceof String&&(_+="");var Q=0,oe=!1,Se={next:function(){if(!oe&&Q<_.length){var ke=Q++;return{value:G(ke,_[ke]),done:!1}}return oe=!0,{done:!0,value:void 0}}};return Se[Symbol.iterator]=function(){return Se},Se}i("Array.prototype.keys",function(_){return _||function(){return j(this,function(G){return G})}}),i("Array.prototype.fill",function(_){return _||function(G,Q,oe){var Se=this.length||0;for(0>Q&&(Q=Math.max(0,Se+Q)),(oe==null||oe>Se)&&(oe=Se),oe=Number(oe),0>oe&&(oe=Math.max(0,Se+oe)),Q=Number(Q||0);Q<oe;Q++)this[Q]=G;return this}});function R(_){return _||Array.prototype.fill}i("Int8Array.prototype.fill",R),i("Uint8Array.prototype.fill",R),i("Uint8ClampedArray.prototype.fill",R),i("Int16Array.prototype.fill",R),i("Uint16Array.prototype.fill",R),i("Int32Array.prototype.fill",R),i("Uint32Array.prototype.fill",R),i("Float32Array.prototype.fill",R),i("Float64Array.prototype.fill",R),i("Object.is",function(_){return _||function(G,Q){return G===Q?G!==0||1/G===1/Q:G!==G&&Q!==Q}}),i("Array.prototype.includes",function(_){return _||function(G,Q){var oe=this;oe instanceof String&&(oe=String(oe));var Se=oe.length;for(Q=Q||0,0>Q&&(Q=Math.max(Q+Se,0));Q<Se;Q++){var ke=oe[Q];if(ke===G||Object.is(ke,G))return!0}return!1}}),i("String.prototype.includes",function(_){return _||function(G,Q){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(G instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(G,Q||0)!==-1}});var z=this||self;function B(_,G){_=_.split(".");var Q=z;_[0]in Q||typeof Q.execScript>"u"||Q.execScript("var "+_[0]);for(var oe;_.length&&(oe=_.shift());)_.length||G===void 0?Q[oe]&&Q[oe]!==Object.prototype[oe]?Q=Q[oe]:Q=Q[oe]={}:Q[oe]=G}function V(_){var G;e:{if((G=z.navigator)&&(G=G.userAgent))break e;G=""}return G.indexOf(_)!=-1}var H=Array.prototype.map?function(_,G){return Array.prototype.map.call(_,G,void 0)}:function(_,G){for(var Q=_.length,oe=Array(Q),Se=typeof _=="string"?_.split(""):_,ke=0;ke<Q;ke++)ke in Se&&(oe[ke]=G.call(void 0,Se[ke],ke,_));return oe},K={},ne=null;function fe(_){var G=_.length,Q=3*G/4;Q%3?Q=Math.floor(Q):"=.".indexOf(_[G-1])!=-1&&(Q="=.".indexOf(_[G-2])!=-1?Q-2:Q-1);var oe=new Uint8Array(Q),Se=0;return ee(_,function(ke){oe[Se++]=ke}),Se!==Q?oe.subarray(0,Se):oe}function ee(_,G){function Q(qe){for(;oe<_.length;){var rt=_.charAt(oe++),ft=ne[rt];if(ft!=null)return ft;if(!/^[\s\xa0]*$/.test(rt))throw Error("Unknown base64 encoding at char: "+rt)}return qe}de();for(var oe=0;;){var Se=Q(-1),ke=Q(0),Ce=Q(64),Fe=Q(64);if(Fe===64&&Se===-1)break;G(Se<<2|ke>>4),Ce!=64&&(G(ke<<4&240|Ce>>2),Fe!=64&&G(Ce<<6&192|Fe))}}function de(){if(!ne){ne={};for(var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),G=["+/=","+/","-_=","-_.","-_"],Q=0;5>Q;Q++){var oe=_.concat(G[Q].split(""));K[Q]=oe;for(var Se=0;Se<oe.length;Se++){var ke=oe[Se];ne[ke]===void 0&&(ne[ke]=Se)}}}}var ge=typeof Uint8Array<"u",Z=!(V("Trident")||V("MSIE"))&&typeof z.btoa=="function";function we(_){if(!Z){var G;G===void 0&&(G=0),de(),G=K[G];for(var Q=Array(Math.floor(_.length/3)),oe=G[64]||"",Se=0,ke=0;Se<_.length-2;Se+=3){var Ce=_[Se],Fe=_[Se+1],qe=_[Se+2],rt=G[Ce>>2];Ce=G[(Ce&3)<<4|Fe>>4],Fe=G[(Fe&15)<<2|qe>>6],qe=G[qe&63],Q[ke++]=rt+Ce+Fe+qe}switch(rt=0,qe=oe,_.length-Se){case 2:rt=_[Se+1],qe=G[(rt&15)<<2]||oe;case 1:_=_[Se],Q[ke]=G[_>>2]+G[(_&3)<<4|rt>>4]+qe+oe}return Q.join("")}for(G="";10240<_.length;)G+=String.fromCharCode.apply(null,_.subarray(0,10240)),_=_.subarray(10240);return G+=String.fromCharCode.apply(null,_),btoa(G)}var Ee=RegExp("[-_.]","g");function Le(_){switch(_){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function De(_){if(!Z)return fe(_);Ee.test(_)&&(_=_.replace(Ee,Le)),_=atob(_);for(var G=new Uint8Array(_.length),Q=0;Q<_.length;Q++)G[Q]=_.charCodeAt(Q);return G}var Be;function se(){return Be||(Be=new Uint8Array(0))}var le={},ye=typeof Uint8Array.prototype.slice=="function",ve=0,xe=0;function Ie(_){var G=0>_;_=Math.abs(_);var Q=_>>>0;_=Math.floor((_-Q)/4294967296),G&&(Q=a(L(Q,_)),G=Q.next().value,_=Q.next().value,Q=G),ve=Q>>>0,xe=_>>>0}var te=typeof BigInt=="function";function L(_,G){return G=~G,_?_=~_+1:G+=1,[_,G]}function U(_,G){this.i=_>>>0,this.h=G>>>0}function re(_){if(!_)return q||(q=new U(0,0));if(!/^-?\d+$/.test(_))return null;if(16>_.length)Ie(Number(_));else if(te)_=BigInt(_),ve=Number(_&BigInt(4294967295))>>>0,xe=Number(_>>BigInt(32)&BigInt(4294967295));else{var G=+(_[0]==="-");xe=ve=0;for(var Q=_.length,oe=G,Se=(Q-G)%6+G;Se<=Q;oe=Se,Se+=6)oe=Number(_.slice(oe,Se)),xe*=1e6,ve=1e6*ve+oe,4294967296<=ve&&(xe+=ve/4294967296|0,ve%=4294967296);G&&(G=a(L(ve,xe)),_=G.next().value,G=G.next().value,ve=_,xe=G)}return new U(ve,xe)}var q;function ie(_,G){return Error("Invalid wire type: "+_+" (at position "+G+")")}function me(){return Error("Failed to read varint, encoding is invalid.")}function je(_,G){return Error("Tried to read past the end of the data "+G+" > "+_)}function He(){throw Error("Invalid UTF8")}function Ge(_,G){return G=String.fromCharCode.apply(null,G),_==null?G:_+G}var Je=void 0,N,k=typeof TextDecoder<"u",$,J=typeof TextEncoder<"u",ce;function be(_){if(_!==le)throw Error("illegal external caller")}function Ne(_,G){if(be(G),this.V=_,_!=null&&_.length===0)throw Error("ByteString should be constructed with non-empty values")}function at(){return ce||(ce=new Ne(null,le))}function St(_){be(le);var G=_.V;return G=G==null||ge&&G!=null&&G instanceof Uint8Array?G:typeof G=="string"?De(G):null,G==null?G:_.V=G}function mt(_){if(typeof _=="string")return{buffer:De(_),C:!1};if(Array.isArray(_))return{buffer:new Uint8Array(_),C:!1};if(_.constructor===Uint8Array)return{buffer:_,C:!1};if(_.constructor===ArrayBuffer)return{buffer:new Uint8Array(_),C:!1};if(_.constructor===Ne)return{buffer:St(_)||se(),C:!0};if(_ instanceof Uint8Array)return{buffer:new Uint8Array(_.buffer,_.byteOffset,_.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function dt(_,G){this.i=null,this.m=!1,this.h=this.j=this.l=0,_t(this,_,G)}function _t(_,G,Q){Q=Q===void 0?{}:Q,_.S=Q.S===void 0?!1:Q.S,G&&(G=mt(G),_.i=G.buffer,_.m=G.C,_.l=0,_.j=_.i.length,_.h=_.l)}dt.prototype.reset=function(){this.h=this.l};function hn(_,G){if(_.h=G,G>_.j)throw je(_.j,G)}function No(_){var G=_.i,Q=_.h,oe=G[Q++],Se=oe&127;if(oe&128&&(oe=G[Q++],Se|=(oe&127)<<7,oe&128&&(oe=G[Q++],Se|=(oe&127)<<14,oe&128&&(oe=G[Q++],Se|=(oe&127)<<21,oe&128&&(oe=G[Q++],Se|=oe<<28,oe&128&&G[Q++]&128&&G[Q++]&128&&G[Q++]&128&&G[Q++]&128&&G[Q++]&128)))))throw me();return hn(_,Q),Se}function ko(_,G){if(0>G)throw Error("Tried to read a negative byte length: "+G);var Q=_.h,oe=Q+G;if(oe>_.j)throw je(G,_.j-Q);return _.h=oe,Q}var To=[];function Pl(){this.h=[]}Pl.prototype.length=function(){return this.h.length},Pl.prototype.end=function(){var _=this.h;return this.h=[],_};function Lu(_,G,Q){for(;0<Q||127<G;)_.h.push(G&127|128),G=(G>>>7|Q<<25)>>>0,Q>>>=7;_.h.push(G)}function us(_,G){for(;127<G;)_.h.push(G&127|128),G>>>=7;_.h.push(G)}function Bh(_,G){if(To.length){var Q=To.pop();_t(Q,_,G),_=Q}else _=new dt(_,G);this.h=_,this.j=this.h.h,this.i=this.l=-1,this.setOptions(G)}Bh.prototype.setOptions=function(_){_=_===void 0?{}:_,this.ca=_.ca===void 0?!1:_.ca},Bh.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function sm(_){var G=_.h;if(G.h==G.j)return!1;_.j=_.h.h;var Q=No(_.h)>>>0;if(G=Q>>>3,Q&=7,!(0<=Q&&5>=Q))throw ie(Q,_.j);if(1>G)throw Error("Invalid field number: "+G+" (at position "+_.j+")");return _.l=G,_.i=Q,!0}function zu(_){switch(_.i){case 0:if(_.i!=0)zu(_);else e:{_=_.h;for(var G=_.h,Q=G+10,oe=_.i;G<Q;)if((oe[G++]&128)===0){hn(_,G);break e}throw me()}break;case 1:_=_.h,hn(_,_.h+8);break;case 2:_.i!=2?zu(_):(G=No(_.h)>>>0,_=_.h,hn(_,_.h+G));break;case 5:_=_.h,hn(_,_.h+4);break;case 3:G=_.l;do{if(!sm(_))throw Error("Unmatched start-group tag: stream EOF");if(_.i==4){if(_.l!=G)throw Error("Unmatched end-group tag");break}zu(_)}while(!0);break;default:throw ie(_.i,_.j)}}var Bc=[];function Xn(){this.j=[],this.i=0,this.h=new Pl}function ja(_,G){G.length!==0&&(_.j.push(G),_.i+=G.length)}function Uc(_,G){if(G=G.R){ja(_,_.h.end());for(var Q=0;Q<G.length;Q++)ja(_,St(G[Q])||se())}}var Jo=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Ci(_,G){return Jo?_[Jo]|=G:_.A!==void 0?_.A|=G:(Object.defineProperties(_,{A:{value:G,configurable:!0,writable:!0,enumerable:!1}}),G)}function Bu(_,G){Jo?_[Jo]&&(_[Jo]&=~G):_.A!==void 0&&(_.A&=~G)}function Bn(_){var G;return Jo?G=_[Jo]:G=_.A,G??0}function Ys(_,G){Jo?_[Jo]=G:_.A!==void 0?_.A=G:Object.defineProperties(_,{A:{value:G,configurable:!0,writable:!0,enumerable:!1}})}function Zn(_){return Ci(_,1),_}function Oy(_,G){Ys(G,(_|0)&-51)}function Vc(_,G){Ys(G,(_|18)&-41)}var Eo={};function Uu(_){return _!==null&&typeof _=="object"&&!Array.isArray(_)&&_.constructor===Object}var Fl,im=[];Ys(im,23),Fl=Object.freeze(im);function jc(_){if(Bn(_.o)&2)throw Error("Cannot mutate an immutable Message")}function Wc(_){var G=_.length;(G=G?_[G-1]:void 0)&&Uu(G)?G.g=1:(G={},_.push((G.g=1,G)))}function Cn(_){var G=_.i+_.G;return _.B||(_.B=_.o[G]={})}function Ks(_,G){return G===-1?null:G>=_.i?_.B?_.B[G]:void 0:_.o[G+_.G]}function Gi(_,G,Q,oe){jc(_),Re(_,G,Q,oe)}function Re(_,G,Q,oe){_.j&&(_.j=void 0),G>=_.i||oe?Cn(_)[G]=Q:(_.o[G+_.G]=Q,(_=_.B)&&G in _&&delete _[G])}function Dt(_,G,Q,oe){var Se=Ks(_,G);Array.isArray(Se)||(Se=Fl);var ke=Bn(Se);if(ke&1||Zn(Se),oe)ke&2||Ci(Se,2),Q&1||Object.freeze(Se);else{oe=!(Q&2);var Ce=ke&2;Q&1||!Ce?oe&&ke&16&&!Ce&&Bu(Se,16):(Se=Zn(Array.prototype.slice.call(Se)),Re(_,G,Se))}return Se}function an(_,G){var Q=Ks(_,G),oe=Q==null?Q:typeof Q=="number"||Q==="NaN"||Q==="Infinity"||Q==="-Infinity"?Number(Q):void 0;return oe!=null&&oe!==Q&&Re(_,G,oe),oe}function en(_,G,Q,oe,Se){_.h||(_.h={});var ke=_.h[Q],Ce=Dt(_,Q,3,Se);if(!ke){var Fe=Ce;ke=[];var qe=!!(Bn(_.o)&16);Ce=!!(Bn(Fe)&2);var rt=Fe;!Se&&Ce&&(Fe=Array.prototype.slice.call(Fe));for(var ft=Ce,Ht=0;Ht<Fe.length;Ht++){var Ft=Fe[Ht],gt=G,Ut=!1;if(Ut=Ut===void 0?!1:Ut,Ft=Array.isArray(Ft)?new gt(Ft):Ut?new gt:void 0,Ft!==void 0){gt=Ft.o;var on=Ut=Bn(gt);Ce&&(on|=2),qe&&(on|=16),on!=Ut&&Ys(gt,on),gt=on,ft=ft||!!(2&gt),ke.push(Ft)}}return _.h[Q]=ke,qe=Bn(Fe),G=qe|33,G=ft?G&-9:G|8,qe!=G&&(ft=Fe,Object.isFrozen(ft)&&(ft=Array.prototype.slice.call(ft)),Ys(ft,G),Fe=ft),rt!==Fe&&Re(_,Q,Fe),(Se||oe&&Ce)&&Ci(ke,2),oe&&Object.freeze(ke),ke}return Se||(Se=Object.isFrozen(ke),oe&&!Se?Object.freeze(ke):!oe&&Se&&(ke=Array.prototype.slice.call(ke),_.h[Q]=ke)),ke}function Wa(_,G,Q){var oe=!!(Bn(_.o)&2);if(G=en(_,G,Q,oe,oe),_=Dt(_,Q,3,oe),!(oe||Bn(_)&8)){for(oe=0;oe<G.length;oe++){if(Q=G[oe],Bn(Q.o)&2){var Se=Wh(Q,!1);Se.j=Q}else Se=Q;Q!==Se&&(G[oe]=Se,_[oe]=Se.o)}Ci(_,8)}return G}function Dr(_,G,Q){if(Q!=null&&typeof Q!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof Q+": "+Q);Gi(_,G,Q)}function Py(_,G,Q,oe,Se){jc(_);var ke=en(_,Q,G,!1,!1);return Q=oe??new Q,_=Dt(_,G,2,!1),Se!=null?(ke.splice(Se,0,Q),_.splice(Se,0,Q.o)):(ke.push(Q),_.push(Q.o)),Q.C()&&Bu(_,8),Q}function Uh(_,G){return _??G}function Ii(_,G,Q){return Q=Q===void 0?0:Q,Uh(an(_,G),Q)}var Ni;function dE(_){switch(typeof _){case"number":return isFinite(_)?_:String(_);case"object":if(_)if(Array.isArray(_)){if((Bn(_)&128)!==0)return _=Array.prototype.slice.call(_),Wc(_),_}else{if(ge&&_!=null&&_ instanceof Uint8Array)return we(_);if(_ instanceof Ne){var G=_.V;return G==null?"":typeof G=="string"?G:_.V=we(G)}}}return _}function Hi(_,G,Q,oe){if(_!=null){if(Array.isArray(_))_=Fy(_,G,Q,oe!==void 0);else if(Uu(_)){var Se={},ke;for(ke in _)Se[ke]=Hi(_[ke],G,Q,oe);_=Se}else _=G(_,oe);return _}}function Fy(_,G,Q,oe){var Se=Bn(_);oe=oe?!!(Se&16):void 0,_=Array.prototype.slice.call(_);for(var ke=0;ke<_.length;ke++)_[ke]=Hi(_[ke],G,Q,oe);return Q(Se,_),_}function hE(_){return _.ja===Eo?_.toJSON():dE(_)}function fE(_,G){_&128&&Wc(G)}function Vh(_,G,Q){if(Q=Q===void 0?Vc:Q,_!=null){if(ge&&_ instanceof Uint8Array)return _.length?new Ne(new Uint8Array(_),le):at();if(Array.isArray(_)){var oe=Bn(_);return oe&2?_:G&&!(oe&32)&&(oe&16||oe===0)?(Ys(_,oe|2),_):(_=Fy(_,Vh,oe&4?Vc:Q,!0),G=Bn(_),G&4&&G&2&&Object.freeze(_),_)}return _.ja===Eo?Gc(_):_}}function jh(_,G,Q,oe,Se,ke,Ce){if(_=_.h&&_.h[Q]){if(oe=Bn(_),oe&2?oe=_:(ke=H(_,Gc),Vc(oe,ke),Object.freeze(ke),oe=ke),jc(G),Ce=oe==null?Fl:Zn([]),oe!=null){for(ke=!!oe.length,_=0;_<oe.length;_++){var Fe=oe[_];ke=ke&&!(Bn(Fe.o)&2),Ce[_]=Fe.o}ke=(ke?8:0)|1,_=Bn(Ce),(_&ke)!==ke&&(Object.isFrozen(Ce)&&(Ce=Array.prototype.slice.call(Ce)),Ys(Ce,_|ke)),G.h||(G.h={}),G.h[Q]=oe}else G.h&&(G.h[Q]=void 0);Re(G,Q,Ce,Se)}else Gi(G,Q,Vh(oe,ke,Ce),Se)}function Gc(_){return Bn(_.o)&2||(_=Wh(_,!0),Ci(_.o,2)),_}function Wh(_,G){var Q=_.o,oe=[];Ci(oe,16);var Se=_.constructor.h;if(Se&&oe.push(Se),Se=_.B,Se){oe.length=Q.length,oe.fill(void 0,oe.length,Q.length);var ke={};oe[oe.length-1]=ke}(Bn(Q)&128)!==0&&Wc(oe),G=G||_.C()?Vc:Oy,ke=_.constructor,Ni=oe,oe=new ke(oe),Ni=void 0,_.R&&(oe.R=_.R.slice()),ke=!!(Bn(Q)&16);for(var Ce=Se?Q.length-1:Q.length,Fe=0;Fe<Ce;Fe++)jh(_,oe,Fe-_.G,Q[Fe],!1,ke,G);if(Se)for(var qe in Se)jh(_,oe,+qe,Se[qe],!0,ke,G);return oe}function qs(_,G,Q){_==null&&(_=Ni),Ni=void 0;var oe=this.constructor.i||0,Se=0<oe,ke=this.constructor.h,Ce=!1;if(_==null){_=ke?[ke]:[];var Fe=48,qe=!0;Se&&(oe=0,Fe|=128),Ys(_,Fe)}else{if(!Array.isArray(_)||ke&&ke!==_[0])throw Error();var rt=Fe=Ci(_,0);if((qe=(16&rt)!==0)&&((Ce=(32&rt)!==0)||(rt|=32)),Se){if(128&rt)oe=0;else if(0<_.length){var ft=_[_.length-1];if(Uu(ft)&&"g"in ft){oe=0,rt|=128,delete ft.g;var Ht=!0,Ft;for(Ft in ft){Ht=!1;break}Ht&&_.pop()}}}else if(128&rt)throw Error();Fe!==rt&&Ys(_,rt)}this.G=(ke?0:-1)-oe,this.h=void 0,this.o=_;e:{if(ke=this.o.length,oe=ke-1,ke&&(ke=this.o[oe],Uu(ke))){this.B=ke,this.i=oe-this.G;break e}G!==void 0&&-1<G?(this.i=Math.max(G,oe+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!Se&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(Q){G=qe&&!Ce&&!0,Se=this.i;var gt;for(qe=0;qe<Q.length;qe++)Ce=Q[qe],Ce<Se?(Ce+=this.G,(oe=_[Ce])?gv(oe,G):_[Ce]=Fl):(gt||(gt=Cn(this)),(oe=gt[Ce])?gv(oe,G):gt[Ce]=Fl)}}qs.prototype.toJSON=function(){return Fy(this.o,hE,fE)},qs.prototype.C=function(){return!!(Bn(this.o)&2)};function gv(_,G){if(Array.isArray(_)){var Q=Bn(_),oe=1;!G||Q&2||(oe|=16),(Q&oe)!==oe&&Ys(_,Q|oe)}}qs.prototype.ja=Eo,qs.prototype.toString=function(){return this.o.toString()};function om(_,G,Q){if(Q){var oe={},Se;for(Se in Q){var ke=Q[Se],Ce=ke.ra;Ce||(oe.J=ke.xa||ke.oa.W,ke.ia?(oe.aa=lm(ke.ia),Ce=function(Fe){return function(qe,rt,ft){return Fe.J(qe,rt,ft,Fe.aa)}}(oe)):ke.ka?(oe.Z=By(ke.da.P,ke.ka),Ce=function(Fe){return function(qe,rt,ft){return Fe.J(qe,rt,ft,Fe.Z)}}(oe)):Ce=oe.J,ke.ra=Ce),Ce(G,_,ke.da),oe={J:oe.J,aa:oe.aa,Z:oe.Z}}}Uc(G,_)}var Gh=Symbol();function am(_,G,Q){return _[Gh]||(_[Gh]=function(oe,Se){return G(oe,Se,Q)})}function Hc(_){var G=_[Gh];if(!G){var Q=cm(_);G=function(oe,Se){return Kc(oe,Se,Q)},_[Gh]=G}return G}function pE(_){var G=_.ia;if(G)return Hc(G);if(G=_.wa)return am(_.da.P,G,_.ka)}function Ly(_){var G=pE(_),Q=_.da,oe=_.oa.U;return G?function(Se,ke){return oe(Se,ke,Q,G)}:function(Se,ke){return oe(Se,ke,Q)}}function kn(_,G){var Q=_[G];return typeof Q=="function"&&Q.length===0&&(Q=Q(),_[G]=Q),Array.isArray(Q)&&(Yi in Q||Yc in Q||0<Q.length&&typeof Q[0]=="function")?Q:void 0}function zy(_,G,Q,oe,Se,ke){G.P=_[0];var Ce=1;if(_.length>Ce&&typeof _[Ce]!="number"){var Fe=_[Ce++];Q(G,Fe)}for(;Ce<_.length;){Q=_[Ce++];for(var qe=Ce+1;qe<_.length&&typeof _[qe]!="number";)qe++;switch(Fe=_[Ce++],qe-=Ce,qe){case 0:oe(G,Q,Fe);break;case 1:(qe=kn(_,Ce))?(Ce++,Se(G,Q,Fe,qe)):oe(G,Q,Fe,_[Ce++]);break;case 2:qe=Ce++,qe=kn(_,qe),Se(G,Q,Fe,qe,_[Ce++]);break;case 3:ke(G,Q,Fe,_[Ce++],_[Ce++],_[Ce++]);break;case 4:ke(G,Q,Fe,_[Ce++],_[Ce++],_[Ce++],_[Ce++]);break;default:throw Error("unexpected number of binary field arguments: "+qe)}}return G}var Hh=Symbol();function lm(_){var G=_[Hh];if(!G){var Q=ea(_);G=function(oe,Se){return xv(oe,Se,Q)},_[Hh]=G}return G}function By(_,G){var Q=_[Hh];return Q||(Q=function(oe,Se){return om(oe,Se,G)},_[Hh]=Q),Q}var Yc=Symbol();function yv(_,G){_.push(G)}function Uy(_,G,Q){_.push(G,Q.W)}function um(_,G,Q,oe){var Se=lm(oe),ke=ea(oe).P,Ce=Q.W;_.push(G,function(Fe,qe,rt){return Ce(Fe,qe,rt,ke,Se)})}function Ll(_,G,Q,oe,Se,ke){var Ce=By(oe,ke),Fe=Q.W;_.push(G,function(qe,rt,ft){return Fe(qe,rt,ft,oe,Ce)})}function ea(_){var G=_[Yc];return G||(G=zy(_,_[Yc]=[],yv,Uy,um,Ll),Yi in _&&Yc in _&&(_.length=0),G)}var Yi=Symbol();function Yh(_,G){_[0]=G}function Kh(_,G,Q,oe){var Se=Q.U;_[G]=oe?function(ke,Ce,Fe){return Se(ke,Ce,Fe,oe)}:Se}function zl(_,G,Q,oe,Se){var ke=Q.U,Ce=Hc(oe),Fe=cm(oe).P;_[G]=function(qe,rt,ft){return ke(qe,rt,ft,Fe,Ce,Se)}}function mE(_,G,Q,oe,Se,ke,Ce){var Fe=Q.U,qe=am(oe,Se,ke);_[G]=function(rt,ft,Ht){return Fe(rt,ft,Ht,oe,qe,Ce)}}function cm(_){var G=_[Yi];return G||(G=zy(_,_[Yi]={},Yh,Kh,zl,mE),Yi in _&&Yc in _&&(_.length=0),G)}function Kc(_,G,Q){for(;sm(G)&&G.i!=4;){var oe=G.l,Se=Q[oe];if(!Se){var ke=Q[0];ke&&(ke=ke[oe])&&(Se=Q[oe]=Ly(ke))}if(!Se||!Se(G,_,oe)){Se=G,oe=_,ke=Se.j,zu(Se);var Ce=Se;if(!Ce.ca){if(Se=Ce.h.h-ke,Ce.h.h=ke,Ce=Ce.h,Se==0)Se=at();else{if(ke=ko(Ce,Se),Ce.S&&Ce.m)Se=Ce.i.subarray(ke,ke+Se);else{Ce=Ce.i;var Fe=ke;Se=ke+Se,Se=Fe===Se?se():ye?Ce.slice(Fe,Se):new Uint8Array(Ce.subarray(Fe,Se))}Se=Se.length==0?at():new Ne(Se,le)}(ke=oe.R)?ke.push(Se):oe.R=[Se]}}}return _}function xv(_,G,Q){for(var oe=Q.length,Se=oe%2==1,ke=Se?1:0;ke<oe;ke+=2)(0,Q[ke+1])(G,_,Q[ke]);om(_,G,Se?Q[0]:void 0)}function qc(_,G){return{U:_,W:G}}var Xs=qc(function(_,G,Q){if(_.i!==5)return!1;_=_.h;var oe=_.i,Se=_.h,ke=oe[Se],Ce=oe[Se+1],Fe=oe[Se+2];return oe=oe[Se+3],hn(_,_.h+4),Ce=(ke<<0|Ce<<8|Fe<<16|oe<<24)>>>0,_=2*(Ce>>31)+1,ke=Ce>>>23&255,Ce&=8388607,Gi(G,Q,ke==255?Ce?NaN:1/0*_:ke==0?_*Math.pow(2,-149)*Ce:_*Math.pow(2,ke-150)*(Ce+Math.pow(2,23))),!0},function(_,G,Q){if(G=an(G,Q),G!=null){us(_.h,8*Q+5),_=_.h;var oe=+G;oe===0?0<1/oe?ve=xe=0:(xe=0,ve=2147483648):isNaN(oe)?(xe=0,ve=2147483647):(oe=(Q=0>oe?-2147483648:0)?-oe:oe,34028234663852886e22<oe?(xe=0,ve=(Q|2139095040)>>>0):11754943508222875e-54>oe?(oe=Math.round(oe/Math.pow(2,-149)),xe=0,ve=(Q|oe)>>>0):(G=Math.floor(Math.log(oe)/Math.LN2),oe*=Math.pow(2,-G),oe=Math.round(8388608*oe),16777216<=oe&&++G,xe=0,ve=(Q|G+127<<23|oe&8388607)>>>0)),Q=ve,_.h.push(Q>>>0&255),_.h.push(Q>>>8&255),_.h.push(Q>>>16&255),_.h.push(Q>>>24&255)}}),wv=qc(function(_,G,Q){if(_.i!==0)return!1;var oe=_.h,Se=0,ke=_=0,Ce=oe.i,Fe=oe.h;do{var qe=Ce[Fe++];Se|=(qe&127)<<ke,ke+=7}while(32>ke&&qe&128);for(32<ke&&(_|=(qe&127)>>4),ke=3;32>ke&&qe&128;ke+=7)qe=Ce[Fe++],_|=(qe&127)<<ke;if(hn(oe,Fe),128>qe)oe=Se>>>0,qe=_>>>0,(_=qe&2147483648)&&(oe=~oe+1>>>0,qe=~qe>>>0,oe==0&&(qe=qe+1>>>0)),oe=4294967296*qe+(oe>>>0);else throw me();return Gi(G,Q,_?-oe:oe),!0},function(_,G,Q){G=Ks(G,Q),G!=null&&(typeof G=="string"&&re(G),G!=null&&(us(_.h,8*Q),typeof G=="number"?(_=_.h,Ie(G),Lu(_,ve,xe)):(Q=re(G),Lu(_.h,Q.i,Q.h))))}),gE=qc(function(_,G,Q){return _.i!==0?!1:(Gi(G,Q,No(_.h)),!0)},function(_,G,Q){if(G=Ks(G,Q),G!=null&&G!=null)if(us(_.h,8*Q),_=_.h,Q=G,0<=Q)us(_,Q);else{for(G=0;9>G;G++)_.h.push(Q&127|128),Q>>=7;_.h.push(1)}}),Xc=qc(function(_,G,Q){if(_.i!==2)return!1;var oe=No(_.h)>>>0;_=_.h;var Se=ko(_,oe);if(_=_.i,k){var ke=_,Ce;(Ce=N)||(Ce=N=new TextDecoder("utf-8",{fatal:!0})),_=Se+oe,ke=Se===0&&_===ke.length?ke:ke.subarray(Se,_);try{var Fe=Ce.decode(ke)}catch(Ht){if(Je===void 0){try{Ce.decode(new Uint8Array([128]))}catch{}try{Ce.decode(new Uint8Array([97])),Je=!0}catch{Je=!1}}throw!Je&&(N=void 0),Ht}}else{Fe=Se,oe=Fe+oe,Se=[];for(var qe=null,rt,ft;Fe<oe;)rt=_[Fe++],128>rt?Se.push(rt):224>rt?Fe>=oe?He():(ft=_[Fe++],194>rt||(ft&192)!==128?(Fe--,He()):Se.push((rt&31)<<6|ft&63)):240>rt?Fe>=oe-1?He():(ft=_[Fe++],(ft&192)!==128||rt===224&&160>ft||rt===237&&160<=ft||((ke=_[Fe++])&192)!==128?(Fe--,He()):Se.push((rt&15)<<12|(ft&63)<<6|ke&63)):244>=rt?Fe>=oe-2?He():(ft=_[Fe++],(ft&192)!==128||(rt<<28)+(ft-144)>>30!==0||((ke=_[Fe++])&192)!==128||((Ce=_[Fe++])&192)!==128?(Fe--,He()):(rt=(rt&7)<<18|(ft&63)<<12|(ke&63)<<6|Ce&63,rt-=65536,Se.push((rt>>10&1023)+55296,(rt&1023)+56320))):He(),8192<=Se.length&&(qe=Ge(qe,Se),Se.length=0);Fe=Ge(qe,Se)}return Gi(G,Q,Fe),!0},function(_,G,Q){if(G=Ks(G,Q),G!=null){var oe=!1;if(oe=oe===void 0?!1:oe,J){if(oe&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(G))throw Error("Found an unpaired surrogate");G=($||($=new TextEncoder)).encode(G)}else{for(var Se=0,ke=new Uint8Array(3*G.length),Ce=0;Ce<G.length;Ce++){var Fe=G.charCodeAt(Ce);if(128>Fe)ke[Se++]=Fe;else{if(2048>Fe)ke[Se++]=Fe>>6|192;else{if(55296<=Fe&&57343>=Fe){if(56319>=Fe&&Ce<G.length){var qe=G.charCodeAt(++Ce);if(56320<=qe&&57343>=qe){Fe=1024*(Fe-55296)+qe-56320+65536,ke[Se++]=Fe>>18|240,ke[Se++]=Fe>>12&63|128,ke[Se++]=Fe>>6&63|128,ke[Se++]=Fe&63|128;continue}else Ce--}if(oe)throw Error("Found an unpaired surrogate");Fe=65533}ke[Se++]=Fe>>12|224,ke[Se++]=Fe>>6&63|128}ke[Se++]=Fe&63|128}}G=Se===ke.length?ke:ke.subarray(0,Se)}us(_.h,8*Q+2),us(_.h,G.length),ja(_,_.h.end()),ja(_,G)}}),Zc=qc(function(_,G,Q,oe,Se){if(_.i!==2)return!1;G=Py(G,Q,oe),Q=_.h.j,oe=No(_.h)>>>0;var ke=_.h.h+oe,Ce=ke-Q;if(0>=Ce&&(_.h.j=ke,Se(G,_,void 0,void 0,void 0),Ce=ke-_.h.h),Ce)throw Error("Message parsing ended unexpectedly. Expected to read "+(oe+" bytes, instead read "+(oe-Ce)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return _.h.h=ke,_.h.j=Q,!0},function(_,G,Q,oe,Se){if(G=Wa(G,oe,Q),G!=null)for(oe=0;oe<G.length;oe++){var ke=_;us(ke.h,8*Q+2);var Ce=ke.h.end();ja(ke,Ce),Ce.push(ke.i),ke=Ce,Se(G[oe],_),Ce=_;var Fe=ke.pop();for(Fe=Ce.i+Ce.h.length()-Fe;127<Fe;)ke.push(Fe&127|128),Fe>>>=7,Ce.i++;ke.push(Fe),Ce.i++}});function Bl(_){return function(G,Q){e:{if(Bc.length){var oe=Bc.pop();oe.setOptions(Q),_t(oe.h,G,Q),G=oe}else G=new Bh(G,Q);try{var Se=cm(_),ke=Kc(new Se.P,G,Se);break e}finally{Se=G.h,Se.i=null,Se.m=!1,Se.l=0,Se.j=0,Se.h=0,Se.S=!1,G.l=-1,G.i=-1,100>Bc.length&&Bc.push(G)}ke=void 0}return ke}}function Qc(_){return function(){var G=new Xn;xv(this,G,ea(_)),ja(G,G.h.end());for(var Q=new Uint8Array(G.i),oe=G.j,Se=oe.length,ke=0,Ce=0;Ce<Se;Ce++){var Fe=oe[Ce];Q.set(Fe,ke),ke+=Fe.length}return G.j=[Q],Q}}function Jc(_){qs.call(this,_)}x(Jc,qs);var bv=[Jc,1,gE,2,Xs,3,Xc,4,Xc];Jc.prototype.l=Qc(bv);function qh(_){qs.call(this,_,-1,dm)}x(qh,qs),qh.prototype.addClassification=function(_,G){return Py(this,1,Jc,_,G),this};var dm=[1],Vy=Bl([qh,1,Zc,bv]);function ed(_){qs.call(this,_)}x(ed,qs);var Ga=[ed,1,Xs,2,Xs,3,Xs,4,Xs,5,Xs];ed.prototype.l=Qc(Ga);function hm(_){qs.call(this,_,-1,fm)}x(hm,qs);var fm=[1],vv=Bl([hm,1,Zc,Ga]);function Vu(_){qs.call(this,_)}x(Vu,qs);var Xh=[Vu,1,Xs,2,Xs,3,Xs,4,Xs,5,Xs,6,wv],Sv=Bl(Xh);Vu.prototype.l=Qc(Xh);function Zs(_,G,Q){if(Q=_.createShader(Q===0?_.VERTEX_SHADER:_.FRAGMENT_SHADER),_.shaderSource(Q,G),_.compileShader(Q),!_.getShaderParameter(Q,_.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+_.getShaderInfoLog(Q));return Q}function td(_){return Wa(_,Jc,1).map(function(G){var Q=Ks(G,1);return{index:Q??0,qa:Ii(G,2),label:Ks(G,3)!=null?Uh(Ks(G,3),""):void 0,displayName:Ks(G,4)!=null?Uh(Ks(G,4),""):void 0}})}function jy(_){return{x:Ii(_,1),y:Ii(_,2),z:Ii(_,3),visibility:an(_,4)!=null?Ii(_,4):void 0}}function ju(_){return Wa(vv(_),ed,1).map(jy)}function Wy(_,G){this.i=_,this.h=G,this.m=0}function pm(_,G,Q){return Gy(_,G),typeof _.h.canvas.transferToImageBitmap=="function"?Promise.resolve(_.h.canvas.transferToImageBitmap()):Q?Promise.resolve(_.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(_.h.canvas):(_.j===void 0&&(_.j=document.createElement("canvas")),new Promise(function(oe){_.j.height=_.h.canvas.height,_.j.width=_.h.canvas.width,_.j.getContext("2d",{}).drawImage(_.h.canvas,0,0,_.h.canvas.width,_.h.canvas.height),oe(_.j)}))}function Gy(_,G){var Q=_.h;if(_.s===void 0){var oe=Zs(Q,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),Se=Zs(Q,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),ke=Q.createProgram();if(Q.attachShader(ke,oe),Q.attachShader(ke,Se),Q.linkProgram(ke),!Q.getProgramParameter(ke,Q.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+Q.getProgramInfoLog(ke));oe=_.s=ke,Q.useProgram(oe),Se=Q.getUniformLocation(oe,"sampler0"),_.l={O:Q.getAttribLocation(oe,"aVertex"),N:Q.getAttribLocation(oe,"aTex"),ya:Se},_.v=Q.createBuffer(),Q.bindBuffer(Q.ARRAY_BUFFER,_.v),Q.enableVertexAttribArray(_.l.O),Q.vertexAttribPointer(_.l.O,2,Q.FLOAT,!1,0,0),Q.bufferData(Q.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),Q.STATIC_DRAW),Q.bindBuffer(Q.ARRAY_BUFFER,null),_.u=Q.createBuffer(),Q.bindBuffer(Q.ARRAY_BUFFER,_.u),Q.enableVertexAttribArray(_.l.N),Q.vertexAttribPointer(_.l.N,2,Q.FLOAT,!1,0,0),Q.bufferData(Q.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),Q.STATIC_DRAW),Q.bindBuffer(Q.ARRAY_BUFFER,null),Q.uniform1i(Se,0)}oe=_.l,Q.useProgram(_.s),Q.canvas.width=G.width,Q.canvas.height=G.height,Q.viewport(0,0,G.width,G.height),Q.activeTexture(Q.TEXTURE0),_.i.bindTexture2d(G.glName),Q.enableVertexAttribArray(oe.O),Q.bindBuffer(Q.ARRAY_BUFFER,_.v),Q.vertexAttribPointer(oe.O,2,Q.FLOAT,!1,0,0),Q.enableVertexAttribArray(oe.N),Q.bindBuffer(Q.ARRAY_BUFFER,_.u),Q.vertexAttribPointer(oe.N,2,Q.FLOAT,!1,0,0),Q.bindFramebuffer(Q.DRAW_FRAMEBUFFER?Q.DRAW_FRAMEBUFFER:Q.FRAMEBUFFER,null),Q.clearColor(0,0,0,0),Q.clear(Q.COLOR_BUFFER_BIT),Q.colorMask(!0,!0,!0,!0),Q.drawArrays(Q.TRIANGLE_FAN,0,4),Q.disableVertexAttribArray(oe.O),Q.disableVertexAttribArray(oe.N),Q.bindBuffer(Q.ARRAY_BUFFER,null),_.i.bindTexture2d(0)}function Zh(_){this.h=_}var mm=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Cv(_,G){return G+_}function Iv(_,G){window[_]=G}function yE(_){var G=document.createElement("script");return G.setAttribute("src",_),G.setAttribute("crossorigin","anonymous"),new Promise(function(Q){G.addEventListener("load",function(){Q()},!1),G.addEventListener("error",function(){Q()},!1),document.body.appendChild(G)})}function xE(){return O(function(_){switch(_.h){case 1:return _.s=2,C(_,WebAssembly.instantiate(mm),4);case 4:_.h=3,_.s=0;break;case 2:return _.s=0,_.l=null,_.return(!1);case 3:return _.return(!0)}})}function Qh(_){if(this.h=_,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=_&&_.locateFile||Cv,typeof window=="object")var G=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")G=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=G,_.options){G=a(Object.keys(_.options));for(var Q=G.next();!Q.done;Q=G.next()){Q=Q.value;var oe=_.options[Q].default;oe!==void 0&&(this.l[Q]=typeof oe=="function"?oe():oe)}}}t=Qh.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function wE(_){var G,Q,oe,Se,ke,Ce,Fe,qe,rt,ft,Ht;return O(function(Ft){switch(Ft.h){case 1:return _.ga?(G=_.h.files===void 0?[]:typeof _.h.files=="function"?_.h.files(_.l):_.h.files,C(Ft,xE(),2)):Ft.return();case 2:if(Q=Ft.i,typeof window=="object")return Iv("createMediapipeSolutionsWasm",{locateFile:_.locateFile}),Iv("createMediapipeSolutionsPackedAssets",{locateFile:_.locateFile}),Ce=G.filter(function(gt){return gt.data!==void 0}),Fe=G.filter(function(gt){return gt.data===void 0}),qe=Promise.all(Ce.map(function(gt){var Ut=gm(_,gt.url);if(gt.path!==void 0){var on=gt.path;Ut=Ut.then(function(Un){return _.overrideFile(on,Un),Promise.resolve(Un)})}return Ut})),rt=Promise.all(Fe.map(function(gt){return gt.simd===void 0||gt.simd&&Q||!gt.simd&&!Q?yE(_.locateFile(gt.url,_.ha)):Promise.resolve()})).then(function(){var gt,Ut,on;return O(function(Un){if(Un.h==1)return gt=window.createMediapipeSolutionsWasm,Ut=window.createMediapipeSolutionsPackedAssets,on=_,C(Un,gt(Ut),2);on.i=Un.i,Un.h=0})}),ft=function(){return O(function(gt){return _.h.graph&&_.h.graph.url?gt=C(gt,gm(_,_.h.graph.url),0):(gt.h=0,gt=void 0),gt})}(),C(Ft,Promise.all([rt,qe,ft]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return oe=G.filter(function(gt){return gt.simd===void 0||gt.simd&&Q||!gt.simd&&!Q}).map(function(gt){return _.locateFile(gt.url,_.ha)}),importScripts.apply(null,l(oe)),Se=_,C(Ft,createMediapipeSolutionsWasm(Module),6);case 6:Se.i=Ft.i,_.m=new OffscreenCanvas(1,1),_.i.canvas=_.m,ke=_.i.GL.createContext(_.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),_.i.GL.makeContextCurrent(ke),Ft.h=4;break;case 7:if(_.m=document.createElement("canvas"),Ht=_.m.getContext("webgl2",{}),!Ht&&(Ht=_.m.getContext("webgl",{}),!Ht))return alert("Failed to create WebGL canvas context when passing video frame."),Ft.return();_.K=Ht,_.i.canvas=_.m,_.i.createContext(_.m,!0,!0,{});case 4:_.j=new _.i.SolutionWasm,_.ga=!1,Ft.h=0}})}function bE(_){var G,Q,oe,Se,ke,Ce,Fe,qe;return O(function(rt){if(rt.h==1){if(_.h.graph&&_.h.graph.url&&_.fa===_.h.graph.url)return rt.return();if(_.u=!0,!_.h.graph||!_.h.graph.url){rt.h=2;return}return _.fa=_.h.graph.url,C(rt,gm(_,_.h.graph.url),3)}for(rt.h!=2&&(G=rt.i,_.j.loadGraph(G)),Q=a(Object.keys(_.D)),oe=Q.next();!oe.done;oe=Q.next())Se=oe.value,_.j.overrideFile(Se,_.D[Se]);if(_.D={},_.h.listeners)for(ke=a(_.h.listeners),Ce=ke.next();!Ce.done;Ce=ke.next())Fe=Ce.value,CE(_,Fe);qe=_.l,_.l={},_.setOptions(qe),rt.h=0})}t.reset=function(){var _=this;return O(function(G){_.j&&(_.j.reset(),_.s={},_.v={}),G.h=0})},t.setOptions=function(_,G){var Q=this;if(G=G||this.h.options){for(var oe=[],Se=[],ke={},Ce=a(Object.keys(_)),Fe=Ce.next();!Fe.done;ke={X:ke.X,Y:ke.Y},Fe=Ce.next())if(Fe=Fe.value,!(Fe in this.l&&this.l[Fe]===_[Fe])){this.l[Fe]=_[Fe];var qe=G[Fe];qe!==void 0&&(qe.onChange&&(ke.X=qe.onChange,ke.Y=_[Fe],oe.push(function(rt){return function(){var ft;return O(function(Ht){if(Ht.h==1)return C(Ht,rt.X(rt.Y),2);ft=Ht.i,ft===!0&&(Q.u=!0),Ht.h=0})}}(ke))),qe.graphOptionXref&&(Fe=Object.assign({},{calculatorName:"",calculatorIndex:0},qe.graphOptionXref,{valueNumber:qe.type===1?_[Fe]:0,valueBoolean:qe.type===0?_[Fe]:!1,valueString:qe.type===2?_[Fe]:""}),Se.push(Fe)))}(oe.length!==0||Se.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(Se),this.F=(this.F===void 0?[]:this.F).concat(oe))}};function vE(_){var G,Q,oe,Se,ke,Ce,Fe;return O(function(qe){switch(qe.h){case 1:if(!_.u)return qe.return();if(!_.F){qe.h=2;break}G=a(_.F),Q=G.next();case 3:if(Q.done){qe.h=5;break}return oe=Q.value,C(qe,oe(),4);case 4:Q=G.next(),qe.h=3;break;case 5:_.F=void 0;case 2:if(_.H){for(Se=new _.i.GraphOptionChangeRequestList,ke=a(_.H),Ce=ke.next();!Ce.done;Ce=ke.next())Fe=Ce.value,Se.push_back(Fe);_.j.changeOptions(Se),Se.delete(),_.H=void 0}_.u=!1,qe.h=0}})}t.initialize=function(){var _=this;return O(function(G){return G.h==1?C(G,wE(_),2):G.h!=3?C(G,bE(_),3):C(G,vE(_),0)})};function gm(_,G){var Q,oe;return O(function(Se){return G in _.L?Se.return(_.L[G]):(Q=_.locateFile(G,""),oe=fetch(Q).then(function(ke){return ke.arrayBuffer()}),_.L[G]=oe,Se.return(oe))})}t.overrideFile=function(_,G){this.j?this.j.overrideFile(_,G):this.D[_]=G},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(_,G){var Q=this,oe,Se,ke,Ce,Fe,qe,rt,ft,Ht;return O(function(Ft){switch(Ft.h){case 1:return Q.h.inputs?(oe=1e3*(G??performance.now()),C(Ft,Q.I,2)):Ft.return();case 2:return C(Ft,Q.initialize(),3);case 3:for(Se=new Q.i.PacketDataList,ke=a(Object.keys(_)),Ce=ke.next();!Ce.done;Ce=ke.next())if(Fe=Ce.value,qe=Q.h.inputs[Fe]){e:{var gt=_[Fe];switch(qe.type){case"video":var Ut=Q.s[qe.stream];if(Ut||(Ut=new Wy(Q.i,Q.K),Q.s[qe.stream]=Ut),Ut.m===0&&(Ut.m=Ut.i.createTexture()),typeof HTMLVideoElement<"u"&&gt instanceof HTMLVideoElement)var on=gt.videoWidth,Un=gt.videoHeight;else typeof HTMLImageElement<"u"&&gt instanceof HTMLImageElement?(on=gt.naturalWidth,Un=gt.naturalHeight):(on=gt.width,Un=gt.height);Un={glName:Ut.m,width:on,height:Un},on=Ut.h,on.canvas.width=Un.width,on.canvas.height=Un.height,on.activeTexture(on.TEXTURE0),Ut.i.bindTexture2d(Ut.m),on.texImage2D(on.TEXTURE_2D,0,on.RGBA,on.RGBA,on.UNSIGNED_BYTE,gt),Ut.i.bindTexture2d(0),Ut=Un;break e;case"detections":for(Ut=Q.s[qe.stream],Ut||(Ut=new Zh(Q.i),Q.s[qe.stream]=Ut),Ut.data||(Ut.data=new Ut.h.DetectionListData),Ut.data.reset(gt.length),Un=0;Un<gt.length;++Un){on=gt[Un];var Mn=Ut.data,Gr=Mn.setBoundingBox,ki=Un,Ds=on.la,cn=new Vu;if(Dr(cn,1,Ds.sa),Dr(cn,2,Ds.ta),Dr(cn,3,Ds.height),Dr(cn,4,Ds.width),Dr(cn,5,Ds.rotation),Gi(cn,6,Ds.pa),Ds=cn.l(),Gr.call(Mn,ki,Ds),on.ea)for(Mn=0;Mn<on.ea.length;++Mn){cn=on.ea[Mn],Gr=Ut.data,ki=Gr.addNormalizedLandmark,Ds=Un,cn=Object.assign({},cn,{visibility:cn.visibility?cn.visibility:0});var cs=new ed;Dr(cs,1,cn.x),Dr(cs,2,cn.y),Dr(cs,3,cn.z),cn.visibility&&Dr(cs,4,cn.visibility),cn=cs.l(),ki.call(Gr,Ds,cn)}if(on.ba)for(Mn=0;Mn<on.ba.length;++Mn)Gr=Ut.data,ki=Gr.addClassification,Ds=Un,cn=on.ba[Mn],cs=new Jc,Dr(cs,2,cn.qa),cn.index&&Gi(cs,1,cn.index),cn.label&&Gi(cs,3,cn.label),cn.displayName&&Gi(cs,4,cn.displayName),cn=cs.l(),ki.call(Gr,Ds,cn)}Ut=Ut.data;break e;default:Ut={}}}switch(rt=Ut,ft=qe.stream,qe.type){case"video":Se.pushTexture2d(Object.assign({},rt,{stream:ft,timestamp:oe}));break;case"detections":Ht=rt,Ht.stream=ft,Ht.timestamp=oe,Se.pushDetectionList(Ht);break;default:throw Error("Unknown input config type: '"+qe.type+"'")}}return Q.j.send(Se),C(Ft,Q.I,4);case 4:Se.delete(),Ft.h=0}})};function SE(_,G,Q){var oe,Se,ke,Ce,Fe,qe,rt,ft,Ht,Ft,gt,Ut,on,Un;return O(function(Mn){switch(Mn.h){case 1:if(!Q)return Mn.return(G);for(oe={},Se=0,ke=a(Object.keys(Q)),Ce=ke.next();!Ce.done;Ce=ke.next())Fe=Ce.value,qe=Q[Fe],typeof qe!="string"&&qe.type==="texture"&&G[qe.stream]!==void 0&&++Se;1<Se&&(_.M=!1),rt=a(Object.keys(Q)),Ce=rt.next();case 2:if(Ce.done){Mn.h=4;break}if(ft=Ce.value,Ht=Q[ft],typeof Ht=="string")return on=oe,Un=ft,C(Mn,Nv(_,ft,G[Ht]),14);if(Ft=G[Ht.stream],Ht.type==="detection_list"){if(Ft){for(var Gr=Ft.getRectList(),ki=Ft.getLandmarksList(),Ds=Ft.getClassificationsList(),cn=[],cs=0;cs<Gr.size();++cs){var Ul=Sv(Gr.get(cs)),IE=Ii(Ul,1),Ev=Ii(Ul,2),_v=Ii(Ul,3),Jh=Ii(Ul,4),ef=Ii(Ul,5,0),ym=void 0;ym=ym===void 0?0:ym,Ul={la:{sa:IE,ta:Ev,height:_v,width:Jh,rotation:ef,pa:Uh(Ks(Ul,6),ym)},ea:ju(ki.get(cs)),ba:td(Vy(Ds.get(cs)))},cn.push(Ul)}Gr=cn}else Gr=[];oe[ft]=Gr,Mn.h=7;break}if(Ht.type==="proto_list"){if(Ft){for(Gr=Array(Ft.size()),ki=0;ki<Ft.size();ki++)Gr[ki]=Ft.get(ki);Ft.delete()}else Gr=[];oe[ft]=Gr,Mn.h=7;break}if(Ft===void 0){Mn.h=3;break}if(Ht.type==="float_list"){oe[ft]=Ft,Mn.h=7;break}if(Ht.type==="proto"){oe[ft]=Ft,Mn.h=7;break}if(Ht.type!=="texture")throw Error("Unknown output config type: '"+Ht.type+"'");return gt=_.v[ft],gt||(gt=new Wy(_.i,_.K),_.v[ft]=gt),C(Mn,pm(gt,Ft,_.M),13);case 13:Ut=Mn.i,oe[ft]=Ut;case 7:Ht.transform&&oe[ft]&&(oe[ft]=Ht.transform(oe[ft])),Mn.h=3;break;case 14:on[Un]=Mn.i;case 3:Ce=rt.next(),Mn.h=2;break;case 4:return Mn.return(oe)}})}function Nv(_,G,Q){var oe;return O(function(Se){return typeof Q=="number"||Q instanceof Uint8Array||Q instanceof _.i.Uint8BlobList?Se.return(Q):Q instanceof _.i.Texture2dDataOut?(oe=_.v[G],oe||(oe=new Wy(_.i,_.K),_.v[G]=oe),Se.return(pm(oe,Q,_.M))):Se.return(void 0)})}function CE(_,G){for(var Q=G.name||"$",oe=[].concat(l(G.wants)),Se=new _.i.StringList,ke=a(G.wants),Ce=ke.next();!Ce.done;Ce=ke.next())Se.push_back(Ce.value);ke=_.i.PacketListener.implement({onResults:function(Fe){for(var qe={},rt=0;rt<G.wants.length;++rt)qe[oe[rt]]=Fe.get(rt);var ft=_.listeners[Q];ft&&(_.I=SE(_,qe,G.outs).then(function(Ht){Ht=ft(Ht);for(var Ft=0;Ft<G.wants.length;++Ft){var gt=qe[oe[Ft]];typeof gt=="object"&&gt.hasOwnProperty&&gt.hasOwnProperty("delete")&&gt.delete()}Ht&&(_.I=Ht)}))}}),_.j.attachMultiListener(Se,ke),Se.delete()}t.onResults=function(_,G){this.listeners[G||"$"]=_},B("Solution",Qh),B("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function kv(_){switch(_===void 0&&(_=0),_){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function Tv(_){var G=this;_=_||{},this.h=new Qh({locateFile:_.locateFile,files:function(Q){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:kv(Q.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:ju},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:ju},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(Q){var oe,Se,ke;return O(function(Ce){return Ce.h==1?(oe=kv(Q),Se="third_party/mediapipe/modules/pose_landmark/"+oe,C(Ce,gm(G.h,oe),2)):(ke=Ce.i,G.h.overrideFile(Se,ke),Ce.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}t=Tv.prototype,t.reset=function(){this.h.reset()},t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(_){this.h.onResults(_)},t.initialize=function(){var _=this;return O(function(G){return C(G,_.h.initialize(),0)})},t.send=function(_,G){var Q=this;return O(function(oe){return C(oe,Q.h.send(_,G),0)})},t.setOptions=function(_){this.h.setOptions(_)},B("Pose",Tv),B("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),B("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),B("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),B("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),B("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),B("VERSION","0.5.1675469404")}).call(v3)),v3}var CC=Y1e();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K1e=1e-7,q1e=1e-4;class cO{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class KN{refCount(e){return no("refCount")}incRef(e){return no("incRef")}timerAvailable(){return!0}time(e){return no("time")}read(e){return no("read")}readSync(e){return no("readSync")}readToGPU(e,n){return no("readToGPU")}numDataIds(){return no("numDataIds")}disposeData(e,n){return no("disposeData")}write(e,n,r){return no("write")}move(e,n,r,s,i){return no("move")}createTensorFromGPUData(e,n,r){return no("createTensorFromGPUData")}memory(){return no("memory")}floatPrecision(){return no("floatPrecision")}epsilon(){return this.floatPrecision()===32?K1e:q1e}dispose(){return no("dispose")}}function no(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,hg(t,e,n)}function yp(t,e,n){return Math.max(t,Math.min(e,n))}function dO(t){return t%2===0?t:t+1}function hg(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function EY(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function ae(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Wi(t,e,n=""){ae(nn(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function w0(t){ae(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ue(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function CU(t){return t.length===0}function Z1e(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function nn(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Yg(t){return t%1===0}function pR(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function $g(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function IU(t,e=s=>0,n,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(t()){s();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function hO(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Jt(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),ae(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),ae(t.every(r=>Yg(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function _h(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:Jt(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function is(t,e){return br(t,e)}function br(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function Q1e(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function J1e(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function fO(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function SI(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function ebe(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function b0(t){return typeof t=="string"||t instanceof String}function tbe(t){return typeof t=="boolean"}function mR(t){return typeof t=="number"}function zp(t){return Array.isArray(t)?zp(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":mR(t)?"float32":b0(t)?"string":tbe(t)?"bool":"float32"}function gR(t){return!!(t&&t.constructor&&t.call&&t.apply)}function yR(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function $t(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function _Y(t,e,n,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)s[l]=_Y(t+l*a,o,n,r)}return s}function _a(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,i)=>s*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return _Y(0,t,e,n)}function IC(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function pO(t,e){const n=As(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function As(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function AY(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return _a(t,new Float32Array(n));if(e==="int32")return _a(t,new Int32Array(n));if(e==="bool")return _a(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function qo(t){t.forEach(e=>{ae(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function xu(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function v0(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function xp(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NU="tfjsflags";class nbe{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=rbe,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(We().getBool("IS_TEST")||We().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];We().getBool("IS_TEST")||We().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(xp(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);NU in e&&e[NU].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=ibe(s,i)})}}function rbe(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(sbe(e,r[0],r[1]),r.join("="))),e}function sbe(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function ibe(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function We(){return $Y}let $Y=null;function obe(t){$Y=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let S3;function RY(){if(S3==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");S3=t}return S3}function abe(){const t=RY();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function mO(t,e){const n=abe();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const j1="Abs",S0="Acos",C0="Acosh",Bp="Add",W1="AddN",qN="All",XN="Any",G1="ArgMax",H1="ArgMin",I0="Asin",N0="Asinh",k0="Atan",T0="Atanh",E0="Atan2",Y1="AvgPool",ZN="AvgPoolGrad",K1="AvgPool3D",QN="AvgPool3DGrad",q1="BatchMatMul",X1="BatchToSpaceND",JN="Bincount",ek="BitwiseAnd",lbe="BroadcastTo",tk="BroadcastArgs",_0="Cast",A0="Ceil",$0="ClipByValue",nk="Complex",Z1="ComplexAbs",Q1="Concat",J1="Conv2D",rk="Conv2DBackpropFilter",eb="Conv2DBackpropInput",tb="Conv3D",sk="Conv3DBackpropFilterV2",ik="Conv3DBackpropInputV2",R0="Cos",M0="Cosh",ok="Cumprod",nb="Cumsum",ak="CropAndResize",lk="DenseBincount",uk="DepthToSpace",rb="DepthwiseConv2dNative",ck="DepthwiseConv2dNativeBackpropFilter",dk="DepthwiseConv2dNativeBackpropInput",hk="Diag",sb="Dilation2D",CI="Dilation2DBackpropInput",II="Dilation2DBackpropFilter",gO="Draw",D0="RealDiv",fk="Einsum",O0="Elu",pk="EluGrad",P0="Erf",ib="Equal",F0="Exp",ob="ExpandDims",L0="Expm1",mk="FFT",gk="Fill",yk="FlipLeftRight",z0="Floor",B0="FloorDiv",ab="FusedBatchNorm",lb="GatherV2",xk="GatherNd",ub="Greater",U0="GreaterEqual",V0="Identity",wk="IFFT",bk="Imag",j0="IsFinite",W0="IsInf",G0="IsNan",cb="LeakyRelu",db="Less",hb="LessEqual",vk="LinSpace",H0="Log",Y0="Log1p",fb="LogicalAnd",pb="LogicalNot",mb="LogicalOr",ube="LogSoftmax",gb="LRN",Sk="LRNGrad",yb="Max",K0="Maximum",xb="MaxPool",Ck="MaxPoolGrad",wb="MaxPool3D",Ik="MaxPool3DGrad",Nk="MaxPoolWithArgmax",bb="Mean",vb="Min",q0="Minimum",Sb="MirrorPad",X0="Mod",kk="Multinomial",Z0="Multiply",Cb="Neg",Ib="NotEqual",Tk="NonMaxSuppressionV3",yO="NonMaxSuppressionV4",Ek="NonMaxSuppressionV5",Nb="OnesLike",kb="OneHot",Tb="Pack",Eb="PadV2",Q0="Pow",_b="Prelu",Ab="Prod",xO="RaggedGather",wO="RaggedRange",bO="RaggedTensorToTensor",_k="Range",Ak="Real",J0="Reciprocal",ey="Relu",$b="Reshape",Rb="ResizeNearestNeighbor",$k="ResizeNearestNeighborGrad",Mb="ResizeBilinear",Rk="ResizeBilinearGrad",ty="Relu6",Db="Reverse",ny="Round",ry="Rsqrt",Mk="ScatterNd",Dk="TensorScatterUpdate",Ok="SearchSorted",Ob="Select",sy="Selu",Pb="Slice",iy="Sin",oy="Sinh",ay="Sign",ly="Sigmoid",uy="Softplus",cy="Sqrt",Fb="Sum",Lb="SpaceToBatchND",zb="SplitV",Bb="Softmax",vO="SparseFillEmptyRows",SO="SparseReshape",Pk="SparseSegmentMean",Fk="SparseSegmentSum",Lk="SparseToDense",dy="SquaredDifference",zk="Square",Bk="StaticRegexReplace",Uk="StridedSlice",Vk="StringNGrams",CO="StringSplit",IO="StringToHashBucketFast",hy="Sub",fy="Tan",py="Tanh",my="Tile",jk="TopK",Wk="Transform",tp="Transpose",NO="Unique",Ub="Unpack",Vb="UnsortedSegmentSum",jb="ZerosLike",gy="Step",NI="FromPixels",Gk="RotateWithOffset",Zw="_FusedMatMul",Qw="FusedConv2D",Jw="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uo(...t){We().getBool("IS_TEST")||We().getBool("PROD")||console.warn(...t)}function cbe(...t){We().getBool("IS_TEST")||We().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kI=mO("kernelRegistry",()=>new Map),xR=mO("gradRegistry",()=>new Map);function TI(t,e){const n=MY(t,e);return kI.get(n)}function kU(t){return xR.get(t)}function TU(t){const e=kI.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===t&&n.push(o)}return n}function kO(t){const{kernelName:e,backendName:n}=t,r=MY(e,n);kI.has(r)&&Uo(`The kernel '${e}' for backend '${n}' is already registered`),kI.set(r,t)}function dbe(t){const{kernelName:e}=t;xR.has(e)&&We().getBool("DEBUG")&&Uo(`Overriding the gradient for '${e}'`),xR.set(e,t)}function MY(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DY(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var C3,EU;function hbe(){if(EU)return C3;EU=1,C3=e;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(M,O,j){this.low=M|0,this.high=O|0,this.unsigned=!!j}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function n(M){return(M&&M.__isLong__)===!0}e.isLong=n;var r={},s={};function i(M,O){var j,R,z;return O?(M>>>=0,(z=0<=M&&M<256)&&(R=s[M],R)?R:(j=a(M,(M|0)<0?-1:0,!0),z&&(s[M]=j),j)):(M|=0,(z=-128<=M&&M<128)&&(R=r[M],R)?R:(j=a(M,M<0?-1:0,!1),z&&(r[M]=j),j))}e.fromInt=i;function o(M,O){if(isNaN(M))return O?b:w;if(O){if(M<0)return b;if(M>=m)return P}else{if(M<=-9223372036854776e3)return I;if(M+1>=g)return D}return M<0?o(-M,O).neg():a(M%f|0,M/f|0,O)}e.fromNumber=o;function a(M,O,j){return new e(M,O,j)}e.fromBits=a;var l=Math.pow;function u(M,O,j){if(M.length===0)throw Error("empty string");if(M==="NaN"||M==="Infinity"||M==="+Infinity"||M==="-Infinity")return w;if(typeof O=="number"?(j=O,O=!1):O=!!O,j=j||10,j<2||36<j)throw RangeError("radix");var R;if((R=M.indexOf("-"))>0)throw Error("interior hyphen");if(R===0)return u(M.substring(1),O,j).neg();for(var z=o(l(j,8)),B=w,V=0;V<M.length;V+=8){var H=Math.min(8,M.length-V),K=parseInt(M.substring(V,V+H),j);if(H<8){var ne=o(l(j,H));B=B.mul(ne).add(o(K))}else B=B.mul(z),B=B.add(o(K))}return B.unsigned=O,B}e.fromString=u;function c(M,O){return typeof M=="number"?o(M,O):typeof M=="string"?u(M,O):a(M.low,M.high,typeof O=="boolean"?O:M.unsigned)}e.fromValue=c;var d=65536,h=1<<24,f=d*d,m=f*f,g=m/2,x=i(h),w=i(0);e.ZERO=w;var b=i(0,!0);e.UZERO=b;var S=i(1);e.ONE=S;var C=i(1,!0);e.UONE=C;var T=i(-1);e.NEG_ONE=T;var D=a(-1,2147483647,!1);e.MAX_VALUE=D;var P=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=P;var I=a(0,-2147483648,!1);e.MIN_VALUE=I;var E=e.prototype;return E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},E.toString=function(O){if(O=O||10,O<2||36<O)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(I)){var j=o(O),R=this.div(j),z=R.mul(j).sub(this);return R.toString(O)+z.toInt().toString(O)}else return"-"+this.neg().toString(O);for(var B=o(l(O,6),this.unsigned),V=this,H="";;){var K=V.div(B),ne=V.sub(K.mul(B)).toInt()>>>0,fe=ne.toString(O);if(V=K,V.isZero())return fe+H;for(;fe.length<6;)fe="0"+fe;H=""+fe+H}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var O=this.high!=0?this.high:this.low,j=31;j>0&&(O&1<<j)==0;j--);return this.high!=0?j+33:j+1},E.isZero=function(){return this.high===0&&this.low===0},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return(this.low&1)===1},E.isEven=function(){return(this.low&1)===0},E.equals=function(O){return n(O)||(O=c(O)),this.unsigned!==O.unsigned&&this.high>>>31===1&&O.high>>>31===1?!1:this.high===O.high&&this.low===O.low},E.eq=E.equals,E.notEquals=function(O){return!this.eq(O)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(O){return this.comp(O)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(O){return this.comp(O)<=0},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(O){return this.comp(O)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(O){return this.comp(O)>=0},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(O){if(n(O)||(O=c(O)),this.eq(O))return 0;var j=this.isNegative(),R=O.isNegative();return j&&!R?-1:!j&&R?1:this.unsigned?O.high>>>0>this.high>>>0||O.high===this.high&&O.low>>>0>this.low>>>0?-1:1:this.sub(O).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(S)},E.neg=E.negate,E.add=function(O){n(O)||(O=c(O));var j=this.high>>>16,R=this.high&65535,z=this.low>>>16,B=this.low&65535,V=O.high>>>16,H=O.high&65535,K=O.low>>>16,ne=O.low&65535,fe=0,ee=0,de=0,ge=0;return ge+=B+ne,de+=ge>>>16,ge&=65535,de+=z+K,ee+=de>>>16,de&=65535,ee+=R+H,fe+=ee>>>16,ee&=65535,fe+=j+V,fe&=65535,a(de<<16|ge,fe<<16|ee,this.unsigned)},E.subtract=function(O){return n(O)||(O=c(O)),this.add(O.neg())},E.sub=E.subtract,E.multiply=function(O){if(this.isZero())return w;if(n(O)||(O=c(O)),t){var j=t.mul(this.low,this.high,O.low,O.high);return a(j,t.get_high(),this.unsigned)}if(O.isZero())return w;if(this.eq(I))return O.isOdd()?I:w;if(O.eq(I))return this.isOdd()?I:w;if(this.isNegative())return O.isNegative()?this.neg().mul(O.neg()):this.neg().mul(O).neg();if(O.isNegative())return this.mul(O.neg()).neg();if(this.lt(x)&&O.lt(x))return o(this.toNumber()*O.toNumber(),this.unsigned);var R=this.high>>>16,z=this.high&65535,B=this.low>>>16,V=this.low&65535,H=O.high>>>16,K=O.high&65535,ne=O.low>>>16,fe=O.low&65535,ee=0,de=0,ge=0,Z=0;return Z+=V*fe,ge+=Z>>>16,Z&=65535,ge+=B*fe,de+=ge>>>16,ge&=65535,ge+=V*ne,de+=ge>>>16,ge&=65535,de+=z*fe,ee+=de>>>16,de&=65535,de+=B*ne,ee+=de>>>16,de&=65535,de+=V*K,ee+=de>>>16,de&=65535,ee+=R*fe+z*ne+B*K+V*H,ee&=65535,a(ge<<16|Z,ee<<16|de,this.unsigned)},E.mul=E.multiply,E.divide=function(O){if(n(O)||(O=c(O)),O.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&O.low===-1&&O.high===-1)return this;var j=(this.unsigned?t.div_u:t.div_s)(this.low,this.high,O.low,O.high);return a(j,t.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?b:w;var R,z,B;if(this.unsigned){if(O.unsigned||(O=O.toUnsigned()),O.gt(this))return b;if(O.gt(this.shru(1)))return C;B=b}else{if(this.eq(I)){if(O.eq(S)||O.eq(T))return I;if(O.eq(I))return S;var V=this.shr(1);return R=V.div(O).shl(1),R.eq(w)?O.isNegative()?S:T:(z=this.sub(O.mul(R)),B=R.add(z.div(O)),B)}else if(O.eq(I))return this.unsigned?b:w;if(this.isNegative())return O.isNegative()?this.neg().div(O.neg()):this.neg().div(O).neg();if(O.isNegative())return this.div(O.neg()).neg();B=w}for(z=this;z.gte(O);){R=Math.max(1,Math.floor(z.toNumber()/O.toNumber()));for(var H=Math.ceil(Math.log(R)/Math.LN2),K=H<=48?1:l(2,H-48),ne=o(R),fe=ne.mul(O);fe.isNegative()||fe.gt(z);)R-=K,ne=o(R,this.unsigned),fe=ne.mul(O);ne.isZero()&&(ne=S),B=B.add(ne),z=z.sub(fe)}return B},E.div=E.divide,E.modulo=function(O){if(n(O)||(O=c(O)),t){var j=(this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,O.low,O.high);return a(j,t.get_high(),this.unsigned)}return this.sub(this.div(O).mul(O))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return a(~this.low,~this.high,this.unsigned)},E.and=function(O){return n(O)||(O=c(O)),a(this.low&O.low,this.high&O.high,this.unsigned)},E.or=function(O){return n(O)||(O=c(O)),a(this.low|O.low,this.high|O.high,this.unsigned)},E.xor=function(O){return n(O)||(O=c(O)),a(this.low^O.low,this.high^O.high,this.unsigned)},E.shiftLeft=function(O){return n(O)&&(O=O.toInt()),(O&=63)===0?this:O<32?a(this.low<<O,this.high<<O|this.low>>>32-O,this.unsigned):a(0,this.low<<O-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(O){return n(O)&&(O=O.toInt()),(O&=63)===0?this:O<32?a(this.low>>>O|this.high<<32-O,this.high>>O,this.unsigned):a(this.high>>O-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(O){if(n(O)&&(O=O.toInt()),O&=63,O===0)return this;var j=this.high;if(O<32){var R=this.low;return a(R>>>O|j<<32-O,j>>>O,this.unsigned)}else return O===32?a(j,0,this.unsigned):a(j>>>O-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},E.toBytes=function(O){return O?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var O=this.high,j=this.low;return[j&255,j>>>8&255,j>>>16&255,j>>>24,O&255,O>>>8&255,O>>>16&255,O>>>24]},E.toBytesBE=function(){var O=this.high,j=this.low;return[O>>>24,O>>>16&255,O>>>8&255,O&255,j>>>24,j>>>16&255,j>>>8&255,j&255]},e.fromBytes=function(O,j,R){return R?e.fromBytesLE(O,j):e.fromBytesBE(O,j)},e.fromBytesLE=function(O,j){return new e(O[0]|O[1]<<8|O[2]<<16|O[3]<<24,O[4]|O[5]<<8|O[6]<<16|O[7]<<24,j)},e.fromBytesBE=function(O,j){return new e(O[4]<<24|O[5]<<16|O[6]<<8|O[7],O[0]<<24|O[1]<<16|O[2]<<8|O[3],j)},C3}var OY=hbe();const PY=Dp(OY),fbe=b8({__proto__:null,default:PY},[OY]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lf=PY||fbe;function Hk(t){return Lf.fromString(t,!0,16)}const FY=Hk("c3a5c85c97cb3127"),Rf=Hk("b492b66fbe98f273"),fi=Hk("9ae16a3b2f90404f");function wR(t){return t.xor(t.shru(47))}function LY(t,e,n){const r=t.slice(e,e+n);return Lf.fromBytes(Array.from(r),!0,!0)}function Hn(t,e){return LY(t,e,8)}function _U(t,e){return LY(t,e,4)}function ms(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function th(t,e,n=Hk("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function pbe(t,e,n,r,s,i){s=s.add(t),i=ms(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(n),i=i.add(ms(s,44)),[s.add(r),i.add(o)]}function J2(t,e,n,r){return pbe(Hn(t,e),Hn(t,e+8),Hn(t,e+16),Hn(t,e+24),n,r)}function mbe(t,e=t.length){if(e>=8){const n=fi.add(e*2),r=Hn(t,0).add(fi),s=Hn(t,e-8),i=ms(s,37).mul(n).add(r),o=ms(r,25).add(s).mul(n);return th(i,o,n)}if(e>=4){const n=fi.add(e*2),r=_U(t,0);return th(r.shl(3).add(e),_U(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],i=n+(r<<8),o=e+(s<<2);return wR(fi.mul(i).xor(FY.mul(o))).mul(fi)}return fi}function gbe(t,e=t.length){const n=fi.add(e*2),r=Hn(t,0).mul(Rf),s=Hn(t,8),i=Hn(t,e-8).mul(n),o=Hn(t,e-16).mul(fi);return th(ms(r.add(s),43).add(ms(i,30)).add(o),r.add(ms(s.add(fi),18)).add(i),n)}function ybe(t,e=t.length){const n=fi.add(e*2),r=Hn(t,0).mul(fi),s=Hn(t,8),i=Hn(t,e-8).mul(n),o=Hn(t,e-16).mul(fi),a=ms(r.add(s),43).add(ms(i,30)).add(o),l=th(a,r.add(ms(s.add(fi),18)).add(i),n),u=Hn(t,16).mul(n),c=Hn(t,24),d=a.add(Hn(t,e-32)).mul(n),h=l.add(Hn(t,e-24)).mul(n);return th(ms(u.add(c),43).add(ms(d,30)).add(h),u.add(ms(c.add(r),18)).add(d),n)}function xbe(t,e=t.length){const n=Lf.fromNumber(81,!0);if(e<=32)return e<=16?mbe(t,e):gbe(t,e);if(e<=64)return ybe(t,e);let r=n,s=n.mul(Rf).add(113),i=wR(s.mul(fi).add(113)).mul(fi),o=[Lf.UZERO,Lf.UZERO],a=[Lf.UZERO,Lf.UZERO];r=r.mul(fi).add(Hn(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=ms(r.add(s).add(o[0]).add(Hn(t,l+8)),37).mul(Rf),s=ms(s.add(o[1]).add(Hn(t,l+48)),42).mul(Rf),r=r.xor(a[1]),s=s.add(o[0]).add(Hn(t,l+40)),i=ms(i.add(a[0]),33).mul(Rf),o=J2(t,l,o[1].mul(Rf),r.add(a[0])),a=J2(t,l+32,i.add(a[1]),s.add(Hn(t,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const d=Rf.add(i.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=ms(r.add(s).add(o[0]).add(Hn(t,l+8)),37).mul(d),s=ms(s.add(o[1]).add(Hn(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(Hn(t,l+40))),i=ms(i.add(a[0]),33).mul(d),o=J2(t,l,o[1].mul(d),r.add(a[0])),a=J2(t,l+32,i.add(a[1]),s.add(Hn(t,l+16))),[i,r]=[r,i],th(th(o[0],a[0],d).add(wR(s).mul(FY)).add(i),th(o[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ah(t,e){return e==="string"?Cc(t):Up([t],e)}function wbe(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Up(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=$c(t)),We().getBool("DEBUG")&&Q1e(t,e),wbe(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Oi(){return We().platform.now()}function Cc(t,e="utf-8"){return e=e||"utf-8",We().platform.encode(t,e)}function Cl(t,e="utf-8"){return e=e||"utf-8",We().platform.decode(t,e)}function Ra(t){return We().platform.isTypedArray!=null?We().platform.isTypedArray(t):DY(t)}function $c(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||xp(t)||t==null||Ra(t)&&n)e.push(t);else if(Array.isArray(t)||Ra(t))for(let r=0;r<t.length;++r)$c(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)$c(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bbe{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Sbe)}profileKernel(e,n,r){let s;const i=()=>{s=r()};let o;const a=Oi();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const u of s)u.dataSync();o=Promise.resolve({kernelMs:Oi()-a})}if(We().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(d=>{vbe(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function vbe(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class Sbe{logKernelProfile(e,n,r,s,i,o){const a=typeof s=="number"?$g(`${s}ms`,9):s.error,l=$g(e,25),u=n.rank,c=n.size,d=$g(n.shape.toString(),14);let h="";for(const f in i){const m=i[f];if(m!=null){const g=m.shape||n.shape,x=g.length;h+=`${f}: ${x}D ${x>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const h=c[d];let f=!1;for(let m=0;m<e.length;m++)if(r[h.id]){u.outputs.forEach(g=>r[g.id]=!0),f=!0,s[u.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(i[u.outputs[d].id]){for(const h in c)i[c[h].id]=!0,o[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&o[u.id]){const c={};for(const h in u.inputs){const f=u.inputs[h];r[f.id]&&(c[h]=f)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function Ibe(t,e,n,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(l=>{const u=t[l.id];u!=null?o.push(u):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=i.inputs[l];if(!nn(u.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AU=20,_x=3,I3=7;function Nbe(t,e,n,r){const s=$t(e),i=kbe(t,e,n,s),o=e.length,a=NC(t,e,n,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function kbe(t,e,n,r){const s=Ue(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?sw(t):t;if(a>1)for(let u=0;u<s/i;u++){const c=u*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],rw(l[c+d],0,n).length)}return o}function rw(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(I3))} + ${parseFloat(t[1].toFixed(I3))}j`:b0(t)?r=`'${t}'`:n==="bool"?r=zY(t):r=parseFloat(t.toFixed(I3)).toString(),$g(r,e)}function zY(t){return t===0?"false":"true"}function NC(t,e,n,r,s,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=sw(t);return[rw(g[0],0,n)]}return n==="bool"?[zY(t[0])]:[t[0].toString()]}if(l===1){if(a>AU){const x=_x*o;let w=Array.from(t.slice(0,x)),b=Array.from(t.slice((a-_x)*o,a*o));return n==="complex64"&&(w=sw(w),b=sw(b)),["["+w.map((S,C)=>rw(S,s[C],n)).join(", ")+", ..., "+b.map((S,C)=>rw(S,s[a-_x+C],n)).join(", ")+"]"]}return["["+(n==="complex64"?sw(t):Array.from(t)).map((x,w)=>rw(x,s[w],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*o,h=[];if(a>AU){for(let g=0;g<_x;g++){const x=g*d,w=x+d;h.push(...NC(t.slice(x,w),u,n,c,s,!1))}h.push("...");for(let g=a-_x;g<a;g++){const x=g*d,w=x+d;h.push(...NC(t.slice(x,w),u,n,c,s,g===a-1))}}else for(let g=0;g<a;g++){const x=g*d,w=x+d;h.push(...NC(t.slice(x,w),u,n,c,s,g===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let g=1;g<h.length-1;g++)h[g]=" "+h[g]+f;let m=`,
`;for(let g=2;g<l;g++)m+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":m),h}function sw(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ns{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=Ue(e),r!=null){const s=r.length;ae(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||br(n,this.size),this.strides=$t(e)}set(e,...n){n.length===0&&(n=[0]),ae(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return dl().makeTensor(this.values,this.shape,this.dtype)}}let dl=null,fg=null;function Tbe(t){dl=t}function Ebe(t){fg=t}class _n{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Ue(e),this.strides=$t(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return fg.buffer(this.shape,this.dtype,e)}bufferSync(){return fg.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return _a(this.shape,e,this.dtype==="complex64")}arraySync(){return _a(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=dl().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Cl(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),dl().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=dl().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Cl(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await dl().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),dl().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return fg.print(this,e)}clone(){return this.throwIfDisposed(),fg.clone(this)}toString(e=!1){const n=this.dataSync();return Nbe(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),fg.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),dl().makeVariable(this,e,n,r)}}Object.defineProperty(_n,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function Ze(){return mO("Tensor",()=>_n)}Ze();class EI extends _n{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!nn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);dl().disposeTensor(this),this.dataId=e.dataId,dl().incRef(this,null)}dispose(){dl().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(EI,Symbol.hasInstance,{value:t=>t instanceof _n&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var $U;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})($U||($U={}));var bR;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(bR||(bR={}));var vR;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(vR||(vR={}));var SR;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(SR||(SR={}));var CR;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(CR||(CR={}));const _be={float32:SR,int32:bR,bool:vR,complex64:CR};function ws(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return _be[t][e]}function Yk(t){return ws(t,"int32")}function BY(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function UY(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sr(t,e){if(t.dtype===e.dtype)return[t,e];const n=ws(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Abe(t,e){ae(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function VY(t){const e=[];return jY(t,e,new Set),e}function jY(t,e,n){if(t==null)return;if(t instanceof _n){e.push(t);return}if(!$be(t))return;const r=t;for(const s in r){const i=r[s];n.has(i)||(n.add(i),jY(i,e,n))}}function $be(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3(t){return t.kernelName!=null}class RU{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Kg{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new RU}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Uo(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new bbe(this.backendInstance),!0}setupRegisteredKernels(){TU(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){TU(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof KN)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Uo(`Initialization of backend ${e} failed`),Uo(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Uo(`Initialization of backend ${e} failed`),Uo(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,i=this.readSync(n),o=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return Kg.nextTensorId++}nextVariableId(){return Kg.nextVariableId++}clone(e){const n=$e.runKernel(V0,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",l={x:o},u={dtype:a};return $e.runKernel(_0,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(TI(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=N3(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(N3(e)){const{kernelName:m,inputs:g,attrs:x}=e;this.backendName==null&&this.backend;const w=TI(m,this.backendName);ae(w!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();l=w.kernelFunc({inputs:g,attrs:x,backend:this.backend});const S=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,b,S);const C=S.map(T=>T.rank!=null?T:this.makeTensorFromTensorInfo(T));if(s){const T=this.getTensorsForGradient(m,g,C);r=this.saveTensorsForBackwardMode(T)}return C}}else{const{forwardFunc:m}=e,g=x=>{s&&(r=x.map(w=>this.keep(this.clone(w))))};a=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>m(this.backend,g));const w=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,x,w),w}}const{inputs:c,attrs:d}=e,h=N3(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),s&&this.addTapeNode(u,c,n,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(m=>c[m]!=null?c[m].shape:null),outputShapes:n.map(m=>m.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=kU(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(ae(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=i.map(u=>n[u]);const l=r.filter((u,c)=>o[c]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&b0(e[0])&&(i=e.map(l=>Cc(l)));const o=s.write(i,n,r),a=new _n(n,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(o),u=ebe(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:i}=e,o=new _n(s,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new EI(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*SI(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof EI||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*SI(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},l=kU(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const h=r[d],f=As(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return c}),s(u.length>1?u:u[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=VY(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,n,r,s=!1){if(ae(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));ae(i instanceof _n,()=>"The result y returned by f() must be a tensor.");const o=Cbe(this.state.activeTape,n,i);if(!s&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??Rbe(i.shape),Ibe(a,o,u=>this.tidy(u),Mbe);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return ae(gR(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{ae(n.every(a=>a instanceof _n),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const i=(a,l)=>(r=e(...n,l),ae(r.value instanceof _n,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),ae(gR(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];ae(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),ae(c.every(h=>h instanceof _n),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Oi(),r=await this.backend.time(e);return r.wallMs=Oi()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new RU;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Kg.nextTensorId=0;Kg.nextVariableId=0;function Rbe(t){const e=pO(Ue(t),"float32");return $e.makeTensor(e,t,"float32")}function WY(){const t=RY();if(t._tfengine==null){const e=new nbe(t);t._tfengine=new Kg(e)}return obe(t._tfengine.ENV),Tbe(()=>t._tfengine),t._tfengine}const $e=WY();function Mbe(t,e){const n={a:t,b:e};return $e.runKernel(Bp,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(){return typeof navigator<"u"&&navigator!=null}function GY(t){if(t||Dbe()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function HY(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ui=We();Ui.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Ui.registerFlag("IS_BROWSER",()=>HY());Ui.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Ui.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Ui.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Ui.registerFlag("PROD",()=>!1);Ui.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ui.getBool("DEBUG"));Ui.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Ui.registerFlag("IS_TEST",()=>!1);Ui.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Ui.getBool("DEBUG"));Ui.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Ui.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Ui.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $h(t,e){let n=t;if(Ra(t))return e==="string"?[]:[t.length];if(BY(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(UY(t))return[t.buffer.size/(e==null?4:SI(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Ra(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&We().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&YY(t,r,[]),r}function YY(t,e,n){if(n=n||[],!Array.isArray(t)&&!Ra(t)){ae(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}ae(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),ae(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)YY(t[s],r,n.concat(s))}function MU(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function pe(t,e,n,r="numeric"){if(t instanceof Ze())return MU(r,t.dtype,e,n),t;let s=zp(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),MU(r,s,e,n),t==null||!Ra(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=$h(t,s);!Ra(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Up(t,s):$c(t,[],!0);return $e.makeTensor(a,i,s)}function _I(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>pe(i,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KY="__op";function Ae(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+KY;const s=(...i)=>{$e.startScope(n);try{const o=r(...i);return xp(o)&&console.error("Cannot return a Promise inside of tidy."),$e.endScope(o),o}catch(o){throw $e.endScope(null),o}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(t,e){const n=pe(t,"real","complex"),r=pe(e,"imag","complex");Wi(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return $e.runKernel(nk,s)}const hh=Ae({complex_:Obe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rh(t,e,n,r){if(r==null)r=zp(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(UY(t)||BY(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return $e.backend.createTensorFromGPUData(t,e||n,r)}if(!Ra(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){qo(e);const s=Ue(e),i=Ue(n);ae(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==Ue(e.slice(o)):!0;ae(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Ra(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Up(t,r):$c(t,[],!0),$e.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wl(t,e,n){const r=$h(t,n);return Rh(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wp={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Ml{static join(e){return new Ml(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Ra(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+s.byteLength;this.shards.push({buffer:s,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,h=a,m=Math.min(n,u.end)-u.start,g=new Uint8Array(u.buffer,d,m-d);if(o.set(g,h),a+=g.length,n<u.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Pbe(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Pbe(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,i=e(t[s]);if(i===0)return s;i<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ci(){return $e}function DU(){return $e.memory()}function Ve(t,e){return $e.tidy(t,e)}function Bt(t){VY(t).forEach(n=>n.dispose())}function gs(t){return $e.keep(t)}function e1(){return $e.backendName}function TO(t,e,n=1){return $e.registerBackend(t,e,n)}function bp(){return $e.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fh=4;async function IR(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<s.length;++o){const a=s[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((x,w)=>x+w.length,0)+fh*h.length,m=new Uint8Array(f);let g=0;for(let x=0;x<h.length;x++){const w=h[x],b=new Uint8Array(new Uint32Array([w.length]).buffer);m.set(b,g),g+=fh,m.set(w,g),g+=w.length}d(m)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const i=await Promise.all(r);return{data:zbe(i),specs:n}}function qY(t,e){const n=new Ml(t),r={};let s=0;for(const i of e){const o=Fbe(i,(a,l)=>n.slice(s+a,s+l));r[i.name]=XY(i,n.slice(s,s+o)),s+=o}return r}function Fbe(t,e){const n=Ue(t.shape);let r;if("quantization"in t){const s=t.quantization;r=wp[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=fh+new Uint32Array(e(s,s+fh))[0];return s}else r=wp[t.dtype];return n*r}async function Lbe(t,e){const n=Ue(t.shape);let r;if("quantization"in t){const s=t.quantization;r=wp[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=fh+new Uint32Array(await e(s,s+fh))[0];return s}else r=wp[t.dtype];return n*r}function XY(t,e){const n=t.name,r=t.dtype,s=t.shape,i=Ue(s);let o,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=wp[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];o[d]=h*l.scale+l.min}}else if(l.dtype==="float16")o=Gbe()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];o[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*u}else if(r==="string"){const l=Ue(t.shape);o=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(a,a+fh))[0];a+=fh;const d=new Uint8Array(e.slice(a,a+c));o.push(d),a+=c}}else{const l=wp[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const u=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let m=0;m<u.length;m++)u[m]=o[m*2],c[m]=o[m*2+1];const d=wl(u,s,"float32"),h=wl(c,s,"float32"),f=hh(d,h);return d.dispose(),h.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*l}return wl(o,s,r)}async function OU(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:i}=await t.read();if(s&&i==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(r.length+i.byteLength);o.set(r,0),o.set(new Uint8Array(i),r.length),r=o}return r.buffer}async function ZY(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const i of e){const o=await Lbe(i,async(u,c)=>(s=await OU(r,s,c),s.slice(u,c)));s=await OU(r,s,o);const a=s.slice(0,o);s=s.slice(o);const l=XY(i,a);if(n[i.name]=l,e1()==="webgpu"){const u=bp();"uploadToGPU"in u&&Ue(l.shape)>=We().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function zbe(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const EO=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function PU(t){return EO?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function Bbe(t){if(EO)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function Ube(t){if(EO){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function QY(t){return Ml.join(t)}function FU(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function JY(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function eK(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function _O(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),eK(t,n,r)}function Wb(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:PU(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:PU(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Ml(t.weightData).byteLength}}function NR(t){const e=[];for(const n of t)e.push(...n.weights);return e}function Vbe(){const t=n=>{let r=n<<13,s=0;for(;(r&8388608)===0;)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function jbe(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function Wbe(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Gbe(){const t=Vbe(),e=jbe(),n=Wbe();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let o=0;o<r.length;o++){const a=r[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return cr.instance==null&&(cr.instance=new cr),cr.instance}static registerSaveRouter(e){cr.getInstance().saveRouters.push(e)}static registerLoadRouter(e){cr.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return cr.getHandlers(e,"save")}static getLoadHandlers(e,n){return cr.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?cr.getInstance().loadRouters:cr.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const Hbe=t=>cr.registerSaveRouter(t),Ybe=t=>cr.registerLoadRouter(t),tK=t=>cr.getSaveHandlers(t),Kbe=(t,e)=>cr.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kR="tensorflowjs",TR=1,Kf="models_store",Hd="model_info_store";function nK(){if(!We().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ER(t){const e=t.result;e.createObjectStore(Kf,{keyPath:"modelPath"}),e.createObjectStore(Hd,{keyPath:"modelPath"})}class vp{constructor(e){if(this.indexedDB=nK(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const i=this.indexedDB.open(kR,TR);i.onupgradeneeded=()=>ER(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(Kf,"readonly"),u=a.objectStore(Kf).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(o.close(),s(u.error)),a.oncomplete=()=>o.close()}else{n.weightData=Ml.join(n.weightData);const a=Wb(n),l=o.transaction(Hd,"readwrite");let u=l.objectStore(Hd),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return s(h)}let d;c.onsuccess=()=>{d=o.transaction(Kf,"readwrite");const h=d.objectStore(Kf);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(m){return s(m)}f.onsuccess=()=>r({modelArtifactsInfo:a}),f.onerror=m=>{u=l.objectStore(Hd);const g=u.delete(this.modelPath);g.onsuccess=()=>(o.close(),s(f.error)),g.onerror=x=>(o.close(),s(f.error))}},c.onerror=h=>(o.close(),s(c.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}vp.URL_SCHEME="indexeddb://";const rK=t=>We().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(vp.URL_SCHEME)?qbe(t.slice(vp.URL_SCHEME.length)):null;cr.registerSaveRouter(rK);cr.registerLoadRouter(rK);function qbe(t){return new vp(t)}function Xbe(t){return t.startsWith(vp.URL_SCHEME)?t.slice(vp.URL_SCHEME.length):t}class Zbe{constructor(){this.indexedDB=nK()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(kR,TR);r.onupgradeneeded=()=>ER(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(Hd,"readonly"),a=i.objectStore(Hd).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=Xbe(e),new Promise((n,r)=>{const s=this.indexedDB.open(kR,TR);s.onupgradeneeded=()=>ER(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(Hd,"readwrite"),a=o.objectStore(Hd),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=i.transaction(Kf,"readwrite");const f=u.objectStore(Kf).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=m=>r(l.error)};c.onsuccess=d,c.onerror=h=>(d(),i.close(),r(l.error))}},l.onerror=c=>(i.close(),r(l.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mc="/",pg="tensorflowjs_models",sK="info",Qbe="model_topology",Jbe="weight_specs",eve="weight_data",tve="model_metadata";function iK(t){return{info:[pg,t,sK].join(mc),topology:[pg,t,Qbe].join(mc),weightSpecs:[pg,t,Jbe].join(mc),weightData:[pg,t,eve].join(mc),modelMetadata:[pg,t,tve].join(mc)}}function oK(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function nve(t){const e=t.split(mc);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(mc)}function rve(t){return t.startsWith(Sp.URL_SCHEME)?t.slice(Sp.URL_SCHEME.length):t}class Sp{constructor(e){if(!We().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=iK(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Wb(e),i=Ml.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Bbe(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw oK(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Ube(o),n}}Sp.URL_SCHEME="localstorage://";const aK=t=>We().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Sp.URL_SCHEME)?sve(t.slice(Sp.URL_SCHEME.length)):null;cr.registerSaveRouter(aK);cr.registerLoadRouter(aK);function sve(t){return new Sp(t)}class ive{constructor(){ae(We().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),ae(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=pg+mc,r=mc+sK;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(n)&&i.endsWith(r)){const o=nve(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=rve(e);const n=iK(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return oK(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rg="://";class di{constructor(){this.managers={}}static getInstance(){return di.instance==null&&(di.instance=new di),di.instance}static registerManager(e,n){ae(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Rg)&&(e=e.slice(0,e.indexOf(Rg))),ae(e.length>0,()=>"scheme must not be an empty string.");const r=di.getInstance();ae(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=di.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(di.getInstance().managers)}}function kC(t){if(t.indexOf(Rg)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${di.getSchemes().join(",")}`);return{scheme:t.split(Rg)[0],path:t.split(Rg)[1]}}async function lK(t,e,n=!1){ae(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=cr.getLoadHandlers(t);ae(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),ae(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],i=cr.getSaveHandlers(e);ae(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),ae(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=i[0],a=kC(t).scheme,l=kC(t).path,u=a===kC(t).scheme,c=await s.load();n&&u&&await di.getManager(a).removeModel(l);const d=await o.save(c);return n&&!u&&await di.getManager(a).removeModel(l),d.modelArtifactsInfo}async function ove(){const t=di.getSchemes(),e={};for(const n of t){const r=await di.getManager(n).listModels();for(const s in r){const i=n+Rg+s;e[i]=r[s]}}return e}async function ave(t){const e=kC(t);return di.getManager(e.scheme).removeModel(e.path)}async function lve(t,e){return lK(t,e,!1)}async function uve(t,e){return lK(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cve{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!We().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return DY(e)}}if(We().get("IS_BROWSER")){We().setPlatform("browser",new cve);try{di.registerManager(Sp.URL_SCHEME,new ive)}catch{}try{di.registerManager(vp.URL_SCHEME,new Zbe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dve={importFetch:()=>require("node-fetch")};let k3;class hve{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return We().global.fetch!=null?We().global.fetch(e,n):(k3==null&&(k3=dve.importFetch()),k3(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}We().get("IS_NODE")&&!We().get("IS_BROWSER")&&We().setPlatform("node",new hve);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zt(t,e="float32",n){return e=e||"float32",qo(t),new ns(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fve(t,e){const n=pe(t,"x","cast");if(!J1e(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return $e.runKernel(_0,r,s)}const lt=Ae({cast_:fve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(t){const n={x:pe(t,"x","clone","string_or_numeric")};return $e.runKernel(V0,n)}const Ic=Ae({clone_:pve});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */WY();const mve={buffer:Zt,cast:lt,clone:Ic,print:uK};Ebe(mve);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gve(t,e){let n=pe(t,"a","add"),r=pe(e,"b","add");[n,r]=Sr(n,r);const s={a:n,b:r};return $e.runKernel(Bp,s)}const Qe=Ae({add_:gve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t,e){let n=pe(t,"a","floorDiv"),r=pe(e,"b","floorDiv");[n,r]=Sr(n,r);const s={a:n,b:r};return $e.runKernel(B0,s)}const AO=Ae({floorDiv_:yve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xve(t,e){let n=pe(t,"a","div"),r=pe(e,"b","div");if([n,r]=Sr(n,r),n.dtype==="int32"&&r.dtype==="int32")return AO(n,r);const s={a:n,b:r},i={};return $e.runKernel(D0,s,i)}const yt=Ae({div_:xve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wve(t,e){let n=pe(t,"a","mul"),r=pe(e,"b","mul");[n,r]=Sr(n,r);const s={a:n,b:r};return $e.runKernel(Z0,s)}const _e=Ae({mul_:wve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bve(t){const e=pe(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return $e.runKernel(Z1,n)}else{const n={x:e};return $e.runKernel(j1,n)}}const Zr=Ae({abs_:bve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vve(t){const n={x:pe(t,"x","acos")};return $e.runKernel(S0,n)}const cK=Ae({acos_:vve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sve(t){const n={x:pe(t,"x","acosh")};return $e.runKernel(C0,n)}const dK=Ae({acosh_:Sve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cve(t){ae(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),ae(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,i)=>pe(s,`tensors${i}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!nn(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return $e.runKernel(W1,r)}const Ive=Ae({addN_:Cve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nve(t,e=null,n=!1){const s={x:pe(t,"x","all","bool")},i={axis:e,keepDims:n};return $e.runKernel(qN,s,i)}const $O=Ae({all_:Nve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kve(t,e=null,n=!1){const s={x:pe(t,"x","any","bool")},i={axis:e,keepDims:n};return $e.runKernel(XN,s,i)}const AI=Ae({any_:kve});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tve(t,e=0){const r={x:pe(t,"x","argMax")},s={axis:e};return $e.runKernel(G1,r,s)}const Cp=Ae({argMax_:Tve});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eve(t,e=0){const r={x:pe(t,"x","argMin")},s={axis:e};return $e.runKernel(H1,r,s)}const hK=Ae({argMin_:Eve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ve(t){const n={x:pe(t,"x","asin")};return $e.runKernel(I0,n)}const fK=Ae({asin_:_ve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(t){const n={x:pe(t,"x","asinh")};return $e.runKernel(N0,n)}const pK=Ae({asinh_:Ave});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ve(t){const n={x:pe(t,"x","atan")};return $e.runKernel(k0,n)}const mK=Ae({atan_:$ve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rve(t,e){let n=pe(t,"a","atan2"),r=pe(e,"b","atan2");[n,r]=Sr(n,r);const s={a:n,b:r};return $e.runKernel(E0,s)}const gK=Ae({atan2_:Rve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mve(t){const n={x:pe(t,"x","atanh")};return $e.runKernel(T0,n)}const yK=Ae({atanh_:Mve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mh(t,e,n,r,s="NHWC",i){const o=t[3],a=[...e,o],l=Co(s);return Kn(t,a,n,i,r,null,null,l)}function Ws(t,e,n,r,s,i,o="channelsLast"){const[a,l]=t1(e);let u;if(o==="channelsLast")u=[a,l,t[3],t[3]];else if(o==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Kn(t,u,n,r,s,i,!1,o)}function Xo(t,e,n,r,s,i,o="NDHWC"){const[a,l,u]=_R(e);let c,d;if(o==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Dl(t,c,n,r,s,!1,d,i)}function Kn(t,e,n,r,s,i,o=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,m]=e,[g,x]=t1(n),[w,b]=t1(r),S=Mg(h,w),C=Mg(f,b),{padInfo:T,outHeight:D,outWidth:P}=Pve(s,u,c,g,x,S,C,i,a),I=o?m*d:m;let E;return a==="channelsFirst"?E=[l,I,D,P]:a==="channelsLast"&&(E=[l,D,P,I]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:D,outWidth:P,outChannels:I,padInfo:T,strideHeight:g,strideWidth:x,filterHeight:h,filterWidth:f,effectiveFilterHeight:S,effectiveFilterWidth:C,dilationHeight:w,dilationWidth:b,inShape:t,outShape:E,filterShape:e}}function Dl(t,e,n,r,s,i=!1,o="channelsLast",a){let[l,u,c,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d,h]=t;else if(o==="channelsFirst")[l,h,u,c,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,m,g,,x]=e,[w,b,S]=_R(n),[C,T,D]=_R(r),P=Mg(f,C),I=Mg(m,T),E=Mg(g,D),{padInfo:M,outDepth:O,outHeight:j,outWidth:R}=Fve(s,u,c,d,w,b,S,P,I,E,a),z=i?x*h:x;let B;return o==="channelsFirst"?B=[l,z,O,j,R]:o==="channelsLast"&&(B=[l,O,j,R,z]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:d,inChannels:h,outDepth:O,outHeight:j,outWidth:R,outChannels:z,padInfo:M,strideDepth:w,strideHeight:b,strideWidth:S,filterDepth:f,filterHeight:m,filterWidth:g,effectiveFilterDepth:P,effectiveFilterHeight:I,effectiveFilterWidth:E,dilationDepth:C,dilationHeight:T,dilationWidth:D,inShape:t,outShape:B,filterShape:e}}function Dve(t,e,n,r,s){r==null&&(r=RO(t,e,n));const i=t[0],o=t[1],a=n1((i-e+2*r)/n+1,s),l=n1((o-e+2*r)/n+1,s);return[a,l]}function Ove(t,e,n,r,s,i){s==null&&(s=RO(t,e[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(o[a]=n1((t[a]-e[a]+2*s)/r[a]+1,i));return o}function RO(t,e,n,r=1){const s=Mg(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function t1(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function _R(t){return typeof t=="number"?[t,t,t]:t}function Mg(t,e){return e<=1?t:t+(t-1)*(e-1)}function Pve(t,e,n,r,s,i,o,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=Dve([e,n],i,r,t,a);c=f[0],d=f[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const h=Math.max(0,(c-1)*r+i-e),f=Math.max(0,(d-1)*s+o-n),m=Math.floor(h/2),g=h-m,x=Math.floor(f/2),w=f-x;u={top:m,bottom:g,left:x,right:w,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/s);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],m=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];u={top:h,bottom:f,left:m,right:g,type:h===0&&f===0&&m===0&&g===0?"VALID":"EXPLICIT"},c=n1((e-i+h+f)/r+1,a),d=n1((n-o+m+g)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function Fve(t,e,n,r,s,i,o,a,l,u,c){let d,h,f,m;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const x=Ove([e,n,r,1],[a,l,u],1,[s,i,o],t,c);h=x[0],f=x[1],m=x[2]}else if(t==="same"){h=Math.ceil(e/s),f=Math.ceil(n/i),m=Math.ceil(r/o);const g=(h-1)*s+a-e,x=(f-1)*i+l-n,w=(m-1)*o+u-r,b=Math.floor(g/2),S=g-b,C=Math.floor(x/2),T=x-C,D=Math.floor(w/2),P=w-D;d={top:C,bottom:T,left:D,right:P,front:b,back:S,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:m}}function n1(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function ph(t){const[e,n,r]=t1(t);return e===1&&n===1&&r===1}function as(t,e){return ph(t)||ph(e)}function Ip(t){return t1(t).every(e=>e>0)}function Co(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function vi(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")ae(Yg(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{ae(Yg(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(t,e){const r={x:pe(t,"x","reshape","string_or_numeric")},s={shape:e};return $e.runKernel($b,r,s)}const Me=Ae({reshape_:Lve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zve(t,e,n,r,s){const i=pe(t,"x","avgPool","float32"),o=1;ae(as(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ae(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),vi("avgPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=$e.runKernel(Y1,u,c);return d=lt(d,i.dtype),l?Me(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Kk=Ae({avgPool_:zve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(t,e,n,r,s,i="NDHWC"){const o=pe(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=Me(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ae(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),ae(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),ae(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),vi("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i};let d=$e.runKernel(K1,u,c);return d=lt(d,a.dtype),l?Me(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const xK=Ae({avgPool3d_:Bve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uve(t,e=0){ae(t.length>=1,()=>"Pass at least one tensor to concat");const n=_I(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Ic(n[0]);const r=n,s={axis:e};return $e.runKernel(Q1,r,s)}const pr=Ae({concat_:Uve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(t,e,n=!1,r=!1){let s=pe(t,"a","matMul"),i=pe(e,"b","matMul");[s,i]=Sr(s,i);const o={a:s,b:i},a={transposeA:n,transposeB:r};return $e.runKernel(q1,o,a)}const dn=Ae({matMul_:Vve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(t){const n={x:pe(t,"x","sigmoid","float32")};return $e.runKernel(ly,n)}const Go=Ae({sigmoid_:jve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wve(t,e,n){const r=pe(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:n};return $e.runKernel(Pb,s,i)}const Kt=Ae({slice_:Wve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(t){const n={x:pe(t,"x","tanh","float32")};return $e.runKernel(py,n)}const Np=Ae({tanh_:Gve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hve(t,e,n,r,s,i){const o=pe(t,"forgetBias","basicLSTMCell"),a=pe(e,"lstmKernel","basicLSTMCell"),l=pe(n,"lstmBias","basicLSTMCell"),u=pe(r,"data","basicLSTMCell"),c=pe(s,"c","basicLSTMCell"),d=pe(i,"h","basicLSTMCell"),h=pr([u,d],1),f=dn(h,a),m=Qe(f,l),g=m.shape[0],x=m.shape[1]/4,w=[g,x],b=Kt(m,[0,0],w),S=Kt(m,[0,x],w),C=Kt(m,[0,x*2],w),T=Kt(m,[0,x*3],w),D=Qe(_e(Go(b),Np(S)),_e(c,Go(Qe(o,C)))),P=_e(Np(D),Go(T));return[D,P]}const Yve=Ae({basicLSTMCell_:Hve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kve(t,e,n){const r=pe(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);ae(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),ae(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),ae(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:n};return $e.runKernel(X1,i,o)}const qk=Ae({batchToSpaceND_:Kve});function qve(t){let e;return t.rank===0||t.rank===1?e=Me(t,[1,1,1,t.size]):t.rank===2?e=Me(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=Me(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xve(t,e,n,r,s,i){i==null&&(i=.001);const o=pe(t,"x","batchNorm"),a=pe(e,"mean","batchNorm"),l=pe(n,"variance","batchNorm");let u;s!=null&&(u=pe(s,"scale","batchNorm"));let c;r!=null&&(c=pe(r,"offset","batchNorm")),ae(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ae(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ae(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:qve(o),scale:u,offset:c,mean:a,variance:l},f={varianceEpsilon:i},m=$e.runKernel(ab,h,f);return Me(m,o.shape)}const Gb=Ae({batchNorm_:Xve});function Zve(t,e,n,r,s,i){const o=pe(t,"x","batchNorm"),a=pe(e,"mean","batchNorm"),l=pe(n,"variance","batchNorm");let u;s!=null&&(u=pe(s,"scale","batchNorm"));let c;return r!=null&&(c=pe(r,"offset","batchNorm")),ae(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),ae(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),ae(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&ae(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&ae(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Gb(o,a,l,c,u,i)}const wK=Ae({batchNorm2d_:Zve});function Qve(t,e,n,r,s,i){const o=pe(t,"x","batchNorm"),a=pe(e,"mean","batchNorm"),l=pe(n,"variance","batchNorm");let u;s!=null&&(u=pe(s,"scale","batchNorm"));let c;return r!=null&&(c=pe(r,"offset","batchNorm")),ae(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),ae(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),ae(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&ae(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&ae(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Gb(o,a,l,c,u,i)}const bK=Ae({batchNorm3d_:Qve});function Jve(t,e,n,r,s,i){const o=pe(t,"x","batchNorm"),a=pe(e,"mean","batchNorm"),l=pe(n,"variance","batchNorm");let u;s!=null&&(u=pe(s,"scale","batchNorm"));let c;return r!=null&&(c=pe(r,"offset","batchNorm")),ae(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),ae(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),ae(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&ae(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&ae(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Gb(o,a,l,c,u,i)}const vK=Ae({batchNorm4d_:Jve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2e(t,e,n){const r=pe(t,"x","bincount"),s=pe(e,"weights","bincount");ae(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),ae(n>=0,()=>`size must be non-negative, but got ${n}.`),ae(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:n};return $e.runKernel(JN,i,o)}const SK=Ae({bincount_:e2e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(t,e){const n=pe(t,"x","bitwiseAnd"),r=pe(e,"y","bitwiseAnd");if(!nn(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return $e.runKernel(ek,s)}const n2e=Ae({bitwiseAnd_:t2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2e(t,e){const n=pe(t,"s0","broadcastArgs","int32"),r=pe(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return $e.runKernel(tk,s)}const s2e=Ae({broadcastArgs_:r2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2e(t,e){let n=pe(t,"broadcastTo","x");const r=n.shape;if(qo(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=Me(n,u)}const s=n.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])i[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Ic(n);const a={x:n},l={reps:i};return $e.runKernel(my,a,l)}const Dg=Ae({broadcastTo_:i2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2e(t){const n={x:pe(t,"x","ceil","float32")};return $e.runKernel(A0,n)}const CK=Ae({ceil_:o2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(t,e,n){qo(t),n=n||zp(e);const r={shape:t,value:e,dtype:n};return $e.runKernel(gk,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a2e(t,e,n){const r=pe(t,"x","clipByValue");if(ae(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return yy(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:n};return $e.runKernel($0,s,i)}const Vi=Ae({clipByValue_:a2e});function l2e(t){return pr(t,0)}const IK=Ae({concat1d_:l2e});function u2e(t,e){return pr(t,e)}const NK=Ae({concat2d_:u2e});function c2e(t,e){return pr(t,e)}const kK=Ae({concat3d_:c2e});function d2e(t,e){return pr(t,e)}const TK=Ae({concat4d_:d2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2e(t,e,n,r,s="NHWC",i=[1,1],o){const a=pe(t,"x","conv2d","float32"),l=pe(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=Me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ae(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),ae(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),vi("conv2d",r,o);const d=s==="NHWC"?u.shape[3]:u.shape[1];ae(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),ae(as(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),ae(Ip(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),ae(Ip(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=$e.runKernel(J1,h,f);return c?Me(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const mh=Ae({conv2d_:h2e});function f2e(t,e,n,r,s="NWC",i=1,o){const a=pe(t,"x","conv1d"),l=pe(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=Me(a,[1,a.shape[0],a.shape[1]])),ae(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),ae(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),vi("conv1d",r,o),ae(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),ae(as(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),ae(Ip(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),ae(Ip(n),()=>"Error in conv1D: Stride should be larger than 0."),ae(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=Me(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=Me(u,[u.shape[0],1,u.shape[1],u.shape[2]]),x=mh(h,d,[1,n],r,"NHWC",[1,i],o);return c?Me(x,[x.shape[2],x.shape[3]]):Me(x,[x.shape[0],x.shape[2],x.shape[3]])}const MO=Ae({conv1d_:f2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2e(t,e,n,r,s,i="NHWC",o){ae(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),ae(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),ae(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),ae(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];ae(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),ae(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),vi("conv2dDerInput",s,o);const h={dy:l,filter:n},f={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},m=$e.runKernel(eb,h,f);return u?Me(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const DO=Ae({conv2DBackpropInput_:p2e});function m2e(t,e,n,r,s,i){const o=pe(t,"x","conv2dTranspose"),a=pe(e,"filter","conv2dTranspose");return DO(n,o,a,r,s,"NHWC",i)}const OO=Ae({conv2dTranspose_:m2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2e(t,e,n,r,s="NDHWC",i=[1,1,1]){const o=pe(t,"x","conv3d"),a=pe(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=Me(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ae(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),ae(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),ae(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),ae(as(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),ae(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),ae(Ip(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),ae(Ip(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:i},h=$e.runKernel(tb,c,d);return u?Me(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const EK=Ae({conv3d_:g2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y2e(t,e,n,r,s){ae(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=Me(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],u=o.shape[4];ae(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),ae(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),ae(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),ae(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),ae(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},d={pad:s,strides:r,inputShape:i},h=$e.runKernel(ik,c,d);return a?Me(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const _K=Ae({conv3DBackpropInput_:y2e});function x2e(t,e,n,r,s){const i=pe(t,"x","conv3dTranspose"),o=pe(e,"filter","conv3dTranspose");return _K(n,i,o,r,s)}const AK=Ae({conv3dTranspose_:x2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w2e(t){const n={x:pe(t,"x","cos","float32")};return $e.runKernel(R0,n)}const Xk=Ae({cos_:w2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2e(t){const n={x:pe(t,"x","cosh","float32")};return $e.runKernel(M0,n)}const PO=Ae({cosh_:b2e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v2e(t,e=0,n=!1,r=!1){const i={x:pe(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return $e.runKernel(ok,i,o)}const $I=Ae({cumprod_:v2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S2e(t,e=0,n=!1,r=!1){const i={x:pe(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return $e.runKernel(nb,i,o)}const FO=Ae({cumsum_:S2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2e(t,e,n,r=!1){const s=pe(t,"x","denseBincount"),i=pe(e,"weights","denseBincount");ae(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),ae(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),ae(n>=0,()=>`size must be non-negative, but got ${n}.`),ae(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:n,binaryOutput:r};return $e.runKernel(lk,o,a)}const AR=Ae({denseBincount_:C2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(t,e,n="NHWC"){const r=pe(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];ae(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),ae(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),ae(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),ae(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return $e.runKernel(uk,a,l)}const $K=Ae({depthToSpace_:I2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2e(t,e,n,r,s="NHWC",i=[1,1],o){const a=pe(t,"x","depthwiseConv2d","float32"),l=pe(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=Me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ae(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),ae(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];ae(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),vi("depthwiseConv2d",r,o);const h={x:u,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=$e.runKernel(rb,h,f);return c?Me(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Hb=Ae({depthwiseConv2d_:N2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2e(t){const n={x:pe(t,"x","diag")};return $e.runKernel(hk,n)}const T2e=Ae({diag_:k2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2e(t,e,n,r,s=[1,1],i="NHWC"){const o=pe(t,"x","dilation2d"),a=pe(e,"filter","dilation2d");ae(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),ae(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),ae(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,u=!1;o.rank===3&&(l=Me(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),ae(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:r,dilations:s},h=$e.runKernel(sb,c,d);return u?Me(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const RK=Ae({dilation2d_:E2e});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gh(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const i=n-1-s,o=t[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function os(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&n.unshift(i)}return n}function jt(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let i=t[t.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[n-s-1]=o;else if(o===1)r[n-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2e(t,e){let n=pe(t,"a","equal","string_or_numeric"),r=pe(e,"b","equal","string_or_numeric");[n,r]=Sr(n,r),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(ib,s)}const Il=Ae({equal_:_2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2e(t,e,n){const r=pe(e,"a","where"),s=pe(n,"b","where"),i=pe(t,"condition","where","bool"),o=jt(jt(i.shape,r.shape),s.shape),a=Dg(i,o),l=Dg(r,o),u=Dg(s,o),c={condition:a,t:l,e:u};return $e.runKernel(Ob,c)}const js=Ae({where_:A2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $2e(t){const n={x:pe(t,"x","zerosLike")};return $e.runKernel(jb,n)}const xn=Ae({zerosLike_:$2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2e(t,e){let n=pe(t,"a","div"),r=pe(e,"b","div");[n,r]=Sr(n,r);const s=yt(n,r),i=xn(s),o=Il(r,i);return js(o,i,s)}const MK=Ae({divNoNan_:R2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(t,e){const n=pe(t,"t1","dot"),r=pe(e,"t2","dot");ae((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(ae(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),n.rank===1&&r.rank===1){const o=Me(n,[1,-1]),a=Me(r,[-1,1]),l=dn(o,a);return Me(l,[])}else if(n.rank===1&&r.rank===2){const o=Me(n,[1,-1]),a=Me(r,[r.shape[0],r.shape[1]]),l=dn(o,a);return Me(l,[l.size])}else if(n.rank===2&&r.rank===1){const o=Me(r,[-1,1]),a=dn(n,o);return Me(a,[a.size])}else{const o=Me(r,[r.shape[0],r.shape[1]]);return dn(n,o)}}const DK=Ae({dot_:M2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(t,...e){const n=e.map((s,i)=>pe(s,`tensors${i}`,"einsum")),r={equation:t};return $e.runKernel(fk,n,r)}const mg=Ae({einsum_:D2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O2e(t){const n={x:pe(t,"x","elu","float32")};return $e.runKernel(O0,n)}const Yb=Ae({elu_:O2e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t,e){const n=pe(t,"x","ensureShape","string_or_numeric");if(!Z1e(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const F2e=Ae({ensureShape_:P2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2e(t){let e=pe(t,"x","erf");ae(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=lt(e,"float32"));const n={x:e};return $e.runKernel(P0,n)}const LO=Ae({erf_:L2e});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zO(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function OK(t,e,n){const r=t.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[i++]):s.push(e[o++]);return s}function $r(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const s=e.map(i=>t[i]);return[n,s]}function Cr(t,e){const n=e.map(r=>1);return OK(t,n,e)}function Wr(t,e,n){ae(zO(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function zn(t,e){if(zO(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function Du(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function qn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(t,e=null,n=!1){const s={x:pe(t,"x","max")},i={reductionIndices:e,keepDims:n};return $e.runKernel(yb,s,i)}const Aa=Ae({max_:z2e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B2e(t,e=null,n=!1){const s={x:pe(t,"x","min")},i={axis:e,keepDims:n};return $e.runKernel(vb,s,i)}const r1=Ae({min_:B2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2e(t,e){let n=pe(t,"base","pow"),r=pe(e,"exp","pow");[n,r]=Sr(n,r);const s={a:n,b:r};return $e.runKernel(Q0,s)}const Rc=Ae({pow_:U2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(t,e){if((Ra(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ra(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Rh(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2e(t){const n={x:pe(t,"x","sqrt","float32")};return $e.runKernel(cy,n)}const $s=Ae({sqrt_:V2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j2e(t){const e=pe(t,"x","square"),n={};return $e.runKernel("Square",{x:e},n)}const Fn=Ae({square_:j2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W2e(t,e=null,n=!1){let r=pe(t,"x","sum");r.dtype==="bool"&&(r=lt(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return $e.runKernel(Fb,s,i)}const Nt=Ae({sum_:W2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2e(t,e="euclidean",n=null,r=!1){t=pe(t,"x","norm");const s=PK(t,e,n);let i=s.shape;if(r){const o=Jt(n,t.shape);i=Cr(s.shape,o)}return Me(s,i)}function PK(t,e,n=null){if(t.rank===0)return Zr(t);if(t.rank!==1&&n===null)return PK(Me(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Nt(Zr(t),n);if(e===1/0)return Aa(Zr(t),n);if(e===-1/0)return r1(Zr(t),n);if(e==="euclidean"||e===2)return $s(Nt(Rc(Zr(t),Mt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Aa(Nt(Zr(t),n[0]),n[1]-1);if(e===1/0)return Aa(Nt(Zr(t),n[1]),n[0]);if(e===-1/0)return r1(Nt(Zr(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return $s(Nt(Fn(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Kb=Ae({norm_:G2e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H2e(t,e=null,n=!1){return Kb(t,"euclidean",e,n)}const FK=Ae({euclideanNorm_:H2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2e(t){const n={x:pe(t,"x","exp")};return $e.runKernel(F0,n)}const wi=Ae({exp_:Y2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2e(t,e=0){const n=pe(t,"x","expandDims","string_or_numeric");ae(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return $e.runKernel(ob,r,s)}const Fr=Ae({expandDims_:K2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2e(t){const n={x:pe(t,"x","expm1")};return $e.runKernel(L0,n)}const LK=Ae({expm1_:q2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X2e(t,e){const n=pe(t,"x","tile","string_or_numeric");ae(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return $e.runKernel(my,r,s)}const Ca=Ae({tile_:X2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z2e(t,e,n,r="float32"){e==null&&(e=t);const s=Zt([t,e],r),i=t<=e?t:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=Me(s.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Ca(Fr(o,0),[n[0],1,1]);if(n.length===2)return Ca(Fr(Fr(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ca(Fr(Fr(Fr(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const BO=Ae({eye_:Z2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2e(t){const n={x:pe(t,"x","floor","float32")};return $e.runKernel(z0,n)}const qb=Ae({floor_:Q2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2e(t,e,n=0,r=0){const s=pe(t,"x","gather"),i=pe(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:n,batchDims:r};return $e.runKernel(lb,o,a)}const Xb=Ae({gather_:J2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eSe(t,e){let n=pe(t,"a","greater","string_or_numeric"),r=pe(e,"b","greater","string_or_numeric");[n,r]=Sr(n,r),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(ub,s)}const Io=Ae({greater_:eSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tSe(t,e){let n=pe(t,"a","greaterEqual","string_or_numeric"),r=pe(e,"b","greaterEqual","string_or_numeric");[n,r]=Sr(n,r),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(U0,s)}const Dh=Ae({greaterEqual_:tSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSe(t){const n={input:pe(t,"input","imag")};return $e.runKernel(bk,n)}const Zk=Ae({imag_:nSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rSe(t){const n={x:pe(t,"x","isFinite")};return $e.runKernel(j0,n)}const zK=Ae({isFinite_:rSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSe(t){const n={x:pe(t,"x","isInf")};return $e.runKernel(W0,n)}const BK=Ae({isInf_:sSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iSe(t){const n={x:pe(t,"x","isNaN")};return $e.runKernel(G0,n)}const UK=Ae({isNaN_:iSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oSe(t,e=.2){const r={x:pe(t,"x","leakyRelu")},s={alpha:e};return $e.runKernel(cb,r,s)}const Qk=Ae({leakyRelu_:oSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(t,e){let n=pe(t,"a","less","string_or_numeric"),r=pe(e,"b","less","string_or_numeric");[n,r]=Sr(n,r),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(db,s)}const s1=Ae({less_:aSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSe(t,e){let n=pe(t,"a","lessEqual","string_or_numeric"),r=pe(e,"b","lessEqual","string_or_numeric");[n,r]=Sr(n,r),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(hb,s)}const Vp=Ae({lessEqual_:lSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uSe(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return $e.runKernel(vk,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cSe(t,e=5,n=1,r=1,s=.5){const i=pe(t,"x","localResponseNormalization");ae(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),ae(Yg(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},u={depthRadius:e,bias:n,alpha:r,beta:s},c=$e.runKernel(gb,l,u);return a?Me(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const VK=Ae({localResponseNormalization_:cSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dSe(t){const n={x:pe(t,"x","log","float32")};return $e.runKernel(H0,n)}const Yo=Ae({log_:dSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hSe(t){const n={x:pe(t,"x","log1p")};return $e.runKernel(Y0,n)}const Jk=Ae({log1p_:hSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fSe(t,e){ae(gR(t),()=>"The f passed in variableGrads(f) must be a function"),ae(e==null||Array.isArray(e)&&e.every(u=>u instanceof EI),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in $e.registeredVariables)e.push($e.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),ae(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=$e.gradients(t,e,null,i);ae(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),ae(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:o,grads:l}}function Mc(t){return $e.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pSe(t){const n={x:pe(t,"x","neg")};return $e.runKernel(Cb,n)}const tr=Ae({neg_:pSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mSe(t){const n={x:pe(t,"x","softplus")};return $e.runKernel(uy,n)}const xy=Ae({softplus_:mSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gSe(t){const e=pe(t,"x","logSigmoid");return Mc(r=>({value:tr(xy(tr(r))),gradFunc:o=>_e(o,Go(tr(r)))}))(e)}const jK=Ae({logSigmoid_:gSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ySe(t,e){let n=pe(t,"a","sub"),r=pe(e,"b","sub");[n,r]=Sr(n,r);const s={a:n,b:r};return $e.runKernel(hy,s)}const xt=Ae({sub_:ySe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xSe(t,e=-1){const n=pe(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Mc((s,i)=>{const a=Aa(s,e,!0),l=xt(s,a),u=xt(lt(l,"float32"),Yo(Nt(wi(l),e,!0)));return i([u]),{value:u,gradFunc:(d,h)=>{const[f]=h,m=!0,g=wi(f);return xt(d,_e(Nt(d,e,m),g))}}})(n)}const UO=Ae({logSoftmax_:xSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wSe(t,e=null,n=!1){const r=pe(t,"x","logSumExp"),s=Jt(e,r.shape),i=Aa(r,s,!0),o=xt(r,i),a=wi(o),l=Nt(a,s),u=Yo(l),c=Qe(Me(i,u.shape),u);if(n){const d=Cr(c.shape,s);return Me(c,d)}return c}const eT=Ae({logSumExp_:wSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bSe(t,e){const n=pe(t,"a","logicalAnd","bool"),r=pe(e,"b","logicalAnd","bool");jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(fb,s)}const ku=Ae({logicalAnd_:bSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vSe(t){const n={x:pe(t,"x","logicalNot","bool")};return $e.runKernel(pb,n)}const tT=Ae({logicalNot_:vSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SSe(t,e){const n=pe(t,"a","logicalOr","bool"),r=pe(e,"b","logicalOr","bool");jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(mb,s)}const VO=Ae({logicalOr_:SSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CSe(t,e){const n=pe(t,"a","logicalXor","bool"),r=pe(e,"b","logicalXor","bool");return jt(n.shape,r.shape),ku(VO(t,e),tT(ku(t,e)))}const WK=Ae({logicalXor_:CSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eS=2147483648;function ISe(t,e,n="left"){const r=pe(t,"sortedSequence","searchSorted"),s=pe(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=s.shape[s.shape.length-1],a=Me(r,[-1,i]),l=Me(s,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Ue(l.shape)>=eS)throw new Error(`values tensor size must less than ${eS}`);if(a.shape[1]>=eS)throw new Error(`trailing dim_size must less than ${eS} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},c={side:n};return $e.runKernel(Ok,u,c)}const jO=Ae({searchSorted_:ISe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NSe(t,e){return jO(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kSe(t,e,n,r,s){const i=pe(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ae(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),ae(as(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),vi("maxPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=$e.runKernel(xb,u,c);return l?Me(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const nT=Ae({maxPool_:kSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TSe(t,e=[1,1,1],n,r,s,i="NDHWC"){const o=pe(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=Me(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ae(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),ae(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),vi("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i},d=$e.runKernel(wb,u,c);return l?Me(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const GK=Ae({maxPool3d_:TSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ESe(t,e,n,r,s=!1){const o={x:pe(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},l=$e.runKernel(Nk,o,a);return{result:l[0],indexes:l[1]}}const _Se=Ae({maxPoolWithArgmax_:ESe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ASe(t,e){let n=pe(t,"a","maximum"),r=pe(e,"b","maximum");[n,r]=Sr(n,r),n.dtype==="bool"&&(n=lt(n,"int32"),r=lt(r,"int32")),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(K0,s)}const Pc=Ae({maximum_:ASe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Se(t,e=null,n=!1){const s={x:pe(t,"x","mean")},i={axis:e,keepDims:n};return $e.runKernel(bb,s,i)}const wr=Ae({mean_:$Se});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(t,e="float32"){if(qo(t),e==="complex64"){const r=_r(t,"float32"),s=_r(t,"float32");return hh(r,s)}const n=As(Ue(t),e);return $e.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mo(t,e="float32"){if(qo(t),e==="complex64"){const r=mo(t,"float32"),s=_r(t,"float32");return hh(r,s)}const n=pO(Ue(t),e);return $e.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=pe(t,"x","meshgrid",t instanceof _n?t.dtype:"float32");if(e===void 0)return[r];let s=pe(e,"y","meshgrid",e instanceof _n?e.dtype:"float32");const i=Ue(r.shape),o=Ue(s.shape);return n==="xy"?(r=Me(r,[1,-1]),s=Me(s,[-1,1]),[dn(mo([o,1],r.dtype),r),dn(s,mo([1,i],s.dtype))]):(r=Me(r,[-1,1]),s=Me(s,[1,-1]),[dn(r,mo([1,o],r.dtype)),dn(mo([i,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MSe(t,e){let n=pe(t,"a","minimum"),r=pe(e,"b","minimum");[n,r]=Sr(n,r),n.dtype==="bool"&&(n=lt(n,"int32"),r=lt(r,"int32")),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(q0,s)}const yh=Ae({minimum_:MSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DSe(t,e,n){ae(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=pe(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ae(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)ae(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ae(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return $e.runKernel(Sb,o,i)}const WO=Ae({mirrorPad_:DSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OSe(t,e){let n=pe(t,"a","mod"),r=pe(e,"b","mod");[n,r]=Sr(n,r);const s={a:n,b:r};return $e.runKernel(X0,s)}const HK=Ae({mod_:OSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PSe(t,e=null,n=!1){t=pe(t,"x","moments");const r=Jt(e,t.shape),s=wr(t,r,n);let i=s.shape;n||(i=Cr(s.shape,r));const o=Fn(xt(lt(t,"float32"),Me(s,i))),a=wr(o,r,n);return{mean:s,variance:a}}const rT=Ae({moments_:PSe});function FSe(t,e,n,r){const s=pe(e,"data","multiRNNCell"),i=_I(n,"c","multiRNNCell"),o=_I(r,"h","multiRNNCell");let a=s;const l=[];for(let d=0;d<t.length;d++){const h=t[d](a,i[d],o[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const LSe=Ae({multiRNNCell_:FSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zSe(t,e,n,r=!1){const s=pe(t,"logits","multinomial"),i=s.size,o=s.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?Me(s,[1,-1]):s},u={numSamples:e,seed:n,normalized:r},c=$e.runKernel(kk,l,u);return o===1?Me(c,[c.size]):c}const BSe=Ae({multinomial_:zSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function USe(t,e){let n=pe(t,"a","notEqual","string_or_numeric"),r=pe(e,"b","notEqual","string_or_numeric");[n,r]=Sr(n,r),jt(n.shape,r.shape);const s={a:n,b:r};return $e.runKernel(Ib,s)}const qg=Ae({notEqual_:USe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VSe(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:pe(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return $e.runKernel(kb,o,a)}const GO=Ae({oneHot_:VSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jSe(t){const n={x:pe(t,"x","onesLike")};return $e.runKernel(Nb,n)}const Ko=Ae({onesLike_:jSe});function WSe(t,e){const n=pe(t,"v1","outerProduct"),r=pe(e,"v2","outerProduct");ae(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=Me(n,[-1,1]),i=Me(r,[1,-1]);return dn(s,i)}const GSe=Ae({outerProduct_:WSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HSe(t,e,n=0){const r=pe(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},i={x:r};return $e.runKernel(Eb,i,s)}const Nl=Ae({pad_:HSe});function YSe(t,e,n=0){return ae(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Nl(t,[e],n)}const KSe=Ae({pad1d_:YSe});function qSe(t,e,n=0){return ae(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Nl(t,e,n)}const XSe=Ae({pad2d_:qSe});function ZSe(t,e,n=0){return ae(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Nl(t,e,n)}const QSe=Ae({pad3d_:ZSe});function JSe(t,e,n=0){return ae(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Nl(t,e,n)}const eCe=Ae({pad4d_:JSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCe(t,e,n){const r=pe(t,"x","spaceToBatchND");ae(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),ae(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),ae(r.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:n};return $e.runKernel(Lb,s,i)}const sT=Ae({spaceToBatchND_:tCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nCe(t,e,n,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=pe(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=Me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ae(as(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const c=Ws(l.shape,e,i,s,r),d=[c.dilationHeight,c.dilationWidth];let h;r==="same"?h=sCe([c.filterHeight,c.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[m,g]=rCe([c.inHeight,c.inWidth],d,h),x=f?r:"valid",w=f?l:sT(l,d,m),S=(n==="avg"?()=>Kk(w,e,i,x,o):()=>nT(w,e,i,x,o))(),C=f?S:qk(S,d,g);return u?Me(C,[C.shape[1],C.shape[2],C.shape[3]]):C}function rCe(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),i=t.concat(r,s),o=e.map((c,d)=>(c-i[d]%c)%c),a=s.map((c,d)=>c+o[d]),l=e.map((c,d)=>[r[d],a[d]]),u=e.map((c,d)=>[0,o[d]]);return[l,u]}function sCe(t,e){const r=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const YK=Ae({pool_:nCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iCe(t,e){const n=pe(t,"x","prelu"),r=pe(e,"alpha","prelu"),s={x:n,alpha:r};return $e.runKernel(_b,s)}const iT=Ae({prelu_:iCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oCe(t,e=null,n=!1){let r=pe(t,"x","prod");r.dtype==="bool"&&(r=lt(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return $e.runKernel(Ab,s,i)}const KK=Ae({prod_:oCe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aCe(t,e,n,r){const s=t.map((c,d)=>pe(c,`tensors${d}`,"raggedGather","int32")),i=pe(e,"paramsDenseValues","raggedGather"),o=pe(n,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:i,indices:o},l={outputRaggedRank:r},u=$e.runKernel(xO,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const lCe=Ae({raggedGather_:aCe});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uCe(t,e,n){const r=pe(t,"starts","raggedRange"),s=pe(e,"limits","raggedRange",r.dtype),i=pe(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:s,deltas:i},a=$e.runKernel(wO,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const cCe=Ae({raggedRange_:uCe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(t,e,n,r,s){const i=pe(t,"shape","raggedTensorToTensor","int32"),o=pe(e,"values","raggedTensorToTensor"),a=pe(n,"defaultValue","raggedTensorToTensor",o.dtype),l=r.map((d,h)=>pe(d,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:i,values:o,defaultValue:a,rowPartitionTensors:l},c={rowPartitionTypes:s};return $e.runKernel(bO,u,c)}const hCe=Ae({raggedTensorToTensor_:dCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCe(t,e,n){qo(t);const r=Ue(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<r;i++)s[i]=e();return $e.makeTensor(s,t,n)}const pCe=Ae({rand_:fCe});var TC={exports:{}},mCe=TC.exports,LU;function gCe(){return LU||(LU=1,function(t){(function(e,n,r){function s(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var c=new s(l),d=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,c),h.state=function(){return i(c,{})}),h}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:this.alea=o})(mCe,t)}(TC)),TC.exports}var EC={exports:{}},yCe=EC.exports,zU;function xCe(){return zU||(zU=1,function(t){(function(e,n,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(yCe,t)}(EC)),EC.exports}var _C={exports:{}},wCe=_C.exports,BU;function bCe(){return BU||(BU=1,function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(wCe,t)}(_C)),_C.exports}var AC={exports:{}},vCe=AC.exports,UU;function SCe(){return UU||(UU=1,function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.x,d=l.i,h,f;return h=c[d],h^=h>>>7,f=h^h<<24,h=c[d+1&7],f^=h^h>>>10,h=c[d+3&7],f^=h^h>>>3,h=c[d+4&7],f^=h^h<<7,h=c[d+7&7],h=h^h<<13,f^=h^h<<9,c[d]=f,l.i=d+1&7,f};function u(c,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],c.x=f,c.i=0,h=256;h>0;--h)c.next()}u(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(c.x&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(vCe,t)}(AC)),AC.exports}var $C={exports:{}},CCe=$C.exports,VU;function ICe(){return VU||(VU=1,function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.w,d=l.X,h=l.i,f,m;return l.w=c=c+1640531527|0,m=d[h+34&127],f=d[h=h+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=d[h]=m^f,l.i=h,m+(c^c>>>16)|0};function u(c,d){var h,f,m,g,x,w=[],b=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,b=Math.max(b,d.length)),m=0,g=-32;g<b;++g)d&&(f^=d.charCodeAt((g+32)%d.length)),g===0&&(x=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(x=x+1640531527|0,h=w[g&127]^=f+x,m=h==0?m+1:0);for(m>=128&&(w[(d&&d.length||0)&127]=-1),m=127,g=4*128;g>0;--g)f=w[m+34&127],h=w[m=m+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,w[m]=f^h;c.w=x,c.X=w,c.i=m}u(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(c.X&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(CCe,t)}($C)),$C.exports}var RC={exports:{}},NCe=RC.exports,jU;function kCe(){return jU||(jU=1,function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.b,h=l.c,f=l.d,m=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^m,m=m-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^m,l.a=m-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(NCe,t)}(RC)),RC.exports}var MC={exports:{}};const TCe={},ECe=Object.freeze(Object.defineProperty({__proto__:null,default:TCe},Symbol.toStringTag,{value:"Module"})),_Ce=v8(ECe);var ACe=MC.exports,WU;function $Ce(){return WU||(WU=1,function(t){(function(e,n,r){var s=256,i=6,o=52,a="random",l=r.pow(s,i),u=r.pow(2,o),c=u*2,d=s-1,h;function f(C,T,D){var P=[];T=T==!0?{entropy:!0}:T||{};var I=w(x(T.entropy?[C,S(n)]:C??b(),3),P),E=new m(P),M=function(){for(var O=E.g(i),j=l,R=0;O<u;)O=(O+R)*s,j*=s,R=E.g(1);for(;O>=c;)O/=2,j/=2,R>>>=1;return(O+R)/j};return M.int32=function(){return E.g(4)|0},M.quick=function(){return E.g(4)/4294967296},M.double=M,w(S(E.S),n),(T.pass||D||function(O,j,R,z){return z&&(z.S&&g(z,E),O.state=function(){return g(E,{})}),R?(r[a]=O,j):O})(M,I,"global"in T?T.global:this==r,T.state)}function m(C){var T,D=C.length,P=this,I=0,E=P.i=P.j=0,M=P.S=[];for(D||(C=[D++]);I<s;)M[I]=I++;for(I=0;I<s;I++)M[I]=M[E=d&E+C[I%D]+(T=M[I])],M[E]=T;(P.g=function(O){for(var j,R=0,z=P.i,B=P.j,V=P.S;O--;)j=V[z=d&z+1],R=R*s+V[d&(V[z]=V[B=d&B+j])+(V[B]=j)];return P.i=z,P.j=B,R})(s)}function g(C,T){return T.i=C.i,T.j=C.j,T.S=C.S.slice(),T}function x(C,T){var D=[],P=typeof C,I;if(T&&P=="object")for(I in C)try{D.push(x(C[I],T-1))}catch{}return D.length?D:P=="string"?C:C+"\0"}function w(C,T){for(var D=C+"",P,I=0;I<D.length;)T[d&I]=d&(P^=T[d&I]*19)+D.charCodeAt(I++);return S(T)}function b(){try{var C;return h&&(C=h.randomBytes)?C=C(s):(C=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(C)),S(C)}catch{var T=e.navigator,D=T&&T.plugins;return[+new Date,e,D,e.screen,S(n)]}}function S(C){return String.fromCharCode.apply(0,C)}if(w(r.random(),n),t.exports){t.exports=f;try{h=_Ce}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:ACe,[],Math)}(MC)),MC.exports}var T3,GU;function RCe(){if(GU)return T3;GU=1;var t=gCe(),e=xCe(),n=bCe(),r=SCe(),s=ICe(),i=kCe(),o=$Ce();return o.alea=t,o.xor128=e,o.xorwow=n,o.xorshift7=r,o.xor4096=s,o.tychei=i,T3=o,T3}var oT=RCe();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HO{constructor(e,n,r,s,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=oT.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class MCe{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const i=s||Math.random();this.randu=oT.alea(i.toString()),this.randn=new HO(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,i,o;for(;;){do s=this.randn.nextValue(),o=1+this.c*s;while(o<=0);if(o*=o*o,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class DCe{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=oT.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCe(t,e,n=1,r="float32",s){if(qo(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new MCe(e,n,r,s),o=Zt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const PCe=Ae({randomGamma_:OCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCe(t,e=0,n=1,r,s){if(qo(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new HO(e,n,r,!1,s),o=Zt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const YO=Ae({randomNormal_:FCe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return YO(t,0,1,e,n)}const zCe=Ae({randomStandardNormal_:LCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BCe(t,e=0,n=1,r="float32",s){qo(t);const i=Zt(t,r),o=new DCe(e,n,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const jp=Ae({randomUniform_:BCe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UCe(t,e,n,r){return jp(t,e,n,"int32",r)}const VCe=Ae({randomUniformInt_:UCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xg(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return $e.runKernel(_k,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCe(t){const n={input:pe(t,"input","real")};return $e.runKernel(Ak,n)}const i1=Ae({real_:jCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCe(t){const n={x:pe(t,"x","reciprocal")};return $e.runKernel(J0,n)}const qK=Ae({reciprocal_:WCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GCe(t){const n={x:pe(t,"x","relu")};return $e.runKernel(ey,n)}const Ou=Ae({relu_:GCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe(t){const n={x:pe(t,"x","relu6")};return $e.runKernel(ty,n)}const KO=Ae({relu6_:HCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCe(t,e){const r={x:pe(t,"x","reverse")},s={dims:e};return $e.runKernel(Db,r,s)}const Ma=Ae({reverse_:YCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(t){const e=pe(t,"x","reverse");return ae(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Ma(e,0)}const qCe=Ae({reverse1d_:KCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(t,e){const n=pe(t,"x","reverse");return ae(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ma(n,e)}const ZCe=Ae({reverse2d_:XCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QCe(t,e){const n=pe(t,"x","reverse");return ae(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ma(n,e)}const JCe=Ae({reverse3d_:QCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eIe(t,e){const n=pe(t,"x","reverse");return ae(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ma(n,e)}const tIe=Ae({reverse4d_:eIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIe(t){const n={x:pe(t,"x","round")};return $e.runKernel(ny,n)}const qO=Ae({round_:nIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rIe(t){const n={x:pe(t,"x","rsqrt","float32")};return $e.runKernel(ry,n)}const XO=Ae({rsqrt_:rIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sIe(t){const n={x:pe(t,"x","selu")};return $e.runKernel(sy,n)}const ZO=Ae({selu_:sIe});function iIe(t,e,n,r,s,i=[1,1],o="NHWC"){const a=pe(t,"x","separableConv2d"),l=pe(e,"depthwiseFilter","separableConv2d"),u=pe(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=Me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ae(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),ae(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),ae(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),ae(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),ae(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],f=l.shape[3];ae(u.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${u.shape[2]}.`);const m=Hb(c,l,r,s,o,i),x=mh(m,u,1,"valid",o);return d?Me(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const QO=Ae({separableConv2d_:iIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oIe(t,e){const n=pe(t,"x","setdiff1d"),r=pe(e,"y","setdiff1d");ae(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),ae(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),ae(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),i=await r.data(),o=new Set(i);let a=0;for(let c=0;c<s.length;c++)o.has(s[c])||a++;const l=new ns([a],n.dtype),u=new ns([a],"int32");for(let c=0,d=0;c<s.length;c++)o.has(s[c])||(l.values[d]=s[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const aIe=oIe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(t){const n={x:pe(t,"x","sign")};return $e.runKernel(ay,n)}const XK=Ae({sign_:lIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uIe(t){const n={x:pe(t,"x","sin","float32")};return $e.runKernel(iy,n)}const JO=Ae({sin_:uIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIe(t){const n={x:pe(t,"x","sinh")};return $e.runKernel(oy,n)}const eP=Ae({sinh_:cIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dIe(t,e,n){const r=pe(t,"x","slice1d");return ae(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Kt(r,[e],[n])}const aT=Ae({slice1d_:dIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hIe(t,e,n){const r=pe(t,"x","slice2d");return ae(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const tP=Ae({slice2d_:hIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fIe(t,e,n){const r=pe(t,"x","slice3d");return ae(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const lT=Ae({slice3d_:fIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pIe(t,e,n){const r=pe(t,"x","slice4d");return ae(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const o1=Ae({slice4d_:pIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mIe(t,e=-1){const n=pe(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return $e.runKernel(Bb,r,s)}const uT=Ae({softmax_:mIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gIe(t){ae(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return $e.runKernel(mk,e)}const cT=Ae({fft_:gIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yIe(t){ae(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return $e.runKernel(wk,e)}const a1=Ae({ifft_:yIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xIe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=Me(t,[n,e]);r=a1(s)}else{const s=[n,2*(e-1)],i=Me(i1(t),[n,e]),o=Me(Zk(t),[n,e]),a=Ma(Kt(i,[0,1],[n,e-2]),1),l=_e(Ma(Kt(o,[0,1],[n,e-2]),1),Mt(-1)),u=pr([i,a],1),c=pr([o,l],1),d=Me(hh(u,c),[s[0],s[1]]);r=a1(d)}if(r=i1(r),t.rank===3&&t.shape[0]!==0){const s=r,i=t.shape[0];r=Me(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const nP=Ae({irfft_:xIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wIe(t,e,n=0){const s={x:pe(t,"x","split")},i={numOrSizeSplits:e,axis:n};return $e.runKernel(zb,s,i)}const go=Ae({split_:wIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bIe(t,e){ae(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const m=t.shape.map(x=>0),g=t.shape.map(x=>x);g[t.shape.length-1]=e,s=Kt(t,m,g),n=e}else if(e!=null&&e>n){const m=t.shape.map(g=>g);m[t.shape.length-1]=e-n,s=pr([t,_r(m)],t.shape.length-1),n=e}else s=t;const i=xn(s),o=Me(hh(s,i),[r,n]),a=cT(o),l=Math.floor(n/2)+1,u=i1(a),c=Zk(a),d=go(u,[l,n-l],u.shape.length-1),h=go(c,[l,n-l],c.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,Me(hh(d[0],h[0]),f)}const dT=Ae({rfft_:bIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vIe(t,e){let n=pe(t,"a","squaredDifference"),r=pe(e,"b","squaredDifference");[n,r]=Sr(n,r),jt(n.shape,r.shape);const s={a:n,b:r},i={};return $e.runKernel(dy,s,i)}const rP=Ae({squaredDifference_:vIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SIe(t,e){const n=pe(t,"x","squeeze","string_or_numeric");return Me(n,_h(n.shape,e).newShape)}const Nn=Ae({squeeze_:SIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CIe(t,e=0){const n=_I(t,"tensors","stack","string_or_numeric");ae(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&ae(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return $e.runKernel(Tb,r,s)}const xo=Ae({stack_:CIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IIe(t,e=0){const r={x:pe(t,"x","step")},s={alpha:e};return $e.runKernel(gy,r,s)}const wy=Ae({step_:IIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NIe(t,e,n,r,s=0,i=0,o=0,a=0,l=0){const c={x:pe(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return $e.runKernel(Uk,c,d)}const ZK=Ae({stridedSlice_:NIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kIe(t){const n={x:pe(t,"x","tan","float32")};return $e.runKernel(fy,n)}const QK=Ae({tan_:kIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Br(t,e){w0(t);const n=$h(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Rh(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $a(t,e,n){if(w0(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=$h(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Rh(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JK(t,e,n){if(w0(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=$h(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Rh(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIe(t,e,n){if(w0(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=$h(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Rh(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIe(t,e,n){if(w0(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=$h(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Rh(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ie(t,e,n){if(w0(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=$h(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Rh(t,e,r,n)}function eq(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(i+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(i+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(i+` update.rank != ${s+t.length-r}`);for(let o=0;o<s;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-s;++o)if(n.shape[o+s]!==t[o+r])throw new Error(i+` updates.shape[${o+s}] (${n.shape[o+s]}) != shape[${o+s}] (${t[o+s]})`)}function sP(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}eq(n,e,t)}function Pu(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let d=s;d<i;++d)o*=n[d];const a=s<1?1:s,l=Ue(e.shape)/a,u=[...$t(n.slice(0,s)),1],c=Ue(n);return{sliceRank:s,numUpdates:l,sliceSize:o,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AIe(t,e,n){const r=pe(t,"tensor","tensorScatterupdate"),s=pe(e,"indices","tensorScatterupdate","int32"),i=pe(n,"updates","tensorScatterupdate");if(sP(i,s,r.shape),r.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${i.dtype}.`);const o={tensor:r,indices:s,updates:i},a={};return $e.runKernel(Dk,o,a)}const $Ie=Ae({tensorScatterUpdate_:AIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(t,e=1,n=!0){const r=pe(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[a,l]=$e.runKernel(jk,i,o);return{values:a,indices:l}}const tq=Ae({topk_:RIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MIe(t,e=0,n=1,r,s){if(qo(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new HO(e,n,r,!0,s),o=Zt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const iP=Ae({truncatedNormal_:MIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(t,e=0){const n=pe(t,"x","unique","string_or_numeric");ae(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[i,o]=$e.runKernel(NO,r,s);return{values:i,indices:o}}const nq=Ae({unique_:DIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OIe(t,e,n){const r=pe(t,"x","unsortedSegmentSum"),s=pe(e,"segmentIds","unsortedSegmentSum","int32");ae(Yg(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:n};return $e.runKernel(Vb,i,o)}const oP=Ae({unsortedSegmentSum_:OIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PIe(t,e=0){const n=pe(t,"x","unstack","string_or_numeric");ae(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return $e.runKernel(Ub,r,s)}const Da=Ae({unstack_:PIe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(t,e){return jO(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rq(t,e=!0,n,r){return $e.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aP(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=Zt(t,"int32"),s=Zt([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),a=i*t.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function LIe(t){const e=pe(t,"condition","whereAsync","bool"),n=await e.data(),r=aP(e.shape,n);return t!==e&&e.dispose(),r}const sq=LIe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function zIe(t,e,n){const r=pe(t,"tensor","boolMask"),s=pe(e,"mask","boolMask","bool"),i=n??0,o=s.rank,a=r.shape;ae(o>0,()=>"mask cannot be scalar"),Wi(a.slice(i,i+o),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=i;g<i+o;g++)l*=a[g];const u=a.slice(0,i).concat([l],a.slice(i+o)),c=Me(r,u),d=Me(s,[-1]),h=await sq(d),f=Nn(h,[1]),m=Xb(c,f,i);return t!==r&&r.dispose(),e!==s&&s.dispose(),f.dispose(),c.dispose(),d.dispose(),h.dispose(),m}const BIe=zIe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UIe(t,e,n){const r=pe(t,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),ae(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{ae(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?Ve(()=>{let o=i1(r),a=Zk(r);return o=$e.runKernel(tp,{x:o},i),a=$e.runKernel(tp,{x:a},i),n&&(a=tr(a)),hh(o,a)}):$e.runKernel(tp,s,i)}const yn=Ae({transpose_:UIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIe(t,e,n,r,s=!0){const i=pe(t,"v","movingAverage"),o=pe(e,"x","movingAverage"),a=pe(n,"decay","movingAverage");Abe(i,o),ae(nn(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=Mt(1),u=xt(l,a);let c=_e(xt(o,i),u);if(s){ae(r!=null,()=>"When using zeroDebias: true, step is required.");const d=pe(r,"step","movingAverage");c=yt(c,xt(l,Rc(a,d)))}return Qe(i,c)}const jIe=Ae({movingAverage_:VIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WIe(t,e,n){qo(n);const r=pe(t,"indices","scatterND","int32"),s=pe(e,"updates","scatterND");sP(s,r,n);const i={indices:r,updates:s},o={shape:n};return $e.runKernel(Mk,i,o)}const GIe=Ae({scatterND_:WIe});function HIe(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YIe(t,e,n,r=0){qo(n);const s=pe(t,"sparseIndices","sparseToDense","int32"),i=pe(e,"sparseValues","sparseToDense","string_or_numeric"),o=pe(r,"defaultValue","sparseToDense",i.dtype);HIe(s,i,n,o);const a={sparseIndices:s,sparseValues:i,defaultValue:o},l={outputShape:n};return $e.runKernel(Lk,a,l)}const KIe=Ae({sparseToDense_:YIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qIe(t,e){const n=pe(e,"indices","gatherND","int32"),s={params:pe(t,"x","gatherND","string_or_numeric"),indices:n};return $e.runKernel(xk,s)}const XIe=Ae({gatherND_:qIe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIe(t,e){if(e==null)return t.shape.slice();if(nn(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(t,e,n,r){const s=pe(t,"x","dropout");if(ae(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),ae(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof _n?s.clone():s;const i=ZIe(s,n),o=1-e,a=yt(qb(Qe(jp(i,0,1,"float32",r),o)),o);return _e(s,a)}const iq=Ae({dropout_:QIe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function lP(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);s[i]=e-n*Math.cos(o)}return Br(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function JIe(t,e,n=1){const r=pe(t,"predictions","inTopK"),s=pe(e,"targets","inTopK");ae(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),ae(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Wi(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];ae(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await r.data(),a=await s.data(),[l,u]=[o.length/i,i],c=is("bool",l);for(let d=0;d<l;d++){const h=d*u,f=o.subarray(h,h+u),m=[];for(let g=0;g<f.length;g++)m.push({value:f[g],index:g});m.sort((g,x)=>x.value-g.value),c[d]=0;for(let g=0;g<n;g++)if(m[g].index===a[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),wl(c,s.shape,"bool")}const eNe=JIe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tNe(t,e,n,r,s,i="NHWC",o){let a=t;t.rank===3&&(a=Me(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]])),ae(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),ae(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),ae(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=i==="NHWC"?a.shape[3]:a.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];ae(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),ae(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),vi("conv2dDerFilter",s,o);const d={x:a,dy:l},h={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:n};return $e.runKernel(rk,d,h)}const uP=Ae({conv2DBackpropFilter_:tNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hT(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return _e(t,wy(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function fT(t,e){let n=e;const r=os(t.shape,e.shape);return r.length>0&&(n=Nt(n,r)),Me(n,t.shape)}function pT(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Ou(t);if(e==="elu")return Yb(t);if(e==="relu6")return KO(t);if(e==="prelu")return iT(t,n);if(e==="leakyrelu")return Qk(t,r);if(e==="sigmoid")return Go(t);throw new Error(`Unknown fused activation ${e}.`)}const mT=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nNe({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",mT($e.state.gradientDepth,l)===!1){ae(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let D=mh(t,e,n,r,s,i,o);return a!=null&&(D=Qe(D,a)),pT(D,l,u,c)}const d=pe(t,"x","conv2d","float32"),h=pe(e,"filter","conv2d","float32");let f=d,m=!1;d.rank===3&&(m=!0,f=Me(d,[1,d.shape[0],d.shape[1],d.shape[2]])),ae(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),ae(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),vi("fused conv2d",r,o);const g=s==="NHWC"?f.shape[3]:f.shape[1];ae(h.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${h.shape[2]}.`),ae(as(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const x=Kn(f.shape,h.shape,n,i,r,o);let w;a!=null&&(w=pe(a,"bias","fused conv2d"),[w]=Sr(w,d),s==="NHWC"?jt(x.outShape,w.shape):(ae(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),ae(w.shape.length===0||w.shape[0]===x.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let b;if(u!=null){const D=u.shape;if(ae(D.length<=1||D.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${D.length}.`),D.length===1)ae(D[0]===1||D[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${D}) is not compatible with the number of output channels (${x.outChannels}).`);else if(D.length===3)try{jt(D,x.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${D}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(I)}b=pe(u,"prelu weights","fused conv2d")}const S=(D,P)=>{ae(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[I,E,M,O]=P,j=hT(D,M,l);ae(ph(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const R=DO(E.shape,j,I,n,r),z=uP(E,j,I.shape,n,r),B=[R,z];if(O!=null){const V=fT(O,j);B.push(V)}return B},C={x:f,filter:h,bias:w,preluActivationWeights:b},T={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return a==null?Mc((P,I,E)=>{let M=$e.runKernel(Qw,C,T);return E([I,P,M]),m&&(M=Me(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:S}})(f,h):Mc((P,I,E,M)=>{let O=$e.runKernel(Qw,C,T);return M([I,P,O,E]),m&&(O=Me(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:S}})(f,h,w)}const aq=Ae({fusedConv2d_:nNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rNe(t,e,n,r,s,i=[1,1],o){let a=t;t.rank===3&&(a=Me(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:n};return $e.runKernel(ck,u,c)}const lq=Ae({depthwiseConv2dNativeBackpropFilter_:rNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNe(t,e,n,r,s,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:t},d=$e.runKernel(dk,u,c);return l?Me(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const uq=Ae({depthwiseConv2dNativeBackpropInput_:sNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iNe({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(mT($e.state.gradientDepth,l)===!1){let T=Hb(t,e,n,r,s,i,o);return a!=null&&(T=Qe(T,a)),pT(T,l,u,c)}const d=pe(t,"x","depthwiseConv2d","float32"),h=pe(e,"filter","depthwiseConv2d","float32");let f=d,m=!1;d.rank===3&&(m=!0,f=Me(d,[1,d.shape[0],d.shape[1],d.shape[2]])),ae(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),ae(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),ae(f.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),i==null&&(i=[1,1]),ae(as(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),vi("fused depthwiseConv2d",r,o);const g=Kn(f.shape,h.shape,n,i,r,o,!0);let x;a!=null&&(x=pe(a,"bias","fused conv2d"),[x]=Sr(x,d),jt(g.outShape,x.shape));let w;u!=null&&(w=pe(u,"prelu weights","fused depthwiseConv2d"));const b=(T,D)=>{ae(ph(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[P,I,E,M]=D,O=hT(T,E,l),j=uq(I.shape,O,P,n,r,i,o),R=lq(I,O,P.shape,n,r,i,o);if(M!=null){const z=fT(x,O);return[j,R,z]}return[j,R]},S={x:f,filter:h,bias:x,preluActivationWeights:w},C={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return a==null?Mc((D,P,I)=>{let E=$e.runKernel(Jw,S,C);return I([P,D,E]),m&&(E=Me(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(f,h):Mc((D,P,I,E)=>{let M=$e.runKernel(Jw,S,C);return E([P,D,M,I]),m&&(M=Me(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:b}})(f,h,x)}const oNe=Ae({fusedDepthwiseConv2d_:iNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aNe({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(mT($e.state.gradientDepth,i)===!1){let O=dn(t,e,n,r);return s!=null&&(O=Qe(O,s)),pT(O,i,o,a)}let l=pe(t,"a","fused matMul"),u=pe(e,"b","fused matMul");[l,u]=Sr(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),g=u.shape.slice(0,-2),x=Ue(m),w=Ue(g);ae(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=jt(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,f]),C=n?Me(l,[x,c,h]):Me(l,[x,h,c]),T=r?Me(u,[w,f,d]):Me(u,[w,d,f]);let D;s!=null&&(D=pe(s,"bias","fused matMul"),[D]=Sr(D,l),jt(S,D.shape));let P;o!=null&&(P=pe(o,"prelu weights","fused matMul"));const I=(O,j)=>{const[R,z,B,V]=j,H=hT(Me(O,B.shape),B,i);let K,ne;if(!n&&!r?(K=dn(H,z,!1,!0),ne=dn(R,H,!0,!1)):!n&&r?(K=dn(H,z,!1,!1),ne=dn(H,R,!0,!1)):n&&!r?(K=dn(z,H,!1,!0),ne=dn(R,H,!1,!1)):(K=dn(z,H,!0,!0),ne=dn(H,R,!0,!0)),s!=null){const fe=fT(V,H);return[K,ne,fe]}else return[K,ne]},E={a:C,b:T,bias:D,preluActivationWeights:P},M={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?Mc((j,R,z)=>{const B=$e.runKernel(Zw,E,M);return z([j,R,B]),{value:Me(B,S),gradFunc:I}})(C,T):Mc((j,R,z,B)=>{const V=$e.runKernel(Zw,E,M);return B([j,R,V,z]),{value:Me(V,S),gradFunc:I}})(C,T,D)}const $R=Ae({fusedMatMul_:aNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lNe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:aq,depthwiseConv2d:oNe,matMul:$R},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uNe(t){return lP(t,.54,.46)}const cNe=Ae({hammingWindow_:uNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dNe(t){return lP(t,.5,.5)}const cq=Ae({hannWindow_:dNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hNe(t,e,n,r=!1,s=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(Kt(t,i,e)),i+=n;if(r)for(;i<t.size;){const a=i+e-t.size,l=pr([Kt(t,i,e-a),yy([a],s)]);o.push(l),i+=n}return o.length===0?$a([],[0,e]):Me(pr(o),[o.length,e])}const dq=Ae({frame_:hNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fNe(t,e,n,r,s=cq){r==null&&(r=oq(e));const i=dq(t,e,n),o=_e(i,s(e));return dT(o,r)}const pNe=Ae({stft_:fNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mNe(t,e,n,r,s="bilinear",i=0){const o=pe(t,"image","cropAndResize"),a=pe(e,"boxes","cropAndResize","float32"),l=pe(n,"boxInd","cropAndResize","int32"),u=a.shape[0];ae(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),ae(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),ae(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),ae(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),ae(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),ae(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:o,boxes:a,boxInd:l},d={method:s,extrapolationValue:i,cropSize:r};return $e.runKernel(ak,c,d)}const gNe=Ae({cropAndResize_:mNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yNe(t){const e=pe(t,"image","flipLeftRight","float32");ae(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return $e.runKernel(yk,n,{})}const xNe=Ae({flipLeftRight_:yNe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wNe(t){const e=pe(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];ae(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),ae(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Ca(e,s)}const bNe=Ae({grayscaleToRGB_:wNe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vNe(t){const e=pe(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];ae(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),ae(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=lt(e,"float32"),o=Br([.2989,.587,.114]);let a;switch(e.rank){case 2:a=mg("ij,j->i",i,o);break;case 3:a=mg("ijk,k->ij",i,o);break;case 4:a=mg("ijkl,l->ijk",i,o);break;case 5:a=mg("ijklm,m->ijkl",i,o);break;case 6:a=mg("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=Fr(a,-1),lt(a,s)}const SNe=Ae({rgbToGrayscale_:vNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CNe(t,e,n=0,r=.5){const s=pe(t,"image","rotateWithOffset","float32");ae(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:n,center:r};return $e.runKernel(Gk,i,o)}const INe=Ae({rotateWithOffset_:CNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(t,e,n,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),ae(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),ae(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),ae(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),ae(e.rank===1,()=>"scores must be a 1D tensor"),ae(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),ae(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NNe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=pe(t,"boxes","nonMaxSuppression","float32"),o=pe(e,"scores","nonMaxSuppression","float32"),a=by(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return $e.runKernel(Tk,{boxes:i,scores:o},l)}const kNe=Ae({nonMaxSuppression_:NNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TNe(t,e,n){const r=ENe(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function ENe(t,e,n){return ANe(t,e,n||_Ne)}function _Ne(t,e){return t>e?1:t<e?-1:0}function ANe(t,e,n){let r=0,s=t.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=n(e,t[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gT(t,e,n,r,s){return dP(t,e,n,r,s,0)}function cP(t,e,n,r,s,i){return dP(t,e,n,r,s,0,!1,i,!0)}function yT(t,e,n,r,s,i){return dP(t,e,n,r,s,i,!0)}function dP(t,e,n,r,s,i,o=!1,a=!1,l=!1){const u=[];for(let x=0;x<e.length;x++)e[x]>s&&u.push({score:e[x],boxIndex:x,suppressBeginIndex:0});u.sort(HU);const c=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&u.length>0;){const x=u.pop(),{score:w,boxIndex:b,suppressBeginIndex:S}=x;if(w<s)break;let C=!1;for(let T=d.length-1;T>=S;--T){const D=$Ne(t,b,d[T]);if(D>=r){C=!0;break}if(x.score=x.score*RNe(r,c,D),x.score<=s)break}x.suppressBeginIndex=d.length,C||(x.score===w?(d.push(b),h.push(x.score)):x.score>s&&TNe(u,x,HU))}const f=d.length,m=n-f;a&&m>0&&(d.push(...new Array(m).fill(0)),h.push(...new Array(m).fill(0)));const g={selectedIndices:d};return o&&(g.selectedScores=h),l&&(g.validOutputs=f),g}function $Ne(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),f=(a-i)*(l-o),m=(d-u)*(h-c);if(f<=0||m<=0)return 0;const g=Math.max(i,u),x=Math.max(o,c),w=Math.min(a,d),b=Math.min(l,h),S=Math.max(w-g,0)*Math.max(b-x,0);return S/(f+m-S)}function RNe(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function HU(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MNe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=pe(t,"boxes","nonMaxSuppressionAsync"),o=pe(e,"scores","nonMaxSuppressionAsync"),a=by(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:d}=gT(u,c,n,r,s);return i!==t&&i.dispose(),o!==e&&o.dispose(),Br(d,"int32")}const DNe=MNe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ONe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=pe(t,"boxes","nonMaxSuppression"),a=pe(e,"scores","nonMaxSuppression"),l=by(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:o,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},d=$e.runKernel(Ek,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const PNe=Ae({nonMaxSuppressionWithScore_:ONe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function FNe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=pe(t,"boxes","nonMaxSuppressionAsync"),a=pe(e,"scores","nonMaxSuppressionAsync"),l=by(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([o.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:h,selectedScores:f}=yT(c,d,n,r,s,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Br(h,"int32"),selectedScores:Br(f)}}const LNe=FNe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zNe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=pe(t,"boxes","nonMaxSuppression"),a=pe(e,"scores","nonMaxSuppression"),l=by(o,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},f={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:i},m=$e.runKernel(yO,h,f);return{selectedIndices:m[0],validOutputs:m[1]}}const BNe=Ae({nonMaxSuppressionPadded_:zNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function UNe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=pe(t,"boxes","nonMaxSuppressionAsync"),a=pe(e,"scores","nonMaxSuppressionAsync"),l=by(o,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:m,validOutputs:g}=cP(h,f,u,c,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Br(m,"int32"),validOutputs:Mt(g,"int32")}}const VNe=UNe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(t,e,n=!1,r=!1){const s=pe(t,"images","resizeBilinear");ae(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),ae(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),ae(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=Me(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=$e.runKernel(Mb,a,l);return o?Me(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const hq=Ae({resizeBilinear_:jNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WNe(t,e,n=!1,r=!1){const s=pe(t,"images","resizeNearestNeighbor");ae(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),ae(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),ae(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),ae(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=Me(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=$e.runKernel(Rb,a,l);return o?Me(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const fq=Ae({resizeNearestNeighbor_:WNe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GNe(t,e="binary",n=!1,r=.5){const s=pe(t,"image","threshold"),i=.2989,o=.587,a=.114,l=s.shape[0]*s.shape[1];let u=_e(Br([r]),255),c,d,h,f;if(ae(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),ae(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),ae(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),ae(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,h]=go(s,[1,1,1],-1);const x=_e(c,i),w=_e(d,o),b=_e(h,a);f=Qe(Qe(x,w),b)}else f=t;if(e==="otsu"){const x=SK(lt(qO(f),"int32"),wl([]),256);u=HNe(x,l)}const m=n?Vp(f,u):Io(f,u);return lt(_e(m,255),"int32")}function HNe(t,e){let n=Br([-1]),r=Br([0]),s=Br([0]),i,o,a,l,u,c;for(let d=0;d<t.size-1;d++){i=Kt(t,0,d+1),o=Kt(t,d+1),u=yt(Nt(i),e),c=yt(Nt(o),e);const h=Nt(_e(i,Xg(0,i.size)));a=yt(h,Nt(i));const f=yy(o.shape,i.size),m=Qe(Xg(0,o.size),f),g=_e(o,m);l=yt(Nt(g),Nt(o));const x=xt(a,l),w=xt(a,l),b=_e(u,c);s=_e(_e(b,x),w);const S=Io(s,r);r=js(S,s,r),n=js(S,Br([d]),n)}return n}const YNe=Ae({threshold_:GNe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KNe(t,e,n="nearest",r="constant",s=0,i){const o=pe(t,"image","transform","float32"),a=pe(e,"transforms","transform","float32");ae(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),ae(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),ae(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},u={interpolation:n,fillMode:r,fillValue:s,outputShape:i};return $e.runKernel(Wk,l,u)}const qNe=Ae({transform_:KNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XNe(t,e,n){const r=pe(t,"a","bandPart");ae(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,l;typeof e=="number"?(ae(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),ae(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=pe(e<0?i:e,"numLower","bandPart")):(ae(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=js(s1(e,0),i,yh(e,i))),typeof n=="number"?(ae(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),ae(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=pe(n<0?o:n,"numUpper","bandPart")):(ae(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=js(s1(n,0),o,yh(n,o)));const u=Me(Xg(0,i,1,"int32"),[-1,1]),c=Xg(0,o,1,"int32"),d=xt(u,c),h=ku(Vp(d,a),Dh(d,tr(l))),f=_r([i,o],r.dtype);return Me(xo(Da(Me(r,[-1,i,o])).map(m=>js(h,m,f))),s)}const ZNe=Ae({bandPart_:XNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QNe(t){let e;if(Array.isArray(t)){e=!1,ae(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let i=1;i<t.length;++i)ae(t[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${s})`)}else e=!0,t=go(t,t.shape[0],0).map(s=>Nn(s,[0]));ae(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push($e.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=_e(Nt(_e(n[o],i)),n[o]);i=xt(i,a)}return yt(i,Kb(i,"euclidean"))}));return e?xo(n,0):n}const JNe=Ae({gramSchmidt_:QNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eke(t,e=!1){if(ae(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return YU(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=Da(Me(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[u,c]=YU(l,e);s.push(u),i.push(c)});const o=Me(xo(s,0),t.shape),a=Me(xo(i,0),t.shape);return[o,a]}}function YU(t,e=!1){return $e.tidy(()=>{ae(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=BO(n),i=Ic(t);const o=$a([[1]],[1,1]);let a=Ic(o);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=i,d=a,h=s;[a,i,s]=$e.tidy(()=>{const f=Kt(i,[u,u],[n-u,1]),m=Kb(f),g=Kt(i,[u,u],[1,1]),x=js(Io(g,0),$a([[-1]]),$a([[1]])),w=xt(g,_e(x,m)),b=yt(f,w);b.shape[0]===1?a=Ic(o):a=pr([o,Kt(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const S=tr(yt(dn(x,w),m)),C=Kt(i,[u,0],[n-u,r]),T=_e(S,a),D=yn(a);if(u===0)i=xt(C,dn(T,dn(D,C)));else{const E=xt(C,dn(T,dn(D,C)));i=pr([Kt(i,[0,0],[u,r]),E],0)}const P=yn(T),I=Kt(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=xt(I,dn(dn(I,a),P));else{const E=xt(I,dn(dn(I,a),P));s=pr([Kt(s,[0,0],[n,u]),E],1)}return[a,i,s]}),Bt([c,d,h])}return!e&&n>r&&(s=Kt(s,[0,0],[n,r]),i=Kt(i,[0,0],[r,r])),[s,i]})}const tke=Ae({qr_:eke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Fi;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Fi||(Fi={}));function nke(t,e,n=Fi.SUM_BY_NONZERO_WEIGHTS){const r=pe(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=pe(e,"weights","computeWeightedLoss"));const i=s==null?r:_e(r,s);if(n===Fi.NONE)return i;if(n===Fi.SUM)return Nt(i);if(n===Fi.MEAN){if(s==null)return wr(i);{const o=r.size/s.size,a=yt(Nt(i),Nt(s));return o>1?yt(a,Mt(o)):a}}if(n===Fi.SUM_BY_NONZERO_WEIGHTS){if(s==null)return yt(Nt(i),Mt(r.size));{const o=_e(s,mo(r.shape)),a=lt(Nt(qg(o,Mt(0))),"float32");return yt(Nt(i),a)}}throw Error(`Unknown reduction: ${n}`)}const Fc=Ae({computeWeightedLoss_:nke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rke(t,e,n,r=Fi.SUM_BY_NONZERO_WEIGHTS){const s=pe(t,"labels","absoluteDifference"),i=pe(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=pe(n,"weights","absoluteDifference")),Wi(s.shape,i.shape,"Error in absoluteDifference: ");const a=Zr(xt(s,i));return Fc(a,o,r)}const ske=Ae({absoluteDifference_:rke});function ike(t,e,n,r,s=Fi.SUM_BY_NONZERO_WEIGHTS){const i=pe(t,"labels","cosineDistance"),o=pe(e,"predictions","cosineDistance");let a=null;r!=null&&(a=pe(r,"weights","cosineDistance")),Wi(i.shape,o.shape,"Error in cosineDistance: ");const l=Mt(1),u=xt(l,Nt(_e(i,o),n,!0));return Fc(u,a,s)}const oke=Ae({cosineDistance_:ike});function ake(t,e,n,r=Fi.SUM_BY_NONZERO_WEIGHTS){let s=pe(t,"labels","hingeLoss");const i=pe(e,"predictions","hingeLoss");let o=null;n!=null&&(o=pe(n,"weights","hingeLoss")),Wi(s.shape,i.shape,"Error in hingeLoss: ");const a=Mt(1);s=xt(_e(Mt(2),s),a);const l=Ou(xt(a,_e(s,i)));return Fc(l,o,r)}const lke=Ae({hingeLoss_:ake});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uke(t,e,n,r=1,s=Fi.SUM_BY_NONZERO_WEIGHTS){const i=pe(t,"labels","huberLoss"),o=pe(e,"predictions","huberLoss");let a=null;n!=null&&(a=pe(n,"weights","huberLoss")),Wi(i.shape,o.shape,"Error in huberLoss: ");const l=Mt(r),u=Zr(xt(o,i)),c=yh(u,l),d=xt(u,c),h=Qe(_e(Mt(.5),Fn(c)),_e(l,d));return Fc(h,a,s)}const cke=Ae({huberLoss_:uke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dke(t,e,n,r=1e-7,s=Fi.SUM_BY_NONZERO_WEIGHTS){const i=pe(t,"labels","logLoss"),o=pe(e,"predictions","logLoss");let a=null;n!=null&&(a=pe(n,"weights","logLoss")),Wi(i.shape,o.shape,"Error in logLoss: ");const l=Mt(1),u=Mt(r),c=tr(_e(i,Yo(Qe(o,u)))),d=_e(xt(l,i),Yo(Qe(xt(l,o),u))),h=xt(c,d);return Fc(h,a,s)}const hke=Ae({logLoss_:dke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(t,e,n,r=Fi.SUM_BY_NONZERO_WEIGHTS){const s=pe(t,"labels","meanSquaredError"),i=pe(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=pe(n,"weights","meanSquaredError")),Wi(s.shape,i.shape,"Error in meanSquaredError: ");const a=rP(s,i);return Fc(a,o,r)}const pke=Ae({meanSquaredError_:fke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(t,e){const n=pe(t,"labels","sigmoidCrossEntropyWithLogits"),r=pe(e,"logits","sigmoidCrossEntropyWithLogits");Wi(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Ou(r),i=_e(r,n),o=Jk(wi(tr(Zr(r))));return Qe(xt(s,i),o)}function gke(t,e,n,r=0,s=Fi.SUM_BY_NONZERO_WEIGHTS){let i=pe(t,"multiClassLabels","sigmoidCrossEntropy");const o=pe(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=pe(n,"weights","sigmoidCrossEntropy")),Wi(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=Mt(r),c=Mt(1),d=Mt(.5);i=Qe(_e(i,xt(c,u)),_e(d,u))}const l=mke(i,o);return Fc(l,a,s)}const yke=Ae({sigmoidCrossEntropy_:gke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Mc((s,i,o)=>{const l=eT(i,[n],!0),u=xt(lt(i,"float32"),l);o([s,u]);const c=tr(_e(u,s));return{value:Nt(c,[n]),gradFunc:(f,m)=>{const[g,x]=m,w=Cr(f.shape,[n]);return[_e(Me(f,w),xt(lt(g,"float32"),wi(x))),_e(Me(f,w),xt(wi(x),lt(g,"float32")))]}}})(t,e)}function wke(t,e,n,r=0,s=Fi.SUM_BY_NONZERO_WEIGHTS){let i=pe(t,"onehotLabels","softmaxCrossEntropy");const o=pe(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=pe(n,"weights","softmaxCrossEntropy")),Wi(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const u=Mt(r),c=Mt(1),d=Mt(i.shape[1]);i=Qe(_e(i,xt(c,u)),yt(u,d))}const l=xke(i,o);return Fc(l,a,s)}const bke=Ae({softmaxCrossEntropy_:wke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vke(t,e,n,r){const s=pe(t,"indices","sparseFillEmptyRows","int32"),i=pe(e,"values","sparseFillEmptyRows"),o=pe(n,"denseShape","sparseFillEmptyRows","int32"),a=pe(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:s,values:i,denseShape:o,defaultValue:a},u=$e.runKernel(vO,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const Ske=Ae({sparseFillEmptyRows_:vke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(t,e,n){const r=pe(t,"inputIndices","sparseReshape","int32"),s=pe(e,"inputShape","sparseReshape","int32"),i=pe(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:r,inputShape:s,newShape:i},a=$e.runKernel(SO,o);return{outputIndices:a[0],outputShape:a[1]}}const Ike=Ae({sparseReshape_:Cke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(t,e,n){const r=pe(t,"data","sparseSegmentMean"),s=pe(e,"indices","sparseSegmentMean","int32"),i=pe(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return $e.runKernel(Pk,o)}const kke=Ae({sparseSegmentMean_:Nke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tke(t,e,n){const r=pe(t,"data","sparseSegmentSum"),s=pe(e,"indices","sparseSegmentSum","int32"),i=pe(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return $e.runKernel(Fk,o)}const Eke=Ae({sparseSegmentSum_:Tke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ke(t,e,n,r,s,i,o,a){const l=pe(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=pe(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:i,padWidth:o,preserveShortSequences:a},d={data:l,dataSplits:u},h=$e.runKernel(Vk,d,c);return{nGrams:h[0],nGramsSplits:h[1]}}const Ake=Ae({stringNGrams_:_ke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t,e,n=!0){const r=pe(t,"input","stringSplit","string"),s=pe(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const i={skipEmpty:n},o={input:r,delimiter:s},a=$e.runKernel(CO,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const Rke=Ae({stringSplit_:$ke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mke(t,e){const n=pe(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return $e.runKernel(IO,s,r)}const Dke=Ae({stringToHashBucketFast_:Mke});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oke(t,e,n,r=!0){const s=pe(t,"input","staticRegexReplace","string"),i={pattern:e,rewrite:n,replaceGlobal:r};return $e.runKernel(Bk,{x:s},i)}const Pke=Ae({staticRegexReplace_:Oke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fke={fft:cT,ifft:a1,rfft:dT,irfft:nP},Lke={hammingWindow:cNe,hannWindow:cq,frame:dq,stft:pNe},gi={flipLeftRight:xNe,grayscaleToRGB:bNe,resizeNearestNeighbor:fq,resizeBilinear:hq,rgbToGrayscale:SNe,rotateWithOffset:INe,cropAndResize:gNe,nonMaxSuppression:kNe,nonMaxSuppressionAsync:DNe,nonMaxSuppressionWithScore:PNe,nonMaxSuppressionWithScoreAsync:LNe,nonMaxSuppressionPadded:BNe,nonMaxSuppressionPaddedAsync:VNe,threshold:YNe,transform:qNe},pq={bandPart:ZNe,gramSchmidt:JNe,qr:tke},zke={absoluteDifference:ske,computeWeightedLoss:Fc,cosineDistance:oke,hingeLoss:lke,huberLoss:cke,logLoss:hke,meanSquaredError:pke,sigmoidCrossEntropy:yke,softmaxCrossEntropy:bke},Bke={sparseFillEmptyRows:Ske,sparseReshape:Ike,sparseSegmentMean:kke,sparseSegmentSum:Eke},Uke={stringNGrams:Ake,stringSplit:Rke,stringToHashBucketFast:Dke,staticRegexReplace:Pke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vke=new Map,jke=new Map;class vy{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class ba{constructor(){this.classNameMap={}}static getMap(){return ba.instance==null&&(ba.instance=new ba),ba.instance}static register(e){ba.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function et(t,e,n){ae(t.className!=null,()=>"Class being registered does not have the static className property defined."),ae(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),ae(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return ba.register(t),Vke.set(s,t),jke.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oh extends vy{minimize(e,n=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Bt(i),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return fSe(e,n)}dispose(){this.iterations_!=null&&Bt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Mt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Oh,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mq extends Oh{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=$e.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=$e.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:Ve(()=>xn(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:Ve(()=>xn(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;Ve(()=>{const c=Qe(_e(l,this.rho),_e(Fn(a),1-this.rho)),d=_e(yt($s(Qe(u,this.epsilon)),$s(Qe(l,this.epsilon))),a),h=Qe(_e(u,this.rho),_e(Fn(d),1-this.rho));l.assign(c),u.assign(h);const f=Qe(_e(d,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Bt(this.accumulatedGrads.map(e=>e.variable)),Bt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gq extends Oh{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=$e.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:Ve(()=>yy(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;Ve(()=>{const l=Qe(a,Fn(o));a.assign(l);const u=Qe(_e(yt(o,$s(Qe(l,$e.backend.epsilon()))),-this.learningRate),i);i.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Bt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yq extends Oh{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ve(()=>{this.accBeta1=Mt(n).variable(),this.accBeta2=Mt(r).variable()}),s==null&&(this.epsilon=$e.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ve(()=>{const r=xt(1,this.accBeta1),s=xt(1,this.accBeta2);n.forEach((i,o)=>{const a=$e.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ve(()=>xn(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:Ve(()=>xn(a).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=Qe(_e(c,this.beta1),_e(u,1-this.beta1)),f=Qe(_e(d,this.beta2),_e(Fn(u),1-this.beta2)),m=yt(h,r),g=yt(f,s);c.assign(h),d.assign(f);const x=Qe(_e(yt(m,Qe($s(g),this.epsilon)),-this.learningRate),a);a.assign(x)}),this.accBeta1.assign(_e(this.accBeta1,this.beta1)),this.accBeta2.assign(_e(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Bt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Ve(()=>{this.accBeta1.assign(Rc(this.beta1,this.iterations_+1)),this.accBeta2.assign(Rc(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xq extends Oh{static get className(){return"Adamax"}constructor(e,n,r,s=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ve(()=>{this.iteration=Mt(0).variable(),this.accBeta1=Mt(n).variable()}),s==null&&(this.epsilon=$e.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ve(()=>{const r=xt(1,this.accBeta1),s=yt(-this.learningRate,Qe(_e(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=$e.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:xn(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:xn(a).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=Qe(_e(c,this.beta1),_e(u,1-this.beta1)),f=_e(d,this.beta2),m=Zr(u),g=Pc(f,m);c.assign(h),d.assign(g);const x=Qe(_e(yt(s,r),yt(h,Qe(g,this.epsilon))),a);a.assign(x)}),this.iteration.assign(Qe(this.iteration,1)),this.accBeta1.assign(_e(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Bt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hP extends Oh{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=$e.registeredVariables[r];Ve(()=>{const a=Qe(_e(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=gs(Mt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wq extends hP{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Mt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=$e.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:Ve(()=>xn(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&Ve(()=>{let l;const u=Qe(_e(this.m,o),a);this.useNesterov?l=Qe(_e(this.c,Qe(a,_e(u,this.m))),i):l=Qe(_e(this.c,u),i),o.assign(u),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Bt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bq extends Oh{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=$e.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=$e.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:Ve(()=>xn(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:Ve(()=>xn(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:Ve(()=>xn(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;Ve(()=>{const c=Qe(_e(l,this.decay),_e(Fn(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,h=Qe(_e(d,this.decay),_e(a,1-this.decay)),f=yt(_e(a,this.learningRate),$s(xt(c,Qe(Fn(h),this.epsilon)))),m=Qe(_e(u,this.momentum),f);l.assign(c),d.assign(h),u.assign(m);const g=xt(i,m);i.assign(g)}else{const d=Qe(_e(l,this.decay),_e(Fn(a),1-this.decay)),h=Qe(_e(u,this.momentum),yt(_e(a,this.learningRate),$s(Qe(d,this.epsilon))));l.assign(d),u.assign(h);const f=xt(i,h);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Bt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Bt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Bt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wke=[mq,gq,yq,xq,wq,bq,hP];function Gke(){for(const t of Wke)et(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hke="model",Yke=".json",Kke=".weights.bin";function KU(t){return new Promise(e=>setTimeout(e)).then(t)}class kp{constructor(e){if(!We().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(kp.URL_SCHEME)&&(e=e.slice(kp.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Hke),this.modelJsonFileName=e+Yke,this.weightDataFileName=e+Kke}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Ml.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=JY(e,s),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await KU(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await KU(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Wb(e)}}}}kp.URL_SCHEME="downloads://";class qke{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const i=JSON.parse(s.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=_O(i,u=>this.loadWeights(u));e(l)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const s=this.checkManifestAndWeightFiles(e),i=r.map(o=>this.loadWeightsFile(o,s[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((r,s)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;r(a)},i.onerror=o=>s(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(i=>FU(i.name)),s={};for(const i of e)i.paths.forEach(o=>{const a=FU(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[o]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const Xke=t=>We().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(kp.URL_SCHEME)?Zke(t.slice(kp.URL_SCHEME.length)):null;cr.registerSaveRouter(Xke);function Zke(t="model"){return new kp(t)}function Qke(t){return new qke(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(t,e,n,r){o(t),n=n??0,r=r??1,a(n,r);let s=0;const i=l=>(l.then(u=>{const c=n+ ++s/t.length*(r-n);return e(c),u}),l);function o(l){ae(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){ae(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),ae(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),ae(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vq(t,e){e==null&&(e={});const n=e.fetchFunc==null?We().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await qU(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await qU(a,e.onProgress,.5,1)}function Jke(t,e){var n;const r=e.fetchFunc==null?We().platform.fetch:e.fetchFunc;let s=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;s<t.length;){i||(i=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await i.read();if(l){s++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/t.length);continue}o.enqueue(u);return}o.close()}})}async function eTe(t,e="",n,r){return Sq(o=>vq(o,{requestInit:r}))(t,e,n)}function Sq(t){return async(e,n="",r)=>{const s=e.map(()=>!1),i={},o=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((f,m)=>{let g=0;f.weights.forEach(x=>{const w="quantization"in x?x.quantization.dtype:x.dtype,b=wp[w]*Ue(x.shape),S=()=>{s[m]=!0,i[m]==null&&(i[m]=[]),i[m].push({manifestEntry:x,groupOffset:g,sizeBytes:b})};r!=null?r.forEach((C,T)=>{C===x.name&&(S(),o[T]=!0)}):S(),a.push(x.name),g+=b})}),!o.every(f=>f)){const f=r.filter((m,g)=>!o[g]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=s.reduce((f,m,g)=>(m&&f.push(g),f),[]),u=[];l.forEach(f=>{e[f].paths.forEach(m=>{const g=n+(n.endsWith("/")?"":"/")+m;u.push(g)})});const c=await t(u),d={};let h=0;return l.forEach(f=>{const m=e[f].paths.length,g=new Ml(c.slice(h,h+m));i[f].forEach(w=>{const b=g.slice(w.groupOffset,w.groupOffset+w.sizeBytes),S=qY(b,[w.manifestEntry]);for(const C in S)d[C]=S[C]}),h+=m}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTe="application/octet-stream",nTe="application/json";class fP{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(ae(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=We().platform.fetch,ae(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&ae(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=JY(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:nTe}),"model.json"),e.weightData!=null){const o=Ml.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:tTe}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:Wb(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return _O(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=NR(e.weightsManifest),s=()=>Jke(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=rTe(n),i=this.weightPathPrefix||r,o=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):o.push(i+u+s);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),r=NR(e),s=await vq(n,this.loadOptions);return[r,s]}}fP.URL_SCHEME_REGEX=/^https?:\/\//;function rTe(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function RR(t){return t.match(fP.URL_SCHEME_REGEX)!=null}const Cq=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>RR(r)):n=RR(t),n)return pP(t,e)}return null};cr.registerSaveRouter(Cq);cr.registerLoadRouter(Cq);function pP(t,e){return new fP(t,e)}function sTe(t,e){return pP(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E3{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class Iq{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class iTe{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function oTe(t,e,n,r){const s=arguments;return new iTe(Nq(...s))}function Nq(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new E3(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new E3({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new E3({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function aTe(t){return new Iq(t)}function lTe(t){return new Iq(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kq=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Ml,browserFiles:Qke,browserHTTPRequest:sTe,concatenateArrayBuffers:QY,copyModel:lve,decodeWeights:qY,decodeWeightsStream:ZY,encodeWeights:IR,fromMemory:oTe,fromMemorySync:Nq,getLoadHandlers:Kbe,getModelArtifactsForJSON:_O,getModelArtifactsForJSONSync:eK,getModelArtifactsInfoForJSON:Wb,getSaveHandlers:tK,getWeightSpecs:NR,http:pP,isHTTPScheme:RR,listModels:ove,loadWeights:eTe,moveModel:uve,registerLoadRouter:Ybe,registerSaveRouter:Hbe,removeModel:ave,weightsLoaderFactory:Sq,withSaveHandler:aTe,withSaveHandlerSync:lTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let yf,XU=!1;function uTe(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(TI(NI,$e.backendName)!=null){const m={pixels:t},g={numChannels:e};return $e.runKernel(NI,m,g)}const[u,c]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)d=t.data;else if(i||s||a){if(yf==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")yf=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else yf=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});yf.canvas.width=u,yf.canvas.height=c,yf.drawImage(t,0,0,u,c),d=yf.getImageData(0,0,u,c).data}let h;if(e===4)h=new Int32Array(d);else{const m=u*c;h=new Int32Array(m*e);for(let g=0;g<m;g++)for(let x=0;x<e;++x)h[g*e+x]=d[g*4+x]}return JK(h,[c,u,e],"int32")}function cTe(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}async function mP(t,e){let n=pe(t,"img","toPixels");if(!(t instanceof _n)){const u=n;n=lt(u,"int32"),u.dispose()}cTe(n);const[r,s]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(s*r*4);for(let u=0;u<r*s;++u){const c=[0,0,0,255];for(let h=0;h<i;h++){const f=o[u*i+h];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);i===1?(c[0]=f*a,c[1]=f*a,c[2]=f*a):c[h]=f*a}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){XU||TI(gO,$e.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),XU=!0),e.width=s,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,s,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}const Tq=Ae({fromPixels_:uTe});function xT(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(Ue(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let d=0;d<s.length-1;++d)o*=s[d];const a=t.shape,l=s.slice();l.pop();let u=1;for(let d=i;d<n;++d)u*=a[d],l.push(a[d]);const c=[...$t(t.shape).map(d=>d/u),1].slice(0,i);return[l,o,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MR=-2,dTe=-1;function wT(t,e,n){const r=t.shape.length;ae(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),ae(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)ae(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function hTe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function bT(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function Eq(t,e,n,r){const s=[...t];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<n;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function _q(t,e,n){return n<=t?n:n-(e-1)}function Aq(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function fTe(t,e,n,r,s,i,o,a,l){const u=t.length;let c=new Array(u),d=new Array(u),h=new Array(u);if(e.length&&n>0){const f=e[0],m=n+1;c=$q(o,f,m,r,t),d=Rq(a,f,m,s,t),h=Eq(i,f,m,t)}else for(let f=0;f<u;f++)c[f]=Dq(o,r,i,t,f,l),d[f]=Oq(a,s,i,t,f,l),h[f]=Mq(i,f,l);return{begin:c,end:d,strides:h}}function $q(t,e,n,r,s){const i=[...s],o=Aq(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=_q(e,n,a);let u=r[l];t&1<<l&&(u=0),i[a]=u}return i}function Rq(t,e,n,r,s){const i=[...s],o=Aq(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=_q(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[a]=u}for(let a=0;a<i.length;a++){const l=s[a];i[a]<0&&(i[a]+=l),i[a]=yp(0,i[a],s[a])}return i}function Mq(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function Dq(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),o=yp(0,o,l-1),o}function Oq(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),a>0?o=yp(0,o,l):o=yp(-1,o,l-1),o}function gP(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function yP(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function Zb(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{ae(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(s).fill(-1):typeof n=="number"?i=[n,...new Array(s-1).fill(-1)]:n.length<s?i=n.concat(new Array(s-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(ae(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,i]}function vT(t,e,n,r,s,i,o,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&(o&o-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let S=0;S<d.dims;S++)c&&(1<<S&a)!==0&&d.numAddAxisAfterEllipsis++,1<<S&o&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};pTe(d,h);let f=!0,m=!0,g=!0;const x=[],w=[];for(let S=0;S<t.length;++S){if(h.strides[S]===0)throw Error(`strides[${S}] must be non-zero`);const C=!!(h.shrinkAxisMask&1<<S),T=t[S];if(T===-1){x.push(C?1:-1);continue}const D=[h.beginMask&1<<S,h.endMask&1<<S],P=[h.strides[S]>0?0:-1,h.strides[S]>0?T:T-1];if(C&&h.strides[S]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&h.strides[S]===1;const I=!!(h.beginMask&1<<S&&h.endMask&1<<S);if(h.beginValid&&h.endValid){if(C){const j=h.begin[S]<0?T+h.begin[S]:h.begin[S];if(h.begin[S]=j,h.end[S]=h.begin[S]+1,j<0||j>=T)throw Error(`slice index ${h.begin[S]} of dimension ${S} out of bounds.`)}else h.begin[S]=ZU(h.begin[S],0,h.strides[S],T,D,P),h.end[S]=ZU(h.end[S],1,h.strides[S],T,D,P);const O=h.strides[S]===1&&h.begin[S]===0&&h.end[S]===T;f=f&&O,m=m&&(S===0&&h.strides[S]===1||O)}else f=f&&h.strides[S]===1&&I,m=m&&(S===0&&h.strides[S]===1||I);let E,M=!1;if(h.beginValid&&h.endValid?(E=h.end[S]-h.begin[S],M=!0):C?(E=1,M=!0):I&&T>=0&&(h.strides[S]<0?E=-T:E=T,M=!0),M){let O;E===0||E<0!=h.strides[S]<0?O=0:O=Math.trunc(E/h.strides[S])+(E%h.strides[S]!==0?1:0),x.push(O)}else x.push(-1)}for(let S=0;S<h.finalShapeGatherIndices.length;++S){const C=h.finalShapeGatherIndices[S];C>=0?w.push(x[C]):C===MR&&w.push(1)}return{finalShapeSparse:w.filter((S,C)=>h.finalShapeGatherIndices[C]!==MR),finalShape:w,isIdentity:f,sliceDim0:m,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function pTe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(MR),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(dTe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function ZU(t,e,n,r,s,i){if(s[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const mTe=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:wT,computeFlatOffset:yP,computeOutShape:bT,getNormalizedAxes:fTe,isSliceContinous:gP,maskToAxes:hTe,parseSliceParams:Zb,sliceInfo:vT,startForAxis:Dq,startIndicesWithElidedDims:$q,stopForAxis:Oq,stopIndicesWithElidedDims:Rq,stridesForAxis:Mq,stridesWithElidedDims:Eq},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gTe{static sgd(e){return new hP(e)}static momentum(e,n,r=!1){return new wq(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,i=!1){return new bq(e,n,r,s,i)}static adam(e=.001,n=.9,r=.999,s=null){return new yq(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new mq(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,i=0){return new xq(e,n,r,s,i)}static adagrad(e,n=.1){return new gq(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ym=gTe;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yTe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function Pq(){return new Promise(t=>yTe(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(t,e){const n=t[0].length;t.forEach((s,i)=>{ae(s.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),ae(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,i)=>{for(let o=0;o<n;o++)ae(o===e||s[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function zi(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var hl;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(hl||(hl={}));function Fq(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const i=n[s],o=r[r.length-n.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${i} but shape[${s+t}] = ${a}`)}else r[o]=i}return r}function Lq(t){const e={FIRST_DIM_SIZE:hl.FIRST_DIM_SIZE,VALUE_ROWIDS:hl.VALUE_ROWIDS,ROW_LENGTHS:hl.ROW_LENGTHS,ROW_SPLITS:hl.ROW_SPLITS,ROW_LIMITS:hl.ROW_LIMITS,ROW_STARTS:hl.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function zq(t){return t.length===0?0:t[0]===hl.FIRST_DIM_SIZE?t.length-1:t.length}function Bq(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const i=t[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${i} but ragged tensor input.flatValues.shape[${s-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xP=30;function CT(t){return t<=xP?t:yR(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IT(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wp(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([t[o+1]/e[o],e[o]]);s=s.concat(t.slice(i+1))}return s}function Gp(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function Hp(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?s.push(e[i-1]*t[i]):s.push(t[i]/e[i-1]):s.push(t[i]);return s}function NT(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function kT(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qb=1.7580993408473768,Jb=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TT=.3275911,ET=.254829592,_T=-.284496736,AT=1.421413741,$T=-1.453152027,RT=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kl(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Uq(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Vq(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function jq(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function wP(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function Wq(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function Gq(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const i=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:n,imag:r}}function Hq(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _3="->",xTe=/->/g,QU=",",JU="...";function MT(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(xTe,"").length)/_3.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${_3}").`);const[r,s]=t.split(_3);ae(r.indexOf(JU)===-1,()=>`The ellipsis notation ("${JU}") is not supported yet.`);const i=r.split(QU),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<s.length;++h){const f=s[h];if(!i.some(m=>m.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<r.length;++h){const f=r[h];a.indexOf(f)===-1&&f!==QU&&a.push(f)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<i[h].length;++f)l[h].push(a.indexOf(i[h][f]))}const u=a.length,c=s.length,d=[];for(let h=c;h<u;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function DT(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function OT(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const i=n[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:ae(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function PT(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=wTe(e,a);for(const u of l)i.indexOf(u)===-1&&(r[o].push(u),i.push(u))}return{path:n,steps:r}}function FT(t){return t.every((e,n)=>e===n)}function wTe(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function LT(t,e,n=0){let r=[];if(typeof e=="number")ae(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);ae(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}ae(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function Kq(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function qq(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xq(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Zq(t,e){return`size ${t} must be non-negative, not ${e}`}function Qq(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Jq(t,e){const n=Ue(t),r=Ue(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function eX(t,e){const n=Ue(t),r=Ue(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DR(){return"segment ids must be >= 0"}function tX(){return"segment ids are not increasing"}function nX(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function rX(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(t,e){let n=!1,r;for(t<=xP?(r=t,n=!0):r=yR(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=yR(t,r+1);return r}function bP(t,e,n){const r=[],s=t.length;for(let i=0;i<s;i++)i!==e?r.push(t[i]):r.push(n);return r}function zT(t,e,n,r){const s=e.shape.length,i=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:a}}const bTe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:zT,computeOutShape:bP,segOpComputeOptimalWindowSize:sX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(t){try{return t.map(e=>Cl(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function iX(t){return t.map(e=>Cc(e))}const vTe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:ET,ERF_A2:_T,ERF_A3:AT,ERF_A4:$T,ERF_A5:RT,ERF_P:TT,PARALLELIZE_THRESHOLD:xP,get RowPartitionType(){return hl},SELU_SCALE:Jb,SELU_SCALEALPHA:Qb,applyActivation:pT,assertAndGetBroadcastShape:jt,assertAxesAreInnerMostDims:Wr,assertParamsConsistent:ST,assignToTypedArray:Wq,axesAreInnerMostDims:zO,calculateShapes:Pu,checkEinsumDimSizes:OT,checkPadOnDimRoundingMode:vi,combineLocations:OK,combineRaggedTensorToTensorShapes:Fq,complexWithEvenIndex:Vq,complexWithOddIndex:jq,computeConv2DInfo:Kn,computeConv3DInfo:Dl,computeDefaultPad:RO,computeDilation2DInfo:Mh,computeOptimalWindowSize:CT,computeOutAndReduceShapes:$r,computeOutShape:zi,computePool2DInfo:Ws,computePool3DInfo:Xo,convertConv2DDataFormat:Co,decodeEinsumEquation:MT,eitherStridesOrDilationsAreOne:as,expandShapeToKeepDim:Cr,exponent:Hq,exponents:Gq,fromStringArrayToUint8:iX,fromUint8ToStringArray:Tl,getAxesPermutation:zn,getBroadcastDims:gh,getComplexWithIndex:wP,getEinsumComputePath:PT,getEinsumPermutation:DT,getFusedBiasGradient:fT,getFusedDyActivation:hT,getImageCenter:IT,getInnerMostAxes:qn,getPermuted:Gp,getRaggedRank:zq,getReductionAxes:os,getReshaped:Wp,getReshapedPermuted:Hp,getRowPartitionTypesHelper:Lq,getSliceBeginCoords:NT,getSliceSize:kT,getSparseFillEmptyRowsIndicesDenseShapeMismatch:Yq,getSparseFillEmptyRowsNegativeIndexErrorMessage:Kq,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:qq,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:Qq,getSparseReshapeInputOutputMismatchErrorMessage:eX,getSparseReshapeInputOutputMultipleErrorMessage:Jq,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Xq,getSparseReshapeNegativeOutputDimErrorMessage:Zq,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:rX,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:DR,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:tX,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:nX,getUndoAxesPermutation:Du,isIdentityPermutation:FT,log:cbe,mergeRealAndImagArrays:kl,prepareAndValidate:xT,prepareSplitSize:LT,segment_util:bTe,shouldFuse:mT,slice_util:mTe,splitRealAndImagArrays:Uq,stridesOrDilationsArePositive:Ip,tupleValuesAreOne:ph,upcastType:ws,validateDefaultValueShape:Bq,validateInput:sP,validateUpdateShape:eq,warn:Uo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Gke();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe=We();STe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var oo;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(oo||(oo={}));var eV;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(eV||(eV={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CTe={};function oX(t){return CTe[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X(t,e,n,r,s){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,u=a<0?e.inputNames.length+a:a;if(i.type==="tensor")return Ns(e.inputNames[u],n,r,s);if(i.type==="tensors"){const h=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((m,g)=>{var x;return((x=h[g])===null||x===void 0?void 0:x.op)!=="NoOp"}).map(m=>Ns(m,n,r,s))}const c=Ns(e.inputNames[u],n,r,s),d=c.dataSync();return i.type==="number"?d[0]:_a(c.shape,d)}const o=e.attrParams[t];return o&&o.value}function Ns(t,e,n,r){const[s,i]=lo(t,n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[RI(s,a)]);return o!==void 0?e[RI(s,o)][i]:void 0}function tV(t,e,n){return e[RI(t,n.currentContextId)]}function uc(t,e){const[n,r,s]=lo(t,e);return[RI(n,e&&e.currentContextId),r,s]}function RI(t,e){return e?`${t}-${e}`:t}function lo(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const i=e.parseNodeNameCache.get(t);if(i!=null)return i}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const i=r[0],o=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);s=[i,a,o]}return n&&e.parseNodeNameCache.set(t,s),s}function DC(t,e,n){let r=X("pad",t,e,n);if(r==="explicit"){r=X("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)s[i][0]=r[i*2],s[i][1]=r[i*2+1];return s}return r}function cc(t){return t.kept?t:Ic(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],NTe=Object.freeze(Object.defineProperty({__proto__:null,json:ITe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kTe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],TTe=Object.freeze(Object.defineProperty({__proto__:null,json:kTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ETe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],_Te=Object.freeze(Object.defineProperty({__proto__:null,json:ETe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ATe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],$Te=Object.freeze(Object.defineProperty({__proto__:null,json:ATe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RTe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],MTe=Object.freeze(Object.defineProperty({__proto__:null,json:RTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DTe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],OTe=Object.freeze(Object.defineProperty({__proto__:null,json:DTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PTe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],FTe=Object.freeze(Object.defineProperty({__proto__:null,json:PTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LTe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],zTe=Object.freeze(Object.defineProperty({__proto__:null,json:LTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BTe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],UTe=Object.freeze(Object.defineProperty({__proto__:null,json:BTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VTe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],jTe=Object.freeze(Object.defineProperty({__proto__:null,json:VTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],GTe=Object.freeze(Object.defineProperty({__proto__:null,json:WTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HTe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],YTe=Object.freeze(Object.defineProperty({__proto__:null,json:HTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KTe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],qTe=Object.freeze(Object.defineProperty({__proto__:null,json:KTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XTe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],ZTe=Object.freeze(Object.defineProperty({__proto__:null,json:XTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QTe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],JTe=Object.freeze(Object.defineProperty({__proto__:null,json:QTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eEe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],tEe=Object.freeze(Object.defineProperty({__proto__:null,json:eEe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nEe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],rEe=Object.freeze(Object.defineProperty({__proto__:null,json:nEe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sEe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],iEe=Object.freeze(Object.defineProperty({__proto__:null,json:sEe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oEe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],aEe=Object.freeze(Object.defineProperty({__proto__:null,json:oEe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nV{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[NTe,TTe,_Te,$Te,MTe,OTe,FTe,zTe,UTe,jTe,GTe,YTe,qTe,ZTe,JTe,tEe,rEe,iEe,aEe],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],i=[],o=[],a=r.reduce((g,x)=>(g[x.name]=this.mapNode(x),x.op.startsWith("Placeholder")?s.push(g[x.name]):x.op==="Const"?i.push(g[x.name]):(x.input==null||x.input.length===0)&&o.push(g[x.name]),g),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(g=>{const x=a[g];x.inputNames.forEach((w,b)=>{const[S,,C]=uc(w),T=a[S];if(T.outputs!=null){const D=T.outputs.indexOf(C);if(D!==-1){const P=`${S}:${D}`;x.inputNames[b]=P}}x.inputs.push(T),T.children.push(x)})}),Object.keys(d).length===0?h.forEach(g=>{const x=a[g];x.children.length===0&&u.push(x)}):Object.keys(d).forEach(g=>{const[x]=uc(g),w=a[x];w!=null&&(w.signatureKey=d[g],u.push(w))}),Object.keys(c).length>0?Object.keys(c).forEach(g=>{const[x]=uc(g),w=a[x];w&&(w.signatureKey=c[g],l.push(w))}):l=s;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((g,x)=>(g[x.signature.name]=this.mapFunction(x),g),{}));const m={nodes:a,inputs:l,outputs:u,weights:i,placeholders:s,signature:n,functions:f};return o.length>0&&(m.initNodes=o),m}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=oX(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,i)=>(s[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,i)=>{const o=i.type;let a;switch(i.type){case"string":a=OR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=OR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=VR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=VR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=FR(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=FR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=UR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=UR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=PR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=PR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=WR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=WR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=BR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=BR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=jR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=jR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=LR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=LR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=zR(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=zR(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=rV(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=rV(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return s[i.name]={value:a,type:o},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let i={};n!=null&&(i=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&s.push(d[h.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=uc(d.name),f={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:vP(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,o.push(f),i[h]=f}),Object.keys(i).forEach(d=>{const h=i[d];h.inputNames.forEach((f,m)=>{const[g,,x]=uc(f),w=i[g];if(w.outputs!=null){const b=w.outputs.indexOf(x);if(b!==-1){const S=`${g}:${b}`;h.inputNames[m]=S}}h.inputs.push(w),w.children.push(h)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[h,f]=uc(u[d.name]),m=i[h];m!=null&&(m.defaultOutput=f,a.push(m))});const c=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:s,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function lEe(t){const e=We().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function aX(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):lEe(t);return e?n:n.toLowerCase()}function OR(t,e,n,r=!1){const s=t[e];return s!=null?aX(s.s,r):n}function PR(t,e,n){const r=t[e];return r?r.b:n}function FR(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function vP(t){switch(typeof t=="string"&&(t=oo[t]),t){case oo.DT_FLOAT:case oo.DT_HALF:return"float32";case oo.DT_INT32:case oo.DT_INT64:case oo.DT_INT8:case oo.DT_UINT8:return"int32";case oo.DT_BOOL:return"bool";case oo.DT_DOUBLE:return"float32";case oo.DT_STRING:return"string";case oo.DT_COMPLEX64:case oo.DT_COMPLEX128:return"complex64";default:return null}}function rV(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function LR(t,e,n){const r=t[e];return r&&r.type?vP(r.type):n}function zR(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>vP(s)):n}function lX(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function BR(t,e,n){const r=t[e];return r&&r.shape?lX(r.shape):n}function UR(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function VR(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(i=>aX(i,r)):n}function jR(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>lX(s)):n}function WR(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uEe{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,i)=>(s[i]=this.getAttr(i),s),{}))}getInput(e){return Ns(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Ns(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return FR(this.node.rawAttrs,e,n);if(r.s!=null)return OR(this.node.rawAttrs,e,n);if(r.b!=null)return PR(this.node.rawAttrs,e,n);if(r.shape!=null)return BR(this.node.rawAttrs,e,n);if(r.type!=null)return LR(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return UR(this.node.rawAttrs,e,n);if(r.list.s!=null)return VR(this.node.rawAttrs,e,n);if(r.list.shape!=null)return jR(this.node.rawAttrs,e,n);if(r.list.b!=null)return WR(this.node.rawAttrs,e,n);if(r.list.type!=null)return zR(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rs=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:KY,abs:Zr,acos:cK,acosh:dK,add:Qe,addN:Ive,all:$O,any:AI,argMax:Cp,argMin:hK,asin:fK,asinh:pK,atan:mK,atan2:gK,atanh:yK,avgPool:Kk,avgPool3d:xK,basicLSTMCell:Yve,batchNorm:Gb,batchNorm2d:wK,batchNorm3d:bK,batchNorm4d:vK,batchToSpaceND:qk,bincount:SK,bitwiseAnd:n2e,booleanMaskAsync:BIe,broadcastArgs:s2e,broadcastTo:Dg,buffer:Zt,cast:lt,ceil:CK,clipByValue:Vi,clone:Ic,complex:hh,concat:pr,concat1d:IK,concat2d:NK,concat3d:kK,concat4d:TK,conv1d:MO,conv2d:mh,conv2dTranspose:OO,conv3d:EK,conv3dTranspose:AK,cos:Xk,cosh:PO,cosineWindow:lP,cumprod:$I,cumsum:FO,denseBincount:AR,depthToSpace:$K,depthwiseConv2d:Hb,diag:T2e,dilation2d:RK,div:yt,divNoNan:MK,dot:DK,dropout:iq,einsum:mg,elu:Yb,enclosingPowerOfTwo:oq,ensureShape:F2e,equal:Il,erf:LO,euclideanNorm:FK,exp:wi,expandDims:Fr,expm1:LK,eye:BO,fft:cT,fill:yy,floor:qb,floorDiv:AO,fused:lNe,gather:Xb,gatherND:XIe,greater:Io,greaterEqual:Dh,ifft:a1,imag:Zk,image:gi,inTopKAsync:eNe,irfft:nP,isFinite:zK,isInf:BK,isNaN:UK,leakyRelu:Qk,less:s1,lessEqual:Vp,linalg:pq,linspace:uSe,localResponseNormalization:VK,log:Yo,log1p:Jk,logSigmoid:jK,logSoftmax:UO,logSumExp:eT,logicalAnd:ku,logicalNot:tT,logicalOr:VO,logicalXor:WK,losses:zke,lowerBound:NSe,matMul:dn,max:Aa,maxPool:nT,maxPool3d:GK,maxPoolWithArgmax:_Se,maximum:Pc,mean:wr,meshgrid:RSe,min:r1,minimum:yh,mirrorPad:WO,mod:HK,moments:rT,movingAverage:jIe,mul:_e,multiRNNCell:LSe,multinomial:BSe,neg:tr,norm:Kb,notEqual:qg,oneHot:GO,ones:mo,onesLike:Ko,op:Ae,outerProduct:GSe,pad:Nl,pad1d:KSe,pad2d:XSe,pad3d:QSe,pad4d:eCe,pool:YK,pow:Rc,prelu:iT,print:uK,prod:KK,raggedGather:lCe,raggedRange:cCe,raggedTensorToTensor:hCe,rand:pCe,randomGamma:PCe,randomNormal:YO,randomStandardNormal:zCe,randomUniform:jp,randomUniformInt:VCe,range:Xg,real:i1,reciprocal:qK,relu:Ou,relu6:KO,reshape:Me,reverse:Ma,reverse1d:qCe,reverse2d:ZCe,reverse3d:JCe,reverse4d:tIe,rfft:dT,round:qO,rsqrt:XO,scalar:Mt,scatterND:GIe,searchSorted:jO,selu:ZO,separableConv2d:QO,setdiff1dAsync:aIe,sigmoid:Go,sign:XK,signal:Lke,sin:JO,sinh:eP,slice:Kt,slice1d:aT,slice2d:tP,slice3d:lT,slice4d:o1,softmax:uT,softplus:xy,spaceToBatchND:sT,sparse:Bke,sparseToDense:KIe,spectral:Fke,split:go,sqrt:$s,square:Fn,squaredDifference:rP,squeeze:Nn,stack:xo,step:wy,stridedSlice:ZK,string:Uke,sub:xt,sum:Nt,tan:QK,tanh:Np,tensor:wl,tensor1d:Br,tensor2d:$a,tensor3d:JK,tensor4d:TIe,tensor5d:EIe,tensor6d:_Ie,tensorScatterUpdate:$Ie,tile:Ca,topk:tq,transpose:yn,truncatedNormal:iP,unique:nq,unsortedSegmentSum:oP,unstack:Da,upperBound:FIe,variable:rq,where:js,whereAsync:sq,zeros:_r,zerosLike:xn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cEe=(t,e,n,r=Rs)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(X("a",t,e,n),X("b",t,e,n))];case"AddN":return[r.addN(X("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(X("a",t,e,n),X("b",t,e,n))];case"Mul":return[r.mul(X("a",t,e,n),X("b",t,e,n))];case"RealDiv":case"Div":return[r.div(X("a",t,e,n),X("b",t,e,n))];case"DivNoNan":return[r.divNoNan(X("a",t,e,n),X("b",t,e,n))];case"FloorDiv":return[r.floorDiv(X("a",t,e,n),X("b",t,e,n))];case"Sub":return[r.sub(X("a",t,e,n),X("b",t,e,n))];case"Minimum":return[r.minimum(X("a",t,e,n),X("b",t,e,n))];case"Maximum":return[r.maximum(X("a",t,e,n),X("b",t,e,n))];case"Pow":return[r.pow(X("a",t,e,n),X("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(X("a",t,e,n),X("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dEe=(t,e,n,r=Rs)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(X("x",t,e,n))];case"Acos":return[r.acos(X("x",t,e,n))];case"Acosh":return[r.acosh(X("x",t,e,n))];case"Asin":return[r.asin(X("x",t,e,n))];case"Asinh":return[r.asinh(X("x",t,e,n))];case"Atan":return[r.atan(X("x",t,e,n))];case"Atan2":return[r.atan2(X("x",t,e,n),X("y",t,e,n))];case"Atanh":return[r.atanh(X("x",t,e,n))];case"Ceil":return[r.ceil(X("x",t,e,n))];case"Complex":return[r.complex(X("real",t,e,n),X("imag",t,e,n))];case"Cos":return[r.cos(X("x",t,e,n))];case"Cosh":return[r.cosh(X("x",t,e,n))];case"Elu":return[r.elu(X("x",t,e,n))];case"Erf":return[r.erf(X("x",t,e,n))];case"Exp":return[r.exp(X("x",t,e,n))];case"Expm1":return[r.expm1(X("x",t,e,n))];case"Floor":return[r.floor(X("x",t,e,n))];case"Log":return[r.log(X("x",t,e,n))];case"Log1p":return[r.log1p(X("x",t,e,n))];case"Imag":return[r.imag(X("x",t,e,n))];case"Neg":return[r.neg(X("x",t,e,n))];case"Reciprocal":return[r.reciprocal(X("x",t,e,n))];case"Real":return[r.real(X("x",t,e,n))];case"Relu":return[r.relu(X("x",t,e,n))];case"Round":return[r.round(X("x",t,e,n))];case"Selu":return[r.selu(X("x",t,e,n))];case"Sigmoid":return[r.sigmoid(X("x",t,e,n))];case"Sin":return[r.sin(X("x",t,e,n))];case"Sign":return[r.sign(X("x",t,e,n))];case"Sinh":return[r.sinh(X("x",t,e,n))];case"Softplus":return[r.softplus(X("x",t,e,n))];case"Sqrt":return[r.sqrt(X("x",t,e,n))];case"Square":return[r.square(X("x",t,e,n))];case"Tanh":return[r.tanh(X("x",t,e,n))];case"Tan":return[r.tan(X("x",t,e,n))];case"ClipByValue":return[r.clipByValue(X("x",t,e,n),X("clipValueMin",t,e,n),X("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(X("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Ns(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(X("x",t,e,n),X("alpha",t,e,n))];case"Prelu":return[r.prelu(X("x",t,e,n),X("alpha",t,e,n))];case"IsNan":return[r.isNaN(Ns(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Ns(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Ns(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xa(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){ae(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],i=e[r];ae(s<0||i<0||s===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function sV(t){return!(typeof t=="number"||t.some(e=>e<0))}function Ax(t,e,n){let r=GR(t,n);const s=!sV(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(i=>{r=GR(i.shape,r)}),!sV(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function GR(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],i=e[r];if(s>=0&&i>=0&&s!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hEe{constructor(e,n,r,s,i,o,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Mt(0),gs(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),xa(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,gs(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return wl([],[0].concat(this.elementShape));const r=this.readMany(e);return xa(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),xo(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return wl([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return xa(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),pr(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Da(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:n.size/r,o=[];Ve(()=>{n=Me(n,[1,r,i]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:s[l-1],0],d=[1,e[l],i];o[l]=Me(Kt(n,c,d),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tp{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);xa(n,i.shape,"TensorList shape mismatch: "),gs(i)}),this.idTensor=Mt(0),this.maxNumElements=s,gs(this.idTensor)}copy(){return new Tp([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);xa(e,this.elementShape,"TensorList shape mismatch: ");const s=Ax(this.elementShape,this.tensors,e);return Ve(()=>{const i=this.tensors.map(o=>Me(o,s));return xo(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Ax(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,xa(s.shape,e,"TensorList shape mismatch: "),Me(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(xa(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");gs(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Tp([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);xa(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=Ax(this.elementShape,this.tensors,n);return Me(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);xa(this.elementShape,n.shape,"TensorList shape mismatch: "),gs(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);xa(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=Ax(this.elementShape,this.tensors,r);return e.length===0?wl([],[0].concat(s)):Ve(()=>{const i=e.map(o=>Me(this.tensors[o],s));return xo(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);xa(this.elementShape,n,"TensorList shape mismatch: ");const r=Ax(this.elementShape,this.tensors,n);return this.size()===0?wl([],[0].concat(r)):Ve(()=>{const s=this.tensors.map(i=>Me(i,r));return pr(s,0)})}}function fEe(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);xa(s,e,"TensorList shape mismatch: ");const i=Da(t);return new Tp(i,e,r)}function pEe(t,e,n,r){return new Tp([],t,e,r)}function mEe(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const i=new Tp([],n,t.dtype,r),o=Da(t,0);return e.forEach((a,l)=>{i.setItem(a,o[l])}),i}function gEe(t,e,n){let r=0;const s=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=GR(i,n),a=r===0?0:t.size/r,l=Ve(()=>{const c=[];t=Me(t,[1,r,a]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:s[d-1],0],m=[1,e[d],a];c[d]=Me(Kt(t,f,m),o)}return t.dispose(),c}),u=new Tp([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yEe=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=X("thenBranch",t,e,n),s=X("elseBranch",t,e,n),i=X("cond",t,e,n),o=X("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=X("body",t,e,n),s=X("cond",t,e,n),i=X("args",t,e,n),o=await n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(c=>c.id);let l=await o[0].data();o.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let u=i;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(f=>f.id);c.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const h=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return u}case"LoopCond":{const r=X("pred",t,e,n);return[cc(r)]}case"Switch":{const r=X("pred",t,e,n);let s=X("data",t,e,n);return s.kept||(s=cc(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>Ns(s,e,n)!==void 0);if(r){const s=Ns(r,e,n);return[cc(s)]}return}case"Enter":{const r=X("frameName",t,e,n),s=X("tensor",t,e,n);return n.enterFrame(r),[cc(s)]}case"Exit":{const r=X("tensor",t,e,n);return n.exitFrame(),[cc(r)]}case"NextIteration":{const r=X("tensor",t,e,n);return n.nextIteration(),[cc(r)]}case"TensorArrayV3":{const r=X("size",t,e,n),s=X("dtype",t,e,n),i=X("elementShape",t,e,n),o=X("dynamicSize",t,e,n),a=X("clearAfterRead",t,e,n),l=X("identicalElementShapes",t,e,n),u=X("name",t,e,n),c=new hEe(u,s,r,i,l,o,a);return n.addTensorArray(c),[c.idTensor,Mt(1)]}case"TensorArrayWriteV3":{const r=X("tensorArrayId",t,e,n),s=X("index",t,e,n),i=X("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(s,i),[o.idTensor]}case"TensorArrayReadV3":{const r=X("tensorArrayId",t,e,n),s=X("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=X("tensorArrayId",t,e,n),s=X("indices",t,e,n),i=X("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,i)]}case"TensorArrayScatterV3":{const r=X("tensorArrayId",t,e,n),s=X("indices",t,e,n),i=X("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(s,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=X("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),i=X("dtype",t,e,n);return[s.concat(i)]}case"TensorArraySplitV3":{const r=X("tensorArrayId",t,e,n),s=X("tensor",t,e,n),i=X("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,s),[o.idTensor]}case"TensorArraySizeV3":{const r=X("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[Mt(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=X("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=X("tensorListId",t,e,n),s=X("index",t,e,n),i=X("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(s,i),[o.idTensor]}case"TensorListGetItem":{const r=X("tensorListId",t,e,n),s=X("index",t,e,n),i=X("elementShape",t,e,n),o=X("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=X("indices",t,e,n),s=X("tensor",t,e,n),i=X("elementShape",t,e,n),o=X("numElements",t,e,n),a=mEe(s,r,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=X("elementShape",t,e,n),s=X("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=X(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,l=pEe(r,s,o,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=X("tensorListId",t,e,n),s=X("indices",t,e,n),i=X("elementShape",t,e,n),o=X("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,o,i)]}case"TensorListStack":{const r=X("tensorListId",t,e,n),s=X("elementShape",t,e,n),i=X("elementDType",t,e,n),o=X("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,i,o)]}case"TensorListFromTensor":{const r=X("tensor",t,e,n),s=X("elementShape",t,e,n),i=X("elementDType",t,e,n),o=fEe(r,s,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=X("tensorListId",t,e,n),s=n.getTensorList(r.id),i=X("dtype",t,e,n),o=X("elementShape",t,e,n);return[s.concat(i,o)]}case"TensorListPushBack":{const r=X("tensorListId",t,e,n),s=X("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(s),[i.idTensor]}case"TensorListPopBack":{const r=X("tensorListId",t,e,n),s=X("elementShape",t,e,n),i=X("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,i)]}case"TensorListSplit":{const r=X("tensor",t,e,n),s=X("elementShape",t,e,n),i=X("lengths",t,e,n),o=gEe(r,i,s);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=X("tensorListId",t,e,n),s=n.getTensorList(r.id);return[Mt(s.size(),"int32")]}case"TensorListResize":{const r=X("tensorListId",t,e,n),s=X("size",t,e,n),o=n.getTensorList(r.id).resize(s);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(t,e,n){const[r,s]=X("fusedOps",t,e,n),i=r==="biasadd",o=!i,a=s==="prelu",l=r==="fusedbatchnorm",u=X("numArgs",t,e,n);if(i){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=X("strides",t,e,n),d=DC(t,e,n),h=X("dataFormat",t,e,n).toUpperCase(),f=X("dilations",t,e,n);let[m,g]=X("args",t,e,n);o&&(g=m,m=void 0);const x=X("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:h,dilations:f,biasArg:m,preluArg:g,activationFunc:s,leakyreluAlpha:x}}const xEe=(t,e,n,r=Rs)=>{switch(t.op){case"Conv1D":{const s=X("stride",t,e,n),i=X("pad",t,e,n),o=X("dataFormat",t,e,n).toUpperCase(),a=X("dilation",t,e,n);return[r.conv1d(X("x",t,e,n),X("filter",t,e,n),s,i,o,a)]}case"Conv2D":{const s=X("strides",t,e,n),i=DC(t,e,n),o=X("dataFormat",t,e,n).toUpperCase(),a=X("dilations",t,e,n);return[r.conv2d(X("x",t,e,n),X("filter",t,e,n),[s[1],s[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=iV(t,e,n);return[r.fused.conv2d({x:X("x",t,e,n),filter:X("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=iV(t,e,n);return[r.fused.depthwiseConv2d({x:X("x",t,e,n),filter:X("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=X("outputShape",t,e,n),i=X("strides",t,e,n),o=DC(t,e,n);return[r.conv2dTranspose(X("x",t,e,n),X("filter",t,e,n),s,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=X("strides",t,e,n),i=DC(t,e,n),o=X("dilations",t,e,n),a=X("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(X("input",t,e,n),X("filter",t,e,n),[s[1],s[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const s=X("strides",t,e,n),i=X("pad",t,e,n),o=X("dataFormat",t,e,n).toUpperCase(),a=X("dilations",t,e,n);return[r.conv3d(X("x",t,e,n),X("filter",t,e,n),[s[1],s[2],s[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const s=X("strides",t,e,n),i=X("pad",t,e,n),o=X("kernelSize",t,e,n);return[r.avgPool(X("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPool":{const s=X("strides",t,e,n),i=X("pad",t,e,n),o=X("kernelSize",t,e,n);return[r.maxPool(X("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPoolWithArgmax":{const s=X("strides",t,e,n),i=X("pad",t,e,n),o=X("kernelSize",t,e,n),a=X("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax(X("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i,a);return[l,u]}case"AvgPool3D":{const s=X("strides",t,e,n),i=X("pad",t,e,n),o=X("kernelSize",t,e,n);return[r.avgPool3d(X("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"MaxPool3D":{const s=X("strides",t,e,n),i=X("pad",t,e,n),o=X("kernelSize",t,e,n);return[r.maxPool3d(X("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"Dilation2D":{const s=X("strides",t,e,n),i=X("pad",t,e,n),o=X("dilations",t,e,n),a=s[1],l=s[2],u=o[1],c=o[2];return[r.dilation2d(X("x",t,e,n),X("filter",t,e,n),[a,l],i,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wEe=(t,e,n,r=Rs)=>{switch(t.op){case"Fill":{const s=X("shape",t,e,n),i=X("dtype",t,e,n),o=X("value",t,e,n);return[r.fill(s,o,i)]}case"LinSpace":{const s=X("start",t,e,n),i=X("stop",t,e,n),o=X("num",t,e,n);return[r.linspace(s,i,o)]}case"Multinomial":{const s=X("logits",t,e,n),i=X("numSamples",t,e,n),o=X("seed",t,e,n);return[r.multinomial(s,i,o)]}case"OneHot":{const s=X("indices",t,e,n),i=X("depth",t,e,n),o=X("onValue",t,e,n),a=X("offValue",t,e,n),l=X("dtype",t,e,n);return[r.oneHot(s,i,o,a,l)]}case"Ones":return[r.ones(X("shape",t,e,n),X("dtype",t,e,n))];case"OnesLike":return[r.onesLike(X("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(X("shape",t,e,n),X("dtype",t,e,n),X("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(X("shape",t,e,n),X("minval",t,e,n),X("maxval",t,e,n),X("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(X("shape",t,e,n),X("minval",t,e,n),X("maxval",t,e,n),X("seed",t,e,n))];case"Range":{const s=X("start",t,e,n),i=X("stop",t,e,n),o=X("step",t,e,n);return[r.range(s,i,o,X("dtype",t,e,n))]}case"TruncatedNormal":{const s=X("shape",t,e,n),i=X("mean",t,e,n),o=X("stdDev",t,e,n),a=X("seed",t,e,n);return[r.truncatedNormal(s,i,o,X("dtype",t,e,n),a)]}case"Zeros":return[r.zeros(X("shape",t,e,n),X("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(X("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3(t,e,n){const r=X("boxes",t,e,n),s=X("scores",t,e,n),i=X("maxOutputSize",t,e,n),o=X("iouThreshold",t,e,n),a=X("scoreThreshold",t,e,n),l=X("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const bEe=async(t,e,n,r,s=Rs)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=A3(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(i,o,a,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=A3(t,e,n),c=X("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(i,o,a,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=A3(t,e,n);return[await s.image.nonMaxSuppressionAsync(i,o,a,l,u)]}case"Where":{const i=s.cast(X("condition",t,e,n),"bool"),o=[await s.whereAsync(i)];return i.dispose(),o}case"ListDiff":return s.setdiff1dAsync(X("x",t,e,n),X("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vEe=(t,e,n,r=Rs)=>{switch(t.op){case"LowerBound":{const s=X("sortedSequence",t,e,n),i=X("values",t,e,n);return[r.lowerBound(s,i)]}case"TopKV2":{const s=X("x",t,e,n),i=X("k",t,e,n),o=X("sorted",t,e,n),a=r.topk(s,i,o);return[a.values,a.indices]}case"UpperBound":{const s=X("sortedSequence",t,e,n),i=X("values",t,e,n);return[r.upperBound(s,i)]}case"Unique":{const s=X("x",t,e,n),i=r.unique(s);return[i.values,i.indices]}case"UniqueV2":{const s=X("x",t,e,n),i=X("axis",t,e,n),o=r.unique(s,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SEe=(t,e,n,r=Rs)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=X("default",t,e,n);return[Ns(t.name,e,n)||s];case"Placeholder":return[Ns(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=X("x",t,e,n);return[cc(c)]}case"IdentityN":return X("x",t,e,n).map(c=>cc(c));case"Snapshot":const i=X("x",t,e,n);return[cc(i)];case"Shape":return[r.tensor1d(X("x",t,e,n).shape,"int32")];case"ShapeN":return X("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(X("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(X("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=X("x",t,e,n),a=X("data",t,e,n),l=X("message",t,e,n),u=X("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CEe{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Mt(0),this.tensorMap=new Map,gs(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Mt(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),Ve(()=>{const s=Da(n),i=r.length,o=s.length;ae(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const l=r[a],u=s[a];gs(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return Ve(()=>{const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=this.findWithDefault(o,n);s.push(a)}return xo(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IEe=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const i=X("keyDType",t,e,n),o=X("valueDType",t,e,n),a=new CEe(i,o);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=X("tableHandle",t,e,n,r),i=X("keys",t,e,n),o=X("values",t,e,n);return[await r.getHashTableById(s.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const s=X("tableHandle",t,e,n,r),i=X("keys",t,e,n),o=X("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=X("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NEe=(t,e,n,r=Rs)=>{switch(t.op){case"ResizeBilinear":{const s=X("images",t,e,n),i=X("size",t,e,n),o=X("alignCorners",t,e,n),a=X("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const s=X("images",t,e,n),i=X("size",t,e,n),o=X("alignCorners",t,e,n),a=X("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[i[0],i[1]],o,a)]}case"CropAndResize":{const s=X("image",t,e,n),i=X("boxes",t,e,n),o=X("boxInd",t,e,n),a=X("cropSize",t,e,n),l=X("method",t,e,n),u=X("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,i,o,a,l,u)]}case"ImageProjectiveTransformV3":{const s=X("images",t,e,n),i=X("transforms",t,e,n),o=X("outputShape",t,e,n),a=X("fillValue",t,e,n),l=X("interpolation",t,e,n),u=X("fillMode",t,e,n);return[r.image.transform(s,i,l.toLowerCase(),u.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kEe=(t,e,n,r=Rs)=>{switch(t.op){case"Equal":return[r.equal(X("a",t,e,n),X("b",t,e,n))];case"NotEqual":return[r.notEqual(X("a",t,e,n),X("b",t,e,n))];case"Greater":return[r.greater(X("a",t,e,n),X("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(X("a",t,e,n),X("b",t,e,n))];case"Less":return[r.less(X("a",t,e,n),X("b",t,e,n))];case"LessEqual":return[r.lessEqual(X("a",t,e,n),X("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(X("a",t,e,n),X("b",t,e,n))];case"LogicalNot":return[r.logicalNot(X("a",t,e,n))];case"LogicalOr":return[r.logicalOr(X("a",t,e,n),X("b",t,e,n))];case"Select":case"SelectV2":return[r.where(X("condition",t,e,n),X("a",t,e,n),X("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(X("a",t,e,n),X("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TEe=(t,e,n,r=Rs)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(X("a",t,e,n),X("b",t,e,n),X("transposeA",t,e,n),X("transposeB",t,e,n))];case"Einsum":return[r.einsum(X("equation",t,e,n),...X("tensors",t,e,n))];case"Transpose":return[r.transpose(X("x",t,e,n),X("perm",t,e,n))];case"_FusedMatMul":const[s,i]=X("fusedOps",t,e,n),o=s==="biasadd",a=i==="prelu",l=X("numArgs",t,e,n),u=X("leakyreluAlpha",t,e,n);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=X("args",t,e,n);return[r.fused.matMul({a:X("a",t,e,n),b:X("b",t,e,n),transposeA:X("transposeA",t,e,n),transposeB:X("transposeB",t,e,n),bias:c,activation:i,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(X("a",t,e,n),X("numLower",t,e,n),X("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EEe=(t,e,n,r=Rs)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(X("x",t,e,n),X("axis",t,e,n),X("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(X("x",t,e,n),X("mean",t,e,n),X("variance",t,e,n),X("offset",t,e,n),X("scale",t,e,n),X("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(X("x",t,e,n),X("mean",t,e,n),X("variance",t,e,n),X("offset",t,e,n),X("scale",t,e,n),X("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(X("x",t,e,n),X("radius",t,e,n),X("bias",t,e,n),X("alpha",t,e,n),X("beta",t,e,n))];case"Softmax":return[r.softmax(X("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(X("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ee=(t,e,n,r=Rs)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:i}=r.raggedGather(X("paramsNestedSplits",t,e,n),X("paramsDenseValues",t,e,n),X("indices",t,e,n),X("outputRaggedRank",t,e,n));return s.concat(i)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:i}=r.raggedRange(X("starts",t,e,n),X("limits",t,e,n),X("splits",t,e,n));return[s,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(X("shape",t,e,n),X("values",t,e,n),X("defaultValue",t,e,n),X("rowPartitionTensors",t,e,n),X("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AEe=(t,e,n,r=Rs)=>{switch(t.op){case"Max":{const a=X("axis",t,e,n),l=X("keepDims",t,e,n);return[r.max(X("x",t,e,n),a,l)]}case"Mean":{const a=X("axis",t,e,n),l=X("keepDims",t,e,n);return[r.mean(X("x",t,e,n),a,l)]}case"Min":{const a=X("axis",t,e,n),l=X("keepDims",t,e,n);return[r.min(X("x",t,e,n),a,l)]}case"Sum":{const a=X("axis",t,e,n),l=X("keepDims",t,e,n);return[r.sum(X("x",t,e,n),a,l)]}case"All":{const a=X("axis",t,e,n),l=X("keepDims",t,e,n);return[r.all(X("x",t,e,n),a,l)]}case"Any":{const a=X("axis",t,e,n),l=X("keepDims",t,e,n);return[r.any(X("x",t,e,n),a,l)]}case"ArgMax":{const a=X("axis",t,e,n);return[r.argMax(X("x",t,e,n),a)]}case"ArgMin":{const a=X("axis",t,e,n);return[r.argMin(X("x",t,e,n),a)]}case"Prod":{const a=X("axis",t,e,n),l=X("keepDims",t,e,n);return[r.prod(X("x",t,e,n),a,l)]}case"Cumprod":{const a=X("axis",t,e,n),l=X("exclusive",t,e,n),u=X("reverse",t,e,n);return[r.cumprod(X("x",t,e,n),a,l,u)]}case"Cumsum":{const a=X("axis",t,e,n),l=X("exclusive",t,e,n),u=X("reverse",t,e,n);return[r.cumsum(X("x",t,e,n),a,l,u)]}case"Bincount":const s=X("x",t,e,n),i=X("weights",t,e,n),o=X("size",t,e,n);return[r.bincount(s,i,o)];case"DenseBincount":{const a=X("x",t,e,n),l=X("weights",t,e,n),u=X("size",t,e,n),c=X("binaryOutput",t,e,n);return[r.denseBincount(a,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ee=(t,e,n,r=Rs)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=X("n",t,e,n),i=X("axis",t,e,n);let o=X("tensors",t,e,n);return o=o.slice(0,s),[r.concat(o,i)]}case"Gather":{const s=X("x",t,e,n),i=X("indices",t,e,n);return[r.gather(s,r.cast(i,"int32"),0)]}case"GatherV2":{const s=X("axis",t,e,n),i=X("batchDims",t,e,n),o=X("x",t,e,n),a=X("indices",t,e,n);return[r.gather(o,r.cast(a,"int32"),s,i)]}case"Reverse":{const s=X("dims",t,e,n),i=[];for(let a=0;a<s.length;a++)s[a]&&i.push(a);const o=X("x",t,e,n);return[r.reverse(o,i)]}case"ReverseV2":{const s=X("axis",t,e,n),i=X("x",t,e,n);return[r.reverse(i,s)]}case"Slice":{const s=X("begin",t,e,n),i=X("size",t,e,n);return[r.slice(X("x",t,e,n),s,i)]}case"StridedSlice":{const s=X("begin",t,e,n),i=X("end",t,e,n),o=X("strides",t,e,n),a=X("beginMask",t,e,n),l=X("endMask",t,e,n),u=X("ellipsisMask",t,e,n),c=X("newAxisMask",t,e,n),d=X("shrinkAxisMask",t,e,n),h=X("x",t,e,n);return[r.stridedSlice(h,s,i,o,a,l,u,c,d)]}case"Pack":return Ve(()=>{const s=X("axis",t,e,n),i=X("tensors",t,e,n),o=i[0].shape,a=r.squeeze(i[0]).shape,l=i.map(u=>{const c=nn(u.shape,o);if(!c&&!nn(r.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,o)});return[r.stack(l,s)]});case"Unpack":{const s=X("axis",t,e,n),i=X("tensor",t,e,n);return r.unstack(i,s)}case"Tile":{const s=X("reps",t,e,n);return[r.tile(X("x",t,e,n),s)]}case"Split":case"SplitV":{const s=X("axis",t,e,n),i=X("numOrSizeSplits",t,e,n),o=X("x",t,e,n);return r.split(o,i,s)}case"ScatterNd":{const s=X("indices",t,e,n),i=X("values",t,e,n),o=X("shape",t,e,n);return[r.scatterND(s,i,o)]}case"GatherNd":{const s=X("x",t,e,n),i=X("indices",t,e,n);return[r.gatherND(s,i)]}case"SparseToDense":{const s=X("sparseIndices",t,e,n),i=X("outputShape",t,e,n),o=X("sparseValues",t,e,n),a=X("defaultValue",t,e,n);return[r.sparseToDense(s,o,i,o.dtype===a.dtype?a:r.cast(a,o.dtype))]}case"TensorScatterUpdate":{const s=X("indices",t,e,n),i=X("values",t,e,n),o=X("tensor",t,e,n);return[r.tensorScatterUpdate(o,s,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const REe=(t,e,n,r=Rs)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows(X("indices",t,e,n),X("values",t,e,n),X("denseShape",t,e,n),X("defaultValue",t,e,n));return[s,i,o,a]}case"SparseReshape":{const{outputIndices:s,outputShape:i}=r.sparse.sparseReshape(X("inputIndices",t,e,n),X("inputShape",t,e,n),X("newShape",t,e,n));return[s,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(X("data",t,e,n),X("indices",t,e,n),X("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(X("data",t,e,n),X("indices",t,e,n),X("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MEe=(t,e,n,r=Rs)=>{switch(t.op){case"FFT":return[r.fft(X("x",t,e,n))];case"IFFT":return[r.ifft(X("x",t,e,n))];case"RFFT":return[r.rfft(X("x",t,e,n))];case"IRFFT":return[r.irfft(X("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DEe=(t,e,n,r=Rs)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(X("input",t,e,n),X("pattern",t,e,n),X("rewrite",t,e,n),X("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:i}=r.string.stringNGrams(X("data",t,e,n),X("dataSplits",t,e,n),X("separator",t,e,n),X("nGramWidths",t,e,n),X("leftPad",t,e,n),X("rightPad",t,e,n),X("padWidth",t,e,n),X("preserveShortSequences",t,e,n));return[s,i]}case"StringSplit":{const{indices:s,values:i,shape:o}=r.string.stringSplit(X("input",t,e,n),X("delimiter",t,e,n),X("skipEmpty",t,e,n));return[s,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(X("input",t,e,n),X("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OEe=(t,e,n,r=Rs)=>{switch(t.op){case"Cast":return[r.cast(X("x",t,e,n),X("dtype",t,e,n))];case"ExpandDims":{const s=X("axis",t,e,n);return[r.expandDims(X("x",t,e,n),s)]}case"Squeeze":{const s=X("axis",t,e,n);return[r.squeeze(X("x",t,e,n),s)]}case"Reshape":return[r.reshape(X("x",t,e,n),X("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(X("x",t,e,n),X("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(X("x",t,e,n),X("padding",t,e,n),X("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(X("x",t,e,n),X("padding",t,e,n),X("constantValue",t,e,n))];case"SpaceToBatchND":{const s=X("blockShape",t,e,n),i=X("paddings",t,e,n);return[r.spaceToBatchND(X("x",t,e,n),s,i)]}case"BatchToSpaceND":{const s=X("blockShape",t,e,n),i=X("crops",t,e,n);return[r.batchToSpaceND(X("x",t,e,n),s,i)]}case"DepthToSpace":{const s=X("blockSize",t,e,n),i=X("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(X("x",t,e,n),s,i)]}case"BroadcastTo":return[r.broadcastTo(X("x",t,e,n),X("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(X("s0",t,e,n),X("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(t,e,n,r,s=Ve){const i=((o,a,l)=>{switch(o.category){case"arithmetic":return s(()=>cEe(o,a,l));case"basic_math":return s(()=>dEe(o,a,l));case"control":return yEe(o,a,l);case"convolution":return s(()=>xEe(o,a,l));case"creation":return s(()=>wEe(o,a,l));case"dynamic":return bEe(o,a,l);case"evaluation":return s(()=>vEe(o,a,l));case"image":return s(()=>NEe(o,a,l));case"graph":return s(()=>SEe(o,a,l));case"logical":return s(()=>kEe(o,a,l));case"matrices":return s(()=>TEe(o,a,l));case"normalization":return s(()=>EEe(o,a,l));case"ragged":return s(()=>_Ee(o,a,l));case"reduction":return s(()=>AEe(o,a,l));case"slice_join":return s(()=>$Ee(o,a,l));case"sparse":return s(()=>REe(o,a,l));case"spectral":return s(()=>MEe(o,a,l));case"string":return s(()=>DEe(o,a,l));case"transformation":return s(()=>OEe(o,a,l));case"hash_table":return IEe(o,a,l,r);case"custom":const u=oX(o.op);if(u&&u.customExecutor)return u.customExecutor(new uEe(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return xp(i)?i.then(o=>[].concat(o)):[].concat(i)}class aV{constructor(e={},n={},r={},s={},i){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(t,e,n,r){const s=new Set,i=[];let o=null,a=null;const l=new Set,u=new Set(Object.keys(t).map(h=>lo(h)[0]));r=r||[];const c=new Set(r.map(h=>lo(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((zf(h)||jEe(h)||WEe(h))&&o==null&&(o=h,a=o.children.map(f=>f.name).filter(f=>s.has(f))),s.add(h.name),n[h.name]==null&&!u.has(h.name)&&!c.has(h.name)){if(h.inputs.length===0){i.push(h.name);continue}h.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:i,dynamicNode:o,syncInputs:a}}function PEe(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(x=>lo(x)[0]).map(x=>t.nodes[x]),i=t.initNodes||[],o=x=>n.has(typeof x=="string"?x:x.name);function a(x){return[...new Map(x.map(w=>[w.name,w])).values()]}const l=a([...s,...t.weights,...i]).filter(o),u=a([...l,...Object.values(t.nodes)]).filter(o),c=new Map(u.map(x=>[x.name,x])),d={};for(const x of u){d[x.name]=d[x.name]||0;for(const w of x.children)o(w)||(d[w.name]=Number.POSITIVE_INFINITY),d[w.name]=(d[w.name]||0)+1}const h=Object.entries(d).filter(([,x])=>x===0).map(([x])=>x),f=[...h];for(;h.length>0;){const x=h.pop(),w=c.get(x);for(const b of w.children.filter(o))--d[b.name]===0&&(f.push(b.name),h.push(b.name))}const m=f.map(x=>c.get(x)),g=FEe(m,l);return LEe(g,l),g}function FEe(t,e){const n=new Map(t.map(o=>[o.name,o])),r=e.map(o=>o.name),s=new Set(r);for(;r.length>0;){const o=r.pop(),a=n.get(o);for(const l of a.children)!n.has(l.name)||s.has(l.name)||(s.add(l.name),r.push(l.name))}return t.filter(o=>s.has(o.name))}class tS extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function LEe(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),r=new Set(e.map(a=>a.name)),s=a=>r.has(typeof a=="string"?a:a.name),i=new Set(t.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(o)){if(!n.has(l.name))throw new tS(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new tS(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!s(a))for(const l of a.inputs){if(!n.has(l.name))throw new tS(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new tS(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function zEe(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,r=t.map((a,l)=>zf(a)?n:l),s=a=>{const l=r[e.get(a.name)];return l??-1},i=t.map((a,l)=>a.children.map(s).reduce((u,c)=>Math.max(u,c),r[l])),o=new Map;for(let a=0;a<t.length;++a){const l=i[a];if(l===n)continue;const u=t[a],c=t[l];o.has(c.name)||o.set(c.name,[]),o.get(c.name).push(u)}return o}const BEe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),UEe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),VEe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function zf(t){return BEe.has(t.op)}function jEe(t){return UEe.has(t.op)}function WEe(t){return VEe.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MI{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new MI(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(i=>i.name).sort(),s=n.map(i=>i.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=lV(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:i,syncInputs:o}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(s.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${s}]`)}const a=PEe(this.graph,r),l=zEe(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return gs(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(h=>this.graph.nodes[lo(h)[0]]),i=n.map(h=>lo(h)[0]),o=new Set(i);let a=i.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(s,a);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,a),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=We().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const c={},d={};return Ve(()=>{const h=new aV(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(w=>{const[b,S]=lo(w,h),C=[];C[S]=e[w],f[b]=C,this.keepIntermediateTensors&&(this.clonedTensorsMap[b]=this.cloneTensorList(C))});const m=this.getFrozenTensorIds(f),{orderedNodes:g,nodeLiveUntilMap:x}=u;for(const w of g){if(f[w.name])continue;const b=oV(w,f,h,this._resourceManager);if(xp(b))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);f[w.name]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(b)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,f,h,m,o,x.get(w.name))}return this.parent==null&&h.dispose(m),n.map(w=>Ns(w,f,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,i,o,a){if(!(zf(n)||o.has(e))){for(const l of r[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(zf(l))continue;const u=tV(l.name,r,s);if(u!=null)for(const c of u){if(!c||c.kept||i.has(c.id))continue;const d=a[c.id];d===1?(c.dispose(),delete a[c.id]):d!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,i,o){function a(l){return zf(l)||i.has(l.name)}if(!(zf(e)||o==null))for(const l of o){if(a(l))continue;const u=tV(l.name,n,r);for(const c of u)!c||c.kept||s.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},i={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=We().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const o=new aV(this.weightMap,s,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,n,r),l=n.map(h=>Ns(h,a,o)),u=l.map(h=>h.id),c=Object.keys(e).map(h=>e[h].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(f=>{f&&!f.isDisposed&&!d.has(f.id)&&f.dispose()})}),this.parent==null&&o.dispose(d),l}async executeFunctionAsync(e,n,r){const s=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const i=Object.keys(e),o=i.map(C=>this.graph.nodes[lo(C)[0]]),a=r.map(C=>lo(C)[0]),l=new Set(a);let u=a.map(C=>this.graph.nodes[C]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:h,syncInputs:f}=lV(e,u,this.weightMap,this._initNodes),m=[...o,...this.graph.weights,...this._initNodes||[]].map(C=>({node:C,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(C=>{const[T,D]=lo(C),P=[];P[D]=e[C],g[T]=P});const x={},w=this.getFrozenTensorIds(g),b={};for(;m.length>0;){const C=this.processStack(o,m,n,g,b,w,l,x,c);await Promise.all(C)}h==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const S=u.filter(C=>!zf(C)&&!Ns(C.name,g,n)).map(C=>C.name);if(S.length>0){let C="";throw h!=null&&(C=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${S}] from the provided inputs [${i}]. Consider providing the following inputs: [${d}]. ${C}`)}return g}processStack(e,n,r,s,i,o,a,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&X("isConstant",d.node,s,r)&&([h]=uc(d.node.name,r)),s[d.node.name]==null){const f=oV(d.node,s,r,this._resourceManager);h||([h]=uc(d.node.name,r));const m=r.currentContext;xp(f)?c.push(f.then(g=>(s[h]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(g)),r.currentContext=m,this.checkTensorForDisposal(h,d.node,s,r,o,a,l),this.processChildNodes(d.node,n,r,s,i,u),g))):(s[h]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(f)),this.checkTensorForDisposal(h,d.node,s,r,o,a,l),this.processChildNodes(d.node,n,r,s,i,u))}else this.processChildNodes(d.node,n,r,s,i,u)}return c}processChildNodes(e,n,r,s,i,o){e.children.forEach(a=>{const[l]=uc(a.name,r);i[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!Ns(u,s,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(u=>!!Ns(u,s,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=lo(n),i=this.graph.nodes[s];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===r.shape.length&&r.shape.every((l,u)=>o[u]===-1||o[u]===l);ae(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&ae(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const i in e){const o=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[i];o!=null?s[o.name]=e[i]:s[i]=e[i]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=lo(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const i=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return i!=null?i.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=lo(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class GEe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HEe="?tfjs-format=file",YEe="model.json";class KEe{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=kq){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new GEe}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return xp(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await ZY(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(s=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new MI(nV.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=nV.Instance.transformGraph(e.modelInitializer);this.initializer=new MI(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof _n?[e]:e,r={};return n.forEach((s,i)=>r[this.structuredOutputKeys[i]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof _n)&&!Array.isArray(e)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((i,o)=>{var a,l,u;const c=(u=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||u===void 0?void 0:u.resourceId;return c!=null?i[o]=this.resourceIdToCapturedInput[c]:i[o]=e[s++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const i=r[s],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Bt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Zg(t,e={},n=kq){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=qEe(t));const r=new KEe(t,e,n);return await r.load(),r}function qEe(t){return t.endsWith("/")||(t=t+"/"),`${t}${YEe}${HEe}`}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zo=We();Zo.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",()=>15);Zo.registerFlag("WEBGPU_CPU_FORWARD",()=>!0);Zo.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",()=>-1);Zo.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",()=>!0);Zo.registerFlag("WEBGPU_USE_LOW_POWER_GPU",()=>!1);Zo.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e3);Zo.registerFlag("WEBGPU_USE_PROFILE_TOOL",()=>!1);Zo.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",()=>!0);Zo.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",()=>!1);Zo.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",()=>-1);Zo.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",()=>!1);Zo.registerFlag("WEBGPU_PRINT_SHADER",()=>"");Zo.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XEe{constructor(e){e&&(this.vendor=e.vendor,this.architecture=e.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}getIntelGPUGeneration(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}isIntel(){return this.vendor==="intel"}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZEe{constructor(e){this.device=e,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireBuffer(e,n,r=!1,s=!0){let i;const o=uV(e,n);return s?(this.freeBuffers.has(o)||this.freeBuffers.set(o,[]),this.freeBuffers.get(o).length>0?(i=this.freeBuffers.get(o).pop(),this.numFreeBuffers--):(i=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e)):(i=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e),this.usedBuffers.has(o)||this.usedBuffers.set(o,[]),this.usedBuffers.get(o).push(i),this.numUsedBuffers++,this.numBytesUsed+=e,i}releaseBuffer(e,n=!0){if(this.freeBuffers.size===0)return;const r=e.size,s=e.usage,i=uV(r,s),o=this.usedBuffers.get(i),a=o.indexOf(e);if(a<0)throw new Error("Cannot find the buffer in buffer manager");o[a]=o[o.length-1],o.pop(),this.numUsedBuffers--,this.numBytesUsed-=r,n?(this.freeBuffers.get(i).push(e),this.numFreeBuffers++):(e.destroy(),this.numBytesAllocated-=r)}getNumUsedBuffers(){return this.numUsedBuffers}getNumFreeBuffers(){return this.numFreeBuffers}dispose(){this.freeBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function uV(t,e){return`${t}_${e}`}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let QEe=class{constructor(e){this.device=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireTexture(e,n,r,s){const i=dV(r),o=e*n*i,a=cV(e,n,r,s);if(this.freeTextures.has(a)||this.freeTextures.set(a,[]),this.usedTextures.has(a)||this.usedTextures.set(a,[]),this.numBytesUsed+=o,this.numUsedTextures++,this.freeTextures.get(a).length>0){this.numFreeTextures--;const u=this.freeTextures.get(a).shift();return this.usedTextures.get(a).push(u),u}this.numBytesAllocated+=o;const l=this.device.createTexture({size:[e,n],format:r,usage:s});return this.usedTextures.get(a).push(l),l}releaseTexture(e){if(this.freeTextures.size===0)return;const n=e.width,r=e.height,s=e.format,i=e.usage,o=cV(n,r,s,i);this.freeTextures.has(o)||this.freeTextures.set(o,[]),this.freeTextures.get(o).push(e),this.numFreeTextures++,this.numUsedTextures--;const a=this.usedTextures.get(o),l=a.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(l,1);const u=dV(s),c=n*r*u;this.numBytesUsed-=c}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){this.freeTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}};function cV(t,e,n,r){return`${t}_${e}_${n}_${r}`}function dV(t){if(t==="rgba8unorm")return 16;throw new Error(`${t} is not supported!`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JEe(t,e){if(Math.max(...t)>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");const n=t.length,r="xyzwuv",s=t.map(o=>`${e}.${r[o]}`),i=new Array(n-1);i[n-2]=s[n-1];for(let o=n-3;o>=0;--o)i[o]=`(${i[o+1]} * ${s[o+1]})`;return i}const Ph=(t,e,n)=>n==="int32"?`atomicAdd(${t}, bitcast<i32>(${e}));`:`
          {
            var oldValue = 0;
            loop {
              let newValueF32 = bitcast<f32>(oldValue) + (${e});
              let newValue = bitcast<i32>(newValueF32);
              let res = atomicCompareExchangeWeak(${t}, oldValue, newValue);
              if res.exchanged {
                break;
              }
              oldValue = res.old_value;
            }
          }`;/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Qg;(function(t){t[t.FROM_PIXELS=0]="FROM_PIXELS",t[t.DRAW=1]="DRAW"})(Qg||(Qg={}));const e_e=(t,e,n,r,s)=>{const i={dtype:r.dtype,shape:r.shape},o=n_e(n,i,e),a=t.createShaderModule({code:o,label:e.constructor.name});let l=We().get("WEBGPU_PRINT_SHADER");if(l!==""){l=l.toLowerCase();const u=l.split(",");(l==="all"||u.some(c=>e.shaderKey.toLowerCase().includes(c)))&&(console.group(e.shaderKey),console.debug(o),console.groupEnd())}return s?t.createComputePipelineAsync({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"}):t.createComputePipeline({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"})},rn=(t,e="f32")=>{switch(t){case 1:return`${e}`;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${t}-component ${e} is not supported.`)}};function Ar(t){if(t<=1)return"i32";if(t===2)return"vec2<i32>";if(t===3)return"vec3<i32>";if(t===4)return"vec4<i32>";if(t===5)return"vec5";if(t===6)return"vec6";throw Error(`GPU for rank ${t} is not yet supported`)}function Nc(t){if(t===0)return"x";if(t===1)return"y";if(t===2)return"z";if(t===3)return"w";if(t===4)return"u";if(t===5)return"v";throw Error(`Index ${t} is not yet supported`)}function ut(...t){let e;switch(t.length){case 0:e=`
        fn main()
      `;break;case 1:e=`
        fn main(${t[0]} : i32)
      `;break;default:throw Error("Unreachable")}return e}function hV(t,e){let n;return n=`
     ${t_e(e)}
      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,
                @builtin(global_invocation_id) GlobalId : vec3<u32>,
                @builtin(local_invocation_index) LocalIndex: u32,
                @builtin(workgroup_id) WorkgroupId : vec3<u32>,
                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {
        localId = LocalId;
        localIndex = LocalIndex;
        globalId = GlobalId;
        numWorkgroups = NumWorkgroups;
        workgroupId = WorkgroupId;
        ${t?"main(getGlobalIndex());":"main();"};
      }
    `,n}function t_e(t){return`
  @compute @workgroup_size(${t.workgroupSize[0]}, ${t.workgroupSize[1]}, ${t.workgroupSize[2]})
`}function n_e(t,e,n){const r=[],s=n.workgroupSize[0]*n.workgroupSize[1]*n.workgroupSize[2];if(n.outputComponent=n.outputComponent?n.outputComponent:1,r.push(`

      var<private> localId: vec3<u32>;
      var<private> localIndex: u32;
      var<private> globalId: vec3<u32>;
      var<private> numWorkgroups: vec3<u32>;
      var<private> workgroupId: vec3<u32>;

      // Only used when the y/z dimension of workgroup size is 1.
      fn getGlobalIndex() -> i32 {
        ${uX(n)?"  return i32(globalId.x);":`  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +
                workgroupId.y * numWorkgroups.x + workgroupId.x) * ${s}u +
                localIndex);
        `}
      }
    `),n.pixelsOpType!=null){const m=n.pixelsOpType===Qg.FROM_PIXELS?`@group(0) @binding(0) var<storage, read_write> result: array<${Bf(e.dtype,n.outputComponent)}>;`:`@group(0) @binding(1) var<storage, read> inBuf : array<${Bf(t[0].dtype,n.outputComponent)}>;`,g=e.shape.length===3?"vec2<i32>":"i32";r.push(`
        struct Uniform {
          outShapeStrides : ${g},
          size            : i32,
          numChannels     : i32,
          alpha           : f32,
        };

        ${m}
        @group(0) @binding(2) var<uniform> uniforms: Uniform;
      `);const x=pV(n);return[fV,r.join(`
`),OC(e.shape),n.getUserCode(),hV(x,n)].join(`
`)}let i,o,a="struct Uniforms { NAN : f32, INFINITY : f32, ";n.variableNames.forEach((m,g)=>{const x=Ar(t[g].shape.length);a+=`${m.charAt(0).toLowerCase()+m.slice(1)}Shape : ${x}, `,i=t[g].shape.length-1,o=Ar(i),a+=`${m.charAt(0).toLowerCase()+m.slice(1)}ShapeStrides: ${o}, `});const l=Ar(e.shape.length);a+=`outShape : ${l}, `,i=e.shape.length-1,o=Ar(i),a+=`
         outShapeStrides: ${o}, `,n.size&&(a+="size : i32, "),n.uniforms&&(a+=n.uniforms),a+="};",a=d_e(a),r.push(a),n.atomic?r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;
    `):r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<${Bf(e.dtype,n.outputComponent)}>;
    `),n.variableNames.forEach((m,g)=>{r.push(`
      @group(0) @binding(${1+g}) var<storage, read> ${m}: array<${n.variableComponents?Bf(t[g].dtype,n.variableComponents[g]):Bf(t[g].dtype,n.outputComponent)}>;
        `)}),a!==""&&r.push(`
      @group(0) @binding(${1+n.variableNames.length}) var<uniform> uniforms: Uniforms;
      `);const u=l_e(e.shape,n.dispatchLayout),c=[fV,r.join(`
`)+s_e,OC(e.shape),u,u_e(e.shape.length)];n.atomic||c.push(c_e(e.shape,e.dtype,n.outputComponent)),n.variableNames.forEach((m,g)=>{c.push(`${OC(t[g].shape,m)}`)});const d=t.map((m,g)=>a_e(m,e.shape,n.variableComponents?n.variableComponents[g]:n.outputComponent,n.dispatchLayout.x.length===e.shape.length)).join(`
`);c.push(d),c.push(n.getUserCode());const h=pV(n);return c.push(hV(h,n)),c.join(`
`)}function r_e(t,e,n){let r=t.shaderKey;if(t.pixelsOpType!=null)return r;const s=[],i=[];e.forEach(c=>{s.push(c.shape),i.push(c.dtype)}),s.push(n.shape),i.push(n.dtype);const o=e.map(c=>gh(c.shape,n.shape)),a=e.map(c=>nn(c.shape,n.shape)).join("_"),l=o.map(c=>c.join("_")).join(";"),u=uX(t)?"flatDispatch":"";return r+="_"+(t.workgroupSize?t.workgroupSize.join(","):"")+s.map(c=>c.length).join(",")+i.join(",")+t.variableNames.join(",")+l+a+u,r}const fV=`
  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};
  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};

  // Checks whether coordinates lie within the bounds of the shape.
  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {
    return all(coord >= vec2<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {
    return all(coord >= vec3<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {
    return all(coord >= vec4<i32>(0)) && all(coord < shape);
  }

  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {
    return coord;
  }
  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {
    return dot(coords, vec2<i32>(shape.y, 1));
  }
  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {
    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));
  }
  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
    return dot(coords, vec4<i32>(
        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
  }
  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {
    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;
  }
  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {
    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;
  }

  // NaN defination in IEEE 754-1985 is :
  //   - sign = either 0 or 1.
  //   - biased exponent = all 1 bits.
  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).
  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers
  fn isnan(val: f32) -> bool {
    let floatToUint: u32 = bitcast<u32>(val);
    return (floatToUint & 0x7fffffffu) > 0x7f800000u;
  }
  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {
    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);
    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);
  }
`,s_e=`
  fn isinf(val: f32) -> bool {
    return abs(val) == uniforms.INFINITY;
  }
`;function OC(t,e=""){const n=t.length,r=e!==""?`get${e.charAt(0).toUpperCase()+e.slice(1)}CoordsFromIndex`:"getCoordsFromIndex",s=e!==""?`${e.charAt(0).toLowerCase()+e.slice(1)}ShapeStrides`:"outShapeStrides";if(n<=1)return`fn ${r}(index : i32) -> i32 { return index; }`;const i=$t(t),o=Ar(n),a=[];for(let u=0;u<n;u++)a.push(`d${u}`);if(i.length===1)return`    fn ${r}(index : i32) -> vec2<i32> {
      let d0 = index / uniforms.${s}; let d1 = index - d0 * uniforms.${s};
      return vec2<i32>(d0, d1);
    }`;let l;return l="var index2 = index;"+i.map((u,c)=>{const d=`let ${a[c]} = index2 / uniforms.${s}.${Nc(c)}`,h=c===i.length-1?`let ${a[c+1]} = index2 - ${a[c]} * uniforms.${s}.${Nc(c)}`:`index2 = index2 - ${a[c]} * uniforms.${s}.${Nc(c)}`;return`${d}; ${h};`}).join(""),`
    fn ${r}(index : i32) -> ${o} {
      ${l}
      return ${o}(${a.join(",")});
    }
  `}function i_e(t,e){const n=t.name,r=t.shape.length,s=Ar(r),i="get"+n.charAt(0).toUpperCase()+n.slice(1),o=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=o.map(c=>`${c} : i32`).join(", ");if(r<1)return`
      fn ${i}() -> ${rn(e)} {
        return ${rn(e)}(${n}[0]);
      }
    `;const l=`uniforms.${n.charAt(0).toLowerCase()+n.slice(1)}Shape`;let u=`${r}D`;return r===0&&(u="1D"),`
    fn ${i}(${a}) -> ${rn(e)} {
      return ${rn(e)}(${n}[getIndexFromCoords${u}(${s}(${o.join(",")}),
        ${l})${e===1?"":` / ${e}`}]);
    }
   `}function o_e(t,e,n,r){const s=t.name,i=s.charAt(0).toUpperCase()+s.slice(1),o="get"+i+"ByOutput",a=t.shape.length,l=e.length,u=Ar(l);if(nn(t.shape,e)&&r)return`
    fn ${o}Index(globalIndex : i32) -> ${rn(n)} {
      return ${rn(n)}(${s}[globalIndex]);
    }

    fn ${o}Coords(coords : ${u}) -> ${rn(n)} {
      return ${rn(n)}(${s}[${l>1?"getOutputIndexFromCoords(coords)":"coords"}${n===1?"":` / ${n}`}]);
    }
    `;const c=gh(t.shape,e),d=l-a;let h="";if(a===0)return`
    fn ${o}Index(globalIndex : i32) -> ${rn(n)}{
      return get${i}();
    }

    fn ${o}Coords(coords : ${u}) -> ${rn(n)}{
      return get${i}();
    }
  `;l<2&&c.length>=1?h="coords = 0;":h=c.map(x=>`coords.${Nc(x+d)} = 0;`).join(`
`);let f="";if(l<2&&a>0)f="coords";else if(l>1){const x=Ar(a),w=t.shape.map((b,S)=>`coords.${Nc(S+d)}`).join(", ");f=`${x}(${w})`}else f="coords";const m=`uniforms.${s.charAt(0).toLowerCase()+s.slice(1)}Shape`,g=`${a}D`;return`
  fn ${o}Index(globalIndex : i32) -> ${rn(n)} {
    var coords = getCoordsFromIndex(globalIndex);
    ${h}
    return ${rn(n)}(${s}[getIndexFromCoords${g}(${f}, ${m})${n===1?"":` / ${n}`}]);
  }

  fn ${o}Coords(coordsIn : ${u}) -> ${rn(n)} {
    var coords = coordsIn;
    ${h}
    return ${rn(n)}(${s}[getIndexFromCoords${g}(${f}, ${m})${n===1?"":` / ${n}`}]);
  }
`}function a_e(t,e,n,r){let s=i_e(t,n);return t.shape.length<=e.length&&(s+=o_e(t,e,n,r)),s}function l_e(t,e){const{x:n,y:r=[],z:s=[]}=e,i=t.length,o=n.length+r.length+s.length;if(o!==i)return"";if(n.length===i)return`fn getOutputCoords() -> ${Ar(i)}{
    let globalIndex = getGlobalIndex();
    return getCoordsFromIndex(globalIndex);
  }
  `;let a="";const l=[n,r,s];for(let h=0;h<l.length;h++){const f=l[h];if(f.length!==0)if(f.length===1)a+=`let d${f[0]} = i32(globalId[${h}]);`;else{const m=JEe(f,"uniforms.outShape");a+=`var index${h} = i32(globalId[${h}]);`;for(let g=0;g<m.length;g++)a+=`let d${f[g]} = index${h} / ${m[g]};`,g===m.length-1?a+=`let d${f[g+1]} = index${h} - d${f[g]} * ${m[g]};`:a+=`index${h} = index${h} - d${f[g]} * ${m[g]};`}}const u=[];for(let h=0;h<o;h++)u.push(`d${h}`);const c=Ar(o);let d=`fn getOutputCoords() -> ${c} {
  ${a}
`;return u.length===0?d+=`return ${c}(0); }`:d+=`return ${c}(${u.join(",")}); }`,d}function u_e(t){let e="";switch(t){case 0:case 1:e+=`
        fn getOutputIndexFromCoords(coords : i32) -> i32 {
          return coords;
        }
        `;break;case 2:e+=`
        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {
          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));
        }
        `;break;case 3:e+=`
        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {
          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));
        }
        `;break;case 4:e+=`
        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
          return dot(coords, vec4<i32>(
            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));
        }
        `;break;case 5:e+=`
        fn getOutputIndexFromCoords(coords : vec5) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u;
        }
        `;break;case 6:e+=`
        fn getOutputIndexFromCoords(coords : vec6) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u * uniforms.outShapeStrides.u +
              coords.v;
        }
        `;break;default:ae(!1,()=>`Unsupported ${t}D shape`);break}return e}function uX(t){return t.dispatch[1]===1&&t.dispatch[2]===1}function Bf(t,e=1){if(t==="float32")return rn(e,"f32");if(t==="int32"||t==="bool")return rn(e,"i32");throw new Error(`type ${t} is not supported.`)}function c_e(t,e,n){const r=t.length,s=Bf(e,n);let i=`fn setOutputAtIndex(flatIndex : i32, value : ${rn(n)}) {
      result[flatIndex] = ${s}(value);
    }

    fn setOutputAtIndexI32(flatIndex : i32, value : ${rn(n,"i32")}) {
      result[flatIndex] = ${s}(value);
    }
    `;if(r>=2){const o=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=Ar(r);i+=`
      fn setOutputAtCoords(${o.map(l=>`${l} : i32`).join(", ")}, value : ${rn(n)}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${o.join(", ")}));
        setOutputAtIndex(flatIndex${n===1?"":` / ${n}`}, value);
      }
      fn setOutputAtCoordsI32(${o.map(l=>`${l} : i32`).join(", ")}, value : ${rn(n,"i32")}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${o.join(", ")}));
        setOutputAtIndexI32(flatIndex${n===1?"":` / ${n}`}, value);
      }
    `}return i}function d_e(t){const e=/(\w+)\s*:\s*vec(5|6)/g;t=t.replace(e,r=>"@align(16) "+r);const n=/vec(5|6)\s*,\s*(\w+)/g;return t=t.replace(n,(r,s,i)=>`vec${s}, @align(16) ${i}`),t}function pV(t){return!(t.dispatchLayout.hasOwnProperty("y")&&t.dispatchLayout.y.length!==0||t.dispatchLayout.hasOwnProperty("z")&&t.dispatchLayout.z.length!==0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const np=t=>{let e=1;for(let n=0;n<t.length;n++)e*=t[n];return e};function ct(t,e,n=[1,1,1],r=[1,1,1]){const[s,i,o]=[Math.ceil(np(t.x.map(a=>e[a]))/(n[0]*r[0])),t.y?Math.ceil(np(t.y.map(a=>e[a]))/(n[1]*r[1])):1,t.z?Math.ceil(np(t.z.map(a=>e[a]))/(n[2]*r[2])):1];return[s,i,o]}function h_e(t,e,n,r=!1){const s=[8,8,1],i=[4,4,1];return r||(t<=8&&(i[1]=1),e<=16&&n<=16&&(s[0]=4)),{workgroupSize:s,elementsPerThread:i}}function cX(t,e,n=!1){if(n)return[8,8,1];const r=np(t.x.map(i=>e[i])),s=np(t.y.map(i=>e[i]));return r<=4?[4,16,1]:s<=4?[16,4,1]:[16,16,1]}function dX(t,e,n=!1){if(n)return[4,4,1];const r=np(t.x.map(i=>e[i])),s=np(t.y.map(i=>e[i]));return r<=4?[1,2,1]:s<=4?[2,1,1]:[2,2,1]}function wt(t){return{x:t.map((e,n)=>n)}}function mV(t){if(t==="float32"||t==="int32"||t==="bool"||t==="string")return 4;if(t==="complex64")return 8;throw new Error(`Unknown dtype ${t}`)}function hX(){return!!(typeof globalThis<"u"&&globalThis.navigator&&globalThis.navigator.gpu)}function fX(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&ae(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGPU backend.`)})}var tu;(function(t){t[t.MatMulReduceProgram=0]="MatMulReduceProgram",t[t.MatMulSplitKProgram=1]="MatMulSplitKProgram",t[t.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",t[t.MatMulPackedProgram=3]="MatMulPackedProgram",t[t.MatMulMax=4]="MatMulMax"})(tu||(tu={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f_e=We().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD"),p_e=(t,e)=>{const n=t.limits.maxComputeWorkgroupsPerDimension,r=e.dispatchLayout,s=e.dispatch;if(s.every(o=>o<=n))return s;ae(s[0]>n&&r.y===void 0&&r.z===void 0,()=>"Dispatch size exceeds WebGPU limits in Y or Z dimension.");let i=Math.ceil(Math.sqrt(s[0]));return i>n?(i=Math.ceil(Math.cbrt(s[0])),ae(i<=n,()=>"Total dispatch size exceeds WebGPU maximum."),[i,i,i]):[i,i,1]};class Sy extends KN{nextDataId(){return Sy.nextDataId++}constructor(e,n){if(super(),this.commandQueueOwnedIds=new WeakSet,this.dispatchCountInPass=0,this.disposed=!1,this.downloadWaitMs=0,this.tensorDataPendingDisposal=[],this.queryResolveBuffer=null,this.querySet=null,this.querySetCount=2,this.stagingPendingDisposal=[],this.uniformPendingDisposal=[],this.uploadWaitMs=0,this.hasReadSyncWarned=!1,this.hasTimestampQueryWarned=!1,!hX())throw new Error("WebGPU is not supported on this device");this.pipelineCache={},this.device=e,this.queue=e.queue,this.commandEncoder=null,this.computePassEncoder=null,this.adapterInfo=new XEe(n),this.supportTimestampQuery=this.device.features.has("timestamp-query"),this.thresholdToIncreaseWorkgroups=this.adapterInfo.intelGPUGeneration>=12?16:8,this.bufferManager=new ZEe(this.device),this.textureManager=new QEe(this.device),this.tensorMap=new cO(this,ci()),We().getBool("WEBGPU_USE_PROFILE_TOOL")&&(this.dummyCanvas=document.createElement("canvas"),this.dummyCanvas.width=1,this.dummyCanvas.height=1,this.dummyContext=this.dummyCanvas.getContext("webgpu"),this.dummyContext.configure({device:e,format:"bgra8unorm"}),document.body.appendChild(this.dummyCanvas))}floatPrecision(){return 32}disposeData(e,n=!1){if(!this.tensorMap.has(e))return!0;const r=this.tensorMap.get(e);return n?r.refCount=0:r.refCount--,r.refCount>0?!1:(r.complexTensorInfos!=null&&(this.disposeData(r.complexTensorInfos.real.dataId),this.disposeData(r.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(e)?(this.tensorDataPendingDisposal.push(e),!0):(this.releaseResource(e),this.tensorMap.delete(e),!0))}memory(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}releaseResource(e){const n=this.tensorMap.get(e);if(!(!n||!n.resource)){if(n.external){n.resource=null;return}n.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(n.resource):n.resource instanceof GPUTexture&&this.textureManager.releaseTexture(n.resource),n.resource=null}}refCount(e){return this.tensorMap.has(e)?this.tensorMap.get(e).refCount:0}incRef(e){const n=this.tensorMap.get(e);n.refCount++}decRef(e){if(this.tensorMap.has(e)){const n=this.tensorMap.get(e);n.refCount--}}write(e,n,r){if(r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.tensorMap.set(s,{dtype:r,shape:n,values:e,refCount:1}),s}move(e,n,r,s,i){if(s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(e,{dtype:s,shape:r,values:n,refCount:i})}submitQueue(){this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach(e=>{this.releaseResource(e),this.tensorMap.delete(e)}),this.uniformPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e)),this.stagingPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e,!1)),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}ensureCommandEncoderReady(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}endComputePassEncoder(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}async checkCompileCompletionAsync(){let e;try{e=await Promise.all(Object.values(this.pipelineCache))}catch(n){throw new Error(n.message)}Object.keys(this.pipelineCache).map((n,r)=>{this.pipelineCache[n]=e[r]})}async getBufferData(e){if(We().getBool("WEBGPU_ENGINE_COMPILE_ONLY"))return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),null;const n=e.size,r=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,n),this.submitQueue(),await r.mapAsync(GPUMapMode.READ);const s=r.getMappedRange().slice(0);return r.unmap(),r!=null&&this.bufferManager.releaseBuffer(r),We().getBool("WEBGPU_USE_PROFILE_TOOL")&&(ae(this.dummyContext!==void 0,()=>"Fail to get context for profiling tool"),this.dummyContext.getCurrentTexture()),s}convertAndCacheOnCPU(e,n){const r=this.tensorMap.get(e);return r.values=n,r.values}readSync(e){const n=this.tensorMap.get(e),{values:r,complexTensorInfos:s}=n;if(r!=null||n.dtype==="string")return r;if(n.dtype==="complex64"){const g=this.readSync(s.real.dataId),x=this.readSync(s.imag.dataId),w=IC(kl(g,x).buffer,"float32");return this.convertAndCacheOnCPU(e,w),w}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));const i=["opaque","premultiplied"],o=n.resource,a=o.size;ae(a%4===0,()=>"Because there is 4 bytes for one pixel, buffer size must be multiple of 4.");const l=a/4,u=new ArrayBuffer(a),c=256,d=256,h=i.map(g=>new OffscreenCanvas(c,d)),f=new OffscreenCanvas(c,d);this.endComputePassEncoder(),h.map((g,x)=>{const w=g.getContext("webgpu");return w.configure({device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:i[x]}),w.getCurrentTexture()}).map((g,x)=>{const w=c*4,b=(I,E,M)=>{this.ensureCommandEncoderReady(),this.commandEncoder.copyBufferToTexture({buffer:o,bytesPerRow:w,offset:M},{texture:g},{width:I,height:E}),this.submitQueue();const O=f.getContext("2d",{willReadFrequently:!0});O.clearRect(0,0,I,E),O.drawImage(h[x],0,0);const j=O.getImageData(0,0,I,E).data,R=i[x],z=new Uint8ClampedArray(u,M,I*E*4);for(let B=0;B<z.length;B+=4)if(R==="premultiplied")z[B+3]=j[B+3];else{const V=j[B];z[B]=j[B+2],z[B+1]=j[B+1],z[B+2]=V}},S=Math.floor(l/(c*d));let C=c,T=d,D=0;for(let I=0;I<S;I++)b(C,T,D),D+=c*d*4;const P=l%(c*d);T=Math.floor(P/c),T>0&&(b(C,T,D),D+=T*(c*4)),C=P%c,C>0&&b(C,1,D)});const m=IC(u,n.dtype);return this.convertAndCacheOnCPU(e,m),m}async read(e){if(!this.tensorMap.has(e))throw new Error(`Tensor ${e} was not registered!`);const n=this.tensorMap.get(e),{values:r}=n;if(r!=null)return r;let s;if(n.dtype==="complex64"){const i=await Promise.all([this.read(n.complexTensorInfos.real.dataId),this.read(n.complexTensorInfos.imag.dataId)]),o=i[0],a=i[1];s=kl(o,a)}else{const i=await this.getBufferData(n.resource);s=IC(i,n.dtype)}return this.convertAndCacheOnCPU(e,s),s}copyBuffer(e){const n=e.size,r=e.usage,s=this.bufferManager.acquireBuffer(n,r);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,s,0,n),this.submitQueue(),s}createTensorFromGPUData(e,n,r){let s=e.buffer;if(r==="complex64")throw new Error("Cannot write to a complex64 dtype. ");const i={id:this.nextDataId()};this.tensorMap.set(i,{dtype:r,shape:n,values:null,refCount:1,external:e.zeroCopy});const o=this.tensorMap.get(i),a=mV(o.dtype)*Ue(o.shape);if(e.buffer.size<a)throw new Error(`GPUBuffer size(${e.buffer.size}) is smaller than tensor size(${a})!`);if((e.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!==(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return e.zeroCopy!==!0&&(s=this.copyBuffer(s)),o.resource=s,ci().makeTensorFromDataId(i,n,r,this)}readToGPU(e){const n=this.tensorMap.get(e),{values:r,dtype:s,shape:i,resource:o}=n;if(s==="complex64")throw new Error("Does not support reading buffer for complex64 dtype.");if(o==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const a=o,l=a.size,u=a.usage,c=this.bufferManager.acquireBuffer(l,u);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(o,0,c,0,l),this.submitQueue();const d=this.makeTensorInfo(i,s),h=ci().makeTensorFromTensorInfo(d),f=this.tensorMap.get(d.dataId);return f.resource=c,{tensorRef:h,buffer:c}}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Cl(s));return Zt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Zt(e.shape,e.dtype,n)}async time(e){!this.supportTimestampQuery&&!this.hasTimestampQueryWarned&&(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --enable-dawn-features=allow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0);const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=$c(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),o=$c(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},l=await Promise.all(i);return a.kernelMs=EY(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", "),this.uploadWaitMs=0,this.downloadWaitMs=0,a}makeTensorInfo(e,n,r){return n==="string"&&r!=null&&r.length>0&&b0(r[0])&&(r=r.map(i=>Cc(i))),{dataId:this.write(r,e,n),shape:e,dtype:n}}tensorToBinding(e){if(!e)return null;const r=this.tensorMap.get(e.dataId).resource;return r instanceof GPUBuffer?{buffer:r}:r instanceof GPUTexture?r.createView():r}uploadToGPU(e){const n=this.tensorMap.get(e);if(n.resource!=null)return;const r=mV(n.dtype)*Ue(n.shape);let s;const i=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(n.values){if(s=this.bufferManager.acquireBuffer(r,i,!0),s.mapState==="unmapped"){const o=this.bufferManager.acquireBuffer(r,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),a=o.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(a).set(n.values):new Float32Array(a).set(n.values),o.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(o,0,s,0,r),this.stagingPendingDisposal.push(o)}else{const o=s.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(o).set(n.values):new Float32Array(o).set(n.values),s.unmap()}n.values=null}else s=this.bufferManager.acquireBuffer(r,i);n.resource=s}makeUniforms(e){let n=0,r=0;const s=[];let i=1;e.forEach(l=>{l.data.length===0&&(l.data=[1]);let u;switch(l.data.length){case 1:u=4;break;case 2:u=8;break;case 3:u=16;break;case 4:u=16;break;case 5:u=16;break;case 6:u=16;break;default:ae(!1,()=>`Unsupported ${l.data.length}D shape`)}(r===5||r===6)&&(u=16),u>i&&(i=u),n=Math.ceil(n/u)*u,r=l.data.length,s.push(n),n+=l.data.length*4}),n=Math.ceil(n/i)*i;const o=new ArrayBuffer(n);e.forEach((l,u)=>{const c=s[u];l.type==="int32"?new Int32Array(o,c,l.data.length).set(l.data):l.type==="uint32"?new Uint32Array(o,c,l.data.length).set(l.data):new Float32Array(o,c,l.data.length).set(l.data)});const a=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(a,0,o,0,n),this.uniformPendingDisposal.push(a),{offset:0,size:n,buffer:a}}runWebGPUProgram(e,n,r,s,i){if(i||(i=this.makeTensorInfo(e.outputShape,r)),Ue(i.shape)===0)return this.tensorMap.get(i.dataId).values=is(i.dtype,0),i;this.uploadToGPU(i.dataId),e.dispatch=p_e(this.device,e);const o=n.map((l,u)=>{if(l.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return this.uploadToGPU(l.dataId),{dtype:this.tensorMap.get(l.dataId).dtype,shape:l.shape,name:e.variableNames[u]}});e.shaderKey=r_e(e,o,i);const a=We().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return e.shaderKey in this.pipelineCache||(this.pipelineCache[e.shaderKey]=e_e(this.device,e,o,i,a)),e.pipeline=this.pipelineCache[e.shaderKey],a||this.recordAndSubmit(e,i,n,s),i}recordAndSubmit(e,n,r,s){if(e.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");let i=[],o=[];const a="int32";if(e.pixelsOpType==null){i.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),o=r.concat(n).map(f=>f.shape);const h="int32";o.map(f=>{i.push({type:h,data:f});const m=$t(f);i.push({type:h,data:m})})}else{const h=$t(n.shape);i.push({type:a,data:h})}if(e.size){const h=Ue(e.outputShape);i.push({type:a,data:[e.outputComponent?h/e.outputComponent:h]})}s&&(i=[...i,...s]);const l=[this.tensorToBinding(n),...r.map(h=>this.tensorToBinding(h)),this.makeUniforms(i)];r.forEach(h=>{this.commandQueueOwnedIds.add(h.dataId)}),this.commandQueueOwnedIds.add(n.dataId);const u=this.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:l.map((h,f)=>({binding:f,resource:h}))}),c=this.activeTimers!=null;this.ensureCommandEncoderReady();const d={};c&&this.supportTimestampQuery?(this.endComputePassEncoder(),this.querySet==null&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),d.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1},this.computePassEncoder=this.commandEncoder.beginComputePass(d)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(d)),this.computePassEncoder.setPipeline(e.pipeline),this.computePassEncoder.setBindGroup(0,u),this.computePassEncoder.dispatchWorkgroups(e.dispatch[0],e.dispatch[1],e.dispatch[2]),this.dispatchCountInPass++,(c||We().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||e.pixelsOpType===Qg.DRAW)&&(this.endComputePassEncoder(),c?this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime()}):this.submitQueue())}async getQueryTime(){if(!this.supportTimestampQuery)return 0;this.queryResolveBuffer==null&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0);const e=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.querySetCount*8),this.submitQueue(),await e.mapAsync(GPUMapMode.READ);const n=new BigUint64Array(e.getMappedRange()),r=Number(n[1]-n[0])/1e6;return e.unmap(),this.bufferManager.releaseBuffer(e),r}shouldExecuteOnCPU(e,n=f_e){return We().getBool("WEBGPU_CPU_FORWARD")&&e.every(r=>this.tensorMap.get(r.dataId).resource==null&&Ue(r.shape)<n)}numDataIds(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}dispose(){this.disposed||(this.querySet!=null&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}Sy.nextDataId=0;/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */hX()&&TO("webgpu",async()=>{const t={powerPreference:We().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},e=await navigator.gpu.requestAdapter(t),n={},r=[];e.features.has("timestamp-query")&&r.push("timestamp-query"),e.features.has("bgra8unorm-storage")&&r.push(["bgra8unorm-storage"]),n.requiredFeatures=r;const s=e.limits;n.requiredLimits={maxComputeWorkgroupStorageSize:s.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:s.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:s.maxStorageBufferBindingSize,maxBufferSize:s.maxBufferSize,maxComputeWorkgroupSizeX:s.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:s.maxComputeInvocationsPerWorkgroup};const i=await e.requestDevice(n),o="info"in e?e.info:"requestAdapterInfo"in e?await e.requestAdapterInfo():void 0;return new Sy(i,o)},3);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Yt;(function(t){t[t.ADD=0]="ADD",t[t.ATAN2=1]="ATAN2",t[t.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",t[t.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",t[t.DIV=4]="DIV",t[t.ELU_DER=5]="ELU_DER",t[t.EQUAL=6]="EQUAL",t[t.FLOOR_DIV=7]="FLOOR_DIV",t[t.GREATER=8]="GREATER",t[t.GREATER_EQUAL=9]="GREATER_EQUAL",t[t.LESS=10]="LESS",t[t.LESS_EQUAL=11]="LESS_EQUAL",t[t.LOGICAL_AND=12]="LOGICAL_AND",t[t.LOGICAL_OR=13]="LOGICAL_OR",t[t.MAX=14]="MAX",t[t.MIN=15]="MIN",t[t.MOD=16]="MOD",t[t.MUL=17]="MUL",t[t.NOT_EQUAL=18]="NOT_EQUAL",t[t.POW=19]="POW",t[t.PRELU=20]="PRELU",t[t.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",t[t.SUB=22]="SUB"})(Yt||(Yt={}));const m_e="let resultTemp = a + b;",g_e="let resultTemp = atan2(a, b);",y_e="let resultTemp = areal * breal - aimag * bimag;",x_e="let resultTemp = areal * bimag + aimag * breal;",w_e="let resultTemp = a / b;",b_e="let resultTemp = select(a * (b + 1.0), a, b >= b - b);",v_e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a == b);
`,S_e=`
  let remainder =
      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));
  let quotient = (a - remainder) / b;
  let resultTemp =
      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));
`,C_e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a > b);
`,I_e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a >= b);
`,N_e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a < b);
`,k_e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a <= b);
`,T_e="return f32(a >= 1.0 && b >= 1.0);",E_e=`return (vec4<f32>(a >= vec4<f32>(1.0)) *
  vec4<f32>(b >= vec4<f32>(1.0)));`,__e="return f32(a >= 1.0 || b >= 1.0);",A_e=`return min(vec4<f32>(a >= vec4<f32>(1.0)) +
  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));`,$_e="let resultTemp = max(a, b);",R_e="let resultTemp = min(a, b);",M_e=`
  let isNaN = b == 0.;
  var resultTemp = a % b;
  resultTemp = select((resultTemp + b) % b, resultTemp,
      (a < 0. && b < 0.) || (a >= 0. && b > 0.));
`,D_e=`
  let isNaN = !vec4<bool>(b);
  var resultTemp = vec4<f32>(a % b);
  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {
    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];
  }
  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {
    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];
  }
  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {
    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];
  }
  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {
    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];
  }
`,O_e="let resultTemp = a * b;",P_e=`
  var resultTemp = f32(a != b);
  let valueForNaN = 1.0;
`,F_e=`
  var resultTemp = vec4<f32>(a != b);
  let valueForNaN = 1.0;
`,L_e=`
  let isNaN = a < 0.0 && floor(b) < b;
  if (b == 0.0) {
    return 1.0;
  }
  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),
      round(abs(b) % 2.0) != 1.0);
`,z_e=`
  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);
  let isModRound1 = vec4<f32>(isModRound1Bool);
  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);
  var resultTemp = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  let isExpZero = b == vec4<f32>(0.0);
  if (isExpZero.r) {
    resultTemp.r = 1.0;
  }
  if (isExpZero.g) {
    resultTemp.g = 1.0;
  }
  if (isExpZero.b) {
    resultTemp.b = 1.0;
  }
  if (isExpZero.a) {
    resultTemp.a = 1.0;
  }
  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);
`,B_e="if (a < 0.0) { return b * a; }  return a;",U_e=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,V_e="let resultTemp = (a - b) * (a - b);",j_e="let resultTemp = a - b;";function SP(t,e){let n;do{switch(t){case Yt.ATAN2:n=g_e;break;case Yt.MAX:n=$_e;break;case Yt.MIN:n=R_e;break;case Yt.MOD:n=e?D_e:M_e;break;case Yt.NOT_EQUAL:n=e?F_e:P_e;break;case Yt.POW:n=e?z_e:L_e;break;default:continue}let r,s,i;return e?(r="isnanVec4",s="vec4<f32>",i="vec4<bool>"):(r="isnan",s="f32",i="bool"),`
      let aIsNaN = ${r}(a);
      let aPostLegalization = select(a, ${s}(42), aIsNaN);
      let bIsNaN = ${r}(b);
      let bPostLegalization = select(b, ${s}(42), bIsNaN);
      let isNaN = false;
      let valueForNaN = uniforms.NAN;
      {
        let a = aPostLegalization;
        let b = bPostLegalization;
        ${n}
        return select(
            resultTemp, ${s}(valueForNaN),
            ${i}(isNaN) | aIsNaN | bIsNaN);
      }
    `}while(!1);switch(t){case Yt.ADD:n=m_e;break;case Yt.COMPLEX_MULTIPLY_IMAG:n=x_e;break;case Yt.COMPLEX_MULTIPLY_REAL:n=y_e;break;case Yt.DIV:n=w_e;break;case Yt.ELU_DER:n=b_e;break;case Yt.EQUAL:n=v_e;break;case Yt.FLOOR_DIV:n=S_e;break;case Yt.GREATER:n=C_e;break;case Yt.GREATER_EQUAL:n=I_e;break;case Yt.LESS:n=N_e;break;case Yt.LESS_EQUAL:n=k_e;break;case Yt.LOGICAL_AND:return e?E_e:T_e;case Yt.LOGICAL_OR:return e?A_e:__e;case Yt.MUL:n=O_e;break;case Yt.PRELU:return e?U_e:B_e;case Yt.SQUARED_DIFFERENCE:n=V_e;break;case Yt.SUB:n=j_e;break}return`
    ${n}
    return resultTemp;
  `}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ot;(function(t){t[t.ABS=0]="ABS",t[t.ACOS=1]="ACOS",t[t.ACOSH=2]="ACOSH",t[t.ASIN=3]="ASIN",t[t.ASINH=4]="ASINH",t[t.ATAN=5]="ATAN",t[t.ATANH=6]="ATANH",t[t.CEIL=7]="CEIL",t[t.COS=8]="COS",t[t.COSH=9]="COSH",t[t.ELU=10]="ELU",t[t.ERF=11]="ERF",t[t.EXP=12]="EXP",t[t.EXPM1=13]="EXPM1",t[t.FLOOR=14]="FLOOR",t[t.IS_FINITE=15]="IS_FINITE",t[t.IS_INF=16]="IS_INF",t[t.IS_NAN=17]="IS_NAN",t[t.LINEAR=18]="LINEAR",t[t.LOG=19]="LOG",t[t.LOG1P=20]="LOG1P",t[t.LOGICAL_NOT=21]="LOGICAL_NOT",t[t.NEG=22]="NEG",t[t.RELU=23]="RELU",t[t.RELU6=24]="RELU6",t[t.LEAKYRELU=25]="LEAKYRELU",t[t.RECIPROCAL=26]="RECIPROCAL",t[t.ROUND=27]="ROUND",t[t.RSQRT=28]="RSQRT",t[t.SELU=29]="SELU",t[t.SIGMOID=30]="SIGMOID",t[t.SIGN=31]="SIGN",t[t.SIN=32]="SIN",t[t.SINH=33]="SINH",t[t.SOFTPLUS=34]="SOFTPLUS",t[t.SQRT=35]="SQRT",t[t.SQUARE=36]="SQUARE",t[t.STEP=37]="STEP",t[t.TAN=38]="TAN",t[t.TANH=39]="TANH",t[t.TO_INT=40]="TO_INT"})(ot||(ot={}));const W_e="return abs(a);",G_e=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return acos(a);
`,H_e=`
  if (a < 1.) {
    return uniforms.NAN;
  }
  return acosh(a);
`,Y_e=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return asin(a);
`,K_e="return asinh(a);",q_e=`
  if (isnan(a)) {
    return uniforms.NAN;
  }
  return atan(a);
`,X_e=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  if (a == 1.) {
    return uniforms.INFINITY;
  }
  if (a == -1.) {
    return -uniforms.INFINITY;
  }
  return atanh(a);
`,Z_e="return ceil(a);",Q_e="return cos(a);",J_e=`
  let e2x = exp(-a);
  return (e2x + 1.0 / e2x) / 2.0;
`,eAe="return exp(a) - 1.0;",tAe="if (a >= 0.0) { return a; }  return (exp(a) - 1.0);",nAe=`
  var resFloat = exp(a) - vec4<f32>(1.0);
  if (a.r >= 0.0) {
    resFloat.r = a.r;
  }
  if (a.g >= 0.0) {
    resFloat.g = a.g;
  }
  if (a.b >= 0.0) {
    resFloat.b = a.b;
  }
  if (a.a >= 0.0) {
    resFloat.a = a.a;
  }
  return resFloat;
`,rAe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  let p = ${TT};
  let a1 = ${ET};
  let a2 = ${_T};
  let a3 = ${AT};
  let a4 = ${$T};
  let a5 = ${RT};

  let sign = sign(a);
  let absA = abs(a);
  let t = 1.0 / (1.0 + p * absA);
  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));
`,sAe="return exp(a);",iAe="return floor(a);",oAe="return f32(!isnan(a) && !isinf(a));",aAe="return f32(isinf(a));",lAe="return f32(isnan(a));",uAe="return a;",cAe=`if (a < 0.0) { return uniforms.NAN; }
  return log(a);`,dAe=`
  if (isnan(a)) { return a; }
  return log(1.0 + a);
`,hAe="return f32(!(a >= 1.0));",fAe="return -a;",pAe="if (a < 0.0) { return uniforms.alpha * a; } return a;",mAe=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,gAe="return 1.0 / a;",yAe="return select(a, 0.0, a < 0.0);",xAe="return clamp(a, 0.0, 6.0);",wAe="return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));",bAe=`
  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));
`,vAe="return round(a);",SAe="return inverseSqrt(a);",CAe=`
  if (a >= 0.0) {
    return ${Jb} * a;
  } else {
    return ${Qb} * (exp(a) - 1.0);
  }
`,IAe="return 1.0 / (1.0 + exp(-1.0 * a));",NAe="return sign(a);",kAe="return sin(a);",TAe=`
  let e2x = exp(a);
  return (e2x - 1.0 / e2x) / 2.0;
`,EAe=`
  let epsilon = 1.1920928955078125e-7;
  let threshold = log(epsilon) + 2.0;

  let too_large = a > -threshold;
  let too_small = a < threshold;
  let exp_a = exp(a);

  if (too_large) {
    return a;
  } else if (too_small) {
    return exp_a;
  } else {
    return log(exp_a + 1.0);
  }
`,_Ae="return sqrt(a);",AAe="return a * a;",$Ae=`
  if (isnan(a)) {
    return a;
  }

  return select(uniforms.stepAlpha, 1.0, a > 0.0);
`,RAe="return tan(a);",MAe=`
  let e2x = exp(-2.0 * abs(a));
  return sign(a) * (1.0 - e2x) / (1.0 + e2x);
`,DAe="return f32(i32((a)));";function Mf(t,e){switch(t){case ot.ABS:return W_e;case ot.ACOS:return G_e;case ot.ACOSH:return H_e;case ot.ASIN:return Y_e;case ot.ASINH:return K_e;case ot.ATAN:return q_e;case ot.ATANH:return X_e;case ot.COS:return Q_e;case ot.COSH:return J_e;case ot.CEIL:return Z_e;case ot.ELU:return e?nAe:tAe;case ot.ERF:return rAe;case ot.EXP:return sAe;case ot.EXPM1:return eAe;case ot.FLOOR:return iAe;case ot.IS_FINITE:return oAe;case ot.IS_INF:return aAe;case ot.IS_NAN:return lAe;case ot.LINEAR:return uAe;case ot.LOG:return cAe;case ot.LOG1P:return dAe;case ot.LOGICAL_NOT:return hAe;case ot.NEG:return fAe;case ot.LEAKYRELU:return e?mAe:pAe;case ot.RECIPROCAL:return gAe;case ot.RELU:return e?bAe:yAe;case ot.RELU6:return e?wAe:xAe;case ot.ROUND:return vAe;case ot.RSQRT:return SAe;case ot.SELU:return CAe;case ot.SIGMOID:return IAe;case ot.SIGN:return NAe;case ot.SIN:return kAe;case ot.SINH:return TAe;case ot.SOFTPLUS:return EAe;case ot.SQRT:return _Ae;case ot.SQUARE:return AAe;case ot.STEP:return $Ae;case ot.TAN:return RAe;case ot.TANH:return MAe;case ot.TO_INT:return DAe;default:throw new Error(`BinaryType ${t} is not implemented!`)}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lc(t,e=!1,n=!1,r=3){if(t===null)return"";let s="";if(t==="linear")s=Mf(ot.LINEAR);else if(t==="relu")s=Mf(ot.RELU,n);else if(t==="elu")s=Mf(ot.ELU,n);else if(t==="relu6")s=Mf(ot.RELU6,n);else if(t==="prelu")s=SP(Yt.PRELU,n);else if(t==="sigmoid")s=Mf(ot.SIGMOID,n);else if(t==="leakyrelu")s=Mf(ot.LEAKYRELU,n);else throw new Error(`Activation ${t} has not been implemented for the WebGPU backend.`);const o=rn(n?4:1);let a="";return e?a=`
      fn activation(a : ${o}, coords : vec${r}<i32>) -> ${o} {
        let b = getPreluActivationWeightsByOutputCoords(coords);
        ${s}
      }`:a=`
      fn activation(a : ${o}, coords : vec${r}<i32>) -> ${o} {
        ${s}
      }`,a}function Yp(t,e){return`
      ${t?"value = value + getBiasByOutputCoords(coords);":""}
      ${e?"value = activation(value, coords);":""}
      `}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(t,e,n=!1,r=!1,s=!1,i=1){ae(t&&i===1||!t,()=>`transposeA ${t} is not compatible with component size ${i}`);const o=`
      ${t?"value = getA(batch, col, row);":"value = getA(batch, row, col);"}

    `,a=e?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return`
  fn mm_readA(batch: i32, row: i32, col: i32) -> ${rn(i)} {
    var value = ${rn(i)}(0.0);
    ${n&&s?o:`
    ${t?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])"}
    {
      ${o}
    }
    `}
    return value;
  }

  fn mm_readB(batch: i32, row: i32, col: i32) -> ${rn(i)} {
    var value = ${rn(i)}(0.0);
    ${a}
    return value;
  }
  `}function CP(t,e,n,r,s=!1,i=!1,o=!1,a=1){return`
  ${pX(n,r,s,i,o,a)}
  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ${rn(a)}) {
    ${s&&i?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)"}
    {
      var value = valueIn;
      let coords = vec3<i32>(batch, row, col);
      ${Yp(t,e)}
      setOutputAtCoords(coords[0], coords[1], coords[2], value);
    }
  }
  `}const OAe=(t,e)=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol * ${e});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRow + innerRow,
          kStart + inputCol * ${e});
        `,PAe=(t,e,n,r)=>{if(t)return`
      for (var k = 0; k < ${r}; k++) {
        let BCached0 = mm_Bsub[k][tileCol];
        let ACached0 = mm_Asub[k][localRow];
        for (var i = 0; i < ${n}; i++) {
          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);
        }
      }`;{let s="",i="";for(let o=0;o<e;o++)s+=`let BCached${o} = mm_Bsub[k * ${e} + ${o}][tileCol];`,i+=`acc[i] = fma(BCached${o}, vec4<f32>(ACached[${o}]), acc[i]);`;return`
      for (var k = 0; k < ${r/e}; k++) {
        ${s}
        for (var i = 0; i < ${n}; i++) {
          let ACached = mm_Asub[tileRow + i][k];
          ${i}
        }
      }`}};function BT(t,e,n=!1,r=32,s=!1,i=32,o=!1){const a=e[1]*t[1],l=e[0]*t[0],u=n?a:r,c=n?r:a,d=u/e[0],h=r/e[1],f=t[1],m=t[0];return ae((n&&d===4&&t[1]===4||!n&&(d===3||d===4))&&u%e[0]===0&&r%e[1]===0&&t[0]===4,()=>`If transposeA ${n} is true, innerElementSize ${d} and workPerThread[1] ${t[1]} must be 4.
          Otherwise, innerElementSize ${d} must be 3 or 4.
      tileAWidth ${u} must be divisible by workgroupSize[0]${e[0]}. tileInner ${r} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${t[0]} must be 4.`),`
  var<workgroup> mm_Asub : array<array<vec${d}<f32>, ${u/d}>, ${c}>;
  var<workgroup> mm_Bsub : array<array<vec4<f32>, ${l/t[0]}>, ${r}>;

  ${ut()} {
    let localRow = i32(localId.y);
    let tileRow = localRow * ${f};
    let tileCol = i32(localId.x);

    let globalRow = i32(globalId.y) * ${f};
    let globalCol = i32(globalId.x) * ${m};
    let batch = ${s?"0":"i32(globalId.z)"};
    let batchA = ${s||!o?"batch":"batch % uniforms.aShape[0]"};
    let batchB = ${s||!o?"batch":"batch % uniforms.bShape[0]"};
    let globalRowStart = i32(workgroupId.y) * ${a};

    let numTiles = ${s?`${Math.ceil(i/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
    var kStart = ${s?`i32(globalId.z) * ${i}`:"0"};

    var acc: array<vec4<f32>, ${f}>;

    // Loop over shared dimension.
    let tileRowB = localRow * ${h};
    for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var innerRow = 0; innerRow < ${f}; innerRow++) {
            let inputRow = tileRow + innerRow;
            let inputCol = tileCol;
            ${OAe(n,d)}
        }

        // Load one tile of B into local memory.
        for (var innerRow = 0; innerRow < ${h}; innerRow++) {
            let inputRow = tileRowB + innerRow;
            let inputCol = tileCol;
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        ${PAe(n,d,f,r)}
        workgroupBarrier();
    }

    for (var innerRow = 0; innerRow < ${f}; innerRow++) {
        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
    }
  }`}const gV=t=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol);
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRowStart + inputRow,
          kStart + inputCol);
        `,FAe=t=>t?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];";function UT(t,e,n=!1,r=32,s=!1,i=32,o=!1,a=!1){const l=t[1]*e[1],u=t[0]*e[0],c=n?l:r,d=n?r:l;ae(d%e[1]===0&&c%e[0]===0&&r%e[1]===0,()=>`tileAHight ${d} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${c} must be divisible by workgroupSize[0]${e[0]}, tileInner ${r} must be divisible by workgroupSize[1]${e[1]}`);const h=d/e[1],f=c/e[0],m=r/e[1],g=t[1],x=t[0],w=o?`
      let localRow = i32(localId.y);
      let localCol = i32(localId.x);
      let globalRowStart = i32(workgroupId.y) * ${l};
      let globalColStart = i32(workgroupId.x) * ${u};

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var inputRow = localRow; inputRow < ${d}; inputRow = inputRow + ${e[1]}) {
          for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${e[0]}) {
            ${gV(n)}
          }
        }
        // Load one tile of B into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${e[1]}) {
              for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${e[0]}) {
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
              kStart + inputRow,
              globalColStart + inputCol);
          }
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        var BCached : array<f32, ${x}>;
        for (var k = 0; k < ${r}; k++) {
          for (var inner = 0; inner < ${x}; inner++) {
            BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
          }
          for (var innerRow = 0; innerRow < ${g}; innerRow++) {
            let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
            for (var innerCol = 0; innerCol < ${x}; innerCol++) {
              acc[innerRow][innerCol] =
                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
            }
          }
        }
        workgroupBarrier();
      }
      for (var innerRow = 0; innerRow < ${g}; innerRow++) {
        let gRow = globalRowStart + localRow + innerRow * ${e[1]};
        for (var innerCol = 0; innerCol < ${x}; innerCol++) {
          let gCol = globalColStart + localCol + innerCol * ${e[0]};
          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
        }
      }
      `:`
  let tileRow = i32(localId.y) * ${g};
  let tileCol = i32(localId.x) * ${x};

  let globalRow = i32(globalId.y) * ${g};
  let globalCol = i32(globalId.x) * ${x};
  let globalRowStart = i32(workgroupId.y) * ${l};

  let tileRowA = i32(localId.y) * ${h};
  let tileColA = i32(localId.x) * ${f};
  let tileRowB = i32(localId.y) * ${m};
  // Loop over shared dimension.
  for (var t = 0; t < numTiles; t++) {
    // Load one tile of A into local memory.
    for (var innerRow = 0; innerRow < ${h}; innerRow++) {
      for (var innerCol = 0; innerCol < ${f}; innerCol++) {
        let inputRow = tileRowA + innerRow;
        let inputCol = tileColA + innerCol;
        ${gV(n)}
      }
    }

    // Load one tile of B into local memory.
    for (var innerRow = 0; innerRow < ${m}; innerRow++) {
      for (var innerCol = 0; innerCol < ${x}; innerCol++) {
        let inputRow = tileRowB + innerRow;
        let inputCol = tileCol + innerCol;
        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
          kStart + inputRow,
          globalCol + innerCol);
      }
    }
    kStart = kStart + ${r};
    workgroupBarrier();

    // Compute acc values for a single thread.
    var BCached : array<f32, ${x}>;
    for (var k = 0; k < ${r}; k++) {
      for (var inner = 0; inner < ${x}; inner++) {
        BCached[inner] = mm_Bsub[k][tileCol + inner];
      }

      for (var innerRow = 0; innerRow < ${g}; innerRow++) {
        ${FAe(n)}
        for (var innerCol = 0; innerCol < ${x}; innerCol++) {
          acc[innerRow][innerCol] =
              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
        }
      }
    }

    workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < ${g}; innerRow++) {
    for (var innerCol = 0; innerCol < ${x}; innerCol++) {
      mm_write(batch, globalRow + innerRow, globalCol + innerCol,
          acc[innerRow][innerCol]);
    }
  }
  `;return`
    var<workgroup> mm_Asub : array<array<f32, ${c}>, ${d}>;
    var<workgroup> mm_Bsub : array<array<f32, ${u}>, ${r}>;

    ${ut()} {
      let batch = ${s?"0":"i32(globalId.z)"};
      let batchA = ${s||!a?"batch":"batch % uniforms.aShape[0]"};
      let batchB = ${s||!a?"batch":"batch % uniforms.bShape[0]"};
      let numTiles = ${s?`${Math.ceil(i/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
      var kStart = ${s?`i32(globalId.z) * ${i}`:"0"};

      var acc : array<array<f32, ${x}>, ${g}>;

      // Without this initialization strange values show up in acc.
      for (var innerRow = 0; innerRow < ${g}; innerRow++) {
        for (var innerCol = 0; innerCol < ${x}; innerCol++) {
          acc[innerRow][innerCol] = 0.0;
        }
      }
      ${w}
    }
  `}const LAe=t=>t?`
      mm_readA(batchA, colA, globalRow),
      mm_readA(batchA, colA + 1, globalRow),
      mm_readA(batchA, colA + 2, globalRow),
      mm_readA(batchA, colA + 3, globalRow)
  `:`
      mm_readA(batchA, globalRow, colA),
      mm_readA(batchA, globalRow, colA + 1),
      mm_readA(batchA, globalRow, colA + 2),
      mm_readA(batchA, globalRow, colA + 3)
  `;function zAe(t,e=!1){ae(t[1]===1&&t[2]===1,()=>`A linear work group size is required. But got ${t}.`);const n=t[0]*4;return`
    var<workgroup> mm_Asub : array<vec4<f32>, ${t[0]}>;

    ${ut()} {
      let tileCol = i32(localId.x);
      let globalCol = i32(globalId.x);
      let globalRow = i32(globalId.y);

      let numTiles = (uniforms.dimInner - 1) / ${n} + 1;
      let batch = i32(globalId.z);
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      // Without this initialization strange values show up in acc.
      var acc = 0.0;

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        let colA = t * ${n} + tileCol * 4;
        mm_Asub[tileCol] = vec4<f32>(${LAe(e)});
        workgroupBarrier();

        // Compute acc values for a single thread.
        for (var k = 0; k < ${n/4}; k++) {
          let rowB = t * ${n} + k * 4;
          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),
                              mm_readB(batchB, rowB + 1, globalCol),
                              mm_readB(batchB, rowB + 2, globalCol),
                              mm_readB(batchB, rowB + 3, globalCol));

          let ACached = mm_Asub[k];
          acc = acc + dot(ACached, BCached);
        }

        workgroupBarrier();
      }

      mm_write(batch, globalRow, globalCol, acc);
    }
  `}let BAe=class{constructor(e,n,r=!1,s=!1,i=null,o=null,a=null,l=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=n,this.dispatchLayout={x:[2],y:[1],z:[0]};const u=r?e[1]:e[2];if(this.isVec4=(u%4===0&&!r||n[1]%4===0&&r)&&n[2]%4===0&&!s,this.outputComponent=this.isVec4?4:1,this.isVectorA=n[1]===1&&!r,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{const h=h_e(n[1],u,n[2],r);this.workgroupSize=h.workgroupSize,this.elementsPerThread=h.elementsPerThread}this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);const c=i!=null,d=a!=null;c&&this.variableNames.push("bias"),d&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=l,this.transposeA=r,this.transposeB=s,this.addBias=c,this.activation=o,this.hasPreluActivationWeights=d,[this.fitAOuter,this.fitBOuter,this.fitInner]=this.getShapeFit(n[1],n[2],u),this.shaderKey=`matMulPacked_${this.elementsPerThread}_${r}_${s}_${this.activation}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.isVectorA}_${this.sequentialAccessByThreads}`}getShapeFit(e,n,r){const s=this.workgroupSize[1]*this.elementsPerThread[1],i=this.workgroupSize[0]*this.elementsPerThread[0];!this.isVec4&&this.isVectorA?this.tileInner=this.workgroupSize[0]*4:this.tileInner=i;const o=e%s===0,a=n%i===0,l=r%this.tileInner===0;return[o,a,l]}getUserCode(){return`
      ${Lc(this.activation,this.hasPreluActivationWeights,this.isVec4)}
      ${CP(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1)}
      ${this.isVec4?BT(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?zAe(this.workgroupSize,this.transposeA):UT(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0)}
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UAe(t){return`
    var<workgroup> sumValues : array<f32, ${t}>;
    ${ut()} {
      let coords = getOutputCoords();
      let batch = coords[0];
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      let row = coords[1];
      let col = coords[2];
      var sum = 0.0;
      let Length = uniforms.dimInner;
      for (var k = i32(localId.x); k < Length; k = k + ${t}) {
        let dataA = mm_readA(batchA, row, k);
        let dataB = mm_readB(batchB, k, col);
        sum = sum + dataA * dataB;
      }
      sumValues[localId.x] = sum;
      workgroupBarrier();

      for(var currentSize = ${t/2}u; currentSize > 1u;
          currentSize = currentSize / 2u) {
        if (localId.x < currentSize)
        {
          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];
        }
        workgroupBarrier();
      }

      if (localId.x == 0u) {
        sum = sumValues[0] + sumValues[1];
        mm_write(batch, row, col, sum);
      }
    }
  `}class VAe{constructor(e,n=!1,r=!1,s=null,i=null,o=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize);const a=s!=null,l=o!=null;a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),this.transposeA=n,this.transposeB=r,this.addBias=a,this.activation=i,this.hasPreluActivationWeights=l,this.shaderKey=`matMulReduce_${this.activation}_${n}_${r}`}getUserCode(){return`
      ${Lc(this.activation,this.hasPreluActivationWeights)}
      ${CP(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${UAe(this.workgroupSize[0])}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jAe(t){const e=t[1],n=t[0],r=e>n?e:n;return`
  var<workgroup> mm_Asub : array<array<f32, ${r}>, ${e}>;
  var<workgroup> mm_Bsub : array<array<f32, ${n}>, ${r}>;

  // If the output size is small for matrix multiplication, avoid to use vec4
  // and handle some elements per thread to optimally utilize the ALU.
  // Read data from global memory to registers firstly, then store them into
  // shared memory, so it is instruction-Level parallelism for arithmetic
  // operations and others handle IO operations between barrier api, makes ALU
  // and load/store units work simultaneously, could improves the performance.
  ${ut()} {
    let tileRow = i32(localId.y);
    let tileCol = i32(localId.x);
    let globalRow = i32(globalId.y);
    let globalCol = i32(globalId.x);
    let batch = i32(globalId.z);
    let batchA = batch % uniforms.aShape[0];
    let batchB = batch % uniforms.bShape[0];

    // uniforms.dimInner should be greater than 0.
    let numTiles = (uniforms.dimInner - 1) / ${r} + 1;
    var acc = 0.0;

    var globalColA = tileCol;
    var globalRowB = 0;
    var regA = mm_readA(batchA, globalRow, globalColA);
    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
    globalColA = globalColA + ${r};
    globalRowB = globalRowB + ${r};

    for (var t = 0; t < numTiles; t = t + 1) {
      mm_Asub[tileRow][tileCol] = regA;
      mm_Bsub[2 * tileRow][tileCol] = regB0;
      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;

      workgroupBarrier();

      regA = mm_readA(batchA, globalRow, globalColA);
      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
      globalColA = globalColA + ${r};
      globalRowB = globalRowB + ${r};

      for (var k = 0; k < ${r}; k = k + 1) {
        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];
      }
      workgroupBarrier();
    }

    mm_write(batch, globalRow, globalCol, acc);
  }
  `}class WAe{constructor(e,n,r,s=!1,i=!1,o=null,a=null,l=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=r,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(r[2]/this.workgroupSize[0]),Math.ceil(r[1]/this.workgroupSize[1]),r[0]];const u=o!=null;u&&this.variableNames.push("bias");const c=l!=null;c&&this.variableNames.push("preluActivationWeights"),this.transposeA=s,this.transposeB=i,this.addBias=u,this.activation=a,this.hasPreluActivationWeights=c,this.shaderKey=`matMulSmallOutputSize_${this.activation}_${s}_${i}`}getUserCode(){return`
      ${Lc(this.activation,this.hasPreluActivationWeights)}
      ${CP(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${jAe(this.workgroupSize)}
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GAe{constructor(e,n,r=!1,s=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,ae(e[0]===1,()=>"MatMulSplitKProgram only supports batch = 1."),this.outputShape=e,this.dispatchLayout={x:[2],y:[1],z:[0,3]};const i=(r&&this.outputShape[1]%4===0||!r&&n%4===0)&&this.outputShape[2]%4===0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=i?4:1,i||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=ct(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],n],this.workgroupSize,this.elementsPerThread),this.transposeA=r,this.transposeB=s,this.shaderKey=`matMulSplitK_${r}_${s}_${this.elementsPerThread}_${this.outputComponent}`}getUserCode(){const e=this.outputComponent;return`
      ${pX(!1,this.transposeB,!1,!1,!1,e)}
      fn mm_write(batch: i32, row : i32, col : i32, value : ${rn(e)}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
          let coords = vec3<i32>(batch, row, col);
          let flatIndex = getOutputIndexFromCoords(coords);
          // The problem is that we should initialize output to zero before using.
          // Otherwise, the original value will be added to the result.
          for (var i = 0; i < ${e}; i = i + 1) {
            ${Ph("&result[flatIndex + i]",`${e>1?"value[i]":"value"}`,"float32")}
          }
        }
      }
      ${e===4?BT(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):UT(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner)}
    `}}class HAe{constructor(e,n=null,r=null,s=null){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n!=null,this.hasPreluActivationWeights=s!=null,this.activation=r,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`biasActivation_${r}`}getUserCode(){return`
    ${Lc(this.activation,this.hasPreluActivationWeights)}
    ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        var value = getXByOutputIndex(index);
        ${Yp(this.addBias,this.activation)}
        setOutputAtIndex(index, value);
      }
    }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let YAe=class{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.size) {
        setOutputAtIndex(index, uniforms.value);
      }
    }
  `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bi(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:i}=n;if(i=i||zp(s),i==="string"){const o=br(i,Ue(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new YAe(r),a=[{type:"float32",data:[s]}];return e.runWebGPUProgram(o,[],i,a)}}const KAe={kernelName:gk,backendName:"webgpu",kernelFunc:Bi};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function It(t){const{inputs:e,attrs:n}=t,{x:r}=e,{shape:s}=n,i=Ue(r.shape),o=hO(s,i),a=Ue(o);return ae(i===a,()=>`The new shape (${o}) has ${a} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),t.backend.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}}const qAe={kernelName:$b,backendName:"webgpu",kernelFunc:It};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VT({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],f=n?t.shape[u-1]:t.shape[u-2],m=r?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),x=e.shape.slice(0,-2),w=Ue(g),b=Ue(x),C=jt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,m]);ae(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const T=n?[w,d,f]:[w,f,d],D=r?[b,m,h]:[b,h,m],P=It({inputs:{x:t},backend:s,attrs:{shape:T}}),I=It({inputs:{x:e},backend:s,attrs:{shape:D}}),E=[P,I],M=Math.max(w,b),O=[P,I],j=[{type:"int32",data:[f]},{type:"int32",data:[m]},{type:"int32",data:[d]}];let R,z;const B=[M,f,m];let V=We().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(V<0){const K=We().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),ne=K>0?K:s.thresholdToIncreaseWorkgroups,fe=M*Math.ceil(f/32)*Math.ceil(m/32);fe<=ne||f<=8&&fe<=ne*2?M*f*m<=128?V=tu.MatMulReduceProgram:M===1&&h>=2e3?V=tu.MatMulSplitKProgram:V=tu.MatMulSmallOutputSizeProgram:V=tu.MatMulPackedProgram}switch(V){case tu.MatMulReduceProgram:R=new VAe(B,n,r,i,l,o);break;case tu.MatMulSplitKProgram:{if(z=Bi({backend:s,attrs:{shape:B,value:0,dtype:t.dtype}}),R=new GAe(B,h,n,r),i||l){z=s.runWebGPUProgram(R,O,t.dtype,j,z);const ne=new HAe(z.shape,i,l,o);let fe=null;const ee=[z];i&&ee.push(i),o&&ee.push(o),l==="leakyrelu"&&(fe=[{type:"float32",data:[a]}],ne.uniforms+=" alpha : f32,");const de=s.runWebGPUProgram(ne,ee,z.dtype,fe);E.push(z);const ge=It({inputs:{x:de},backend:s,attrs:{shape:C}});E.push(de);for(const Z of E)s.disposeData(Z.dataId);return ge}break}case tu.MatMulSmallOutputSizeProgram:R=new WAe(T,D,B,n,r,i,l,o);break;case tu.MatMulPackedProgram:const K=s.adapterInfo.isIntel();R=new BAe(T,B,n,r,i,l,o,K);break;default:throw new Error(`Unsupported MatMulProgramType ${V}.`)}i&&O.push(i),o&&O.push(o),l==="leakyrelu"&&(j.push({type:"float32",data:[a]}),R.uniforms+=" alpha : f32,"),z=s.runWebGPUProgram(R,O,t.dtype,j,z);const H=It({inputs:{x:z},backend:s,attrs:{shape:C}});E.push(z);for(const K of E)s.disposeData(K.dataId);return H}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XAe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return VT({a:s,b:i,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const ZAe={kernelName:Zw,backendName:"webgpu",kernelFunc:XAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let yV=class{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=jt(n,r),this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`binaryOpComplex_${e}`,this.op=e}getUserCode(){return`
      fn binaryOpComplex(
          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {
        ${SP(this.op,!1)}
      }

      ${ut("index")} {
        if(index < uniforms.size) {
          let areal = getARealByOutputIndex(index);
          let aimag = getAImagByOutputIndex(index);
          let breal = getBRealByOutputIndex(index);
          let bimag = getBImagByOutputIndex(index);
          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));
        }
      }
    `}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let DI=class{constructor(e,n,r){if(this.size=!0,this.variableNames=["A","B"],this.outputShape=jt(n,r),this.dispatchLayout=wt(this.outputShape),this.op=e,this.useSharedMemoryWithA=n.length<=1&&r.length>1&&n[0]<128,this.useSharedMemoryWithB=r.length<=1&&n.length>1&&r[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?r[0]:n[0],this.shaderKey=`binary_${e}_${this.lastDimensionSize}`,this.type="shared",this.workgroupSize=[256,1,1];else{const s=n.length>0&&n[n.length-1]%4===0,i=r.length>0&&r[r.length-1]%4===0;s&&i?(this.outputComponent=4,this.variableComponents=[4,4]):s&&(CU(r)||r[r.length-1]===1)||i&&(CU(n)||n[n.length-1]===1)?(this.outputComponent=4,this.variableComponents=s?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey=`binary_${e}_${this.variableComponents}`,this.workgroupSize=[128,1,1]}this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}getUserCode(){let e;const n=this.outputComponent===4?"vec4<f32>":"f32",r=`
    fn binaryOperation(a : ${n}, b : ${n}) -> ${n} {
      ${SP(this.op,this.outputComponent===4)}
    };
    `;if(this.type==="shared"){const s=this.lastDimensionSize>1?`coords[${this.outputShape.length-1}]`:"0",i=this.useSharedMemoryWithB?`let a = getAByOutputIndex(index);
          let b = sharedBuf[${s}];`:`let a = sharedBuf[${s}];
          let b = getBByOutputIndex(index);`;e=`
        ${r}
        var<workgroup> sharedBuf : array<f32, ${this.lastDimensionSize}>;
        ${ut("index")} {
          // Fill in the shared memory buffer.
          let localIndex = i32(localId.x);
          if(localIndex < ${this.lastDimensionSize}) {
            sharedBuf[localIndex] = f32(${this.useSharedMemoryWithB?"B":"A"}[localIndex]);
          }
          workgroupBarrier();

          if(index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            ${i}
            setOutputAtIndex(index, binaryOperation(a, b));
          }
        }
        `}else e=`
       ${r}
       ${ut("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index * ${this.outputComponent});
           let a = ${n}(getAByOutputCoords(coords));
           let b = ${n}(getBByOutputCoords(coords));
           setOutputAtIndex(index, binaryOperation(a, b));
         }
       }
       `;return e}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wo(t){const{inputs:e}=t,{x:n}=e;return t.backend.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const QAe={kernelName:V0,backendName:"webgpu",kernelFunc:wo};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.tensorMap.get(i.dataId),a=wo({inputs:{x:r},backend:n}),l=wo({inputs:{x:s},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const JAe={kernelName:nk,backendName:"webgpu",kernelFunc:Kp};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Cy=class{constructor(e,n,r=""){this.variableNames=["A"],this.size=!0;const s=128;this.workgroupSize=[s,1,1],this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=n,r!==""&&(this.uniforms=r),this.shaderKey=`unary_${n}`}getUserCode(){return`
      fn unaryOperation(a : f32) -> f32 {
        ${Mf(this.op,!1)}
      }
      ${ut("index")} {
        if (index < uniforms.size) {
          let a = getAByOutputIndex(index);
          setOutputAtIndex(index, unaryOperation(a));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wn({opType:t,cpuKernelImpl:e,dtype:n}){return({inputs:r,backend:s})=>{const{x:i}=r,o=s,a=n||i.dtype;if(o.shouldExecuteOnCPU([i])&&e!=null){const u=o.tensorMap.get(i.dataId),c=e(u.values,a);return o.makeTensorInfo(i.shape,a,c)}const l=new Cy(i.shape,t);return o.runWebGPUProgram(l,[i],a)}}function bs({opType:t,cpuKernelImpl:e,supportsComplex:n=!1,dtype:r}){return({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;if(n&&o.dtype==="complex64"){const d=l.tensorMap.get(o.dataId),h=l.tensorMap.get(a.dataId);let f,m;if(t!==Yt.MUL)[f,m]=[[d.complexTensorInfos.real,h.complexTensorInfos.real],[d.complexTensorInfos.imag,h.complexTensorInfos.imag]].map(x=>{const[w,b]=x,S={dataId:w.dataId,dtype:w.dtype,shape:o.shape},C={dataId:b.dataId,dtype:b.dtype,shape:a.shape},T=new DI(t,o.shape,a.shape);return l.runWebGPUProgram(T,[S,C],ws(w.dtype,b.dtype))});else{const x=new yV(Yt.COMPLEX_MULTIPLY_REAL,o.shape,a.shape),w=new yV(Yt.COMPLEX_MULTIPLY_IMAG,o.shape,a.shape),b=[{dataId:d.complexTensorInfos.real.dataId,dtype:d.complexTensorInfos.real.dtype,shape:o.shape},{dataId:d.complexTensorInfos.imag.dataId,dtype:d.complexTensorInfos.imag.dtype,shape:o.shape},{dataId:h.complexTensorInfos.real.dataId,dtype:h.complexTensorInfos.real.dtype,shape:a.shape},{dataId:h.complexTensorInfos.imag.dataId,dtype:h.complexTensorInfos.imag.dtype,shape:a.shape}];f=l.runWebGPUProgram(x,b,"float32"),m=l.runWebGPUProgram(w,b,"float32")}const g=Kp({inputs:{real:f,imag:m},backend:l});return l.disposeData(f.dataId),l.disposeData(m.dataId),g}const u=r||ws(o.dtype,a.dtype);if((o.dtype==="string"||a.dtype==="string"||l.shouldExecuteOnCPU([o,a]))&&e!=null){const d=l.tensorMap.get(o.dataId).values,h=l.tensorMap.get(a.dataId).values,f=o.dtype==="string"?Tl(d):d,m=o.dtype==="string"?Tl(h):h,[g,x]=e(o.shape,a.shape,f,m,u);return l.makeTensorInfo(x,u,g)}const c=new DI(t,o.shape,a.shape);return l.runWebGPUProgram(c,[o,a],u)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kt(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&ae(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const e3e=t=>{const{x:e}=t.inputs,n=t.backend;kt(e,"abs");let r=new Float32Array(Ue(e.shape));const s=n.data.get(e.dataId).values;return r=mX(s),n.makeOutput(r,e.shape,e.dtype)},t3e={kernelName:j1,backendName:"cpu",kernelFunc:e3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(t){return(e,n,r,s,i)=>{const o=jt(e,n),a=o.length,l=$t(o),u=Ue(o),c=is(i,u),d=e.length,h=n.length,f=$t(e),m=$t(n),g=gh(e,o),x=gh(n,o);if(g.length+x.length===0)for(let w=0;w<c.length;++w)c[w]=t(r[w%r.length],s[w%s.length]);else for(let w=0;w<c.length;++w){const b=v0(w,a,l),S=b.slice(-d);g.forEach(P=>S[P]=0);const C=xu(S,d,f),T=b.slice(-h);x.forEach(P=>T[P]=0);const D=xu(T,h,m);c[w]=t(r[C],s[D])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ho(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(s.shape,"float32",o)},a}const n3e={kernelName:nk,backendName:"cpu",kernelFunc:ho};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OI(t,e,n="float32"){if(n==="complex64"){const s=OI(t,e,"float32"),i=OI(t,e,"float32");return ho({inputs:{real:s,imag:i},backend:t})}const r=As(Ue(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tu(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const r3e={kernelName:V0,backendName:"cpu",kernelFunc:Tu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ep(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const s3e={kernelName:Ak,backendName:"cpu",kernelFunc:Ep};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Up([0],n),[i,o]=Rr((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function xh(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return Tu({inputs:{x:s},backend:n});const c=OI(n,s.shape,s.dtype),d=xh({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),h=ho({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),h}if(s.dtype==="complex64"){const c=Ep({inputs:{input:s},backend:n}),d=xh({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),d}if(!fO(s.dtype,i)){const c=Tu({inputs:{x:s},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:i}}const o=n.data.get(s.dataId).values,[a,l,u]=gX(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,u)}const i3e={kernelName:_0,backendName:"cpu",kernelFunc:xh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ls(t,e,n,r){return n==null?({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;kt([o,a],t);const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,d=o.dtype==="string"?Tl(u):u,h=o.dtype==="string"?Tl(c):c,f=r||o.dtype,[m,g]=e(o.shape,a.shape,d,h,f);return l.makeTensorInfo(g,f,m)}:({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const u=xh({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,h=c.complexTensorInfos.imag,f=l.data.get(d.dataId).values,m=l.data.get(h.dataId).values,g=xh({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(g.dataId),w=x.complexTensorInfos.real,b=x.complexTensorInfos.imag,S=l.data.get(w.dataId).values,C=l.data.get(b.dataId).values,[T,D,P]=n(o.shape,a.shape,f,m,S,C),I=l.makeTensorInfo(P,"float32",T),E=l.makeTensorInfo(P,"float32",D),M=ho({inputs:{real:I,imag:E},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(I),l.disposeIntermediateTensorInfo(E),M}else{const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,d=r||o.dtype,[h,f]=e(o.shape,a.shape,u,c,d);return l.makeTensorInfo(f,d,h)}}}function IP(t){return(e,n,r,s,i,o)=>{const a=jt(e,n),l=Ue(a),u=a.length,c=$t(a),d=is("float32",l),h=is("float32",l),f=gh(e,a),m=gh(n,a),g=kl(r,s),x=kl(i,o),w=e.length,b=$t(e),S=n.length,C=$t(n);if(f.length+m.length===0)for(let T=0;T<d.length;T++){const D=T%g.length,P=T%x.length,I=t(g[D*2],g[D*2+1],x[P*2],x[P*2+1]);d[T]=I.real,h[T]=I.imag}else for(let T=0;T<d.length;T++){const D=v0(T,u,c),P=D.slice(-w);f.forEach(j=>P[j]=0);const I=xu(P,w,b),E=D.slice(-S);m.forEach(j=>E[j]=0);const M=xu(E,S,C),O=t(g[I*2],g[I*2+1],x[M*2],x[M*2+1]);d[T]=O.real,h[T]=O.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yX=Rr((t,e)=>t+e),o3e=IP((t,e,n,r)=>({real:t+n,imag:e+r})),Jg=ls(Bp,yX,o3e),a3e={kernelName:Bp,backendName:"cpu",kernelFunc:Jg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(t,e,n,r,s){const i=Ue(r),o=As(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function xX(t,e,n,r=!1){const s=t.shape[0],i=t.shape[1],o=Zt([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<i;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?o.set(1,a,u):e.size>0?o.set(o.get(a,u)+e.get(a,l),a,u):o.set(o.get(a,u)+1,a,u))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX=Rr((t,e)=>t&e),l3e=ls(ek,wX),u3e={kernelName:ek,backendName:"cpu",kernelFunc:l3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fu(t){return(e,n,r)=>{const s=br(n,e.length);for(let i=0;i<e.length;++i)s[i]=t(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rn(t,e,n){const r=Fu(e);return Fh(t,r,n)}function Fh(t,e,n){return({inputs:r,attrs:s,backend:i})=>{const{x:o}=r;kt(o,t);const a=i,l=a.data.get(o.dataId).values;let u;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Tl(l)}else u=l;const c=n||o.dtype,d=e(u,c,s);return a.makeTensorInfo(o.shape,c,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX=Fu(t=>Math.ceil(t)),c3e=Fh(A0,bX),d3e={kernelName:A0,backendName:"cpu",kernelFunc:c3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vX(t,e,n,r){const s=br(n,Ue(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const a=Ue(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?Tl(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const c=u*e[1]+i;for(let d=0;d<o.shape[1];++d)s[c+d]=a[l++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX=Rr((t,e)=>t===e?1:0),CX=ls(ib,SX,null,"bool"),h3e={kernelName:ib,backendName:"cpu",kernelFunc:CX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX=Fu(t=>Math.exp(t)),NX=Fh(F0,IX,"float32"),f3e={kernelName:F0,backendName:"cpu",kernelFunc:NX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX=Fu(t=>Math.expm1(t)),p3e=Fh(L0,kX),m3e={kernelName:L0,backendName:"cpu",kernelFunc:p3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX=Fu(t=>Math.floor(t)),g3e=Fh(z0,TX),y3e={kernelName:z0,backendName:"cpu",kernelFunc:g3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EX=Rr((t,e)=>Math.floor(t/e)),x3e=ls(B0,EX,null,"int32"),w3e={kernelName:B0,backendName:"cpu",kernelFunc:x3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _X(t,e,n,r,s,i,o,a,l){const u=Zt([r,i],n);for(let c=0;c<r;c++){const d=[];let h=0;for(let f=0;f<s;f++){const m=t[c*s+f];h+=m*o[f],d.push(m)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<i;f++)u.values[c*i+f]=e.get(...e.indexToLoc(h*i+f))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AX(t,e,n){const r=Zt(n,t.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],l=o[2],u=e.locToIndex([a,l]);o[2]=e.values[u];const c=t.locToIndex(o);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X=Rr((t,e)=>t>e?1:0),b3e=ls(ub,$X,null,"bool"),v3e={kernelName:ub,backendName:"cpu",kernelFunc:b3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX=Rr((t,e)=>t>=e?1:0),S3e=ls(U0,RX,null,"bool"),C3e={kernelName:U0,backendName:"cpu",kernelFunc:S3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX=Rr((t,e)=>t<e?1:0),I3e=ls(db,MX,null,"bool"),N3e={kernelName:db,backendName:"cpu",kernelFunc:I3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX=Rr((t,e)=>t<=e?1:0),k3e=ls(hb,DX,null,"bool"),T3e={kernelName:hb,backendName:"cpu",kernelFunc:k3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OX(t,e,n){const r=(e-t)/(n-1),s=As(n,"float32");s[0]=t;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX=Fu(t=>Math.log(t)),E3e=Fh(H0,PX),_3e={kernelName:H0,backendName:"cpu",kernelFunc:E3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(t,e,n,r){const s=is(r,Ue(n));for(let i=0;i<s.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const u=t[o+l];(Number.isNaN(u)||u>a)&&(a=u)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX=Rr((t,e)=>Math.max(t,e)),A3e=ls(K0,LX),$3e={kernelName:K0,backendName:"cpu",kernelFunc:A3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX=Rr((t,e)=>Math.min(t,e)),R3e=ls(q0,zX),M3e={kernelName:q0,backendName:"cpu",kernelFunc:R3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kP=Rr((t,e)=>t*e),D3e=IP((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),jT=ls(Z0,kP,D3e),O3e={kernelName:Z0,backendName:"cpu",kernelFunc:jT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BX(t,e,n){const r=Ah(-1,n);return kP([],e,r,t,n)}function P3e(t){const{inputs:e,backend:n}=t,{x:r}=e;kt(r,"neg");const s=n.data.get(r.dataId).values,[i,o]=BX(s,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}const F3e={kernelName:Cb,backendName:"cpu",kernelFunc:P3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UX=Rr((t,e)=>t!==e?1:0),L3e=ls(Ib,UX,null,"bool"),z3e={kernelName:Ib,backendName:"cpu",kernelFunc:L3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(t,e,n,r,s){const i=e.length,o=Ue(e),a=$t(e),l=$t(s),u=is(n,Ue(s));for(let c=0;c<o;++c){const d=v0(c,i,a),h=new Array(d.length);for(let m=0;m<h.length;m++)h[m]=d[r[m]];const f=xu(h,i,l);u[f]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ji(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:i}=n;kt(s,"transpose");const o=s.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=s.shape[i[d]];const l=r.data.get(s.dataId).values,u=TP(l,s.shape,s.dtype,i,a);return{dataId:r.write(u,a,s.dtype),shape:a,dtype:s.dtype}}const B3e={kernelName:tp,backendName:"cpu",kernelFunc:ji};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VX(t,e,n,r){const[s,i]=$r(t,r),o=ws(e,"int32"),a=As(Ue(s),o),l=Ue(i);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let h=0;h<l;++h)d*=n[c+h];a[u]=d}return{outVals:a,outShape:s,outDtype:o}}function U3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;kt(s,"prod");const a=s.shape.length,l=Jt(i,s.shape),u=zn(l,a);let c=l,d=s;const h=[];u!=null&&(d=ji({inputs:{x:s},backend:n,attrs:{perm:u}}),h.push(d),c=qn(c.length,a));const f=n.data.get(d.dataId).values,{outVals:m,outShape:g,outDtype:x}=VX(d.shape,d.dtype,f,c);let w=g;return o&&(w=Cr(g,l)),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(w,x,m)}const V3e={kernelName:Ab,backendName:"cpu",kernelFunc:U3e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3e(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const i=v0(s,e.length,$t(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function W3e(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function G3e(t,e,n,r){const s=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);W3e(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let h=0;h<n.length;++h){const f=n[h],m=h+e.length-1;if(m>=0){const g=a[m],x=g[g.length-1]-f[c];for(let w=c;w<d;++w)a[m].push(f[w+1]+x)}c=f[c],d=f[d]}d!==c&&(s.push([c,d]),i+=d-c)}return{outSplits:a,valueSlices:s,numValues:i}}function H3e(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=br("int32",r);e.push(s),t[n].forEach((i,o)=>s[o]=i)}return e}function xV(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Y3e(t,e,n,r,s,i){const o=xV(e,2)[1],a=xV(i,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)s[l*a+d]=t[c*o+d];++l}}function K3e(t,e,n,r,s){const i=e.slice();i[0]=s;const o=br(n,Ue(i)),a=t.length,l=a===0?0:a/e[0];return Y3e(t,e,r,l,o,i),[o,i]}function jX(t,e,n,r,s,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(j3e(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:h}=G3e(i,o,t,u),f=H3e(c),m=K3e(n,r,s,d,h);return[f,m[0],m[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wV=2147483647;function WX(t,e,n,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=o.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(o[0]);for(let x=1;x<c.length;++x)if(c[x]!==c[x-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],h=br("int32",d+1);h[0]=0;for(let x=0;x<d;++x){const w=a?t[0]:t[x],b=l?r[0]:r[x],S=u?i[0]:i[x];if(S===0)throw new Error("Requires delta != 0");let C;if(S>0&&b<w||S<0&&b>w)C=0;else if(C=Math.ceil(Math.abs((b-w)/S)),C>wV)throw new Error(`Requires ((limit - start) / delta) <= ${wV}`);h[x+1]=h[x]+C}const f=h[d],m=br(n,f);let g=0;for(let x=0;x<d;++x){const w=h[x+1]-h[x];let b=a?t[0]:t[x];const S=u?i[0]:i[x];for(let C=0;C<w;++C)m[g++]=b,b+=S}return[h,m]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ua=hl;class PI{constructor(e,n,r,s,i,o,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=Lq(c),this.raggedRank=zq(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===ua.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===ua.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case ua.VALUE_ROWIDS:return PI.getMaxWidthValueRowID(n);case ua.ROW_SPLITS:return PI.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ua[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return vV(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;Bq(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=Fq(this.raggedRank,s,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=n)i.push(o);for(let a=s;a<e;++a)i.push(-1);return ae(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)o.push(c),c+=r;for(let d=0;d<l-u;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];o.push(u);for(let c=1;c<i;++c){const d=e[c];if(d===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case ua.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,s);case ua.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,s);default:throw new Error(`Unsupported partition type: ${ua[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ua.FIRST_DIM_SIZE:return e[0];case ua.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ua.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ua[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const i=vV(r,!1),o=br(this.valuesDType,Ue(i));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const l=Ue(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const m=this.defaultValueShape;Ve(()=>{const g=Me(c,m);c=Dg(g,a).dataSync()})}let d=0,h=0,f=0;for(let m=0;m<=u;++m){let g=m<u?n[m]:-1;if(g===f){++f;continue}if(h<f){const x=i.subarray(d*l),w=o.subarray(h*l),b=(f-h)*l;bV(w,x,b)}if(m>=u){const x=r.length;g=Math.floor(x/l)}if(g>f)if(this.defaultValue.length===1)o.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const x=o.slice(f*l);bV(x,c,l),++f}g<0?(d=m+1,h=f):(d=m,h=f,f=h+1)}}}function bV(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function vV(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function GX(t,e,n,r,s,i,o,a,l,u){return new PI(t,e,n,r,s,i,o,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(t,e,n,r){const s=t===e,i=t<e&&n<0,o=e<t&&n>1;if(s||i||o)return As(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=As(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YX=Fu(t=>1/Math.sqrt(t)),q3e=Fh(ry,YX),X3e={kernelName:ry,backendName:"cpu",kernelFunc:q3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qf(t,e,n,r,s,i,o,a,l,u){const c=[r/s,s],d=t.values,h=e.values;if(r===0)return Zt(n,e.dtype);const f=l instanceof ns?l:Zt(c,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let m=0;m<i;m++){const g=[];let x=0;for(let w=0;w<o;w++){const b=d[m*o+w];g.push(b),x+=b*a[w]}if(x<0||x>=r/s)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let w=0;w<s;w++)u?f.values[x*s+w]+=h[m*s+w]:f.values[x*s+w]=e.rank===0?h[0]:h[m*s+w]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z3e=Fu(t=>1/(1+Math.exp(-t))),KX=Rn(ly,t=>1/(1+Math.exp(-t))),Q3e={kernelName:ly,backendName:"cpu",kernelFunc:KX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qX(t,e,n,r,s){const i=gP(r,e,n),o=Ue(n),a=$t(r);if(i){const d=yP(e,a);return s==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=s==="string"?Tl(t):t,u=Zt(r,s,l),c=Zt(n,s);for(let d=0;d<c.size;++d){const h=c.indexToLoc(d),f=h.map((m,g)=>m+e[g]);c.set(u.get(...f),...h)}return s==="string"?iX(c.values):c.values}function _p(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r;kt(s,"slice");const[a,l]=Zb(s,i,o);wT(s,a,l);const u=n.data.get(s.dataId).values,c=qX(u,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,c)}const J3e={kernelName:Pb,backendName:"cpu",kernelFunc:_p};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XX(t,e,n,r,s,i,o){const a=e[0],l=i[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(Yq(a));const x=br(n,0),w=br(s,0);return[x,[0,d],w,u,c]}let h=!0,f=0;const m=new Array(l).fill(0);for(let x=0;x<a;++x){const w=t[x*d];if(w<0)throw new Error(Kq(x,w));if(w>=l)throw new Error(qq(x,w,l));++m[w],h=h&&w>=f,f=w}let g=!0;for(let x=0;x<l;++x){const w=m[x]===0;u[x]=w,g=g&&!w,m[x]=Math.max(m[x],1),x>0&&(m[x]+=m[x-1])}if(g&&h){const x=t,w=r;for(let b=0;b<a;++b)c[b]=b;return[x,[a,d],w,u,c]}else{const x=m[l-1],w=br(n,x*d),b=br(s,x),S=new Array(l).fill(0);for(let C=0;C<a;++C){const T=t[C*d],D=S[T],P=(T===0?0:m[T-1])+D;S[T]++;for(let I=0;I<d;++I)w[P*d+I]=t[C*d+I];b[P]=r[C],c[C]=P}for(let C=0;C<l;++C)if(S[C]===0){const D=C===0?0:m[C-1];w[D*d+0]=C;for(let P=1;P<d;++P)w[D*d+P]=0;b[D]=o}return[w,[x,d],b,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(t,e,n,r,s){const i=Ue(r),o=e[0],a=s.length,l=[];let u=1,c=-1;for(let x=0;x<a;++x){const w=s[x];if(w===-1){if(c!==-1)throw new Error(Xq(c,x));c=x,l.push(1)}else{if(w<0)throw new Error(Zq(x,w));u*=w,l.push(w)}}if(c!==-1){if(u<=0)throw new Error(Qq());const x=Math.trunc(i/u);if(u*x!==i)throw new Error(Jq(r,l));l[c]=x}if(Ue(l)!==i)throw new Error(eX(r,l));const h=r.length,f=[];if(h>0){f[h-1]=1;for(let x=h-2;x>=0;--x)f[x]=f[x+1]*r[x+1]}const m=[];if(a>0){m[a-1]=1;for(let x=a-2;x>=0;--x)m[x]=m[x+1]*l[x+1]}const g=br(n,o*a);for(let x=0;x<o;++x){let w=0;for(let b=0;b<h;++b)w+=t[x*h+b]*f[b];for(let b=0;b<a;++b)g[x*a+b]=Math.trunc(w/m[b]),w%=m[b]}return[g,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EP(t,e,n,r,s,i=!1,o=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(DR());const h=e.slice();h[0]=d;const f=h.reduce((S,C)=>S*C,1),m=br(n,f);if(a===0)return d>0&&m.fill(o),[m,h];if(d<=0)throw new Error(DR());let g=0,x=1,w=0,b=s[g];for(;;){let S=0;if(x<a){if(S=s[x],b===S){++x;continue}if(b>=S)throw new Error(tX())}if(b<0||b>=d)throw new Error(nX(b,d));b>w&&m.fill(o,w*u,b*u);for(let C=g;C<x;++C){const T=r[C];if(T<0||T>=l[0])throw new Error(rX(C,r[C],l[0]));for(let D=0;D<u;D++)m[b*u+D]+=t[T*u+D]}if(i)for(let C=0;C<u;C++)m[b*u+C]/=x-g;if(g=x,++x,w=b+1,b=S,x>a)break}return w<d&&m.fill(o,w*u,d*u),[m,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e$e=Fu(t=>Math.sqrt(t)),t$e=Rn(cy,t=>Math.sqrt(t)),n$e={kernelName:cy,backendName:"cpu",kernelFunc:t$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX=Rr((t,e)=>{const n=t-e;return n*n}),r$e=ls(dy,QX),s$e={kernelName:dy,backendName:"cpu",kernelFunc:r$e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX=Fu((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)}),i$e=Fh(Bk,JX),o$e={kernelName:Bk,backendName:"cpu",kernelFunc:i$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eZ(t,e,n,r){const s=Zt(t,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+r[l];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a$e{constructor(e,n,r,s,i,o){this.separator=Cc(e),this.nGramWidths=n,this.leftPad=Cc(r),this.rightPad=Cc(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),u=Math.max(0,l-a),c=Math.max(0,l-(i-(a+1))),d=o-(u+c),h=n+(u>0?0:a-l);let f=0;f+=u*this.leftPad.length;for(let b=0;b<d;++b)f+=e[h+b].length;f+=c*this.rightPad.length;const m=u+c+d-1;f+=m*this.separator.length,r[s+a]=new Uint8Array(f);const g=r[s+a];let x=0;const w=b=>b.forEach(S=>g[x++]=S);for(let b=0;b<u;++b)w(this.leftPad),w(this.separator);for(let b=0;b<d-1;++b)w(e[h+b]),w(this.separator);if(d>0){w(e[h+d-1]);for(let b=0;b<c;++b)w(this.separator),w(this.rightPad)}else{for(let b=0;b<c-1;++b)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=s-1,o=br("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=i;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),o[l]=o[l-1]+c}const a=new Array(o[i]);for(let l=0;l<i;++l){const u=n[l];let c=o[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,u,a,c,f,d),c+=f}),this.preserveShort&&c===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,u,a,c,1,h)}}return[a,o]}}function tZ(t,e,n,r,s,i,o,a){return new a$e(n,r,s,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$e(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&r.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(s,i);(!n||o.length!==0)&&r.push(o),s=i+1}}function nZ(t,e,n){const r=t.length,s=[];let i=0,o=0;const a=new Array(r);for(let h=0;h<r;++h){const f=s.length;l$e(t[h],e,n,s);const m=s.length-f;a[h]=m,i+=m,o=Math.max(o,m)}const l=br("int32",i*2),u=new Array(i),c=[r,o];let d=0;for(let h=0;h<r;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,u[d]=s[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rZ(t,e){const n=br("int32",t.length);for(let r=0;r<t.length;++r)n[r]=xbe(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sZ=Rr((t,e)=>t-e),u$e=IP((t,e,n,r)=>({real:t-n,imag:e-r})),_P=ls(hy,sZ,u$e),c$e={kernelName:hy,backendName:"cpu",kernelFunc:_P};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iZ(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=Zt(n,t.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iw=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function oZ(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*c/a+d)),f=Math.min(r,Math.floor(e+(a-l)*c/a+d));oZ(t,e,h,f)}const s=t[e];let i=n,o=r;for(hg(t,n,e),iw(t[r],s)>0&&hg(t,n,r);i<o;){for(hg(t,i,o),i++,o--;iw(t[i],s)<0;)i=i+1;for(;iw(t[o],s)>0;)o=o-1}iw(t[n],s)===0?hg(t,n,o):(o=o+1,hg(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function aZ(t,e,n,r,s){const i=e[e.length-1],[o,a]=[t.length/i,i],l=is(n,o*r),u=is("int32",o*r);for(let d=0;d<o;d++){const h=d*a,f=t.subarray(h,h+a);let m=new Array(f.length);f.forEach((b,S)=>m[S]={value:b,index:S}),r<m.length&&(oZ(m,r),m=m.slice(0,r)),s&&m.sort(iw);const g=d*r,x=l.subarray(g,g+r),w=u.subarray(g,g+r);for(let b=0;b<r;b++)x[b]=m[b].value,w[b]=m[b].index}const c=e.slice();return c[c.length-1]=r,[Zt(c,n,l),Zt(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZ(t,e,n,r){const s=Jt(e,n)[0],i=[1,n[0],1];for(let m=0;m<s;m++)i[0]*=n[m];i[1]=n[s];for(let m=s+1;m<n.length;m++)i[2]*=n[m];const o=new Map,a=new Int32Array(n[s]),l=new ns(i,r,t),u=[],c=i[0]===1&&i[2]===1;for(let m=0;m<n[s];m++){let g;if(c)g=t[m].toString();else{const w=[];for(let b=0;b<i[0];b++)for(let S=0;S<i[2];S++)w.push(l.get(b,m,S));g=w.join(",")}const x=o.get(g);if(x!=null)a[m]=x;else{const w=o.size;o.set(g,w),a[m]=w,u.push(m)}}const d=i.slice();d[1]=o.size;const h=new ns(d,r);u.forEach((m,g)=>{for(let x=0;x<i[0];x++)for(let w=0;w<i[2];w++)h.set(l.get(x,m,w),x,g,w)});const f=n.slice();return f[s]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uZ=Object.freeze(Object.defineProperty({__proto__:null,addImpl:yX,bincountImpl:NP,bincountReduceImpl:xX,bitwiseAndImpl:wX,castImpl:gX,ceilImpl:bX,concatImpl:vX,equalImpl:SX,expImpl:IX,expm1Impl:kX,floorDivImpl:EX,floorImpl:TX,gatherNdImpl:_X,gatherV2Impl:AX,greaterEqualImpl:RX,greaterImpl:$X,lessEqualImpl:DX,lessImpl:MX,linSpaceImpl:OX,logImpl:PX,maxImpl:FX,maximumImpl:LX,minimumImpl:zX,multiplyImpl:kP,negImpl:BX,notEqualImpl:UX,prodImpl:VX,raggedGatherImpl:jX,raggedRangeImpl:WX,raggedTensorToTensorImpl:GX,rangeImpl:HX,rsqrtImpl:YX,scatterImpl:qf,sigmoidImpl:Z3e,simpleAbsImpl:mX,sliceImpl:qX,sparseFillEmptyRowsImpl:XX,sparseReshapeImpl:ZX,sparseSegmentReductionImpl:EP,sqrtImpl:e$e,squaredDifferenceImpl:QX,staticRegexReplaceImpl:JX,stridedSliceImpl:eZ,stringNGramsImpl:tZ,stringSplitImpl:nZ,stringToHashBucketFastImpl:rZ,subImpl:sZ,tileImpl:iZ,topKImpl:aZ,transposeImpl:TP,uniqueImpl:lZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:d$e,castImpl:h$e,ceilImpl:f$e,concatImpl:p$e,equalImpl:m$e,expImpl:g$e,expm1Impl:y$e,floorImpl:x$e,floorDivImpl:w$e,gatherNdImpl:b$e,gatherV2Impl:v$e,greaterEqualImpl:S$e,greaterImpl:C$e,lessEqualImpl:I$e,lessImpl:N$e,logImpl:k$e,maxImpl:T$e,maximumImpl:E$e,minimumImpl:_$e,multiplyImpl:A$e,negImpl:$$e,notEqualImpl:R$e,prodImpl:M$e,rangeImpl:D$e,rsqrtImpl:O$e,scatterImpl:P$e,simpleAbsImpl:F$e,sliceImpl:L$e,stridedSliceImpl:z$e,stringNGramsImpl:B$e,subImpl:U$e,tileImpl:V$e,topKImpl:j$e,transposeImpl:W$e}=uZ;/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$e=wn({opType:ot.ABS,cpuKernelImpl:F$e}),H$e={kernelName:j1,backendName:"webgpu",kernelFunc:G$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y$e=wn({opType:ot.ACOS}),K$e={kernelName:S0,backendName:"webgpu",kernelFunc:Y$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q$e=wn({opType:ot.ACOSH}),X$e={kernelName:C0,backendName:"webgpu",kernelFunc:q$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z$e=bs({opType:Yt.ADD,cpuKernelImpl:d$e,supportsComplex:!0}),Q$e={kernelName:Bp,backendName:"webgpu",kernelFunc:Z$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let J$e=class{constructor(e){this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e[0],this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}getUserCode(){const e=[];this.variableNames.forEach(s=>{e.push(`let v${s} = get${s}ByOutputCoords(coords);`)});const n=this.variableNames.map(s=>`v${s}`).join(" + ");return`
      ${ut("index")} {
        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if (flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            ${e.join(`
        `)}
            setOutputAtIndex(flatIndex, ${n});
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eRe(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return wo({inputs:{x:r[0]},backend:n});const s=r.map(a=>a.dtype).reduce((a,l)=>ws(a,l)),i=r.map(a=>a.shape),o=new J$e(i);return n.runWebGPUProgram(o,r,s)}const tRe={kernelName:W1,backendName:"webgpu",kernelFunc:eRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nRe{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[16,16,1];const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[n[s]];this.outputShape=r,this.dispatchLayout={x:[0],y:[1]},this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}getUserCode(){ae(this.workgroupSize[0]===this.workgroupSize[1],()=>`Must be a square tile, current tile shape is ${this.workgroupSize[0]} x ${this.workgroupSize[1]}`);const e=this.workgroupSize[0];return`
      var<workgroup> tile : array<array<f32, ${this.workgroupSize[0]+1}>, ${this.workgroupSize[0]}>;
      ${ut()} {
        var x = i32(workgroupId.x) * ${e} + i32(localId.x);
        var y = i32(workgroupId.y) * ${e} + i32(localId.y);
        let width = uniforms.outShape[0];
        let height = uniforms.outShape[1];
        if (x < width && y < height) {
          tile[localId.y][localId.x] = f32(A[y * width + x]);
        }
        workgroupBarrier();

        x = i32(workgroupId.y) * ${e} + i32(localId.x);
        y = i32(workgroupId.x) * ${e} + i32(localId.y);
        if (x < height && y < width) {
          setOutputAtIndex((y * height + x), tile[localId.x]
            [localId.y]);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rRe=class{constructor(e,n){this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[n[s]];this.outputShape=r,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=n,this.shaderKey=`transpose_${n}`}getUserCode(){const e=Ar(this.outputShape.length),n=cZ(this.newDim);return`
      ${ut("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            setOutputAtIndex(flatIndex, A[getIndexFromCoords${this.outputShape.length}D(
              ${e}(${n}), uniforms.aShape)]);
          }
        }
      }
    `}};function cZ(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=new Array(e);for(let r=0;r<t.length;r++)n[t[r]]=`coords.${Nc(r)}`;return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eu(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,o=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[i[c]];if(n.shouldExecuteOnCPU([s])){const d=o.tensorMap.get(s.dataId).values,h=W$e(d,s.shape,s.dtype,i,l);return n.makeTensorInfo(l,s.dtype,h)}if(s.shape.length===2&&nn(i,[1,0])){const c=new nRe(s.shape,i);return o.runWebGPUProgram(c,[s],s.dtype)}const u=new rRe(s.shape,i);return o.runWebGPUProgram(u,[s],s.dtype)}const sRe={kernelName:tp,backendName:"webgpu",kernelFunc:Eu};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let iRe=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[e.batchSize,e.inSize];const[s]=$r(this.inputShape,[1]);this.outputShape=s.length===0?[1]:s,e.inSize>=32768&&r>=512?this.workgroupSize=[512,1,1]:e.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=n,this.shaderKey=`reduce_${n}`}getUserCode(){let e="",n="0.0";const r=this.workgroupSize[0];this.reduceType==="min"||this.reduceType==="max"?(e=`
         if (isnan(candidate)) {
          bestValue = uniforms.NAN;
         } else if (!isnan(bestValue) && candidate ${this.reduceType==="min"?"<":">"} bestValue)
           {  bestValue = candidate; }`,n="f32(x[offset])"):this.reduceType==="sum"||this.reduceType==="mean"?e=" bestValue = bestValue + candidate; ":this.reduceType==="prod"?(e=" bestValue = bestValue * candidate; ",n="1.0"):this.reduceType==="all"?(e=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",n="1.0"):this.reduceType==="any"&&(e=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",n="0.0");const s=this.reduceType==="mean"?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);";return`
       fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
       }

       ${`
         var<workgroup> xBestValues : array<f32, ${r}>;
       `}
       fn getOffset(outputIndex : i32) -> i32 {
         let outputCoords = getCoordsFromIndex(outputIndex);
         let offset = ${this.outputShape.length===1?"outputCoords":"outputCoords[0]"} * uniforms.reduceSize;
          return offset;
       }
       ${ut("index")} {
         let outputIndex = index / ${r};
         let offset = getOffset(outputIndex);
         var bestValue = ${n};
         let Length = uniforms.reduceSize;
         let WorkPerThread = DIV_CEIL(u32(Length), ${r}u);
         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;
             k = k + ${r}) {
           let candidate = f32(x[offset + k]);
           ${e}
         }
         xBestValues[localId.x] = bestValue;
         workgroupBarrier();

         var reduceSize = min(u32(Length), ${r}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            ${e}
            xBestValues[localId.x] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (localId.x == 0u && outputIndex < uniforms.size) {
          ${s}
        }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oRe={mean:"float32",all:"bool",any:"bool"};function qp(t,e,n,r,s){const i=t.shape.length,o=[],a=Jt(e,t.shape);let l=a;const u=zn(l,i);let c=t;u!=null&&(c=Eu({inputs:{x:t},attrs:{perm:u},backend:s}),l=qn(l.length,i),o.push(c)),Wr(r,l,i);const[d,h]=$r(c.shape,l);let f=d;n&&(f=Cr(d,a));let m;if((r==="max"||r==="prod")&&s.shouldExecuteOnCPU([c])){const g=s.tensorMap.get(c.dataId).values;switch(r){case"max":const x=T$e(g,Ue(h),f,t.dtype);m=s.makeTensorInfo(f,t.dtype,x);break;case"prod":const{outVals:w,outShape:b,outDtype:S}=M$e(c.shape,c.dtype,g,l);m=s.makeTensorInfo(b,S,w);break;default:throw new Error(`${r} CPU implementation is not yet supported.`)}}else{const g=Ue(h),w=Ue(c.shape)/g,b={windowSize:g,inSize:g,batchSize:w,outSize:1},S=oRe[r]||Yk(t.dtype),C=[{type:"int32",data:[g]}],T=new iRe(b,r,s.device.limits.maxComputeWorkgroupSizeX),D=s.runWebGPUProgram(T,[c],S,C);o.push(D),m=It({inputs:{x:D},attrs:{shape:f},backend:s})}return o.forEach(g=>s.disposeData(g.dataId)),m}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:i,axis:o}=r;return qp(s,o,i,"all",n)}const lRe={kernelName:qN,backendName:"webgpu",kernelFunc:aRe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:i,axis:o}=r;return qp(s,o,i,"any",n)}const cRe={kernelName:XN,backendName:"webgpu",kernelFunc:uRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dZ=class{constructor(e,n,r){this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;const s=[n];this.op=r==="min"?"<":">";const[i,o]=$r(e,s);this.outputShape=i.length===0?[1]:i,this.dispatchLayout=wt(this.outputShape),Ue(o)<32?(this.type="plain",this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=ct(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=e,this.shaderKey=`argMinMax_${this.op}_${this.type}`}getUserCode(){const e=this.workgroupSize[0],n=()=>this.inputShape.length===1?"uniforms.xShape":`uniforms.xShape.${Nc(this.inputShape.length-1)}`,r=()=>{let s="";if(this.outputShape.length===1)this.inputShape.length!==1&&(s+="outputCoords,");else for(let i=0;i<this.outputShape.length;i++)s+=`outputCoords.${Nc(i)},`;return s};return this.type==="shared"?`
      fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
      }

      ${`
      var<workgroup> xBestIndices : array<i32, ${e}>;
      var<workgroup> xBestValues : array<f32, ${e}>;
    `}

      ${ut("index")} {
        let outputIndex = index / ${e};
        let reduceLength = ${n()};

        var bestIndex = i32(localId.x);
        var bestValue = uniforms.infinityValue;
        let outputCoords = getCoordsFromIndex(outputIndex);
        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;
            k = k + ${e}) {
          let candidate = getX(${r()} k);
          if (!isnan(candidate) && candidate ${this.op} bestValue) {
            bestValue = candidate;
            bestIndex = k;
          }
        }
        xBestValues[localId.x] = bestValue;
        xBestIndices[localId.x] = bestIndex;
        workgroupBarrier();

        var reduceSize = min(u32(reduceLength), ${e}u);
        for (var currentSize = reduceSize / 2u; reduceSize > 1u;
            currentSize = reduceSize / 2u) {
          let interval = DIV_CEIL(reduceSize, 2u);
          if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              xBestValues[localId.x] = bestValue;
              xBestIndices[localId.x] = xBestIndices[localId.x + interval];
            }
          }
          reduceSize = interval;
          workgroupBarrier();
        }

        if (localId.x == 0u && outputIndex < uniforms.size) {
          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);
        }
      }
    `:`
      ${ut("index")} {
        if (index < uniforms.size) {
          let outputCoords = getCoordsFromIndex(index);
          var bestIndex = 0;
          var bestValue = getX(${r()} 0);
          let reduceLength = ${n()};
          for (var i = 1; i < reduceLength; i++) {
            let candidate = getX(${r()} i);
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              bestIndex = i;
            }
          }
          setOutputAtIndexI32(index, bestIndex);
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Jt(i,s.shape);const a=zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Eu({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=qn(o.length,l.shape.length)),Wr("argMax",[o[0]],l.shape.length);const c=new dZ(l.shape,o[0],"max"),d=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],h=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(f=>n.disposeData(f.dataId)),h}const hRe={kernelName:G1,backendName:"webgpu",kernelFunc:dRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Jt(i,s.shape);const a=zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Eu({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=qn(o.length,l.shape.length)),Wr("argMin",[o[0]],l.shape.length);const c=new dZ(l.shape,o[0],"min"),d=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],h=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(f=>n.disposeData(f.dataId)),h}const pRe={kernelName:H1,backendName:"webgpu",kernelFunc:fRe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mRe=wn({opType:ot.ASIN}),gRe={kernelName:I0,backendName:"webgpu",kernelFunc:mRe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yRe=wn({opType:ot.ASINH}),xRe={kernelName:N0,backendName:"webgpu",kernelFunc:yRe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wRe=wn({opType:ot.ATAN}),bRe={kernelName:k0,backendName:"webgpu",kernelFunc:wRe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vRe=bs({opType:Yt.ATAN2}),SRe={kernelName:E0,backendName:"webgpu",kernelFunc:vRe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CRe=wn({opType:ot.ATANH}),IRe={kernelName:T0,backendName:"webgpu",kernelFunc:CRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NRe{constructor(e){this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];

          let xRCCorner = coords.yz * uniforms.strides;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          let value = getX(batch, xRCorner, xCCorner, d);
          setOutputAtIndex(index, value);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let l1=class{constructor(e,n,r=!1,s=!1,i=!1){if(this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=s,this.includeBatchIndex=i,this.shaderKey=`pool2D_${n}_${r}_${s}_${i}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue = resultValue + value; count = count + 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];
          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {
            let xR = xRCorner + wR;

            if (xR < 0 || xR >= uniforms.convDims.x) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {
              let xC = xCCorner + wC;
              if (xC < 0 || xC >= uniforms.convDims.y) {
                continue;
              }

              let value = getX(batch, xR, xC, d);
              ${e}
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}},AP=class{constructor(e,n,r=!1,s=!1,i=!1){if(this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=s,this.includeBatchIndex=i,this.shaderKey=`pool3D_${n}_${r}_${s}_${i}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue += value; count += 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords.x;
          let ch = coords.u;

          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
          let xDCorner = xCorner.x;
          let xRCorner = xCorner.y;
          let xCCorner = xCorner.z;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {
            let xD = xDCorner + wD;
            if (xD < 0 || xD >= uniforms.convDims.x) {
              continue;
            }

            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {
              let xR = xRCorner + wR;
              if (xR < 0 || xR >= uniforms.convDims.y) {
                continue;
              }

              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {
                let xC = xCCorner + wC;
                if (xC < 0 || xC >= uniforms.convDims.z) {
                  continue;
                }

                let value = getX(batch, xD, xR, xC, ch);
                ${e}
              }
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r;return qp(s,i,o,"max",n)}const kRe={kernelName:yb,backendName:"webgpu",kernelFunc:hZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:i,axis:o}=r;return qp(s,o,i,"mean",n)}const TRe={kernelName:bb,backendName:"webgpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pZ(t,e,n,r){if(e.filterWidth===1&&e.filterHeight===1&&nn(e.inShape,e.outShape))return wo({inputs:{x:t},backend:r});if(e.filterWidth===e.inWidth&&e.filterHeight===e.inHeight&&e.batchSize===1&&e.padInfo.type==="VALID"){const o=t.shape.length,a=It({inputs:{x:t},backend:r,attrs:{shape:[t.shape[o-3]*t.shape[o-2],t.shape[o-1]]}});let l;n==="avg"?l=fZ({inputs:{x:a},backend:r,attrs:{axis:0,keepDims:!1}}):(ae(n==="max",()=>`Invalid pool type ${n}`),l=hZ({inputs:{x:a},backend:r,attrs:{reductionIndices:0,keepDims:!1}}));const u=It({inputs:{x:l},backend:r,attrs:{shape:e.outShape}});return r.disposeData(a.dataId),r.disposeData(l.dataId),u}let s;const i=[{type:"int32",data:[e.strideHeight,e.strideWidth]}];return e.filterHeight===1&&e.filterWidth===1?s=new NRe(e):(n==="avg"?s=new l1(e,"avg"):(ae(n==="max",()=>`Invalid pool type ${n}`),s=new l1(e,"max")),i.push({type:"int32",data:[e.padInfo.top,e.padInfo.left]},{type:"int32",data:[e.dilationHeight,e.dilationWidth]},{type:"int32",data:[e.inHeight,e.inWidth]},{type:"int32",data:[e.effectiveFilterHeight,e.effectiveFilterWidth]})),r.runWebGPUProgram(s,[t],t.dtype,i)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,c=Ws(s.shape,i,o,1,a,l);return pZ(s,c,"avg",n)}const _Re={kernelName:Y1,backendName:"webgpu",kernelFunc:ERe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ARe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Xo(s.shape,i,o,c,a,u,l),h=new AP(d,"avg"),f=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[s],s.dtype,f)}const $Re={kernelName:K1,backendName:"webgpu",kernelFunc:ARe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let RRe=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}getUserCode(){return`
      ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);

            dotProd = dotProd + dyValue * uniforms.avgMultiplier;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},MRe=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}getUserCode(){return`
      ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              dotProd += dyValue * uniforms.avgMultiplier;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DRe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=Xo(o.shape,a,l,1,u,c),h=new MRe(d),f=1/(d.filterDepth*d.filterHeight*d.filterWidth),m=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.effectiveFilterDepth-1-d.padInfo.front,d.effectiveFilterHeight-1-d.padInfo.top,d.effectiveFilterWidth-1-d.padInfo.left]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]},{type:"int32",data:[d.outDepth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"float32",data:[f]}];return n.runWebGPUProgram(h,[s],o.dtype,m)}const ORe={kernelName:QN,backendName:"webgpu",kernelFunc:DRe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PRe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;fX([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Ws(o.shape,a,l,1,u),d=new RRe(c),h=1/(c.filterHeight*c.filterWidth),f=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.effectiveFilterHeight-1-c.padInfo.top,c.effectiveFilterWidth-1-c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]},{type:"int32",data:[c.outHeight]},{type:"int32",data:[c.outWidth]},{type:"float32",data:[h]}];return n.runWebGPUProgram(d,[s],o.dtype,f)}const FRe={kernelName:ZN,backendName:"webgpu",kernelFunc:PRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LRe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return VT({a:s,b:i,transposeA:o,transposeB:a,backend:n})}const zRe={kernelName:q1,backendName:"webgpu",kernelFunc:LRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let BRe=class{constructor(e,n){this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.rank=n.length,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=e,this.uniforms=`start : ${Ar(e.length)}, `,this.shaderKey="slice"}getUserCode(){const e=Ar(this.rank),n=URe(this.rank);let r;return this.start.length===1?r=this.outputShape.map((i,o)=>"sourceLoc = uniforms.start + coords;"):r=this.outputShape.map((i,o)=>`sourceLoc.${HR[o]} = uniforms.start.${Nc(o)} + coords.${HR[o]};`),`
      ${ut("index")} {
        if (index < uniforms.size) {
          var sourceLoc : ${e};
          let coords = getCoordsFromIndex(index);
          ${r.join(`
`)}
          setOutputAtIndex(index, getSource(${n}));
        }
      }
    `}};const HR=["x","y","z","w","u","v"];function URe(t){if(t===1)return"sourceLoc";if(t<=6)return HR.slice(0,t).map(e=>`sourceLoc.${e}`).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iy(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r,[a,l]=Zb(s,i,o);if(wT(s,a,l),n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.tensorMap.get(s.dataId),h=L$e(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,h)}if(Ue(l)===0)return n.makeTensorInfo(l,s.dtype,[]);const u=new BRe(a,l),c=[{type:"int32",data:a}];return n.runWebGPUProgram(u,[s],s.dtype,c)}const VRe={kernelName:Pb,backendName:"webgpu",kernelFunc:Iy};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jRe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;ae(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet");const a=i.reduce((b,S)=>b*S),l=Wp(s.shape,i,a),u=Gp(l.length,i.length),c=Hp(s.shape,i,a),d=NT(o,i.length),h=kT(c,o,i.length),f=[],m=It({inputs:{x:s},backend:n,attrs:{shape:l}}),g=Eu({inputs:{x:m},backend:n,attrs:{perm:u}}),x=It({inputs:{x:g},backend:n,attrs:{shape:c}}),w=Iy({inputs:{x},backend:n,attrs:{begin:d,size:h}});return f.push(m),f.push(g),f.push(x),f.forEach(b=>n.disposeData(b.dataId)),w},WRe={kernelName:X1,backendName:"webgpu",kernelFunc:jRe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GRe=`
  fn bincount_write(index: i32, value: f32) {
    ${Ph("&result[index]","value","float32")}
  }
`,HRe=`
  fn bincount_write(index: i32, value: f32) {
    atomicStore(&result[index], bitcast<i32>(value));
  }
`;class mZ{constructor(e,n,r=!1){this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=e,this.rank=e.length,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=r,r&&(this.atomic=!1),this.hasWeights=n,this.hasWeights&&this.variableNames.push("w"),this.shaderKey=`bincount_${this.hasWeights}_${this.binaryOutput}_${this.rank}`}getUserCode(){return`
    ${this.binaryOutput?HRe:GRe}
  ${ut("index")} {
    ${this.rank===1?`if (index < uniforms.xShape) {
      let indexVal = i32(getX(index));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(index)":"1."};
        bincount_write(indexVal, value);
      }
    }`:`let coord = getCoordsFromIndex(index);
    if (coordsInBounds2D(coord, uniforms.xShape)) {
      let indexVal = i32(getX(coord[0], coord[1]));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1."};
        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);
      }
    }`}
  }
  `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=Ue(s.shape),u=Ue(i.shape)>0,c=[o],d=i.dtype,h=Bi({backend:n,attrs:{shape:c,value:0,dtype:d}}),f=new mZ([a],u),m=[{type:"int32",data:[o]}],g=u?[s,i]:[s];return n.runWebGPUProgram(f,g,d,m,h)}const KRe={kernelName:JN,backendName:"webgpu",kernelFunc:YRe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qRe{constructor(e){this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}getUserCode(){return`
  ${ut("index")} {
    if (index < uniforms.size) {
      var s0 = 1.0;
      var s1 = 1.0;
      let indexS0 = index - uniforms.size + uniforms.s0Size;
      let indexS1 = index - uniforms.size + uniforms.s1Size;
      if (indexS0 >= 0) {
        s0 = getS0(indexS0);
      }
      if (indexS1 >= 0) {
        s1 = getS1(indexS1);
      }

      if (s0 == 1.0) {
        setOutputAtIndex(index, s1);
      } else if (s1 == 1.0) {
        setOutputAtIndex(index, s0);
      } else if (s0 != s1) {
        setOutputAtIndex(index, uniforms.NAN);
      } else {
        setOutputAtIndex(index, s0);
      }
    }
  }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XRe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e;if(n.shouldExecuteOnCPU([r,s])){const c=n.tensorMap.get(r.dataId),d=n.tensorMap.get(s.dataId),h=c.values,f=d.values,m=jt(Array.from(h),Array.from(f));return n.makeTensorInfo([m.length],"int32",Int32Array.from(m))}const i=Ue(r.shape),o=Ue(s.shape),a=Math.max(i,o),l=new qRe(a),u=[{type:"int32",data:[i]},{type:"int32",data:[o]}];return n.runWebGPUProgram(l,[r,s],"int32",u)}const ZRe={kernelName:tk,backendName:"webgpu",kernelFunc:XRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gZ=bs({opType:Yt.NOT_EQUAL,dtype:"bool",cpuKernelImpl:R$e}),QRe={kernelName:Ib,backendName:"webgpu",kernelFunc:gZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ev(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.tensorMap.get(r.dataId);return wo({inputs:{x:s.complexTensorInfos.real},backend:n})}const JRe={kernelName:Ak,backendName:"webgpu",kernelFunc:ev};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eMe(t,e){const n=new Cy(t.shape,ot.TO_INT),r=e.runWebGPUProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YR(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return wo({inputs:{x:s},backend:n});const o=_r(s.shape),a=YR({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=Kp({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeData(a.dataId),l}if(s.dtype==="complex64"){const o=ev({inputs:{input:s},backend:n}),a=YR({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeData(o.dataId),a}if(!fO(s.dtype,i)){const o=wo({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([s])){const o=n.tensorMap.get(s.dataId).values,[a,l,u]=h$e(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,u)}if(i==="int32")return eMe(s,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",is("bool",1)),l=gZ({inputs:{a:s,b:o},backend:n});return n.disposeData(o.dataId),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const tMe={kernelName:_0,backendName:"webgpu",kernelFunc:YR};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nMe=wn({opType:ot.CEIL,cpuKernelImpl:f$e}),rMe={kernelName:A0,backendName:"webgpu",kernelFunc:nMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sMe{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}getUserCode(){return`
      ${ut("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          var clampedValue = clamp(
              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));
          clampedValue = select(clampedValue, value, isnanVec4(value));
          setOutputAtIndex(index, clampedValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let iMe=class{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}getUserCode(){return`
      ${ut("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          if (isnan(value)) {
            setOutputAtIndex(index, value);
            return;
          }
          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;const l=[{type:"float32",data:[i]},{type:"float32",data:[o]}];return Ue(s.shape)%4===0?a=new sMe(s.shape):a=new iMe(s.shape),n.runWebGPUProgram(a,[s],s.dtype,l)}const aMe={kernelName:$0,backendName:"webgpu",kernelFunc:oMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let lMe=class{constructor(e){this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.size) {
        let re = abs(getRealByOutputIndex(index));
        let im = abs(getImagByOutputIndex(index));
        let mx = max(re, im);

        // The length function in wgsl may be not underflow-safe on some GPUs.
        // So the safe solution is to ensure underflow-safety in all cases.
        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function uMe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.tensorMap.get(r.dataId),i=new lMe(r.shape),o=[SV(r,s.complexTensorInfos.real),SV(r,s.complexTensorInfos.imag)];return n.runWebGPUProgram(i,o,o[0].dtype)}const cMe={kernelName:Z1,backendName:"webgpu",kernelFunc:uMe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dMe=class{constructor(e){this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=zi(e,1),this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=e.length-1;for(let n=0;n<this.offsetLength;n++)this.uniforms+=`offset${n} : i32,`;this.shaderKey="concat"}getUserCode(){const e=[];if(this.offsetLength>0){e.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(let i=1;i<this.offsetLength;i++)e.push(`else if (yC < uniforms.offset${[i]}){ setOutputAtCoords(coords.x, coords.y, getT${i}(yR, yC - uniforms.offset${i-1})); }`);const r=this.offsetLength,s=this.offsetLength-1;e.push(`else { setOutputAtCoords(coords.x, coords.y, getT${r}(yR, yC - uniforms.offset${s})); }`)}else e.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return`
      ${ut("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            let yR = coords.x;
            let yC = coords.y;

            ${e.join(`
        `)}
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WT(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.tensorMap.get(r.dataId);return wo({inputs:{x:s.complexTensorInfos.imag},backend:n})}const hMe={kernelName:bk,backendName:"webgpu",kernelFunc:WT};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ow(t,e,n){const r=t[0].dtype;if(r==="complex64"){const m=t.map(S=>ev({inputs:{input:S},backend:n})),g=t.map(S=>WT({inputs:{input:S},backend:n})),x=ow(m,e,n),w=ow(g,e,n),b=Kp({inputs:{real:x,imag:w},backend:n});return m.forEach(S=>n.disposeData(S.dataId)),g.forEach(S=>n.disposeData(S.dataId)),n.disposeData(x.dataId),n.disposeData(w.dataId),b}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const m=t.map(T=>{const P=[-1,Ue(T.shape.slice(e))];return It({inputs:{x:T},backend:n,attrs:{shape:P}})}),g=m.map(T=>({vals:n.readSync(T.dataId),shape:T.shape})),x=zi(m.map(T=>T.shape),1),w=m[0].shape[0]===1,b=p$e(g,x,r,w),S=zi(t.map(T=>T.shape),e),C=n.makeTensorInfo(S,r,b);return m.forEach(T=>n.disposeData(T.dataId)),C}const i=n.device.limits.maxStorageBuffersPerShaderStage-1;if(t.length>i){const m=[];for(let x=0;x<t.length;x+=i){const w=t.slice(x,x+i);m.push(ow(w,e,n))}const g=ow(m,e,n);for(const x of m)n.disposeData(x.dataId);return g}const{tensors2D:o,outShape:a}=fMe(t,e,n),l=o.map(m=>m.shape),u=new dMe(l),c=[],d=new Array(l.length-1);if(d.length>0){d[0]=l[0][1],c.push({type:"int32",data:[d[0]]});for(let m=1;m<d.length;m++)d[m]=d[m-1]+l[m][1],c.push({type:"int32",data:[d[m]]})}const h=n.runWebGPUProgram(u,o,o[0].dtype,c);o.forEach(m=>n.disposeData(m.dataId));const f=It({inputs:{x:h},backend:n,attrs:{shape:a}});return n.disposeData(h.dataId),f}function fMe(t,e,n){const r=zi(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>It({inputs:{x:i},backend:n,attrs:{shape:[Ue(i.shape.slice(0,e)),Ue(i.shape.slice(e))]}})),outShape:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yZ(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Jt(s,e[0].shape)[0],o=e.map(u=>u.shape);ST(o,i);const a=zi(e.map(u=>u.shape),i);if(Ue(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>Ue(u.shape)>0);return l.length===1?wo({inputs:{x:l[0]},backend:n}):ow(l,i,n)}const pMe={kernelName:Q1,backendName:"webgpu",kernelFunc:yZ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMe(t,e,n,r,s=!1,i=null,o=!1,a=4,l=4,u=4){const c=E=>{switch(E){case 1:return"resData = f32(x[xIndex]);";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = vec4<f32>(x[xIndex / 4]);";default:throw new Error(`innerElementSize ${E} is not supported.`)}},d=E=>{switch(E){case 1:return"return f32(W[row * uniforms.wShape[3] + col]);";case 4:return"return vec4<f32>(W[(row * uniforms.wShape[3] + col) / 4]);";default:throw new Error(`innerElementSize ${E} is not supported.`)}},h=t?`
      let coord = vec4<i32>(batch, xRow, xCol, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, xRow, xCol);
      `,f=t?`
      let coords = vec4<i32>(
        batch,
        row / outWidth,
        row % outWidth,
        col);
      `:`
      let coords = vec4<i32>(
        batch,
        row,
        col / outWidth,
        col % outWidth);
      `,m=t?"uniforms.xShape[1]":"uniforms.xShape[2]",g=t?"uniforms.xShape[2]":"uniforms.xShape[3]",x=t?"row":"col",w=t?"col":"row",b=`
      let inChannels = uniforms.wShape[2];
      let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
      let outRow = ${x} / outWidth;
      let outCol = ${x} % outWidth;

      let WRow = ${w} / (uniforms.filterDims[1] * inChannels);
      let WCol = ${w} / inChannels % uniforms.filterDims[1];
      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];
      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];
      let xCh = ${w} % inChannels;
      var resData = ${rn(a)}(0.0);
      // The bounds checking is always needed since we use it to pad zero for
      // the 'same' padding type.
      if (xRow >= 0 && xRow < ${m} && xCol >= 0 && xCol < ${g}) {
        ${h}
        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);
        ${c(a)}
      }
      return resData;`,S=t?e&&r?`
      ${b}`:`
      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${b}
      }
      return ${rn(a)}(0.0);`:r&&n?`
      ${b}`:`
      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {
        ${b}
      }
      return ${rn(a)}(0.0);`,C=`${d(l)}`,T=rn(u),D=rn(t?a:l),P=rn(t?l:a);return`
      ${Lc(i,o,u===4,4)}
      fn mm_readA(batch: i32, row : i32, col : i32) -> ${D} {
        ${t?S:C}
      }

      fn mm_readB(batch: i32, row : i32, col : i32) -> ${P} {
        ${t?C:S}
      }

      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ${T}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)
        {
        var value = valueIn;
        let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
        ${f}
        ${Yp(s,i)}
        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }`}class gMe{constructor(e,n,r,s,i=!1,o=null,a=!1,l=!1){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=((e.inChannels%4===0||e.inChannels%3===0)&&this.isChannelsLast||e.outWidth%4===0&&!this.isChannelsLast)&&e.outChannels%4===0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=cX(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=dX(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&e.inChannels%4!==0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),i&&(this.variableNames.push("bias"),this.variableComponents.push(4)),a&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=l,this.addBias=i,this.activation=o,this.hasPreluActivationWeights=a,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=n%this.tileAOuter===0,this.fitBOuter=r%this.tileBOuter===0,this.fitInner=s%this.tileInner===0,this.shaderKey=`conv2DMM_${this.elementsPerThread}_${this.activation}}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.innerElementSize}_${this.isChannelsLast}_${this.sequentialAccessByThreads}`}getUserCode(){const e=this.isVec4?BT(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):UT(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),n=this.isVec4?[this.innerElementSize,4,4]:[1,1,1];return`
    ${mMe(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,n[0],n[1],n[2])}
    ${e}
  `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yMe{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n,this.activation=r,this.hasPreluActivationWeights=s,n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`conv2dnaive_${this.activation}_${this.isChannelsLast}`}getUserCode(){return`
       ${Lc(this.activation,this.hasPreluActivationWeights,!1,4)}
       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{
         let coords = vec4<i32>(batch, row, col, chan);
         if (coordsInBounds4D(coords, uniforms.xShape)) {
           return  getX(batch, row, col, chan);
         } else {
          return 0.0;
         }
       }
       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{
         let coords = vec4<i32>(row, col, xChannel, outChannel);
         if(coordsInBounds4D(coords, uniforms.wShape)) {
           return getW(row, col, xChannel, outChannel);
          } else {
            return 0.0;
          }
       }
       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {
         let coords = ${this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);"}
         if (coordsInBounds4D(coords, uniforms.outShape)) {
           var value = valueIn;
           ${Yp(this.addBias,this.activation)}
           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);
         }
       }
       ${ut("index")} {
         let coords = getOutputCoords();
         let batch = coords[0];
         let outChannel = ${this.isChannelsLast?"coords[3];":"coords[1];"}
         let outRow = ${this.isChannelsLast?"coords[1];":"coords[2];"}
         let outCol = ${this.isChannelsLast?"coords[2];":"coords[3];"}
         var acc : f32 = 0.0;
         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {
           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {
             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];
             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];
             for (var xChannel = 0; xChannel < ${this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"} xChannel = xChannel + 1) {
               ${this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);"}
               let f = readFilt(row, col, xChannel, outChannel);
               acc = acc + v * f;
             }
           }
         }
         writeResult(batch, outRow, outCol, outChannel, acc);
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xMe{constructor(e,n){this.variableNames=["x"],this.uniforms=`pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,
       inChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=n,this.shaderKey=`im2col_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?"coords[1]":"coords[2]",s=this.isChannelsLast?"coords[2]":"coords[1]",i=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return`
    ${ut("index")} {
      let coords = getCoordsFromIndex(index);
      if(index < uniforms.size) {
        let batch = coords[0];
        let row = ${r};
        let col = ${s};
        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];
        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);
        var value = 0.0;
        if(xRow < uniforms.xShape[${e}] && xRow >= 0) {
          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -
              uniforms.pads[1];
          let xCol = offsetX + uniforms.dilations[1] * ((col %
              uniforms.itemsPerBlockRow) / uniforms.inChannels);
          let ch = col % uniforms.inChannels;
          if(xCol < uniforms.xShape[${n}] && xCol >= 0) {
            value = ${i};
          }
        }
        setOutputAtIndex(index, value);
      }
    }
   `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FI(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function wMe({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=n.dataFormat==="channelsLast",u=!l,c=!1,d=l&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",h=[];let f,m;if(d){const w=n.inHeight*n.inWidth*n.inChannels;f=It({inputs:{x:t},backend:r,attrs:{shape:[1,n.batchSize,w]}}),m=It({inputs:{x:e},backend:r,attrs:{shape:[1,w,n.outChannels]}})}else f=It({inputs:{x:t},backend:r,attrs:{shape:l?[n.batchSize,n.inHeight*n.inWidth,n.inChannels]:[n.batchSize,n.inChannels,n.inHeight*n.inWidth]}}),m=It({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});if(h.push(f),h.push(m),i!=null){const w=FI(i.shape,l);w!=null&&(i=It({inputs:{x:i},backend:r,attrs:{shape:w}}),h.push(i))}if(s!=null){const w=FI(s.shape,l);w!=null&&(s=It({inputs:{x:s},backend:r,attrs:{shape:w}}),h.push(s))}const g=VT({a:l?f:m,b:l?m:f,transposeA:u,transposeB:c,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),x=It({inputs:{x:g},backend:r,attrs:{shape:n.outShape}});h.push(g);for(const w of h)r.disposeData(w.dataId);return x}function bMe({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,strideWidth:d,strideHeight:h,padInfo:f,outWidth:m,outHeight:g,dilationWidth:x,dilationHeight:w,dataFormat:b}=n,S=b==="channelsLast",C=l*u*c,T=g*m,D=S?[n.batchSize,T,C]:[n.batchSize,C,T],P=new xMe(D,S),I=[{type:"int32",data:[f.top,f.left]},{type:"int32",data:[h,d]},{type:"int32",data:[w,x]},{type:"int32",data:[m]},{type:"int32",data:[c*l]},{type:"int32",data:[c]}],E=r.runWebGPUProgram(P,[t],t.dtype,I),M=[];M.push(E);const O=It({inputs:{x:e},backend:r,attrs:{shape:[1,C,-1]}});if(M.push(O),i!=null){const V=FI(i.shape,S);V!=null&&(i=It({inputs:{x:i},backend:r,attrs:{shape:V}}),M.push(i))}if(s!=null){const V=FI(s.shape,S);V!=null&&(s=It({inputs:{x:s},backend:r,attrs:{shape:V}}),M.push(s))}const z=VT({a:S?E:O,b:S?O:E,transposeA:!S,transposeB:!1,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),B=It({inputs:{x:z},backend:r,attrs:{shape:n.outShape}});M.push(z);for(const V of M)r.disposeData(V.dataId);return B}function xZ({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=s!=null,u=i!=null,c=n.dataFormat==="channelsLast",d=c&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",h=We().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!h&&(d||n.filterHeight===1&&n.filterWidth===1&&n.dilationHeight===1&&n.dilationWidth===1&&n.strideHeight===1&&n.strideWidth===1&&(n.padInfo.type==="SAME"||n.padInfo.type==="VALID")))return wMe({x:t,filter:e,convInfo:n,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});const f=We().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),m=f>-1?f:r.thresholdToIncreaseWorkgroups,g=n.batchSize*Math.ceil(n.outHeight*n.outWidth/32)*Math.ceil(n.outChannels/32);if(We().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||g<=m)return bMe({x:t,filter:e,convInfo:n,backend:r,bias:s,preluActivationWeights:i,leakyreluAlpha:o,activation:a});let x;const w=[n.padInfo.top,n.padInfo.left],b=[{type:"int32",data:[n.filterHeight,n.filterWidth]},{type:"int32",data:[...w]},{type:"int32",data:[n.strideHeight,n.strideWidth]},{type:"int32",data:[n.dilationHeight,n.dilationWidth]}];if(h)x=new yMe(n,l,a,u);else{const D=c?n.outHeight*n.outWidth:n.outChannels,P=c?n.outChannels:n.outHeight*n.outWidth,I=n.filterHeight*n.filterWidth*n.inChannels;b.push({type:"int32",data:[D]},{type:"int32",data:[P]},{type:"int32",data:[I]});const E=r.adapterInfo.isIntel();x=new gMe(n,D,P,I,l,a,u,E)}const S=[],C=[t,e];l&&(!c&&s.shape.length===1&&(s=It({inputs:{x:s},backend:r,attrs:{shape:[s.shape[0],1,1]}}),S.push(s)),C.push(s)),u&&(!c&&i.shape.length===1&&(i=It({inputs:{x:i},backend:r,attrs:{shape:[i.shape[0],1,1]}}),S.push(i)),C.push(i)),a==="leakyrelu"&&(b.push({type:"float32",data:[o]}),x.uniforms+=" alpha : f32,");const T=r.runWebGPUProgram(x,C,t.dtype,b);for(const D of S)r.disposeData(D.dataId);return T}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vMe(t){const{inputs:e,attrs:n,backend:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=n,d=Co(l),h=Kn(s.shape,i.shape,o,u,a,c,!1,d);return xZ({x:s,filter:i,convInfo:h,backend:r})}const SMe={kernelName:J1,backendName:"webgpu",kernelFunc:vMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let CMe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=e.inShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=this.isChannelsLast&&e.outChannels%4===0&&e.inChannels%4===0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey=`conv2DDerInput_${this.isChannelsLast}_${this.isVec4}_${this.workPerThread}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?3:1,s=`
    ${ut()} {
      let batch = i32(globalId.z) / uniforms.outShape[1];
      let r = i32(globalId.z) % uniforms.outShape[1];
      let c = i32(globalId.y) * ${this.workPerThread};
      let d1 = i32(globalId.x) * 4;

      let dyCorner = vec2<i32>(r, c) - uniforms.pads;

      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
      // ? = to be determined. : = across all values in that axis.
      var dotProd: array<vec4<f32>, ${this.workPerThread}>;
      for (var i = 0; i < ${this.workPerThread}; i++) {
        dotProd[i] = vec4<f32>(0.0);
      }
      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);
        let wRPerm = uniforms.filterDims.x - 1 - wR;
        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||
            fract(dyR) > 0.0) {
          continue;
        }
        let idyR = i32(dyR);

        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);
          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);
          let wCPerm = uniforms.filterDims.y - 1 - wC;
          var bDyCVal = true;
          var bDyCVal2 = true;
          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
              fract(dyC) > 0.0) {
            bDyCVal = false;
          }
          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||
              fract(dyC2) > 0.0) {
            bDyCVal2 = false;
          }

          let idyC = i32(dyC);
          let idyC2 = i32(dyC2);
          if (bDyCVal && bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
              xValue = getDy(batch, idyR, idyC2, d2);
              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),
                                                  dot(xValue, wValue1),
                                                  dot(xValue, wValue2),
                                                  dot(xValue, wValue3));
            }
          } else if (bDyCVal) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
            }
          } else if (bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC2, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[1] = dotProd[1] + tmpval;
            }
          }
        }
      }

      for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
        let coords = vec4<i32>(batch, r, c + i, d1);
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);
        }
      }
    }
    `;return this.isVec4?`
    ${s}
    `:`
    ${ut("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[${r}];

        let dyCorner = vec2<i32>(coords[${e}], coords[${n}]) - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);
          let wRPerm = uniforms.filterDims.x - 1 - wR;
          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||
              wRPerm < 0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);
            let wCPerm = uniforms.filterDims.y - 1 - wC;
            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
                fract(dyC) > 0.0 || wCPerm < 0) {
              continue;
            }
            let idyC = i32(dyC);

            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {
              let xValue = ${this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)"};
              let wValue = getW(wRPerm, wCPerm, d1, d2);
              dotProd = dotProd + xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},IMe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",this.shaderKey=`conv2DDerFilter_${this.isChannelsLast}`}getUserCode(){return`
    ${ut("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let d2 = coords[3];

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b = b + 1) {
          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];
            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              if (${this.isChannelsLast}) {
                let dyValue = getDy(b, yR, yC, d2);
                let xValue = getX(b, xR, xC, d1);
                dotProd = dotProd + xValue * dyValue;
              } else {
                let dyValue = getDy(b, d2, yR, yC);
                let xValue = getX(b, d1, xR, xC);
                dotProd = dotProd + xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},NMe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,
       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}getUserCode(){return`
    ${ut("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wF = coords.x;
        let wR = coords.y;
        let wC = coords.z;
        let d1 = coords.w;
        let d2 = coords.u;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yF = 0; yF < uniforms.outDepth; yF++) {
            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];
            if (xF < 0 || xF >= uniforms.inDepth) {
              continue;
            }

            for (var yR = 0; yR < uniforms.outHeight; yR++) {
              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];
              if (xR < 0 || xR >= uniforms.inHeight) {
                continue;
              }

              for (var yC = 0; yC < uniforms.outWidth; yC++) {
                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];
                if (xC < 0 || xC >= uniforms.inWidth) {
                  continue;
                }

                let dyValue = getDy(b, yF, yR, yC, d2);
                let xValue = getX(b, xF, xR, xC, d1);
                dotProd += xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},kMe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}getUserCode(){return`
    ${ut("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let d1 = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyFCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);
          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {
            continue;
          }
          let idyF = i32(dyF);

          let wFPerm = uniforms.filterDims[0] - 1 - wF;

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            let wRPerm = uniforms.filterDims[1] - 1 - wR;

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let wCPerm = uniforms.filterDims[2] - 1 - wC;

              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {
                let xValue = getDy(batch, idyF, idyR, idyC, d2);
                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Co(l),h=Kn(s.shape,c,o,1,a,u,!1,d),f=new IMe(h),m=[{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]},{type:"int32",data:[h.inHeight]},{type:"int32",data:[h.inWidth]}];return n.runWebGPUProgram(f,[s,i],s.dtype,m)}const EMe={kernelName:rk,backendName:"webgpu",kernelFunc:TMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Me(t=4){const e=i=>{switch(i){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];
            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];
            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];
            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];
            return vec4<f32>(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${i} is not supported.`)}},r=`if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${`
      let outRow = row / uniforms.outShape[2];
      let outCol = row % uniforms.outShape[2];

      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];
      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {
        return ${rn(t)}(0.0);
      }
      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {
        return ${rn(t)}(0.0);
      }
      let coord = vec4<i32>(
          batch,
          i32(xR),
          i32(xC),
          col % uniforms.outBackprop[3]);
      return x[getIndexFromCoords4D(coord, uniforms.xShape)/${t}];`}
      }
      return ${rn(t)}(0.0);`;return`
  fn mm_readA(batch: i32, row : i32, col : i32) -> ${rn(t)} {
    ${r}
  }

  fn mm_readB(batch: i32, row : i32, col : i32) -> ${rn(t)} {
    let coordX = uniforms.filterDims.x - 1 -
        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
    let coordY = uniforms.filterDims.y - 1 -
        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];
    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&
        coordX >= 0 && coordY >= 0) {
      let rowInner = row % uniforms.outBackprop[3];
      let coord = vec4<i32>(coordX, coordY, col, rowInner);
      ${e(t)}
    }
    return ${rn(t)}(0.0);
  }

  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ${rn(t)}) {
    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
      var value = valueInput;
      let outCoord = vec4<i32>(
          batch,
          row / uniforms.outShape[2],
          row % uniforms.outShape[2],
          col);
      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/${t}] = value;
    }
  }`}class AMe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.inShape,ae(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),this.isVec4=e.inChannels%4===0&&e.outChannels%4===0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=cX(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=dX(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey=`conv2DDerInputMM_${this.isVec4}_${this.elementsPerThread}`}getUserCode(){const e=this.isVec4?BT(this.elementsPerThread,this.workgroupSize):UT(this.elementsPerThread,this.workgroupSize);return`
    ${_Me(this.isVec4?4:1)}
    ${e}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Me(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Co(u),h=Kn(o,i.shape,a,1,l,c,!1,d),f=[{type:"int32",data:[h.filterHeight,h.filterWidth]},{type:"int32",data:[h.filterHeight-1-h.padInfo.top,h.filterWidth-1-h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize,h.outHeight,h.outWidth,h.outChannels]}];let m;if(We().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||h.dataFormat!=="channelsLast")m=new CMe(h);else{m=new AMe(h);const g=h.inHeight*h.inWidth,x=h.inChannels,w=h.filterHeight*h.filterWidth*h.outChannels;f.push({type:"uint32",data:[g]},{type:"uint32",data:[x]},{type:"uint32",data:[w]})}return n.runWebGPUProgram(m,[s,i],"float32",f)}const RMe={kernelName:eb,backendName:"webgpu",kernelFunc:$Me};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MMe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords.x;
        let d2 = coords.u;

        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
        let xFCorner = xFRCCorner.x;
        let xRCorner = xFRCCorner.y;
        let xCCorner = xFRCCorner.z;

        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;
        let inputDepthVec4Remainder = uniforms.xShape.u % 4;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let xF = xFCorner + wF * uniforms.dilations[0];
          if (xF < 0 || xF >= uniforms.xShape.y) {
            continue;
          }

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let xR = xRCorner + wR * uniforms.dilations[1];
            if (xR < 0 || xR >= uniforms.xShape.z) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let xC = xCCorner + wC * uniforms.dilations[2];
              if (xC < 0 || xC >= uniforms.xShape.w) {
                continue;
              }

              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {
                let xValues = vec4<f32>(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                let wValues = vec4<f32>(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (inputDepthVec4Remainder == 1) {
                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *
                  getW(wF, wR, wC, inputDepthNearestVec4, d2);
              } else if (inputDepthVec4Remainder == 2) {
                let xValues = vec2<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)
                );
                let wValues = vec2<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (inputDepthVec4Remainder == 3) {
                let xValues = vec3<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)
                );
                let wValues = vec3<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }`}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Dl(s.shape,i.shape,o,l,a),c=[u.padInfo.front,u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationDepth,u.dilationHeight,u.dilationWidth]}],h=new MMe(u),f=ws(s.dtype,i.dtype);return n.runWebGPUProgram(h,[s,i],f,d)}const OMe={kernelName:tb,backendName:"webgpu",kernelFunc:DMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r,u=Dl(s.shape,l,o,1,a),c=new NMe(u),d=[{type:"int32",data:[u.padInfo.front,u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.batchSize]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.inDepth]},{type:"int32",data:[u.inHeight]},{type:"int32",data:[u.inWidth]}];return n.runWebGPUProgram(c,[s,i],i.dtype,d)}const FMe={kernelName:sk,backendName:"webgpu",kernelFunc:PMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LMe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,pad:a,inputShape:l}=r,u=Dl(l,i.shape,o,1,a),c=new kMe(u),d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[u.filterDepth-1-u.padInfo.front,u.filterHeight-1-u.padInfo.top,u.filterWidth-1-u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.outChannels]}];return n.runWebGPUProgram(c,[s,i],s.dtype,d)}const zMe={kernelName:ik,backendName:"webgpu",kernelFunc:LMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BMe=wn({opType:ot.COS}),UMe={kernelName:R0,backendName:"webgpu",kernelFunc:BMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VMe=wn({opType:ot.COSH}),jMe={kernelName:M0,backendName:"webgpu",kernelFunc:VMe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let WMe=class{constructor(e,n,r,s){this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;const[i]=n;this.outputShape=[i,r[0],r[1],e],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId=s==="bilinear"?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey=`cropAndResize_${this.methodId}_${this.cropHeightBiggerThan1}_${this.cropWidthBiggerThan1}`}getUserCode(){const[e,n]=["f32(uniforms.imageShape[1] - 1)","f32(uniforms.imageShape[2] - 1)"],[r,s,i]=this.cropHeightBiggerThan1?[`(${e} / f32(uniforms.outShape[1] - 1))`,"(y2-y1) * height_ratio",`y1*${e} + f32(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${e}`],[o,a,l]=this.cropWidthBiggerThan1?[`(${n} / f32(uniforms.outShape[2] - 1))`,"(x2-x1) * width_ratio",`x1*${n} + f32(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${n}`];return`
    ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let height_ratio = f32(${r});
        let width_ratio = f32(${o});
        let b = coords[0];
        let y = coords[1];
        let x = coords[2];
        let d = coords[3];
        // get box vals
        let y1 = getBoxes(b, 0);
        let x1 = getBoxes(b, 1);
        let y2 = getBoxes(b, 2);
        let x2 = getBoxes(b, 3);
        // get image in batch index
        let bInd = i32(round(getBoxInd(b)));
        if(bInd < 0 || bInd >= uniforms.outShape[0]) {
          return;
        }
        let height_scale = ${s};
        let width_scale = ${a};
        let in_y = ${i};
        if( in_y < 0.0 || in_y > ${e} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let in_x = ${l};
        if( in_x < 0.0 || in_x > ${n} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let sourceFracIndexCR = vec2<f32>(in_x,in_y);
        if(${this.methodId} == 1) {
          // Compute the four integer indices.
          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);
          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));
          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);
          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);
          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);
          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);
          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);
          let top = topLeft + (topRight - topLeft) * fracCR.x;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          let newValue = top + (bottom - top) * fracCR.y;
          setOutputAtIndex(index, newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          let sourceNearestCR = vec2<i32>(floor(
            sourceFracIndexCR + vec2<f32>(0.5,0.5)));
          let newValue = getImage(
            bInd, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutputAtIndex(index, newValue);
        }
      }
    }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GMe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new WMe(s.shape[3],i.shape,a,l),d=[{type:"float32",data:[u]}];return n.runWebGPUProgram(c,[s,i,o],"float32",d)},HMe={kernelName:ak,backendName:"webgpu",kernelFunc:GMe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var u1;(function(t){t.Prod="*",t.Sum="+"})(u1||(u1={}));let CV=class{constructor(e,n,r,s){this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=n,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=r,this.reverse=s,this.op=e,this.shaderKey=`cum_${this.op}_${this.exclusive}_${this.reverse}`}getUserCode(){const e=this.outputShape.length,n=this.op===u1.Prod?"1.0":"0.0",r=this.exclusive?n:`getX(${IV(e,"coords",this.op)})`,s=this.outputShape[this.outputShape.length-1];let i="",o="";return this.exclusive?(i=this.reverse?`end != ${s-1}`:"end != 0",o=this.reverse?"end + 1":"end - 1"):(i=this.reverse?`end + pow2 < ${s}`:"end >= pow2",o=this.reverse?"end + pow2":"end - pow2"),`
      ${ut("index")} {
       if (index < uniforms.size) {
         var coords = getCoordsFromIndex(index);

         let end = ${NV(e,"coords",this.op)};
         var val = ${r};
         let pow2 = i32(pow(2.0, uniforms.index));
         if (${i}) {
           let idx = ${o};
           ${NV(e,"coords",this.op)} = idx;
           val ${this.op}= getX(${IV(e,"coords",this.op)});
         }
         setOutputAtIndex(index, val);
       }
      }
    `}};function IV(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function NV(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wZ(t,e,n,r,s,i){const o=e.shape.length,a=zn([r],o);let l=e;a!=null&&(l=Eu({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=qn(1,o)[0];if(u!==o-1)throw new Error(`WebGPU cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=wo({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const f=new CV(t,l.shape,!1,i),m=d,g=[{type:"float32",data:[h]}];d=n.runWebGPUProgram(f,[d],d.dtype,g),n.disposeData(m.dataId)}if(s){const h=new CV(t,l.shape,s,i),f=d,m=[{type:"float32",data:[0]}];d=n.runWebGPUProgram(h,[d],d.dtype,m),n.disposeData(f.dataId)}if(a!=null){const h=Du(a),f=Eu({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeData(d.dataId),n.disposeData(l.dataId),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return wZ(u1.Prod,s,n,i,o,a)}const KMe={kernelName:ok,backendName:"webgpu",kernelFunc:YMe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return wZ(u1.Sum,s,n,i,o,a)}const XMe={kernelName:nb,backendName:"webgpu",kernelFunc:qMe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r,l=s.shape.length===1,c=Ue(i.shape)>0,d=i.dtype,h=l?[s.shape[0]]:[s.shape[0],s.shape[1]],f=l?[o]:[s.shape[0],o],m=Bi({backend:n,attrs:{shape:f,value:0,dtype:d}}),g=new mZ(h,c,a),x=[{type:"int32",data:[o]}],w=c?[s,i]:[s];return n.runWebGPUProgram(g,w,d,x,m)}const QMe={kernelName:lk,backendName:"webgpu",kernelFunc:ZMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let JMe=class{constructor(e,n){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`depthToSpace_${n}`,this.dataFormat=n}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let h = ${this.getHeightCoordString()};
          let w = ${this.getWidthCoordString()};
          let d = ${this.getDepthCoordString()};

          let in_h = h / uniforms.blockSize;
          let offset_h = h % uniforms.blockSize;
          let in_w = w / uniforms.blockSize;
          let offset_w = w % uniforms.blockSize;
          let offset_d = (offset_h * uniforms.blockSize + offset_w) *
            ${this.getOutputDepthSize()};
          let in_d = d + offset_d;

          let rlt = ${this.getInputSamplingString()};
          setOutputAtIndex(index, rlt);
        }
      }`}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?"uniforms.outShape[3]":"uniforms.outShape[1]"}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],l=o==="NHWC"?s.shape[1]:s.shape[2],u=o==="NHWC"?s.shape[2]:s.shape[3],c=o==="NHWC"?s.shape[3]:s.shape[1],d=l*i,h=u*i,f=c/(i*i),m=o==="NHWC"?[a,d,h,f]:[a,f,d,h],g=[{type:"int32",data:[i]}],x=new JMe(m,o);return n.runWebGPUProgram(x,[s],s.dtype,g)}const tDe={kernelName:uk,backendName:"webgpu",kernelFunc:eDe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nDe{constructor(e,n,r,s=!1,i=null,o=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=e,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),s&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.addBias=s,this.activation=i,this.hasPreluActivation=o,this.filterHeight=n,this.filterWidth=r,this.shaderKey=`depthwiseNCHW_${this.activation}_${this.filterHeight}_${this.filterWidth}`}getUserCode(){const e=this.filterWidth*this.filterHeight,n=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],r=this.workgroupSize[1]+this.filterHeight-1,s=this.workgroupSize[0]+this.filterWidth-1;return`
      ${Lc(this.activation,this.hasPreluActivation,!1,4)}

      var<workgroup> mm_Asub : array<array<f32, ${s}>, ${r}>;
      var<workgroup> mm_Bsub : array<array<f32, ${this.filterWidth}>, ${this.filterHeight}>;
      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {
        var value = 0.0;
        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])
        {
          value = getX(batch, channel, row, col);
        }
        return value;
      }

      ${ut()} {
        let coords = getOutputCoords();
        let batch = coords[0];
        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;
        let channelMul = uniforms.wShape[3];
        let d1 = coords[1] / channelMul;
        let q = coords[1] % channelMul;

        let inputRowStart = xRCCorner.x;
        let inputColStart = xRCCorner.y;

        let localRow = i32(localId.y);
        let localCol = i32(localId.x);

        // Load one tile of X into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${this.workgroupSize[1]}) {
          for (var inputCol = localCol; inputCol < ${s}; inputCol = inputCol + ${this.workgroupSize[0]}) {
            let rowOffset = inputRow - localRow;
            let colOffset = inputCol - localCol;
            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);
          }
        }

        // Load one tile of W into local memory.
        var wIndex = i32(localIndex);
        ${e<n?`if (wIndex < ${e})`:`for(; wIndex < ${e}; wIndex = wIndex + ${n})`}

        {
          let wRow = wIndex / ${this.filterWidth};
          let wCol = wIndex % ${this.filterWidth};
          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);
        }

        workgroupBarrier();

        var value = 0.0;
        for (var wR = 0; wR < ${this.filterHeight}; wR = wR + 1) {
          for (var wC = 0; wC < ${this.filterWidth}; wC = wC + 1) {
            let xVal = mm_Asub[localRow + wR][localCol + wC];
            let wVal = mm_Bsub[wR][wC];
            value = fma(xVal, wVal, value);
          }
        }
        ${Yp(this.addBias,this.activation)}
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bZ{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=e.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;const i=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=wt(i),this.dispatch=ct(this.dispatchLayout,i,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),ae(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=s,this.shaderKey=`depthwiseVec4_${r}_${this.convInfo.filterHeight}_${this.convInfo.filterWidth}_${this.convInfo.strideHeight}_${this.convInfo.strideWidth}_${this.workPerThread}`}getUserCode(){const e=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,n=this.convInfo.strideHeight,r=this.convInfo.strideWidth;return`
      ${Lc(this.activation,this.hasPreluActivation,!0,4)}
      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {
        var value = vec4<f32>(0.0);
        if (col >=0 && col < uniforms.inDims[1]) {
          value = getX(batch, row, col, channel);
        }
        return value;
      }

      ${ut("index")} {
        let width0 = uniforms.outShape[3] / ${this.outputComponent};
        let d1 = (index % width0) * ${this.outputComponent};
        var index1 = index / width0;
        let width1 = uniforms.virtualWidth / ${this.workPerThread};
        let c = (index1 % width1) * ${this.workPerThread};
        index1 = index1 / width1;
        let r = index1 % uniforms.outShape[1];
        let batch = index1 / uniforms.outShape[1];

        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(${n}, ${r}) - uniforms.pads;

        let xRCorner = xRCCorner.x;
        let xCCorner = xRCCorner.y;
        var xVals : array<vec4<f32>, ${e}>;
        var dotProd : array<vec4<f32>, ${this.workPerThread}>;
        for (var i = 0; i < ${this.workPerThread}; i++) {
          dotProd[i] = vec4<f32>(0.0);
        }

        // Use constant instead of uniform can give better performance.
        for (var wR = 0; wR < ${this.convInfo.filterHeight}; wR = wR + 1) {
          let xR = xRCorner + wR;
          if (xR >=0 && xR < uniforms.inDims[0]) {
            for (var i = 0; i < ${e}; i++) {
              xVals[i] = readX(batch, xR, xCCorner + i, d1);
            }
            for (var wC = 0; wC < ${this.convInfo.filterWidth}; wC = wC + 1) {
              let wValue = getW(wR, wC, d1, 0);
              for (var i = 0; i < ${this.workPerThread}; i++) {
                dotProd[i] = fma(xVals[i * ${r} + wC], wValue, dotProd[i]);
              }
            }
          }
        }

        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let coords = vec4<i32>(batch, r, c + i, d1);
          if (coordsInBounds4D(coords, uniforms.outShape)) {
            var value = dotProd[i];
            ${Yp(this.addBias,this.activation)}
            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let vZ=class{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms=`pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,
      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,`,this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=s,this.shaderKey=`depthwise_${this.activation}_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return`
      ${Lc(this.activation,this.hasPreluActivation,!1,4)}

      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let batch = coords[0];
          let xRCCorner = vec2<i32>(coords.${this.isChannelsLast?"yz":"zw"}) * uniforms.strides - uniforms.pads;
          let d2 = coords[${this.isChannelsLast?3:1}];
          let channelMul = uniforms.wShape[3];
          let d1 = d2 / channelMul;
          let q = d2 % channelMul;

          let inputRowStart = xRCCorner.x;
          let inputColStart = xRCCorner.y;
          let inputRowEnd = inputRowStart + uniforms.filterHeight *
              uniforms.dilations[0];
          let inputColEnd = inputColStart + uniforms.filterWidth *
              uniforms.dilations[1];

          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get
          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all
          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.
          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.
          var value = 0.0;

          // Extract if checking out of for loop for performance.
          if (inputRowStart >= 0 && inputColStart >= 0 &&
            inputRowEnd < uniforms.inDims[0] &&
                inputColEnd < uniforms.inDims[1]) {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            } else {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                if (xR < 0 || xR >= uniforms.inDims[0]) {
                  continue;
                }

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  if (xC < 0 || xC >= uniforms.inDims[1]) {
                    continue;
                  }

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            }
            ${Yp(this.addBias,this.activation)}
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Co(l);let h=u;h==null&&(h=[1,1]);const f=Kn(s.shape,i.shape,o,h,a,c,!0,d),m=[{type:"int32",data:[f.padInfo.top,f.padInfo.left]},{type:"int32",data:[f.inHeight,f.inWidth]}],g=f.dataFormat==="channelsLast";let x;return!g&&f.inHeight>16&&f.inWidth>16&&f.strideHeight===1&&f.strideWidth===1&&f.dilationWidth===1&&f.dilationHeight===1&&f.inChannels===f.outChannels?x=new nDe(f.outShape,f.filterHeight,f.filterWidth):g&&f.outHeight>4&&f.outWidth>4&&f.strideWidth<=2&&f.inChannels===f.outChannels&&f.dilationHeight===1&&f.dilationWidth===1&&f.inChannels%4===0?(x=new bZ(f),m.push({type:"int32",data:[x.virtualWidth]})):(x=new vZ(f),m.push({type:"int32",data:[f.filterHeight]},{type:"int32",data:[f.filterWidth]},{type:"int32",data:[f.strideHeight,f.strideWidth]},{type:"int32",data:[f.dilationHeight,f.dilationWidth]})),n.runWebGPUProgram(x,[s,i],s.dtype,m)}const sDe={kernelName:rb,backendName:"webgpu",kernelFunc:rDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let iDe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,
      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}getUserCode(){return`
      ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let dm = coords[3];
        let d2 = d1 * uniforms.channelMul + dm;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yR = 0; yR < uniforms.outHeight; yR++) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];

            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC++) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              let dyValue = getDy(b, yR, yC, d2);
              let xValue = getX(b, xR, xC, d1);
              dotProd += xValue * dyValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},oDe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}getUserCode(){return`
      ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[3];
        let dyCorner = coords.yz - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }

          let idyR = i32(dyR);
          let wRPerm = uniforms.filterDims[0] - 1 - wR;

          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }

            let idyC = i32(dyC);
            let wCPerm = uniforms.filterDims[1] - 1 - wC;

            for (var dm = 0; dm < uniforms.channelMul; dm++) {
              let d2 = d1 * uniforms.channelMul + dm;
              let xValue = getDy(batch, idyR, idyC, d2);
              let wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=Kn(s.shape,c,o,a,l,u,!0),h=new iDe(d),f=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.inHeight]},{type:"int32",data:[d.inWidth]},{type:"int32",data:[d.batchSize]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[s,i],"float32",f)}const lDe={kernelName:ck,backendName:"webgpu",kernelFunc:aDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uDe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=Kn(c,i.shape,o,a,l,u,!0),h=new oDe(d),f=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.filterHeight-1-d.padInfo.top,d.filterWidth-1-d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[s,i],s.dtype,f)}const cDe={kernelName:dk,backendName:"webgpu",kernelFunc:uDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dDe=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,e],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);
          setOutputAtIndex(index, value);
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hDe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],i=Ue(r.shape),o=It({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new dDe(i),l=n.runWebGPUProgram(a,[o],o.dtype),u=It({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeData(o.dataId),n.disposeData(l.dataId),u}const fDe={kernelName:hk,backendName:"webgpu",kernelFunc:hDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let pDe=class{constructor(e){this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}getUserCode(){return`
       ${ut("index")} {
         if (index < uniforms.size) {
           let neg_infinity = -3.4e38;
           let coords = getOutputCoords();
           let batch = coords.x;
           let d1 = coords.w;
           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;
           let hBeg = outTopLeftCorner.x;
           let wBeg = outTopLeftCorner.y;

           var curVal = neg_infinity;
           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {
             let hIn = hBeg + h * uniforms.dilations[0];

             if (hIn >= 0 && hIn < uniforms.xShape[1]) {
               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {
                 let wIn = wBeg + w * uniforms.dilations[1];

                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {
                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);
                   if (val > curVal) {
                     curVal = val;
                   }
                 }
               }
             }
           }

           setOutputAtIndex(index, curVal);
         }
       }
     `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Mh(s.shape,i.shape,o,a,"NHWC",l),c=[u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]}],h=new pDe(u);return n.runWebGPUProgram(h,[s,i],s.dtype,d)}const gDe={kernelName:sb,backendName:"webgpu",kernelFunc:mDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yDe{constructor(e,n){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.inShape,this.dispatchLayout=wt(e.outShape),this.dispatch=ct(this.dispatchLayout,e.outShape,this.workgroupSize),n!=="float32"&&n!=="int32")throw new Error(`Dilation2DBackpropInput only supports float32 and int32
          types, does not support ${n} type.`);this.type=n,this.shaderKey="dilation2DBackpropInput"}getUserCode(){return`
       ${ut("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var xRMax = 0;
           var xCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     xRMax = xR;
                     xCMax = xC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.xShape[3] *
               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));
           let value = getDy(b, r, c, d);
           ${Ph("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}class xDe{constructor(e,n,r){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.filterShape,this.dispatchLayout=wt(e.outShape),this.dispatch=ct(this.dispatchLayout,e.outShape,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`Dilation2DBackpropFilter only supports float32 and int32
          types, does not support ${r} type.`);this.type=r,this.shaderKey="dilation2DBackpropFilter"}getUserCode(){return`
       ${ut("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var wRMax = 0;
           var wCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     wRMax = wR;
                     wCMax = wC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);
           let value = getDy(b, r, c, d);
           ${Ph("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,dy:o}=e,{strides:a,pad:l,dilations:u}=r,c=Mh(s.shape,i.shape,a,l,"NHWC",u),d=i.dtype,h=new xDe(c,i.shape,d),f=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[Ue(c.outShape)]}],m=Bi({backend:n,attrs:{shape:i.shape,value:0,dtype:d}});return n.runWebGPUProgram(h,[s,i,o],d,f,m)}const bDe={kernelName:II,backendName:"webgpu",kernelFunc:wDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,dy:o}=e,{strides:a,pad:l,dilations:u}=r,c=Mh(s.shape,i.shape,a,l,"NHWC",u),d=s.dtype,h=new yDe(c,d),f=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[Ue(c.outShape)]}],m=Bi({backend:n,attrs:{shape:c.inShape,value:0,dtype:d}});return n.runWebGPUProgram(h,[s,i,o],d,f,m)}const SDe={kernelName:CI,backendName:"webgpu",kernelFunc:vDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CDe{constructor(e,n,r){this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=Qg.DRAW,this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=n,this.textureFormat=r,this.shaderKey=`draw_${n}_${r}`}getUserCode(){let e;const n=this.type==="float32"?"value":"value / 255.0";return e=`
      if (uniforms.numChannels == 1) {
        rgba[0] = ${n};
        rgba[1] = ${n};
        rgba[2] = ${n};
      } else {
        rgba[d] = ${n};
      }`,`
       @group(0) @binding(0) var outImage : texture_storage_2d<${this.textureFormat}, write>;
       ${ut("index")} {
         if (index < uniforms.size) {
           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);
           for (var d = 0; d < uniforms.numChannels; d = d + 1) {
             let value = f32(inBuf[index * uniforms.numChannels + d]);
             ${e}
           }
           rgba.x = rgba.x * rgba.w;
           rgba.y = rgba.y * rgba.w;
           rgba.z = rgba.z * rgba.w;
           let coords = getCoordsFromIndex(index);
           textureStore(outImage, vec2<i32>(coords.yx), rgba);
         }
       }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IDe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:i,options:o}=r,[a,l]=s.shape.slice(0,2),{imageOptions:u}=o||{},c=(u==null?void 0:u.alpha)||1,d=n.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",h=[a,l],f=new CDe(h,s.dtype,d);i.width=l,i.height=a;const m="webgpu";let g=i.getContext(m),x;g||(x=new OffscreenCanvas(l,a),g=x.getContext(m));const w=s.shape.length===3?s.shape[2]:1;g.configure({device:n.device,format:d,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});const b="int32",S=n.makeTensorInfo(h,b),C=n.tensorMap.get(S.dataId);C.resource=g.getCurrentTexture(),C.external=!0;const T=[{type:"uint32",data:[w]},{type:"float32",data:[c]}];if(n.runWebGPUProgram(f,[s],b,T,S),x){const D=i.getContext("2d");if(!D)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");D.drawImage(x,0,0)}return n.disposeData(S.dataId),s}const NDe={kernelName:gO,backendName:"webgpu",kernelFunc:IDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SZ=bs({opType:Yt.MUL,cpuKernelImpl:A$e,supportsComplex:!0}),kDe={kernelName:Z0,backendName:"webgpu",kernelFunc:SZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return qp(s,i,o,"sum",n)}const TDe={kernelName:Fb,backendName:"webgpu",kernelFunc:CZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EDe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=MT(s,i.length);OT(o.length,l,i);const{path:u,steps:c}=PT(a,l),d=c.length;let h=null,f=o.length;const m=[];for(let g=0;g<d;++g){for(const x of c[g]){const{permutationIndices:w,expandDims:b}=DT(f,l[x]);let S;FT(w)?S=i[x]:(S=Eu({inputs:{x:i[x]},backend:n,attrs:{perm:w}}),m.push(S));const C=S.shape.slice();for(let T=0;T<b.length;++T)C.splice(b[T],0,1);nn(S.shape,C)||(S=It({inputs:{x:S},backend:n,attrs:{shape:C}}),m.push(S)),h===null?h=S:(h=SZ({inputs:{a:S,b:h},backend:n}),m.push(h))}g<d-1&&(u[g]>=0&&(h=CZ({inputs:{x:h},backend:n,attrs:{axis:u[g]-(o.length-f),keepDims:!1}}),m.push(h)),f--)}for(const g of m)g!==h&&n.disposeData(g.dataId);return h}const _De={kernelName:fk,backendName:"webgpu",kernelFunc:EDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ADe=wn({opType:ot.ELU}),$De={kernelName:O0,backendName:"webgpu",kernelFunc:ADe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RDe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=new DI(Yt.ELU_DER,r.shape,s.shape);return n.runWebGPUProgram(i,[r,s],r.dtype)},MDe={kernelName:pk,backendName:"webgpu",kernelFunc:RDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DDe=bs({opType:Yt.EQUAL,dtype:"bool",cpuKernelImpl:m$e}),ODe={kernelName:ib,backendName:"webgpu",kernelFunc:DDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PDe=wn({opType:ot.ERF}),FDe={kernelName:P0,backendName:"webgpu",kernelFunc:PDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LDe=wn({opType:ot.EXP,cpuKernelImpl:g$e,dtype:"float32"}),zDe={kernelName:F0,backendName:"webgpu",kernelFunc:LDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KR(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(ae(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),It({inputs:{x:i},backend:r,attrs:{shape:a}})}const BDe={kernelName:ob,backendName:"webgpu",kernelFunc:KR};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UDe=wn({opType:ot.EXPM1,cpuKernelImpl:y$e}),VDe={kernelName:L0,backendName:"webgpu",kernelFunc:UDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let kV=class{constructor(e,n){this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=e,this.shaderKey=`fft_${e}`}getUserCode(){return`
    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {
      ${this.component==="real"?"return real * expR - imag * expI;":"return real * expI + imag * expR;"}
    }

    fn mulMatDFT(batch: i32, index: i32) -> f32 {
      let indexRatio = f32(index) / f32(uniforms.realShape[1]);
      let exponentMultiplierTimesIndexRatio =
          uniforms.exponentMultiplier * indexRatio;

      var result = 0.0;

      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {
        // x = (-2|2 * PI / N) * index * i;
        let x = exponentMultiplierTimesIndexRatio * f32(i);
        let expR = cos(x);
        let expI = sin(x);
        let real = getReal(batch, i);
        let imag = getImag(batch, i);

        result = result +
            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;
      }

      return result;
    }

    ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IZ(t,e,n){const r=n.tensorMap.get(t.dataId),s=Ue(t.shape),i=t.shape[t.shape.length-1],o=s/i,a=[],l=It({inputs:{x:t},backend:n,attrs:{shape:[o,i]}});a.push(l);const u=l.shape,c=new kV("real",u),d=new kV("imag",u),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],f=e?2*Math.PI:-2*Math.PI,m=e?u[1]:1,g=[{type:"float32",data:[f]},{type:"float32",data:[m]}],x=n.runWebGPUProgram(c,h,"float32",g);a.push(x);const w=n.runWebGPUProgram(d,h,"float32",g);a.push(w);const b=Kp({inputs:{real:x,imag:w},backend:n});a.push(b);const S=It({inputs:{x:b},backend:n,attrs:{shape:t.shape}});return a.forEach(C=>n.disposeData(C.dataId)),S}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jDe(t){const{inputs:e,backend:n}=t,{input:r}=e;return IZ(r,!1,n)}const WDe={kernelName:mk,backendName:"webgpu",kernelFunc:jDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let GDe=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let coordX = uniforms.xShape[2] - coords[2] - 1;
          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);
          setOutputAtIndex(index, outputValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HDe={kernelName:yk,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new GDe(n.shape);return r.runWebGPUProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YDe=wn({opType:ot.FLOOR,cpuKernelImpl:x$e}),KDe={kernelName:z0,backendName:"webgpu",kernelFunc:YDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qDe=bs({opType:Yt.FLOOR_DIV,cpuKernelImpl:w$e,dtype:"int32"}),XDe={kernelName:B0,backendName:"webgpu",kernelFunc:qDe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ZDe=class{constructor(e,n,r=!1){this.pixelsOpType=Qg.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[n,1,1]),this.importVideo=r,this.shaderKey=`fromPixels_${this.importVideo}`}getUserCode(){const e=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)";return`
      @binding(1) @group(0) var src: ${this.importVideo?"texture_external":"texture_2d<f32>"};
      ${ut("index")} {
        let flatIndex = index * uniforms.numChannels;
        if (flatIndex < uniforms.size) {
          let coords = getCoordsFromIndex(flatIndex);
          let values = ${e};
          for (var i = 0; i < uniforms.numChannels; i = i + 1) {
            result[flatIndex + i] = i32(floor(255.0 * values[i]));
          }
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QDe={kernelName:NI,backendName:"webgpu",kernelFunc:JDe};let Km,$3=We().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function JDe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r;if(s==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");const o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,l=typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas,u=typeof ImageBitmap<"u"&&s instanceof ImageBitmap,[c,d]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],h=[d,c,i],f=We().getBool("WEBGPU_IMPORT_EXTERNAL_TEXTURE")&&o,m=o||a;if(u||l||m){let b;if(f)b=n.device.importExternalTexture({source:s});else{if(m){const R=We().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Km==null||R!==$3)&&($3=R,Km=document.createElement("canvas").getContext("2d",{willReadFrequently:$3})),Km.canvas.width=c,Km.canvas.height=d,Km.drawImage(s,0,0,c,d),s=Km.canvas}const M=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,j=n.textureManager.acquireTexture(h[1],h[0],"rgba8unorm",M);n.queue.copyExternalImageToTexture({source:s},{texture:j},[h[1],h[0]]),b=j}const S=Ue(h),C=$t(h),T=new ZDe(h,i,f),D=[{type:"uint32",data:[S]},{type:"uint32",data:[i]},{type:"uint32",data:[...C]}],P=n.makeTensorInfo([d,c],"int32"),I=n.tensorMap.get(P.dataId);I.resource=b;const E=n.runWebGPUProgram(T,[P],"int32",D);return n.disposeData(P.dataId),E}const g=s.data;let x=g;if(i!=null&&i!==4){x=new Uint8Array(s.width*s.height*i);const b=g.length;let S=0;for(let C=0;C<b;C++)C%4<i&&(x[S++]=g[C])}const w=n.makeTensorInfo(h,"int32",new Int32Array(x));return n.uploadToGPU(w.dataId),w}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eOe=class{constructor(e,n,r,s,i){this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],jt(e,n),jt(e,r),this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),s!=null&&(jt(e,s),this.variableNames.push("offset")),i!=null&&(jt(e,i),this.variableNames.push("scale")),this.offsetShape=s,this.scaleShape=i,this.shaderKey="batchNorm"}getUserCode(){let e="0.0";this.offsetShape!=null&&(e="getOffsetByOutputIndex(index)");let n="1.0";return this.scaleShape!=null&&(n="getScaleByOutputIndex(index)"),`
      ${ut("index")} {
        if (index < uniforms.size)
        {
          let xValue = getXByOutputIndex(index);
          let meanValue = getMeanByOutputIndex(index);
          let varianValue = getVarianceByOutputIndex(index);
          let offsetValue = ${e};
          let scaleValue = ${n};
          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));
          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tOe={kernelName:ab,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r,scale:s,offset:i,mean:o,variance:a}=t,{varianceEpsilon:l}=e,u=n,c=[r,o,a];let d=null;i!=null&&(d=i.shape,c.push(i));let h=null;s!=null&&(h=s.shape,c.push(s));const f=new eOe(r.shape,o.shape,a.shape,d,h),m=[{type:"float32",data:[l]}];return u.runWebGPUProgram(f,c,r.dtype,m)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=r,g=Co(c),x=Kn(s.shape,i.shape,l,d,u,h,!1,g);return xZ({x:s,filter:i,convInfo:x,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:m,activation:f})}const rOe={kernelName:Qw,backendName:"webgpu",kernelFunc:nOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r;let m=c;m==null&&(m=[1,1]),ae(as(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=Kn(s.shape,i.shape,l,m,u,d,!0),x=[s,i],w=o!=null,b=a!=null;w&&x.push(o),b&&x.push(a);const S=[{type:"int32",data:[g.padInfo.top,g.padInfo.left]},{type:"int32",data:[g.inHeight,g.inWidth]}];let C;return g.outHeight>4&&g.outWidth>4&&g.strideWidth<=2&&g.inChannels===g.outChannels&&g.dilationHeight===1&&g.dilationWidth===1&&g.inChannels%4===0?(C=new bZ(g,w,h,b),S.push({type:"int32",data:[C.virtualWidth]})):(C=new vZ(g,w,h,b),S.push({type:"int32",data:[g.filterHeight]},{type:"int32",data:[g.filterWidth]},{type:"int32",data:[g.strideHeight,g.strideWidth]},{type:"int32",data:[g.dilationHeight,g.dilationWidth]})),h==="leakyrelu"&&(S.push({type:"float32",data:[f]}),C.uniforms+=" alpha : f32,"),n.runWebGPUProgram(C,x,"float32",S)}const iOe={kernelName:Jw,backendName:"webgpu",kernelFunc:sOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oOe=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`gathernd_${e}`,this.sliceDim=e,this.uniforms=`sliceDim : i32, strides : ${Ar(e)},`}getUserCode(){let e;return this.sliceDim>1?e="uniforms.strides[j]":e="uniforms.strides",`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          var flattenIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexTemp = i32(round(getIndices(coords[0], j)));
            let strideNum = ${e};
            flattenIndex = flattenIndex + indexTemp * strideNum;
          }

          setOutputAtIndex(index, getA(flattenIndex, coords[1]));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aOe(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=Ue(r.shape),[l,u,c,d]=xT(r,s),h=It({inputs:{x:s},backend:n,attrs:{shape:[u,o]}}),f=It({inputs:{x:r},backend:n,attrs:{shape:[Ue(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const b=n.readSync(s.dataId),S=n.bufferSync(r),C=b$e(b,S,r.dtype,u,o,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,C.values)}const m=new oOe(o,[u,c]),g=[{type:"int32",data:[o]},{type:"int32",data:d}],x=n.runWebGPUProgram(m,[f,h],f.dtype,g),w=It({inputs:{x},backend:n,attrs:{shape:l}});return n.disposeData(h.dataId),n.disposeData(f.dataId),n.disposeData(x.dataId),w}const lOe={kernelName:xk,backendName:"webgpu",kernelFunc:aOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let uOe=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.slice(),this.aShape=e,this.outputShape=n,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}getUserCode(){const e=cOe(this.aShape);return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let indexZ = i32(getIndices(resRC.x, resRC.z));
          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);
          setOutputAtIndex(index, inBounds * getA(${e}));
        }
      }
    `}};function cOe(t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<t.length;r++)r===2?n.push("indexZ"):n.push(`${e[r]}`);return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,l=Jt(o,s.shape)[0],u=zT(s,i,l,a),c=Ue(i.shape),d=[],h=It({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=It({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(f);const m=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,i])){const S=n.tensorMap.get(f.dataId).values,C=Zt(f.shape,f.dtype,S),D=n.tensorMap.get(h.dataId).values,P=Zt(h.shape,h.dtype,D),I=v$e(P,C,m);return d.forEach(E=>n.disposeData(E.dataId)),n.makeTensorInfo(u.outputShape,I.dtype,I.values)}const g=new uOe(h.shape,m),x=n.runWebGPUProgram(g,[h,f],h.dtype);d.push(x);const w=It({inputs:{x},backend:n,attrs:{shape:u.outputShape}});return d.forEach(b=>n.disposeData(b.dataId)),w}const dOe={kernelName:lb,backendName:"webgpu",kernelFunc:NZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hOe=bs({opType:Yt.GREATER,cpuKernelImpl:C$e,dtype:"bool"}),fOe={kernelName:ub,backendName:"webgpu",kernelFunc:hOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pOe=bs({opType:Yt.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:S$e}),mOe={kernelName:U0,backendName:"webgpu",kernelFunc:pOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gOe(t){const{inputs:e,backend:n}=t,{input:r}=e;return IZ(r,!0,n)}const yOe={kernelName:wk,backendName:"webgpu",kernelFunc:gOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xOe=wn({opType:ot.IS_FINITE,dtype:"bool"}),wOe={kernelName:j0,backendName:"webgpu",kernelFunc:xOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bOe=wn({opType:ot.IS_INF,dtype:"bool"}),vOe={kernelName:W0,backendName:"webgpu",kernelFunc:bOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SOe=wn({opType:ot.IS_NAN,dtype:"bool"}),COe={kernelName:G0,backendName:"webgpu",kernelFunc:SOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r,o=[{type:"float32",data:[i]}],a=new Cy(s.shape,ot.LEAKYRELU,"alpha : f32,");return n.runWebGPUProgram(a,[s],"float32",o)}const NOe={kernelName:cb,backendName:"webgpu",kernelFunc:IOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kOe=bs({opType:Yt.LESS,dtype:"bool",cpuKernelImpl:N$e}),TOe={kernelName:db,backendName:"webgpu",kernelFunc:kOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EOe=bs({opType:Yt.LESS_EQUAL,dtype:"bool",cpuKernelImpl:I$e}),_Oe={kernelName:hb,backendName:"webgpu",kernelFunc:EOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AOe{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Oe(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=(s-r)/(i-1),a=new AOe(i),l=[{type:"float32",data:[r]},{type:"float32",data:[o]}];return e.runWebGPUProgram(a,[],"float32",l)}const ROe={kernelName:vk,backendName:"webgpu",kernelFunc:$Oe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MOe=wn({opType:ot.LOG,cpuKernelImpl:k$e}),DOe={kernelName:H0,backendName:"webgpu",kernelFunc:MOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OOe=wn({opType:ot.LOG1P}),POe={kernelName:Y0,backendName:"webgpu",kernelFunc:OOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FOe=bs({opType:Yt.LOGICAL_AND,dtype:"bool"}),LOe={kernelName:fb,backendName:"webgpu",kernelFunc:FOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zOe=wn({opType:ot.LOGICAL_NOT}),BOe={kernelName:pb,backendName:"webgpu",kernelFunc:zOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UOe=bs({opType:Yt.LOGICAL_OR}),VOe={kernelName:mb,backendName:"webgpu",kernelFunc:UOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kZ=`
  var powValue = 0.0;
  let basis = uniforms.bias + uniforms.alpha * sum;
  if (uniforms.beta == 0.5) {
    powValue = inverseSqrt(basis);
  } else if (uniforms.beta == 1.0) {
    powValue = 1.0 / basis;
  } else {
    powValue = exp(log(basis) * (-uniforms.beta));
  }
`;let jOe=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];
        let d = coords[3];

        let x = getX(b, r, c, d);
        var sum = 0.0;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let idx = d + i;
          if (idx >= 0 && idx < uniforms.xShape[3]) {
            let z = getX(b, r, c, idx);
            sum = sum + z * z;
          }
        }
        ${kZ}

        setOutputAtIndex(index, x * powValue);
      }
    }
  `}};class WOe{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,ae(n<=this.maxAllowRadius,()=>`Radius must be less than or equal to ${this.maxAllowRadius}, current radius is ${n}`),this.outputShape=e,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=ct(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}getUserCode(){return`
    var <workgroup>lrnSub: array<f32, ${this.workgroupSize[0]}>;
    const elementsPerWorkgroup = ${this.elementsPerWorkgroup};
    const maxAllowRadius = ${this.maxAllowRadius};

    ${ut()} {
      let localDepth = i32(localId.x);
      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;
      let xDepth = workgroupDepth + localDepth - maxAllowRadius;
      let b = i32(globalId.z) / uniforms.xShape[1];
      let r = i32(globalId.z) - b * uniforms.xShape[1];
      let c = i32(globalId.y);
      let d = workgroupDepth + localDepth;

      var x = 0.0;
      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {
        x = getX(b, r, c, xDepth);
      }
      lrnSub[localDepth] = x;
      workgroupBarrier();

      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {
        var sum = 0.0;
        let index = localDepth + maxAllowRadius;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let z = lrnSub[index + i];
          sum = sum + z * z;
        }
        ${kZ}

        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);
      }
    } `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r;let u;i>16?u=new jOe(s.shape):u=new WOe(s.shape,i);const c=[{type:"int32",data:[i]},{type:"float32",data:[o]},{type:"float32",data:[a]},{type:"float32",data:[l]}];return n.runWebGPUProgram(u,[s],s.dtype,c)}const HOe={kernelName:gb,backendName:"webgpu",kernelFunc:GOe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let YOe=class{constructor(e){this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];

        let MIN_DEPTH_BEGIN = 0;
        let MAX_DEPTH_END = uniforms.outShape[3];
        var result = 0.0;
        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {
          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);
          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);

          var norm = 0.0;
          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            } else {
              break;
            }
          }

          norm = uniforms.alpha * norm + uniforms.bias;

          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              var dyi = -2.0 * uniforms.alpha * uniforms.beta
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * uniforms.beta);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            } else {
              break;
            }
          }
        }

        setOutputAtIndex(index, result);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new YOe(s.shape),h=[{type:"int32",data:[a]},{type:"float32",data:[l]},{type:"float32",data:[u]},{type:"float32",data:[c]}];return n.runWebGPUProgram(d,[s,i,o],s.dtype,h)}const qOe={kernelName:Sk,backendName:"webgpu",kernelFunc:KOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XOe=bs({opType:Yt.MAX,cpuKernelImpl:E$e}),ZOe={kernelName:K0,backendName:"webgpu",kernelFunc:XOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,c=Ws(s.shape,i,o,1,a,l);return pZ(s,c,"max",n)}const JOe={kernelName:xb,backendName:"webgpu",kernelFunc:QOe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ePe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Xo(s.shape,i,o,c,a,u,l),h=new AP(d,"max"),f=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[s],s.dtype,f)}const tPe={kernelName:wb,backendName:"webgpu",kernelFunc:ePe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nPe=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}getUserCode(){return`
      ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);
            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            let curPosValue = wR * uniforms.filterDims[1] + wC;
            let mask = select(0.0, 1.0, maxPosValue == curPosValue);
            dotProd += dyValue * mask;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},rPe=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}getUserCode(){return`
      ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;

        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;
              let mask = select(0.0, 1.0, maxPosValue == curPosValue);
              dotProd += dyValue * mask;
            }
          }
        }

        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sPe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Xo(o.shape,a,l,d,u,c),f=new AP(h,"max",!0);let m=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.front,h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.inDepth,h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]}];const g=n.runWebGPUProgram(f,[o],"int32",m),x=new rPe(h);m=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterDepth-1-h.padInfo.front,h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outDepth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const w=n.runWebGPUProgram(x,[s,g],o.dtype,m);return n.disposeData(g.dataId),w}const iPe={kernelName:Ik,backendName:"webgpu",kernelFunc:sPe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oPe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;fX([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=Ws(a.shape,l,u,1,c,d),f=new l1(h,"max",!0);let m=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]}];const g=n.runWebGPUProgram(f,[a],"int32",m),x=new nPe(h);m=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const w=n.runWebGPUProgram(x,[s,g],a.dtype,m);return n.disposeData(g.dataId),w}const aPe={kernelName:Ck,backendName:"webgpu",kernelFunc:oPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lPe(t){const{inputs:e,backend:n,attrs:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=r,{x:l}=e;ae(l.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.shape.length}.`);const u=[1,1];ae(as(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ws(l.shape,s,i,u,o),d=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.inHeight,c.inWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]}];let h=new l1(c,"max",!1);const f=n.runWebGPUProgram(h,[l],l.dtype,d);h=new l1(c,"max",!0,!0,a);const m=n.runWebGPUProgram(h,[l],"int32",d);return[f,m]}const uPe={kernelName:Nk,backendName:"webgpu",kernelFunc:lPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return qp(s,i,o,"min",n)}const dPe={kernelName:vb,backendName:"webgpu",kernelFunc:cPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hPe=bs({opType:Yt.MIN,cpuKernelImpl:_$e}),fPe={kernelName:q0,backendName:"webgpu",kernelFunc:hPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let pPe=class{constructor(e,n,r){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((s,i)=>s[0]+e[i]+s[1]),this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,n.map((s,i)=>{this.uniforms+=` pad${i} : vec2<i32>,`}),this.offset=r==="reflect"?0:1,this.shaderKey=`mirrorPad_${r}`}getUserCode(){const e=this.xShape.length,n=this.xShape.map((u,c)=>`uniforms.pad${c}[0]`).join(","),r=this.xShape.map((u,c)=>`uniforms.pad${c}[0] + uniforms.xShape${e>1?`[${c}]`:""}`).join(","),s=e===1?"start":"start[i]",i=e===1?"end":"end[i]",o=e===1?"outC":"outC[i]",a=Ar(e),l=e>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,e):"coords";return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let start = ${a}(${n});
          let end = ${a}(${r});
          var outC = getCoordsFromIndex(index);
          for (var i = 0; i < ${e}; i = i + 1) {
            if (${o} < ${s}) {
              ${o} = ${s} * 2 - ${o} - ${this.offset};
            } else if(${o} >= ${i}) {
              ${o} = (${i} - 1) * 2 - ${o} + ${this.offset};
            }
          }
          let coords = outC - start;
          setOutputAtIndex(index, getX(${l}));
        }
      }
    `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mPe={kernelName:Sb,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{paddings:s,mode:i}=e,o=n,a=s.map(c=>({type:"int32",data:[c[0],c[1]]})),l=new pPe(r.shape,s,i);return o.runWebGPUProgram(l,[r],r.dtype,a)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gPe=bs({opType:Yt.MOD}),yPe={kernelName:X0,backendName:"webgpu",kernelFunc:gPe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xPe=class{constructor(e,n){this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}getUserCode(){return`
    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {
      let HASHSCALE1 = 443.8975;
      let p = resultUV * seed;
      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);
      p3 = p3 + dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${ut("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords[0];

        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),
            f32(coords[0]) / f32(uniforms.outShape[0]));
        let r = random(uniforms.seed, resUV);
        var cdf = 0.0;
        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {
          cdf = cdf + getProbs(batch, i);

          if (r < cdf) {
            setOutputAtIndexI32(index, i);
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wPe{constructor(e){this.variableNames=["logits"],this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}getUserCode(){return`
    var<workgroup> buf : array<f32, ${this.workgroupSize[0]}>;
    var<workgroup> rowMaxShared : f32;
    var<workgroup> rowSumShared : f32;
    const blockSize = ${this.workgroupSize[0]};
    ${ut("index")} {
      let row = index / blockSize;
      let tid = i32(localId.x);
      let cols = uniforms.outShape[1];

      var threadMax = -3.402823e+38f;
      for (var col = tid; col < cols; col += blockSize) {
        let value = getLogits(row, col);
        threadMax = max(threadMax, value);
      }
      if (tid < cols) {
        buf[tid] = threadMax;
      }
      workgroupBarrier();

      var reduceSize = min(cols, blockSize);
      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
        reduceSize = currSize + (reduceSize & 1);
        if (tid < currSize) {
          buf[tid] = max(buf[tid], buf[tid + reduceSize]);
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowMaxShared = buf[0];
      }
      workgroupBarrier();

      var threadSum = 0.0;
      for (var col = tid; col < cols; col += blockSize) {
        let subExp = exp(getLogits(row, col) - rowMaxShared);
        threadSum += subExp;
      }
      buf[tid] = threadSum;
      workgroupBarrier();

      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {
        if (tid < currSize) {
          buf[tid] = buf[tid] + buf[tid + currSize];
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowSumShared = buf[0];
      }
      workgroupBarrier();

      for (var col = tid; col < cols; col += blockSize) {
        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;
        setOutputAtCoords(row, col, value);
      }
  }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TZ(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=It({inputs:{x:s},backend:n,attrs:{shape:[Ue(s.shape)/s.shape[i],s.shape[i]]}}),a=new wPe(o.shape),l=n.runWebGPUProgram(a,[o],s.dtype),u=It({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeData(o.dataId),n.disposeData(l.dataId),u}const bPe={kernelName:Bb,backendName:"webgpu",kernelFunc:TZ};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vPe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,l=a?s:TZ({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new xPe(u,i),h=[{type:"float32",data:[o]},{type:"int32",data:[c]}],f=n.runWebGPUProgram(d,[l],"int32",h);return a||n.disposeData(l.dataId),f}const SPe={kernelName:kk,backendName:"webgpu",kernelFunc:vPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CPe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.tensorMap.get(r.dataId),[o,a]=$$e(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}const s=new Cy(r.shape,ot.NEG);return n.runWebGPUProgram(s,[r],r.dtype)}const IPe={kernelName:Cb,backendName:"webgpu",kernelFunc:CPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NPe(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),{selectedIndices:d}=gT(u,c,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const kPe={kernelName:Tk,backendName:"webgpu",kernelFunc:NPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TPe(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(i.dataId),h=o,f=a,m=l,g=u,{selectedIndices:x,selectedScores:w}=yT(c,d,h,f,m,g);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const EPe={kernelName:Ek,backendName:"webgpu",kernelFunc:TPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _Pe=class{constructor(e,n){this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}getUserCode(){return`
      ${ut("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,
                                      f32(i32(round(getX(coords.x))) == coords.y)));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function APe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r,u=Ue(s.shape),c=new _Pe(u,o),d=It({inputs:{x:s},backend:n,attrs:{shape:[u]}}),h=[{type:"float32",data:[a]},{type:"float32",data:[l]}],f=n.runWebGPUProgram(c,[d],i,h);n.disposeData(d.dataId);const m=[...s.shape,o],g=It({inputs:{x:f},backend:n,attrs:{shape:m}});return n.disposeData(f.dataId),g}const $Pe={kernelName:kb,backendName:"webgpu",kernelFunc:APe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LI(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=ev({inputs:{input:r},backend:n}),i=LI({inputs:{x:s},backend:n}),o=WT({inputs:{input:r},backend:n}),a=LI({inputs:{x:o},backend:n}),l=Kp({inputs:{real:i,imag:a},backend:n});return n.disposeData(s.dataId),n.disposeData(i.dataId),n.disposeData(o.dataId),n.disposeData(a.dataId),l}else return Bi({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const RPe={kernelName:jb,backendName:"webgpu",kernelFunc:LI};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=ev({inputs:{input:r},backend:n}),i=EZ({inputs:{x:s},backend:n}),o=WT({inputs:{input:r},backend:n}),a=LI({inputs:{x:o},backend:n}),l=Kp({inputs:{real:i,imag:a},backend:n});return n.disposeData(s.dataId),n.disposeData(i.dataId),n.disposeData(o.dataId),n.disposeData(a.dataId),l}else return Bi({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const MPe={kernelName:Nb,backendName:"webgpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DPe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return KR({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Wi(i,c.shape,"All tensors passed to stack must have matching shapes"),ae(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=KR({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=yZ({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeData(c.dataId)),u}const OPe={kernelName:Tb,backendName:"webgpu",kernelFunc:DPe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Z(t,e=!1){const n=t.length,r=Ar(n),s=t.map((d,h)=>`uniforms.pad${h}[0]`).join(","),i=t.map((d,h)=>`uniforms.pad${h}[0] + uniforms.xShape${n>1?`[${h}]`:""}`).join(","),o=n>1?`${r}(${s})`:`${s}`,a=n>1?`${r}(${i})`:`${i}`,l=n>1?"any(paddedCoords < start)":"paddedCoords < start",u=n>1?"any(paddedCoords >= end)":"paddedCoords >= end",c=n>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n):"coords";return`
        let start = ${o};
        let end = ${a};
        if (${l} || ${u}) {
          setOutputAtIndex(index, ${e?0:"uniforms.constantValue"});
        } else {
          let coords = paddedCoords - start;
          setOutputAtIndex(index, getX(${c}));
        }
  `}let PPe=class{constructor(e,n){this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((r,s)=>r[0]+e[s]+r[1]),this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),n.map((r,s)=>{this.uniforms+=` pad${s} : vec2<i32>,`}),this.xShape=e,this.shaderKey="pad"}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let paddedCoords = getCoordsFromIndex(index);
          ${_Z(this.xShape)}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FPe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;if(i.every(u=>nn(u,[0,0])))return wo({inputs:{x:s},backend:n});if(Ue(s.shape)===0){const u=i.map((c,d)=>c[0]+s.shape[d]+c[1]);return Bi({backend:n,attrs:{shape:u,value:o,dtype:s.dtype}})}const a=[{type:"float32",data:[o]}];i.map(u=>a.push({type:"int32",data:[u[0],u[1]]}));const l=new PPe(s.shape,i);return n.runWebGPUProgram(l,[s],s.dtype,a)},LPe={kernelName:Eb,backendName:"webgpu",kernelFunc:FPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zPe=bs({opType:Yt.POW}),BPe={kernelName:Q0,backendName:"webgpu",kernelFunc:zPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UPe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=new DI(Yt.PRELU,r.shape,s.shape);return n.runWebGPUProgram(i,[r,s],"float32")}const VPe={kernelName:_b,backendName:"webgpu",kernelFunc:UPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return qp(s,i,o,"prod",n)}const WPe={kernelName:Ab,backendName:"webgpu",kernelFunc:jPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GPe=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:o}=n,a=D$e(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},HPe={kernelName:_k,backendName:"webgpu",kernelFunc:GPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YPe=bs({opType:Yt.DIV}),KPe={kernelName:D0,backendName:"webgpu",kernelFunc:YPe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qPe=wn({opType:ot.RECIPROCAL}),XPe={kernelName:J0,backendName:"webgpu",kernelFunc:qPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZPe=wn({opType:ot.RELU}),QPe={kernelName:ey,backendName:"webgpu",kernelFunc:ZPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JPe=wn({opType:ot.RELU6}),e4e={kernelName:ty,backendName:"webgpu",kernelFunc:JPe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let t4e=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC =
            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *
            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);

          // Compute the four integer indices.
          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);
          let sourceCeilRC = vec2<i32>(
            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));

          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);
          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);
          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);
          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);

          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);

          let top = topLeft + (topRight - topLeft) * fracRC.y;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
          let newValue = top + (bottom - top) * fracRC.x;

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,size:o,halfPixelCenters:a}=r,[l,u]=o,c=i&&l>1?1:0,d=i&&u>1?1:0,f=[{type:"float32",data:[c,d]},{type:"float32",data:[a?.5:0]}],m=new t4e(s.shape,l,u);return n.runWebGPUProgram(m,[s],"float32",f)}const r4e={kernelName:Mb,backendName:"webgpu",kernelFunc:n4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let s4e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,
       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeBilinearBackprop_${n}`}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let dxR = f32(dyR) * uniforms.heightScale;
              let topDxRIndex = i32(floor(dxR));
              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));
              let dxRLerp = dxR - f32(topDxRIndex);
              let inverseDxRLerp = 1.0 - dxRLerp;

              let dxC = f32(dyC) * uniforms.widthScale;
              let leftDxCIndex = i32(floor(dxC));
              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));
              let dxCLerp = dxC - f32(leftDxCIndex);
              let inverseDxCLerp = 1.0 - dxCLerp;

              if (r == topDxRIndex && c == leftDxCIndex) {
                // topLeft
                accumulator +=
                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
              }

              if (r == topDxRIndex && c == rightDxCIndex) {
                // topRight
                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
              }

              if (r == bottomDxRIndex && c == leftDxCIndex) {
                // bottomLeft
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
              }

              if (r == bottomDxRIndex && c == rightDxCIndex) {
                // bottomRight
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,[,a,l]=s.shape,[,u,c]=i.shape,d=[o&&u>1?a-1:a,o&&c>1?l-1:l],h=[o&&u>1?u-1:u,o&&c>1?c-1:c],f=d[0]/h[0],m=d[1]/h[1],g=1/f,x=1/m,w=Math.ceil(g)*2+2,b=Math.ceil(x)*2+2,S=new s4e(s.shape,o),C=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[f]},{type:"float32",data:[m]},{type:"float32",data:[g]},{type:"float32",data:[x]},{type:"int32",data:[w]},{type:"int32",data:[b]}];return n.runWebGPUProgram(S,[i],i.dtype,C)}const o4e={kernelName:Rk,backendName:"webgpu",kernelFunc:i4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let a4e=class{constructor(e,n,r,s){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=s,this.shaderKey=`resizeNearest_${s}`}getUserCode(){let e;return this.halfPixelCenters?e="max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":e="vec2<f32>(rc) * effectiveInputOverOutputRatioRC",`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC = ${e};

          // Compute the coordinators of nearest neighbor point.
          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));
          let sourceNearestRC = vec2<i32>(
            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));
          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=i&&l>1?1:0,d=i&&u>1?1:0,f=[{type:"float32",data:[c,d]},{type:"float32",data:[i?.5:0]}],m=new a4e(s.shape,l,u,o);return n.runWebGPUProgram(m,[s],s.dtype,f)}const u4e={kernelName:Rb,backendName:"webgpu",kernelFunc:l4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let c4e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,
       winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeNearestNeigborBackprop_${n}`}getUserCode(){return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *
                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));

              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *
                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));

              let sourceNearestRow =
                  i32(min(f32(uniforms.outShape[1] - 1),
                  ${this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)"}));

              let sourceNearestCol =
                  i32(min(f32(uniforms.outShape[2] - 1),
                  ${this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)"}));

              if (r == sourceNearestRow && c == sourceNearestCol) {
                accumulator += getDy(b, dyR, dyC, d);
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,[,a,l]=s.shape,[,u,c]=i.shape,d=[o&&u>1?a-1:a,o&&c>1?l-1:l],h=[o&&u>1?u-1:u,o&&c>1?c-1:c],f=d[0]/h[0],m=d[1]/h[1],g=1/f,x=1/m,w=Math.ceil(g)*2+2,b=Math.ceil(x)*2+2,S=new c4e(s.shape,o),C=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[g]},{type:"float32",data:[x]},{type:"int32",data:[w]},{type:"int32",data:[b]}];return n.runWebGPUProgram(S,[i],i.dtype,C)}const h4e={kernelName:$k,backendName:"webgpu",kernelFunc:d4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let f4e=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}getUserCode(){return`
      
      // Using uniform variables as judging conditions, so the function has
      // coherent execution within all threads.
      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {
        var reverseCoords = coords;
        if (uniforms.axis[0] == 1) {
          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;
        }
        if (uniforms.axis[1] == 1) {
          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;
        }
        if (uniforms.axis[2] == 1) {
          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;
        }
        if (uniforms.axis[3] == 1) {
          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;
        }

        return reverseCoords;
      }
    
      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let reverseCoords = getReverseCoords(coords);
          setOutputAtIndex(index, getX(reverseCoords[0],
              reverseCoords[1], reverseCoords[2], reverseCoords[3]));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r,o=s.shape.length;if(o===0)return wo({inputs:{x:s},backend:n});const a=s.shape,l=[1,1,1,1];a.forEach((x,w)=>{const b=w+4-o;l[b]=x});const u=Jt(i,s.shape),c=[0,0,0,0];u.forEach(x=>{const w=x+4-o;c[w]=1});const d=[{type:"int32",data:c}],h=It({inputs:{x:s},backend:n,attrs:{shape:l}}),f=new f4e(l),m=n.runWebGPUProgram(f,[h],h.dtype,d);n.disposeData(h.dataId);const g=It({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeData(m.dataId),g}const m4e={kernelName:Db,backendName:"webgpu",kernelFunc:p4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let g4e=class{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`centerX : f32, centerY : f32, sinRadians : f32,
          cosRadians : f32,`,this.shaderKey="rotate",this.outputShape=e,typeof n=="number"?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}getUserCode(){return`
        ${ut("index")} {
          if (index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *
                uniforms.sinRadians;
            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *
                uniforms.cosRadians;
            let coordX = i32(round(coordXFloat + uniforms.centerX));
            let coordY = i32(round(coordYFloat + uniforms.centerY));
            ${this.fillSnippet}
            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&
                coordY < uniforms.xShape[1]) {
              outputValue = getX(coords[0], coordY, coordX, coords[3]);
            }
            setOutputAtIndex(index, outputValue);
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y4e={kernelName:Gk,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=new g4e(r.shape,i),[u,c]=IT(o,r.shape[1],r.shape[2]),d=[{type:"float32",data:[u]},{type:"float32",data:[c]},{type:"float32",data:[Math.sin(s)]},{type:"float32",data:[Math.cos(s)]}];return typeof i=="number"?d.push({type:"float32",data:[Number.parseFloat(i.toFixed(2))]}):d.push({type:"float32",data:i}),a.runWebGPUProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x4e=wn({opType:ot.ROUND}),w4e={kernelName:ny,backendName:"webgpu",kernelFunc:x4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b4e=wn({opType:ot.RSQRT,cpuKernelImpl:O$e}),v4e={kernelName:ry,backendName:"webgpu",kernelFunc:b4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Aw=class{constructor(e,n,r,s,i,o,a,l=!0){this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=o,this.type=a,this.sumDupeIndices=l,this.dispatchLayout=wt(e),this.dispatch=ct(this.dispatchLayout,e,this.workgroupSize),this.sliceDimGreaterThanOne=n>1,this.shaderKey=`scatter_${r}_${s}_${this.sliceDimGreaterThanOne}_${a}_${l}_${i.length}`;const u=Ar(i.length);this.uniforms=`sliceDim : i32, strides: ${u}, updatesSize: i32,`,this.updatesRank=s,this.indicesRank=r}getUserCode(){let e="";this.indicesRank===1?e="coords[0]":this.indicesRank===2&&(e="coords[0], j");const n=`getIndices(${e})`,r=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides";let s="",i="";this.dispatchLayout.x.length===1?(s="flattenedIndex",i=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {
        return index;
      }
      `):this.dispatchLayout.x.length===2&&(s="vec2<i32>(flattenedIndex, coords[1])",i=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {
        // N.B. |updates| could be a scalar tensor, conceptually representing a
        // 2D tensor with all values equal to that. By design, its size must be
        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|
        // gives the other.
        let sliceSize = uniforms.outShape[1];
        let d0 = index / sliceSize;
        let d1 = index - d0 * sliceSize;
        return vec2<i32>(d0, d1);
      }
      `);const a=`getUpdates(${Array.from({length:this.updatesRank},(u,c)=>`coords[${c}]`).join(", ")})`;return`
    ${i}
      ${ut("index")} {
        if (index < uniforms.updatesSize) {
          let coords = getUpdatesCoordsFromFlatIndex(index);
          var flattenedIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexInside = i32(round(${n}));
            flattenedIndex = flattenedIndex + indexInside * ${r};
          }
          let updateValue =
              ${Bf(this.type)}(${a});
          let flatIndex = getOutputIndexFromCoords(${s});

          ${this.sumDupeIndices?Ph("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));"}
        }
      }`}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S4e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Pu(i,s,o),h=[d/u,u];if(d===0)return n.makeTensorInfo(o,s.dtype);const f=It({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),m=It({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=m.dtype,x=Bi({backend:n,attrs:{shape:h,value:0,dtype:g}}),w=Ue(m.shape),b=[{type:"int32",data:[a]},{type:"int32",data:c},{type:"int32",data:[w]}],S=new Aw(m.shape,a,f.shape.length,m.shape.length,c,h,g),C=n.runWebGPUProgram(S,[m,f],g,b,x),T=It({inputs:{x:C},backend:n,attrs:{shape:o}});return n.disposeData(f.dataId),n.disposeData(m.dataId),n.disposeData(C.dataId),T}const C4e={kernelName:Mk,backendName:"webgpu",kernelFunc:S4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let I4e=class{constructor(e,n){this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=n,this.shaderKey=`search_sorted_${n}`}getUserCode(){return`
      fn findBound(batch: i32, value: f32) -> i32 {
        var left = i32(0);
        var right = uniforms.numInputs;
        while (left < right) {
          var mid = (left + right) / 2;
          if (getSortedSequence(batch, mid) ${this.side==="left"?"<":"<="} value) {
            left = mid + 1;
          } else {
            right = mid;
          }
        }
        return right;
      }

      ${ut("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let value = getValuesByOutputIndex(index);
          setOutputAtIndexI32(index, findBound(coords[0], value));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4e(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=new I4e([i.shape[0],i.shape[1]],o),l=[{type:"int32",data:[s.shape[1]]}];return n.runWebGPUProgram(a,[s,i],"int32",l)}const k4e={kernelName:Ok,backendName:"webgpu",kernelFunc:N4e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let T4e=class{constructor(e,n,r){this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=e,this.rank=r,this.shaderKey="select"}getUserCode(){let e,n;if(this.rank>4)throw Error(`Where for rank ${this.rank} is not yet supported`);if(this.rank===1)n="resRC",e="resRC";else{const s=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=[];for(let a=0;a<this.outputShape.length;a++)o.push(`${s[a]}`),a<this.cRank&&i.push(`${s[a]}`);e=i.join(),n=o.join()}return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let cVal = getC(${e});
          if (cVal >= 1.0) {
            setOutputAtIndex(index, getA(${n}));
          } else {
            setOutputAtIndex(index, getB(${n}));
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4e(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,o=new T4e(r.shape.length,s.shape,s.shape.length);return n.runWebGPUProgram(o,[r,s,i],ws(s.dtype,i.dtype))}const _4e={kernelName:Ob,backendName:"webgpu",kernelFunc:E4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A4e=wn({opType:ot.SELU}),$4e={kernelName:sy,backendName:"webgpu",kernelFunc:A4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R4e=wn({opType:ot.SIGMOID}),M4e={kernelName:ly,backendName:"webgpu",kernelFunc:R4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4e=wn({opType:ot.SIGN}),O4e={kernelName:ay,backendName:"webgpu",kernelFunc:D4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P4e=wn({opType:ot.SIN}),F4e={kernelName:iy,backendName:"webgpu",kernelFunc:P4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4e=wn({opType:ot.SINH}),z4e={kernelName:oy,backendName:"webgpu",kernelFunc:L4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B4e=wn({opType:ot.SOFTPLUS}),U4e={kernelName:uy,backendName:"webgpu",kernelFunc:B4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V4e{constructor(e,n,r,s,i,o){this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;const a=new Array(s.length);for(let l=0;l<a.length;l++)a[l]=s[i[l]];this.outputShape=a,this.newDim=i,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,this.paddedXShape=n,this.uniforms+=`reshapedPaddedXShape : ${Ar(s.length)}, paddedXShapeStrides : ${Ar(o)}, `,r.map((l,u)=>{this.uniforms+=` pad${u} : vec2<i32>,`}),this.shaderKey=`spaceToBatchND_${i}`}getUserCode(){const e=Ar(this.outputShape.length),n=cZ(this.newDim);return`
      ${OC(this.paddedXShape,"PaddedX")}
      ${ut("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let switchedIndex = getIndexFromCoords${this.outputShape.length}D(${e}(${n}), uniforms.reshapedPaddedXShape);
          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);
          ${_Z(this.xShape,!0)}
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j4e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;ae(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet");const a=i.reduce((b,S)=>b*S),l=[[0,0]];l.push(...o);for(let b=1+i.length;b<s.shape.length;++b)l.push([0,0]);const u=l.map((b,S)=>b[0]+s.shape[S]+b[1]),c=Wp(u,i,a,!1),d=Gp(c.length,i.length,!1),h=Hp(u,i,a,!1),f=$t(u),m=new V4e(s.shape,u,l,c,d,f.length),g=[{type:"int32",data:c},{type:"int32",data:f}];l.map(b=>g.push({type:"int32",data:[b[0],b[1]]}));const x=n.runWebGPUProgram(m,[s],s.dtype,g),w=It({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeData(x.dataId),w},W4e={kernelName:Lb,backendName:"webgpu",kernelFunc:j4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G4e{constructor(e,n,r){this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e,this.type=r,this.dispatchLayout=wt([n]),this.dispatch=ct(this.dispatchLayout,[n],this.workgroupSize),this.shaderKey="sparseSegmentSum"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.sparseSize) {
        let indexInSegmentIds = index / uniforms.segmentSize;
        let indexInSegment = index % uniforms.segmentSize;
        let indexInInput = indices[indexInSegmentIds];
        let segmentId = segmentIds[indexInSegmentIds];

        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];
        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;
        ${Ph("&result[outIndex]","value",this.type)}
      }
    }
  `}}class H4e{constructor(e,n){this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[e],this.dispatchLayout=wt(n),this.dispatch=ct(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.segmentIdsShape) {
        let segmentId = segmentIds[index];
        ${Ph("&result[segmentId]","1","int32")}
      }
    }
  `}}class Y4e{constructor(e,n){this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.type=n,this.dispatchLayout=wt(e),this.dispatch=ct(this.dispatchLayout,e,this.workgroupSize),this.shaderKey="sparseSegmentMean"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.size) {
        let segmentId = index / uniforms.segmentSize;
        let count = sameSegmentIdCount[segmentId];
        if (count != 0) {
          ${this.type==="float32"?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);"}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(t,e,n,r=!1,s){const o=Ue(t.shape)/t.shape[0],a=t.dtype,l=Ue(e.shape),u=s.readSync(n.dataId),d=l>0?u[l-1]+1:0;let h;const f=t.shape.slice();f[0]=d;const m=l*o,g=Bi({backend:s,attrs:{shape:f,value:0,dtype:a}});h=new G4e(f,m,a);let x=[{type:"int32",data:[o]},{type:"int32",data:[m]}];const w=s.runWebGPUProgram(h,[t,e,n],a,x,g);if(r)return w;const b=Bi({backend:s,attrs:{shape:[d],value:0,dtype:"int32"}});h=new H4e(d,n.shape);const S=s.runWebGPUProgram(h,[n],"int32",null,b),C=Bi({backend:s,attrs:{shape:f,value:0,dtype:a}});h=new Y4e(f,a),x=[{type:"int32",data:[o]}];const T=s.runWebGPUProgram(h,[w,S],a,x,C);return s.disposeData(w.dataId),s.disposeData(S.dataId),T}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K4e(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;return AZ(r,s,i,!1,n)}const q4e={kernelName:Pk,backendName:"webgpu",kernelFunc:K4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4e(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;return AZ(r,s,i,!0,n)}const Z4e={kernelName:Fk,backendName:"webgpu",kernelFunc:X4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Q4e=class{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[s]*n[s];this.outputShape=r,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}getUserCode(){const e=J4e(this.rank,"uniforms.");return`
      ${ut("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          setOutputAtIndex(index, getA(${e}));
        }
      }
    `}};function J4e(t,e=""){if(t>=5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`(resRC % ${e}aShape)`;const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t;s++)r.push(`(${n[s]} % ${e}aShape[${s}])`);return r.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $P(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;if(n.shouldExecuteOnCPU([s])||s.dtype==="string"||s.shape.length>=5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(h=>Cl(h)):l,c=Zt(s.shape,s.dtype,u),d=V$e(c,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new Q4e(s.shape,i);return n.runWebGPUProgram(o,[s],s.dtype)}const eFe={kernelName:my,backendName:"webgpu",kernelFunc:$P};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tFe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Pu(i,s,a),f=!1;if(i.dtype==="string"){const I=n.bufferSync(s),E=n.bufferSync(i),M=Cl(n.readSync(o.dataId)[0]),O=P$e(I,E,a,h,c,u,l,d,M,f);return n.makeTensorInfo(a,O.dtype,O.values)}const m=[h/c,c],g=It({inputs:{x:s},backend:n,attrs:{shape:[u,l]}}),x=i.shape.length?It({inputs:{x:i},backend:n,attrs:{shape:[u,c]}}):wo({inputs:{x:i},backend:n}),w=x.dtype,b=n.makeTensorInfo([],w,As(1,w)),S=It({inputs:{x:o},backend:n,attrs:{shape:Array(m.length).fill(1)}}),C=$P({inputs:{x:S},backend:n,attrs:{reps:m}}),T=Ue([u,c]),D=[{type:"int32",data:[l]},{type:"int32",data:d},{type:"int32",data:[T]}];switch(u){case 0:break;case 1:{const I=new Aw([u,c],l,g.shape.length,x.shape.length,d,m,w,f);n.runWebGPUProgram(I,[x,g],w,D,C)}break;default:{const I=new Aw([u,c],l,g.shape.length,b.shape.length,d,m,w,f);n.runWebGPUProgram(I,[b,g],w,D,C)}{const I=new Aw([u,c],l,g.shape.length,x.shape.length,d,m,w);n.runWebGPUProgram(I,[x,g],w,D,C)}}const P=It({inputs:{x:C},backend:n,attrs:{shape:a}});return n.disposeData(g.dataId),n.disposeData(x.dataId),n.disposeData(S.dataId),n.disposeData(b.dataId),n.disposeData(C.dataId),P}const nFe={kernelName:Lk,backendName:"webgpu",kernelFunc:tFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Jt(o,s.shape)[0],l=LT(s,i,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const m=Iy({inputs:{x:s},backend:n,attrs:{begin:c,size:f}});return c[a]+=h,m})}const sFe={kernelName:zb,backendName:"webgpu",kernelFunc:rFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iFe=wn({opType:ot.SQRT}),oFe={kernelName:cy,backendName:"webgpu",kernelFunc:iFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aFe={kernelName:zk,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e,s=new Cy(n.shape,ot.SQUARE);return r.runWebGPUProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lFe=bs({opType:Yt.SQUARED_DIFFERENCE}),uFe={kernelName:dy,backendName:"webgpu",kernelFunc:lFe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cFe({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=new Cy(r.shape,ot.STEP,"stepAlpha : f32,"),i=[{type:"float32",data:[e.alpha]}];return n.runWebGPUProgram(s,[r],r.dtype,i)}const dFe={kernelName:gy,backendName:"webgpu",kernelFunc:cFe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hFe=class{constructor(e){this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);const n=Ar(this.outputShape.length);this.uniforms=`begin : ${n},  strides : ${n}, `,this.shaderKey="stridedSlice"}getUserCode(){const e=this.outputShape.length;let n="";if(e===1)n="coords * uniforms.strides + uniforms.begin";else{let s=0;n=this.outputShape.map((i,o)=>(s++,this.outputShape.length===1?`coords * uniforms.strides[${o}] + uniforms.begin[${o}]`:`coords[${s-1}] * uniforms.strides[${o}] + uniforms.begin[${o}]`)).join(",")}return`
       ${ut("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index);
           setOutputAtIndex(index, getX(${n}));
         }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:x,isSimpleSlice:w,begin:b,end:S,strides:C}=vT(s.shape,i,o,a,l,u,c,d,h);let T;if(g)T=It({inputs:{x:s},backend:n,attrs:{shape:m}});else if(x||w){ae(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const D=bT(b,S,C),P=Iy({inputs:{x:s},backend:n,attrs:{begin:b,size:D}});T=It({inputs:{x:P},backend:n,attrs:{shape:m}}),n.disposeData(P.dataId)}else if(n.shouldExecuteOnCPU([s])){const P=n.readSync(s.dataId),I=Zt(s.shape,s.dtype,P),E=z$e(f,I,C,b);T=n.makeTensorInfo(m,s.dtype,E.values)}else{const P=new hFe(f),I=[{type:"int32",data:b},{type:"int32",data:C}],E=n.runWebGPUProgram(P,[s],s.dtype,I);T=It({inputs:{x:E},backend:n,attrs:{shape:m}}),n.disposeData(E.dataId)}return T}const pFe={kernelName:Uk,backendName:"webgpu",kernelFunc:fFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mFe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,h=n.readSync(c.dataId),f=n.readSync(d.dataId),[m,g]=B$e(h,f,s,i,o,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",g)]}const gFe={kernelName:Vk,backendName:"webgpu",kernelFunc:mFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yFe=bs({opType:Yt.SUB,cpuKernelImpl:U$e,supportsComplex:!0}),xFe={kernelName:hy,backendName:"webgpu",kernelFunc:yFe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wFe=wn({opType:ot.TAN}),bFe={kernelName:fy,backendName:"webgpu",kernelFunc:wFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vFe=wn({opType:ot.TANH}),SFe={kernelName:py,backendName:"webgpu",kernelFunc:vFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CFe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Pu(o,i,s.shape),h=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,i.dtype);const f=[],m=It({inputs:{x:i},backend:n,attrs:{shape:[l,a]}});f.push(m);const g=It({inputs:{x:o},backend:n,attrs:{shape:[l,u]}});f.push(g);const x=It({inputs:{x:s},backend:n,attrs:{shape:h}});f.push(x);const w=$P({inputs:{x},backend:n,attrs:{reps:Array(h.length).fill(1)}}),b=new Aw([l,u],a,m.shape.length,g.shape.length,c,h,s.dtype,!1),S=Ue([l,u]),C=[{type:"int32",data:[a]},{type:"int32",data:c},{type:"int32",data:[S]}],T=n.runWebGPUProgram(b,[g,m],x.dtype,C,w);f.push(T);const D=It({inputs:{x:T},backend:n,attrs:{shape:s.shape}});return f.forEach(P=>n.disposeData(P.dataId)),D}const IFe={kernelName:Dk,backendName:"webgpu",kernelFunc:CFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let NFe=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`inputSize : i32, firstPass : i32, negativeInf : f32,
        dir : i32, inc : i32,`,this.shaderKey="swap"}getUserCode(){return`
        ${ut("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // We compare elements pair-wise within a group of size 2 * inc.
            // The comparing rule for each group alternates between ascending
            // and descending. Within each group, we compare each pair at
            // positions i and i+inc. To decide whether an element at position i
            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
            // inc, it is in the first half of the group, we denote it as x0,
            // otherwise we denote it as x1.
            // For example, as shown in the Bitonic top K paper referenced
            // above, Figure5(a) shows that element[1] is in the second half of
            // the group when group size is 2, but it is in the first half of
            // the group when group size is 4.
            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;
            var i = 0;
            if (isFirstInPair) {
              i = elemIdx;
            } else {
              i = elemIdx - uniforms.inc;
            }

            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }

            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.inc;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.inc));
            }

            var x0 = f32(0.0);
            var x1 = f32(0.0);
            if (i0 < uniforms.inputSize) {
              x0 = getX(batch, i0);
            } else {
              x0 = uniforms.negativeInf;
            }
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = uniforms.negativeInf;
            }

            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;
            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
            if (reverse == isGreater) {
              // Elements in opposite order of direction
              let iTemp = i0;
              i0 = i1;
              i1 = iTemp;
            }
            if (isFirstInPair) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}},kFe=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}getUserCode(){return`
        ${ut("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // The output size is half of the previous size.
            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _
            // (k=4), we only need to output the indices at positions |, the
            // indices at positions _ can be thrown away, see Figure5(b) After
            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced
            // above.
            // For example, the paper shows we only need to output the orange
            // bars. The output sequence should look like this | | | | | | | |.
            // Because the sequence is halved, to map the output index back to
            // the previous sequence to find the corresponding value, we need
            // to double the index. When we double the index, we basically
            // interpolate a position, so 2i looks like
            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k
            // position of each 2k positions by - elemIdx % k. E.g. for output
            // at index 4,5,6,7, we want to get the corresponding element at
            // original index 8,9,10,11, for output at index 8,9,10,11,
            // we want to get the corresponding element at original index
            // 16,17,18,19, so on and so forth.

            var i = 0;
            if (elemIdx < uniforms.k) {
              i = elemIdx;
            } else {
              i = elemIdx * 2 - elemIdx % uniforms.k;
            }
            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }
            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.k;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.k));
            }

            let x0 = getX(batch, i0);
            var x1 = f32(0.0);
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = x0;
            }

            if (x0 >= x1) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qm(t,e){e!==null&&t.disposeData(e.dataId)}function TV(t){let e=1;for(;e<t;)e*=2;return e}function TFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r,a=s.shape,l=a[a.length-1];if(n.shouldExecuteOnCPU([s])){const T=n.readSync(s.dataId),[D,P]=j$e(T,a,s.dtype,i,o);return[n.makeTensorInfo(D.shape,D.dtype,D.values),n.makeTensorInfo(P.shape,P.dtype,P.values)]}if(i===0)return a[a.length-1]=0,[n.makeTensorInfo(a,s.dtype,[]),n.makeTensorInfo(a,"int32",[])];if(l===1)return[s,Bi({attrs:{shape:a,dtype:"int32",value:0},backend:n})];const c=Ue(a)/l,d=It({inputs:{x:s},attrs:{shape:[c,l]},backend:n}),h=TV(i),f=TV(l);let m=null;const g=()=>m===null?[d,d]:[d,m],x=(T,D,P)=>{const I=g(),E=new NFe(P),O=[{type:"int32",data:[l]},{type:"int32",data:[m===null?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[T]},{type:"int32",data:[D]}],j=m;m=n.runWebGPUProgram(E,I,"int32",O),qm(n,j)};for(let T=1;T<h;T*=2){const D=T*2;for(let P=T;P>=1;P/=2)x(D,P,[c,f])}for(let T=f;T>h;T/=2){const D=g(),P=new kFe([c,T/2]),E=[{type:"int32",data:[l]},{type:"int32",data:[m===null?1:0]},{type:"int32",data:[h]}],M=m;m=n.runWebGPUProgram(P,D,"int32",E),qm(n,M);const O=h/2,j=O*2;for(let R=O;R>=1;R/=2)x(j,R,m.shape)}let w=m;m=Iy({inputs:{x:m},backend:n,attrs:{begin:0,size:[c,i]}}),qm(n,w);let b=NZ({inputs:{x:d,indices:m},backend:n,attrs:{axis:1,batchDims:1}});qm(n,d);const S=a.slice(0,-1);S.push(i),w=m,m=It({inputs:{x:m},attrs:{shape:S},backend:n}),qm(n,w);const C=b;return b=It({inputs:{x:b},attrs:{shape:S},backend:n}),qm(n,C),[b,m]}const EFe={kernelName:jk,backendName:"webgpu",kernelFunc:TFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _Fe=class{constructor(e){this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}getUserCode(){return`
          fn mapCoord(outCoord : f32, len : f32) -> f32{
            var inCoord = outCoord;
            if(uniforms.fillModeId == 2) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  if (inCoord < sz2) {
                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +
                    inCoord;
                  }
                  if (inCoord < -len) {
                    inCoord = inCoord + sz2;
                  } else {
                    inCoord = -inCoord - 1.0;
                  }
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));
                  if (inCoord >= len) {
                    inCoord = sz2 - inCoord - 1.0;
                  }
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 3) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 4) {
              return clamp(outCoord, 0.0, len - 1.0);
            }
            return outCoord;
          }
          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,
            channel : i32) -> f32 {
            var outputValue : f32;
            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {
                outputValue = getImage(batch, coordY, coordX, channel);
            } else {
              outputValue = uniforms.fillValue;
            }
            return outputValue;
          }

          ${ut("index")} {
            if (index < uniforms.size) {
              let coords = getCoordsFromIndex(index);
              var outputValue : f32;
              let batch = coords[0];
              let x = coords[2];
              let y = coords[1];
              let channel = coords[3];
              let xf = f32(x);
              let yf = f32(y);
              let a1 = getTransforms(batch, 0);
              let a2 = getTransforms(batch, 1);
              let a3 = getTransforms(batch, 2);
              let b1 = getTransforms(batch, 3);
              let b2 = getTransforms(batch, 4);
              let b3 = getTransforms(batch, 5);
              let c1 = getTransforms(batch, 6);
              let c2 = getTransforms(batch, 7);
              let projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = uniforms.fillValue;
              } else {
                let inX = (a1 * xf + a2 * yf + a3) / projection;
                let inY = (b1 * xf + b2 * yf + b3) / projection;
                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));
                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));

                if (uniforms.interpolationModeId == 1) {
                  let coordY = i32(round(mapY));
                  let coordX = i32(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  let yFloor = floor(mapY);
                  let xFloor = floor(mapX);
                  let yCeil = yFloor + 1.0;
                  let xCeil = xFloor + 1.0;
                  let valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);
                  let valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutputAtIndex(index, outputValue);
            }
          }
        `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AFe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,h,f]=s.shape,[m,g]=u??[d,h],x=[c,m,g,f],w=new _Fe(x),b=o==="nearest"?1:2;let S;switch(a){case"constant":S=1;break;case"reflect":S=2;break;case"wrap":S=3;break;case"nearest":S=4;break;default:S=1;break}const C=[{type:"int32",data:[b]},{type:"int32",data:[S]},{type:"float32",data:[l]}];return n.runWebGPUProgram(w,[s,i],"float32",C)}const $Fe={kernelName:Wk,backendName:"webgpu",kernelFunc:AFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RFe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[i],u=new Array(a-1);let c=0;for(let g=0;g<a;g++)g!==i&&(u[c++]=o.shape[g]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const m=new Array(l);for(let g=0;g<m.length;g++){h[i]=g;const x=Iy({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),w=It({inputs:{x},backend:n,attrs:{shape:u}});m[g]=w,d.push(x)}return d.forEach(g=>n.disposeData(g.dataId)),m}const MFe={kernelName:Ub,backendName:"webgpu",kernelFunc:RFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DFe{constructor(e,n,r){if(this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=n,this.dispatchLayout=wt(e),this.dispatch=ct(this.dispatchLayout,e,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`UnsortedSegmentSum only supports float32 and int32
              types, does not support ${r} type.`);this.type=r,this.shaderKey="unsortedSegmentSum"}getUserCode(){return`
    ${ut("index")} {
      if (index < uniforms.xSize) {
        let coords = getXCoordsFromIndex(index);
        let b = coords[0];
        let inCol = coords[1];

        let segmentId = i32(getSegmentIds(inCol));
        if (segmentId >= 0) {
          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;
          let value = getX(b, inCol);

          ${Ph("&result[flatIndex]","value",this.type)}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,l=[];let u=0;const c=zn([u],a);let d=s;c!=null&&(d=Eu({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=qn(1,a)[0]);const h=bP(d.shape,u,o),f=Ue([d.shape[u]]),m=It({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(m);const g=s.dtype,x=[m.shape[0],o],w=Bi({backend:n,attrs:{shape:x,value:0,dtype:g}}),b=new DFe(m.shape,x,g),S=[{type:"int32",data:[o]},{type:"int32",data:[Ue(m.shape)]}],C=n.runWebGPUProgram(b,[m,i],g,S,w),T=It({inputs:{x:C},backend:n,attrs:{shape:h}});l.push(C);let D=T;if(c!=null){l.push(T);const P=Du(c);D=Eu({inputs:{x:D},backend:n,attrs:{perm:P}})}return l.forEach(P=>n.disposeData(P.dataId)),D}const PFe={kernelName:Vb,backendName:"webgpu",kernelFunc:OFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FFe=[ZAe,H$e,K$e,X$e,Q$e,tRe,lRe,cRe,hRe,pRe,gRe,xRe,bRe,SRe,IRe,_Re,$Re,ORe,FRe,zRe,WRe,KRe,ZRe,tMe,rMe,aMe,JAe,cMe,pMe,SMe,EMe,RMe,OMe,FMe,zMe,UMe,jMe,HMe,KMe,XMe,QMe,tDe,lDe,cDe,sDe,fDe,gDe,bDe,SDe,NDe,_De,$De,MDe,ODe,FDe,zDe,BDe,VDe,WDe,KAe,HDe,QDe,KDe,XDe,tOe,rOe,iOe,lOe,dOe,fOe,mOe,QAe,yOe,hMe,wOe,vOe,COe,NOe,TOe,_Oe,ROe,POe,DOe,LOe,BOe,VOe,HOe,qOe,kRe,ZOe,JOe,aPe,tPe,iPe,uPe,TRe,dPe,fPe,mPe,yPe,SPe,kDe,IPe,kPe,EPe,QRe,$Pe,MPe,OPe,LPe,BPe,VPe,WPe,HPe,JRe,KPe,XPe,QPe,e4e,qAe,r4e,o4e,u4e,h4e,m4e,y4e,w4e,v4e,C4e,k4e,_4e,$4e,M4e,O4e,F4e,z4e,VRe,dFe,pFe,gFe,bPe,U4e,W4e,q4e,Z4e,nFe,sFe,oFe,aFe,uFe,xFe,TDe,bFe,SFe,IFe,eFe,EFe,$Fe,sRe,MFe,PFe,RPe];for(const t of FFe)kO(t);/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var $Z=function(t,e){return($Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])})(t,e)};function RZ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}$Z(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Vn=function(){return(Vn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function mn(t,e,n,r){return new(n||(n=Promise))(function(s,i){function o(u){try{l(r.next(u))}catch(c){i(c)}}function a(u){try{l(r.throw(u))}catch(c){i(c)}}function l(u){var c;u.done?s(u.value):(c=u.value,c instanceof n?c:new n(function(d){d(c)})).then(o,a)}l((r=r.apply(t,[])).next())})}function gn(t,e){var n,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(s=2&c[0]?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[2&c[0],s.value]),c[0]){case 0:case 1:s=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(s=o.trys,!((s=s.length>0&&s[s.length-1])||c[0]!==6&&c[0]!==2)){o=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){o.label=c[1];break}if(c[0]===6&&o.label<s[1]){o.label=s[1],s=c;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(c);break}s[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(d){c=[6,d],r=0}finally{n=s=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function Xf(t,e,n){if(n||arguments.length===2)for(var r,s=0,i=e.length;s<i;s++)!r&&s in e||(r||(r=Array.prototype.slice.call(e,0,s)),r[s]=e[s]);return t.concat(r||Array.prototype.slice.call(e))}var _u=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],c1=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"];function zI(t){return t instanceof SVGAnimatedLength?t.baseVal.value:t}function MZ(t){return mn(this,void 0,void 0,function(){var e,n;return gn(this,function(r){switch(r.label){case 0:return e=document.createElement("canvas"),t instanceof _n?[4,mP(t,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:e.width=zI(t.width),e.height=zI(t.height),n=e.getContext("2d"),t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0),r.label=3;case 3:return[2,e]}})})}function DZ(t){return mn(this,void 0,void 0,function(){var e,n,r,s,i,o;return gn(this,function(a){switch(a.label){case 0:return t instanceof _n?(e=t.shape.slice(0,2),n=e[0],r=e[1],s=ImageData.bind,[4,mP(t)]):[3,2];case 1:return[2,new(s.apply(ImageData,[void 0,a.sent(),r,n]))];case 2:return i=document.createElement("canvas"),o=i.getContext("2d"),i.width=zI(t.width),i.height=zI(t.height),o.drawImage(t,0,0),[2,o.getImageData(0,0,i.width,i.height)]}})})}function LFe(t){return mn(this,void 0,void 0,function(){var e,n;return gn(this,function(r){switch(r.label){case 0:return t instanceof SVGImageElement||t instanceof OffscreenCanvas?[4,MZ(t)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=t,r.label=3;case 3:return e=n,[2,Tq(e,4)]}})})}function OZ(t){if(t<0||t>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(t));if(!Number.isInteger(t))throw new Error("Mask value must be an integer but got ".concat(t))}var $x={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},zFe=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return mn(this,void 0,void 0,function(){return gn(this,function(e){return[2,this.mask]})})},t.prototype.toImageData=function(){return mn(this,void 0,void 0,function(){return gn(this,function(e){return[2,DZ(this.mask)]})})},t.prototype.toTensor=function(){return mn(this,void 0,void 0,function(){return gn(this,function(e){return[2,LFe(this.mask)]})})},t.prototype.getUnderlyingType=function(){return"canvasimagesource"},t}();function BFe(t){return OZ(t),"person"}var UFe=function(){function t(e){var n,r=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new CC.Pose({locateFile:function(s,i){if(e.solutionPath){var o=e.solutionPath.replace(/\/+$/,"");return"".concat(o,"/").concat(s)}return"".concat(i,"/").concat(s)}}),e.modelType){case"lite":n=0;break;case"heavy":n=2;break;case"full":default:n=1}this.poseSolution.setOptions({modelComplexity:n,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(s){if(r.height=s.image.height,r.width=s.image.width,s.poseLandmarks==null)r.poses=[];else{var i=r.translateOutput(s.poseLandmarks,s.poseWorldLandmarks);s.segmentationMask&&(i.segmentation={maskValueToLabel:BFe,mask:new zFe(s.segmentationMask)}),r.poses=[i]}})}return t.prototype.translateOutput=function(e,n){var r=this,s={keypoints:e.map(function(i,o){return{x:i.x*r.width,y:i.y*r.height,z:i.z,score:i.visibility,name:c1[o]}})};return n!=null&&(s.keypoints3D=n.map(function(i,o){return{x:i.x,y:i.y,z:i.z,score:i.visibility,name:c1[o]}})),s},t.prototype.estimatePoses=function(e,n,r){return mn(this,void 0,void 0,function(){var s,i;return gn(this,function(o){switch(o.label){case 0:return n&&n.flipHorizontal&&n.flipHorizontal!==this.selfieMode&&(this.selfieMode=n.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof _n?(i=ImageData.bind,[4,mP(e)]):[3,2];case 1:return s=new(i.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:s=e,o.label=3;case 3:return e=s,[4,this.poseSolution.send({image:e},r)];case 4:return o.sent(),[2,this.poses]}})})},t.prototype.dispose=function(){this.poseSolution.close()},t.prototype.reset=function(){this.poseSolution.reset()},t.prototype.initialize=function(){return this.poseSolution.initialize()},t}();function VFe(t){return mn(this,void 0,void 0,function(){var e,n;return gn(this,function(r){switch(r.label){case 0:return e=function(s){if(s==null)return Vn({},$x);var i=Vn({},s);return i.runtime="mediapipe",i.enableSegmentation==null&&(i.enableSegmentation=$x.enableSegmentation),i.enableSmoothing==null&&(i.enableSmoothing=$x.enableSmoothing),i.smoothSegmentation==null&&(i.smoothSegmentation=$x.smoothSegmentation),i.modelType==null&&(i.modelType=$x.modelType),i}(t),[4,(n=new UFe(e)).initialize()];case 1:return r.sent(),[2,n]}})})}function e0(t){return t instanceof _n?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function PZ(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function RP(t){return t instanceof _n?t:Tq(t)}function FZ(t,e,n){return qR(n,"inputResolution"),[1/n.width*t[0][0]*e.width,1/n.height*t[0][1]*e.width,t[0][3]*e.width,1/n.width*t[1][0]*e.height,1/n.height*t[1][1]*e.height,t[1][3]*e.height,0,0]}function qR(t,e){ae(t.width!==0,function(){return"".concat(e," width cannot be 0.")}),ae(t.height!==0,function(){return"".concat(e," height cannot be 0.")})}function R3(t,e,n){var r=n.rotationVectorStartKeypointIndex,s=n.rotationVectorEndKeypointIndex,i=t.locationData,o=i.relativeKeypoints[r].x*e.width,a=i.relativeKeypoints[r].y*e.height,l=i.relativeKeypoints[s].x*e.width,u=i.relativeKeypoints[s].y*e.height,c=2*Math.sqrt((l-o)*(l-o)+(u-a)*(u-a)),d=function(h,f,m){var g,x=h.locationData,w=m.rotationVectorStartKeypointIndex,b=m.rotationVectorEndKeypointIndex;g=m.rotationVectorTargetAngle?m.rotationVectorTargetAngle:Math.PI*m.rotationVectorTargetAngleDegree/180;var S=x.relativeKeypoints[w].x*f.width,C=x.relativeKeypoints[w].y*f.height,T=x.relativeKeypoints[b].x*f.width,D=x.relativeKeypoints[b].y*f.height;return PZ(g-Math.atan2(-(D-C),T-S))}(t,e,n);return{xCenter:o/e.width,yCenter:a/e.height,width:c/e.width,height:c/e.height,rotation:d}}function LZ(t){if(t.length!==16)throw new Error("Array length must be 16 but got ".concat(t.length));return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}function M3(t,e,n,r,s,i,o){return t[e][s]*(t[n][i]*t[r][o]-t[n][o]*t[r][i])}function si(t,e,n){var r=(e+1)%4,s=(e+2)%4,i=(e+3)%4,o=(n+1)%4,a=(n+2)%4,l=(n+3)%4;return M3(t,r,s,i,o,a,l)+M3(t,s,i,r,o,a,l)+M3(t,i,r,s,o,a,l)}function EV(t,e,n){n===void 0&&(n={ignoreRotation:!1});for(var r=[],s=0,i=t;s<i.length;s++){var o=i[s],a=o.x-.5,l=o.y-.5,u=n.ignoreRotation?0:e.rotation,c=Math.cos(u)*a-Math.sin(u)*l,d=Math.sin(u)*a+Math.cos(u)*l;c=c*e.width+e.xCenter,d=d*e.height+e.yCenter;var h=o.z*e.width,f=Vn({},o);f.x=c,f.y=d,f.z=h,r.push(f)}return r}function zZ(t,e){var n=function(r,s,i,o){var a=s-r,l=o-i,u=l/a;return{scale:u,offset:i-r*u}}(0,255,e[0],e[1]);return Ve(function(){return Qe(_e(t,n.scale),n.offset)})}function XR(t,e,n){var r,s,i,o,a,l,u,c,d,h,f,m,g,x,w=e.outputTensorSize,b=e.keepAspectRatio,S=e.borderMode,C=e.outputTensorFloatRange,T=e0(t),D=function(E,M){return M?{xCenter:M.xCenter*E.width,yCenter:M.yCenter*E.height,width:M.width*E.width,height:M.height*E.height,rotation:M.rotation}:{xCenter:.5*E.width,yCenter:.5*E.height,width:E.width,height:E.height,rotation:0}}(T,n),P=function(E,M,O){if(O===void 0&&(O=!1),!O)return{top:0,left:0,right:0,bottom:0};var j=M.height,R=M.width;qR(M,"targetSize"),qR(E,"roi");var z,B,V=j/R,H=E.height/E.width,K=0,ne=0;return V>H?(z=E.width,B=E.width*V,ne=(1-H/V)/2):(z=E.height/V,B=E.height,K=(1-V/H)/2),E.width=z,E.height=B,{top:ne,left:K,right:K,bottom:ne}}(D,w,b),I=(r=D,s=T.width,i=T.height,o=!1,a=r.width,l=r.height,u=o?-1:1,c=Math.cos(r.rotation),d=Math.sin(r.rotation),h=r.xCenter,f=r.yCenter,m=1/s,g=1/i,(x=new Array(16))[0]=a*c*u*m,x[1]=-l*d*m,x[2]=0,x[3]=(-.5*a*c*u+.5*l*d+h)*m,x[4]=a*d*u*g,x[5]=l*c*g,x[6]=0,x[7]=(-.5*l*c-.5*a*d*u+f)*g,x[8]=0,x[9]=0,x[10]=a*m,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,LZ(x));return{imageTensor:Ve(function(){var E=RP(t),M=$a(FZ(I,T,w),[1,8]),O=S==="zero"?"constant":"nearest",j=gi.transform(Fr(lt(E,"float32")),M,"bilinear",O,0,[w.height,w.width]);return C!=null?zZ(j,C):j}),padding:P,transformationMatrix:I}}function _V(t,e,n,r){return r===1?.5*(t+e):t+(e-t)*n/(r-1)}function jFe(t){return Ve(function(){var e=function(s){return Ve(function(){return[Kt(s,[0,0,0],[1,-1,1]),Kt(s,[0,0,1],[1,-1,-1])]})}(t),n=e[0],r=e[1];return{boxes:Nn(r),logits:Nn(n)}})}function BZ(t){return t!=null&&t.currentTime!=null}function AV(t){for(var e={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,o=0;o<t.length;++o){var a=t[o];n=Math.min(n,a.x),r=Math.max(r,a.x),s=Math.min(s,a.y),i=Math.max(i,a.y),e.locationData.relativeKeypoints.push({x:a.x,y:a.y})}return e.locationData.relativeBoundingBox={xMin:n,yMin:s,xMax:r,yMax:i,width:r-n,height:i-s},e}function WFe(t,e,n,r){return mn(this,void 0,void 0,function(){var s,i,o,a,l;return gn(this,function(u){switch(u.label){case 0:return t.sort(function(c,d){return Math.max.apply(Math,d.score)-Math.max.apply(Math,c.score)}),s=$a(t.map(function(c){return[c.locationData.relativeBoundingBox.yMin,c.locationData.relativeBoundingBox.xMin,c.locationData.relativeBoundingBox.yMax,c.locationData.relativeBoundingBox.xMax]})),i=Br(t.map(function(c){return c.score[0]})),[4,gi.nonMaxSuppressionAsync(s,i,e,n)];case 1:return[4,(o=u.sent()).array()];case 2:return a=u.sent(),l=t.filter(function(c,d){return a.indexOf(d)>-1}),Bt([s,i,o]),[2,l]}})})}function UZ(t,e){return t.map(function(n){var r=Vn(Vn({},n),{x:n.x*e.width,y:n.y*e.height});return n.z!=null&&(r.z=n.z*e.width),r})}function GFe(t,e,n){return mn(this,void 0,void 0,function(){var r,s,i,o,a,l,u,c,d,h,f,m,g,x,w,b,S,C,T,D,P,I,E,M;return gn(this,function(O){switch(O.label){case 0:if(r=Nn(e,[0]),s=r.shape,i=s[0],o=s[1],a=s[2],t.length!==a)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(t.length,", heatmap length: ").concat(a));return l=[],[4,r.buffer()];case 1:for(u=O.sent(),c=0;c<t.length;c++)if(d=t[c],h=Vn({},d),l.push(h),f=Math.trunc(h.x*o),m=Math.trunc(h.y*i),!(f<0||f>=o||m<0||f>=i)){for(g=Math.trunc((n.kernelSize-1)/2),x=Math.max(0,f-g),w=Math.min(o,f+g+1),b=Math.max(0,m-g),S=Math.min(i,m+g+1),C=0,T=0,D=0,P=0,I=b;I<S;++I)for(E=x;E<w;++E)M=u.get(I,E,c),C+=M,P=Math.max(P,M),T+=E*M,D+=I*M;P>=n.minConfidenceToRefine&&C>0&&(h.x=T/o/C,h.y=D/i/C)}return r.dispose(),[2,l]}})})}function $V(t,e){var n=e.left,r=e.top,s=e.left+e.right,i=e.top+e.bottom;return t.map(function(o){return Vn(Vn({},o),{x:(o.x-n)/(1-s),y:(o.y-r)/(1-i),z:o.z/(1-s)})})}function HFe(t,e,n){return e1()==="webgl"?function(r,s,i){var o=i.combineWithPreviousRatio.toFixed(2),a={variableNames:["prevMask","newMask"],outputShape:r.shape,userCode:`
  void main() {
      ivec2 coords = getOutputCoords();
      int height = coords[0];
      int width = coords[1];

      float prevMaskValue = getPrevMask(height, width);
      float newMaskValue = getNewMask(height, width);

      /*
      * Assume p := newMaskValue
      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)
      * uncertainty alpha(p) =
      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the
      * uncertainty]
      *
      * The following polynomial approximates uncertainty alpha as a
      * function of (p + 0.5):
      */
      const float c1 = 5.68842;
      const float c2 = -0.748699;
      const float c3 = -57.8051;
      const float c4 = 291.309;
      const float c5 = -624.717;
      float t = newMaskValue - 0.5;
      float x = t * t;

      float uncertainty =
        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));

      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *
                             (uncertainty * `.concat(o,`);

      setOutput(outputValue);
    }
`)},l=bp();return Ve(function(){var u=l.compileAndRun(a,[r,s]);return ci().makeTensorFromDataId(u.dataId,u.shape,u.dtype)})}(t,e,n):Ve(function(){var r=xt(e,.5),s=Fn(r),i=xt(1,yh(1,_e(s,Qe(5.68842,_e(s,Qe(-.748699,_e(s,Qe(-57.8051,_e(s,Qe(291.309,_e(s,-624.717)))))))))));return Qe(e,_e(xt(t,e),_e(i,n.combineWithPreviousRatio)))})}function YFe(t,e,n){return mn(this,void 0,void 0,function(){var r,s,i,o,a;return gn(this,function(l){switch(l.label){case 0:return r=t[0],s=t[1],i=function(u,c,d){return Ve(function(){var h,f,m,g;d.reverseOutputOrder?(f=Nn(Kt(u,[0,d.boxCoordOffset+0],[-1,1])),h=Nn(Kt(u,[0,d.boxCoordOffset+1],[-1,1])),g=Nn(Kt(u,[0,d.boxCoordOffset+2],[-1,1])),m=Nn(Kt(u,[0,d.boxCoordOffset+3],[-1,1]))):(h=Nn(Kt(u,[0,d.boxCoordOffset+0],[-1,1])),f=Nn(Kt(u,[0,d.boxCoordOffset+1],[-1,1])),m=Nn(Kt(u,[0,d.boxCoordOffset+2],[-1,1])),g=Nn(Kt(u,[0,d.boxCoordOffset+3],[-1,1]))),f=Qe(_e(yt(f,d.xScale),c.w),c.x),h=Qe(_e(yt(h,d.yScale),c.h),c.y),d.applyExponentialOnBoxSize?(m=_e(wi(yt(m,d.hScale)),c.h),g=_e(wi(yt(g,d.wScale)),c.w)):(m=_e(yt(m,d.hScale),c.h),g=_e(yt(g,d.wScale),c.h));var x=xt(h,yt(m,2)),w=xt(f,yt(g,2)),b=Qe(h,yt(m,2)),S=Qe(f,yt(g,2)),C=pr([Me(x,[d.numBoxes,1]),Me(w,[d.numBoxes,1]),Me(b,[d.numBoxes,1]),Me(S,[d.numBoxes,1])],1);if(d.numKeypoints)for(var T=0;T<d.numKeypoints;++T){var D=d.keypointCoordOffset+T*d.numValuesPerKeypoint,P=void 0,I=void 0;d.reverseOutputOrder?(P=Nn(Kt(u,[0,D],[-1,1])),I=Nn(Kt(u,[0,D+1],[-1,1]))):(I=Nn(Kt(u,[0,D],[-1,1])),P=Nn(Kt(u,[0,D+1],[-1,1])));var E=Qe(_e(yt(P,d.xScale),c.w),c.x),M=Qe(_e(yt(I,d.yScale),c.h),c.y);C=pr([C,Me(E,[d.numBoxes,1]),Me(M,[d.numBoxes,1])],1)}return C})}(s,e,n),o=Ve(function(){var u=r;return n.sigmoidScore?(n.scoreClippingThresh!=null&&(u=Vi(r,-n.scoreClippingThresh,n.scoreClippingThresh)),u=Go(u)):u}),[4,KFe(i,o,n)];case 1:return a=l.sent(),Bt([i,o]),[2,a]}})})}function KFe(t,e,n){return mn(this,void 0,void 0,function(){var r,s,i,o,a,l,u,c,d,h,f,m;return gn(this,function(g){switch(g.label){case 0:return r=[],[4,t.data()];case 1:return s=g.sent(),[4,e.data()];case 2:for(i=g.sent(),o=0;o<n.numBoxes;++o)if(!(n.minScoreThresh!=null&&i[o]<n.minScoreThresh||(a=o*n.numCoords,l=qFe(s[a+0],s[a+1],s[a+2],s[a+3],i[o],n.flipVertically,o),(u=l.locationData.relativeBoundingBox).width<0||u.height<0))){if(n.numKeypoints>0)for((c=l.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,h=0;h<d;h+=n.numValuesPerKeypoint)f=a+n.keypointCoordOffset+h,m={x:s[f+0],y:n.flipVertically?1-s[f+1]:s[f+1]},c.relativeKeypoints.push(m);r.push(l)}return[2,r]}})})}function qFe(t,e,n,r,s,i,o){return{score:[s],ind:o,locationData:{relativeBoundingBox:{xMin:e,yMin:i?1-n:t,xMax:r,yMax:i?1-t:n,width:r-e,height:n-t}}}}function XFe(t,e){return t==="none"?e:function(n){return 1/(1+Math.exp(-n))}(e)}function RV(t,e,n,r){return mn(this,void 0,void 0,function(){var s,i,o,a,l,u,c,d;return gn(this,function(h){switch(h.label){case 0:return n=n||e.flipHorizontally||!1,r=r||e.flipVertically||!1,s=t.size,i=s/e.numLandmarks,[4,t.data()];case 1:for(o=h.sent(),a=[],l=0;l<e.numLandmarks;++l)u=l*i,(d={x:0,y:0}).x=n?e.inputImageWidth-o[u]:o[u],i>1&&(d.y=r?e.inputImageHeight-o[u+1]:o[u+1]),i>2&&(d.z=o[u+2]),i>3&&(d.score=XFe(e.visibilityActivation,o[u+3])),a.push(d);for(c=0;c<a.length;++c)(d=a[c]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,a]}})})}function MV(t,e,n){var r=t.width,s=t.height,i=t.rotation;if(n.rotation==null&&n.rotationDegree==null||(i=function(u,c){return c.rotation!=null?u+=c.rotation:c.rotationDegree!=null&&(u+=Math.PI*c.rotationDegree/180),PZ(u)}(i,n)),i===0)t.xCenter=t.xCenter+r*n.shiftX,t.yCenter=t.yCenter+s*n.shiftY;else{var o=(e.width*r*n.shiftX*Math.cos(i)-e.height*s*n.shiftY*Math.sin(i))/e.width,a=(e.width*r*n.shiftX*Math.sin(i)+e.height*s*n.shiftY*Math.cos(i))/e.height;t.xCenter=t.xCenter+o,t.yCenter=t.yCenter+a}{var l=Math.max(r*e.width,s*e.height);r=l/e.width,s=l/e.height}return t.width=r*n.scaleX,t.height=s*n.scaleY,t}function ZFe(t,e){return t.map(function(n){var r=Vn(Vn({},n),{x:n.x/e.width,y:n.y/e.height});return n.z!=null&&(n.z=n.z/e.width),r})}var Yd=function(){function t(e){this.alpha=e,this.initialized=!1}return t.prototype.apply=function(e,n){var r;return this.initialized?r=n==null?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*n*Math.asinh((e-this.storedValue)/n):(r=e,this.initialized=!0),this.rawValue=e,this.storedValue=r,r},t.prototype.applyWithAlpha=function(e,n,r){return this.alpha=n,this.apply(e,r)},t.prototype.hasLastRawValue=function(){return this.initialized},t.prototype.lastRawValue=function(){return this.rawValue},t.prototype.reset=function(){this.initialized=!1},t}(),D3=function(){function t(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new Yd(this.getAlpha(this.minCutOff)),this.dx=new Yd(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return t.prototype.apply=function(e,n,r){if(e==null)return e;var s=Math.trunc(n);if(this.lastTimestamp>=s)return e;this.lastTimestamp!==0&&s!==0&&(this.frequency=1/(1e-6*(s-this.lastTimestamp))),this.lastTimestamp=s;var i=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*r*this.frequency:0,o=this.dx.applyWithAlpha(i,this.getAlpha(this.derivateCutOff)),a=this.minCutOff+this.beta*Math.abs(o),l=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(o):null;return this.x.applyWithAlpha(e,this.getAlpha(a),l)},t.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},t}(),ZR=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var s=this;if(e==null)return this.reset(),null;this.initializeFiltersIfEmpty(e);var i=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return Xf([],e,!0);i=1/r}return e.map(function(o,a){var l=Vn(Vn({},o),{x:s.xFilters[a].apply(o.x,n,i),y:s.yFilters[a].apply(o.y,n,i)});return o.z!=null&&(l.z=s.zFilters[a].apply(o.z,n,i)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new D3(n.config)}),this.yFilters=e.map(function(r){return new D3(n.config)}),this.zFilters=e.map(function(r){return new D3(n.config)}))},t}(),O3=function(){function t(e){this.config=e,this.window=[],this.lowPassFilter=new Yd(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return t.prototype.apply=function(e,n,r){if(e==null)return e;var s,i=Math.trunc(n);if(this.lastTimestamp>=i)return e;if(this.lastTimestamp===-1)s=1;else{for(var o=e*r-this.lastValue*this.lastValueScale,a=i-this.lastTimestamp,l=o,u=a,c=(1+this.window.length)*(1e6/30),d=0,h=this.window;d<h.length;d++){var f=h[d];if(u+f.duration>c)break;l+=f.distance,u+=f.duration}var m=l/(1e-6*u);s=1-1/(1+this.config.velocityScale*Math.abs(m)),this.window.unshift({distance:o,duration:a}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=r,this.lastTimestamp=i,this.lowPassFilter.applyWithAlpha(e,s)},t}(),QFe=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var s=this;if(e==null)return this.reset(),null;var i=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return Xf([],e,!0);i=1/r}return this.initializeFiltersIfEmpty(e),e.map(function(o,a){var l=Vn(Vn({},o),{x:s.xFilters[a].apply(o.x,n,i),y:s.yFilters[a].apply(o.y,n,i)});return o.z!=null&&(l.z=s.zFilters[a].apply(o.z,n,i)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new O3(n.config)}),this.yFilters=e.map(function(r){return new O3(n.config)}),this.zFilters=e.map(function(r){return new O3(n.config)}))},t}(),P3=function(){function t(e){if(e.velocityFilter!=null)this.keypointsFilter=new QFe(e.velocityFilter);else{if(e.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new ZR(e.oneEuroFilter)}}return t.prototype.apply=function(e,n,r,s,i){if(s===void 0&&(s=!1),e==null)return this.keypointsFilter.reset(),null;var o=i!=null?function(u,c){return(u.width*c.width+u.height*c.height)/2}(i,r):1,a=s?UZ(e,r):e,l=this.keypointsFilter.apply(a,n,o);return s?ZFe(l,r):l},t}(),DV=function(){function t(e){this.alpha=e.alpha}return t.prototype.apply=function(e){var n=this;if(e==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(a){return new Yd(n.alpha)}));for(var r=[],s=0;s<e.length;++s){var i=e[s],o=Vn({},i);o.score=this.visibilityFilters[s].apply(i.score),r.push(o)}return r},t}(),JFe={interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},Xm={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},eLe={maxPoses:1,flipHorizontal:!1},tLe={applyExponentialOnBoxSize:!1,flipVertically:!1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},nLe=.3,OV={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25},rLe={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},sLe={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},iLe={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},oLe={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},aLe={kernelSize:7,minConfidenceToRefine:.5},PV={alpha:.1},lLe={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},uLe={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},cLe={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},dLe={activation:"none"},hLe={combineWithPreviousRatio:.7},fLe=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return mn(this,void 0,void 0,function(){return gn(this,function(e){return[2,MZ(this.mask)]})})},t.prototype.toImageData=function(){return mn(this,void 0,void 0,function(){return gn(this,function(e){return[2,DZ(this.mask)]})})},t.prototype.toTensor=function(){return mn(this,void 0,void 0,function(){return gn(this,function(e){return[2,this.mask]})})},t.prototype.getUnderlyingType=function(){return"tensor"},t}();function pLe(t){return OZ(t),"person"}var mLe=function(){function t(e,n,r,s,i,o){this.detectorModel=e,this.landmarkModel=n,this.enableSmoothing=r,this.enableSegmentation=s,this.smoothSegmentation=i,this.modelType=o,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(d){d.reduceBoxesInLowestLayer==null&&(d.reduceBoxesInLowestLayer=!1),d.interpolatedScaleAspectRatio==null&&(d.interpolatedScaleAspectRatio=1),d.fixedAnchorSize==null&&(d.fixedAnchorSize=!1);for(var h=[],f=0;f<d.numLayers;){for(var m=[],g=[],x=[],w=[],b=f;b<d.strides.length&&d.strides[b]===d.strides[f];){var S=_V(d.minScale,d.maxScale,b,d.strides.length);if(b===0&&d.reduceBoxesInLowestLayer)x.push(1),x.push(2),x.push(.5),w.push(.1),w.push(S),w.push(S);else{for(var C=0;C<d.aspectRatios.length;++C)x.push(d.aspectRatios[C]),w.push(S);if(d.interpolatedScaleAspectRatio>0){var T=b===d.strides.length-1?1:_V(d.minScale,d.maxScale,b+1,d.strides.length);w.push(Math.sqrt(S*T)),x.push(d.interpolatedScaleAspectRatio)}}b++}for(var D=0;D<x.length;++D){var P=Math.sqrt(x[D]);m.push(w[D]/P),g.push(w[D]*P)}var I=0,E=0;if(d.featureMapHeight.length>0)I=d.featureMapHeight[f],E=d.featureMapWidth[f];else{var M=d.strides[f];I=Math.ceil(d.inputSizeHeight/M),E=Math.ceil(d.inputSizeWidth/M)}for(var O=0;O<I;++O)for(var j=0;j<E;++j)for(var R=0;R<m.length;++R){var z={xCenter:(j+d.anchorOffsetX)/E,yCenter:(O+d.anchorOffsetY)/I,width:0,height:0};d.fixedAnchorSize?(z.width=1,z.height=1):(z.width=g[R],z.height=m[R]),h.push(z)}f=b}return h}(JFe);var a=Br(this.anchors.map(function(d){return d.width})),l=Br(this.anchors.map(function(d){return d.height})),u=Br(this.anchors.map(function(d){return d.xCenter})),c=Br(this.anchors.map(function(d){return d.yCenter}));this.anchorTensor={x:u,y:c,w:a,h:l},this.prevFilteredSegmentationMask=this.enableSegmentation?$a([],[0,0]):null}return t.prototype.estimatePoses=function(e,n,r){return mn(this,void 0,void 0,function(){var s,i,o,a,l,u,c,d,h,f,m,g,x,w,b,S,C,T,D,P,I,E,M;return gn(this,function(O){switch(O.label){case 0:return s=function(j){var R;if((R=j==null?eLe:Vn({},j)).maxPoses==null&&(R.maxPoses=1),R.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(R.maxPoses,". Should be > 0."));if(R.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return R}(n),e==null?(this.reset(),[2,[]]):(this.maxPoses=s.maxPoses,this.timestamp=r!=null?1e3*r:BZ(e)?1e6*e.currentTime:null,i=e0(e),o=Ve(function(){return lt(RP(e),"float32")}),(a=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(o)]);case 1:if((l=O.sent()).length===0)return this.reset(),o.dispose(),[2,[]];u=l[0],a=this.poseDetectionToRoi(u,i),O.label=2;case 2:return[4,this.poseLandmarksByRoi(a,o)];case 3:return c=O.sent(),o.dispose(),c==null?(this.reset(),[2,[]]):(d=c.landmarks,h=c.auxiliaryLandmarks,f=c.poseScore,m=c.worldLandmarks,g=c.segmentationMask,x=this.poseLandmarkFiltering(d,h,m,i),w=x.actualLandmarksFiltered,b=x.auxiliaryLandmarksFiltered,S=x.actualWorldLandmarksFiltered,C=this.poseLandmarksToRoi(b,i),this.regionOfInterest=C,T=this.smoothSegmentation&&g!=null?this.poseSegmentationFiltering(g):g,(D=w!=null?UZ(w,i):null)!=null&&D.forEach(function(j,R){j.name=c1[R]}),(P=S)!=null&&P.forEach(function(j,R){j.name=c1[R]}),I={score:f,keypoints:D,keypoints3D:P},T!==null&&(E=Ve(function(){var j=Fr(T,2),R=Nl(j,[[0,0],[0,0],[0,1]]);return WO(R,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||Bt(T),M={maskValueToLabel:pLe,mask:new fLe(E)},I.segmentation=M),[2,[I]])}})})},t.prototype.poseSegmentationFiltering=function(e){var n=this.prevFilteredSegmentationMask;return n.size===0?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=HFe(n,e,hLe),Bt(e)),Bt(n),this.prevFilteredSegmentationMask},t.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),Bt([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},t.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(Bt(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=$a([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},t.prototype.detectPose=function(e){return mn(this,void 0,void 0,function(){var n,r,s,i,o,a,l,u,c,d;return gn(this,function(h){switch(h.label){case 0:return n=XR(e,rLe),r=n.imageTensor,s=n.padding,i=this.detectorModel.predict(r),o=jFe(i),a=o.boxes,[4,YFe([l=o.logits,a],this.anchorTensor,tLe)];case 1:return(u=h.sent()).length===0?(Bt([r,i,l,a]),[2,u]):[4,WFe(u,this.maxPoses,nLe)];case 2:return c=h.sent(),d=function(f,m){f===void 0&&(f=[]);for(var g=m.left,x=m.top,w=m.left+m.right,b=m.top+m.bottom,S=0;S<f.length;S++){var C=f[S],T=C.locationData.relativeBoundingBox,D=(T.xMin-g)/(1-w),P=(T.yMin-x)/(1-b),I=T.width/(1-w),E=T.height/(1-b);T.xMin=D,T.yMin=P,T.width=I,T.height=E,T.xMax=D+I,T.yMax=P+E;var M=C.locationData.relativeKeypoints;M&&M.forEach(function(O){var j=(O.x-g)/(1-w),R=(O.y-x)/(1-b);O.x=j,O.y=R})}return f}(c,s),Bt([r,i,l,a]),[2,d]}})})},t.prototype.poseDetectionToRoi=function(e,n){return MV(R3(e,n,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),n,OV)},t.prototype.poseLandmarksByRoi=function(e,n){return mn(this,void 0,void 0,function(){var r,s,i,o,a,l,u,c,d,h,f,m,g,x;return gn(this,function(w){switch(w.label){case 0:if(r=e0(n),s=XR(n,sLe,e),i=s.imageTensor,o=s.padding,a=s.transformationMatrix,this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return l=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&l.push("activation_segmentation"),u=this.landmarkModel.execute(i,l),[4,this.tensorsToPoseLandmarksAndSegmentation(u)];case 1:return(c=w.sent())==null?(Bt(u),Bt(i),[2,null]):(d=c.landmarks,h=c.auxiliaryLandmarks,f=c.poseScore,m=c.worldLandmarks,g=c.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(r,e,o,a,d,h,m,g)]);case 2:return x=w.sent(),Bt(u),Bt(i),[2,Vn({poseScore:f},x)]}})})},t.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,n,r,s,i,o,a,l){return mn(this,void 0,void 0,function(){var u,c,d,h,f,m;return gn(this,function(g){return u=$V(i,r),c=$V(o,r),d=EV(u,n),h=EV(c,n),f=function(x,w){for(var b=[],S=0,C=x;S<C.length;S++){var T=C[S],D=T.x,P=T.y,I=w.rotation,E=Math.cos(I)*D-Math.sin(I)*P,M=Math.sin(I)*D+Math.cos(I)*P,O=Vn({},T);O.x=E,O.y=M,b.push(O)}return b}(a,n),m=null,this.enableSegmentation&&(m=Ve(function(){var x=l.shape,w=x[0],b=x[1],S=function(D){var P=LZ(new Array(16).fill(0));P[0][0]=si(D,0,0),P[1][0]=-si(D,0,1),P[2][0]=si(D,0,2),P[3][0]=-si(D,0,3),P[0][2]=si(D,2,0),P[1][2]=-si(D,2,1),P[2][2]=si(D,2,2),P[3][2]=-si(D,2,3),P[0][1]=-si(D,1,0),P[1][1]=si(D,1,1),P[2][1]=-si(D,1,2),P[3][1]=si(D,1,3),P[0][3]=-si(D,3,0),P[1][3]=si(D,3,1),P[2][3]=-si(D,3,2),P[3][3]=si(D,3,3);for(var I=D[0][0]*P[0][0]+D[1][0]*P[0][1]+D[2][0]*P[0][2]+D[3][0]*P[0][3],E=0;E<P.length;E++)for(var M=0;M<P.length;M++)P[E][M]/=I;return P}(s),C=$a(FZ(S,{width:b,height:w},e),[1,8]),T=[1,w,b,1];return Nn(gi.transform(Me(l,T),C,"bilinear","constant",0,[e.height,e.width]),[0,3])}),Bt(l)),[2,{landmarks:d,auxiliaryLandmarks:h,worldLandmarks:f,segmentationMask:m}]})})},t.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return mn(this,void 0,void 0,function(){var n,r,s,i,o,a,l,u,c,d,h,f,m;return gn(this,function(g){switch(g.label){case 0:return n=e[0],r=e[1],s=e[2],i=e[3],o=this.enableSegmentation?e[4]:null,[4,r.data()];case 1:return(a=g.sent()[0])<.5?[2,null]:[4,RV(n,iLe)];case 2:return[4,GFe(g.sent(),s,aLe)];case 3:return l=g.sent(),u=l.slice(0,33),c=l.slice(33,35),[4,RV(i,oLe)];case 4:return d=g.sent(),h=d.slice(0,33),f=function(x,w,b){for(var S=[],C=0;C<x.length;C++){var T=Vn({},w[C]);T.score=x[C].score,S.push(T)}return S}(u,h),m=this.enableSegmentation?function(x,w,b){return Ve(function(){var S=Nn(x,[0]),C=S.shape[2];if(C===1){var T=S;switch(w.activation){case"none":break;case"sigmoid":T=Go(T);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(w.activation,")"))}var D=T;return Nn(D,[2])}throw new Error("Unsupported number of tensor channels ".concat(C))})}(o,dLe):null,[2,{landmarks:u,auxiliaryLandmarks:c,poseScore:a,worldLandmarks:f,segmentationMask:m}]}})})},t.prototype.poseLandmarksToRoi=function(e,n){return MV(R3(AV(e),n,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),n,OV)},t.prototype.poseLandmarkFiltering=function(e,n,r,s){var i,o,a;if(this.timestamp!=null&&this.enableSmoothing){var l=R3(AV(n),s,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new DV(PV)),i=this.visibilitySmoothingFilterActual.apply(e),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new DV(PV)),o=this.visibilitySmoothingFilterAuxiliary.apply(n),a=this.visibilitySmoothingFilterActual.apply(r),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new P3(lLe)),i=this.landmarksSmoothingFilterActual.apply(i,this.timestamp,s,!0,l),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new P3(uLe)),o=this.landmarksSmoothingFilterAuxiliary.apply(o,this.timestamp,s,!0,l),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new P3(cLe)),a=this.worldLandmarksSmoothingFilterActual.apply(r,this.timestamp)}else i=e,o=n,a=r;return{actualLandmarksFiltered:i,auxiliaryLandmarksFiltered:o,actualWorldLandmarksFiltered:a}},t}();function gLe(t){return mn(this,void 0,void 0,function(){var e,n,r,s,i,o;return gn(this,function(a){switch(a.label){case 0:return e=function(l){var u=Vn({},l??Xm);if(u.enableSmoothing==null&&(u.enableSmoothing=Xm.enableSmoothing),u.enableSegmentation==null&&(u.enableSegmentation=Xm.enableSegmentation),u.smoothSegmentation==null&&(u.smoothSegmentation=Xm.smoothSegmentation),u.modelType==null&&(u.modelType=Xm.modelType),u.detectorModelUrl==null&&(u.detectorModelUrl=Xm.detectorModelUrl),u.landmarkModelUrl==null)switch(u.modelType){case"lite":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;case"full":default:u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return u}(t),n=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Zg(e.detectorModelUrl,{fromTFHub:n}),Zg(e.landmarkModelUrl,{fromTFHub:r})])];case 1:return s=a.sent(),i=s[0],o=s[1],[2,new mLe(i,o,e.enableSmoothing,e.enableSegmentation,e.smoothSegmentation,e.modelType)]}})})}var rp,wu,VZ=function(){function t(e){(function(n){if(n.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(n.maxTracks));if(n.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(n.maxAge));if(n.keypointTrackerParams!==void 0){if(n.keypointTrackerParams.keypointConfidenceThreshold<0||n.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(n.keypointTrackerParams.keypointConfidenceThreshold));if(n.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(n.keypointTrackerParams.minNumberOfKeypoints));for(var r=0,s=n.keypointTrackerParams.keypointFalloff;r<s.length;r++){var i=s[r];if(i<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(i))}}})(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return t.prototype.apply=function(e,n){this.filterOldTracks(n);var r=this.computeSimilarity(e);return this.assignTracks(e,r,n),this.updateTracks(n),e},t.prototype.getTracks=function(){return this.tracks.slice()},t.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},t.prototype.filterOldTracks=function(e){var n=this;this.tracks=this.tracks.filter(function(r){return e-r.lastTimestamp<=n.maxAge})},t.prototype.assignTracks=function(e,n,r){for(var s=Array.from(Array(n[0].length).keys()),i=[],o=0,a=Array.from(Array(e.length).keys());o<a.length;o++){var l=a[o];if(s.length!==0){for(var u=-1,c=-1,d=0,h=s;d<h.length;d++){var f=h[d],m=n[l][f];m>=this.minSimilarity&&m>c&&(u=f,c=m)}if(u>=0){var g=this.tracks[u];g=Object.assign(g,this.createTrack(e[l],r,g.id)),e[l].id=g.id;var x=s.indexOf(u);s.splice(x,1)}else i.push(l)}else i.push(l)}for(var w=0,b=i;w<b.length;w++){l=b[w];var S=this.createTrack(e[l],r);this.tracks.push(S),e[l].id=S.id}},t.prototype.updateTracks=function(e){this.tracks.sort(function(n,r){return r.lastTimestamp-n.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},t.prototype.createTrack=function(e,n,r){var s={id:r||this.nextTrackID(),lastTimestamp:n,keypoints:Xf([],e.keypoints,!0).map(function(i){return Vn({},i)})};return e.box!==void 0&&(s.box=Vn({},e.box)),s},t.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},t.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.tracks=this.tracks.filter(function(r){return!e.includes(r.id)})},t.prototype.reset=function(){this.tracks=[]},t}(),yLe=function(t){function e(n){return t.call(this,n)||this}return RZ(e,t),e.prototype.computeSimilarity=function(n){var r=this;return n.length===0||this.tracks.length===0?[[]]:n.map(function(s){return r.tracks.map(function(i){return r.iou(s,i)})})},e.prototype.iou=function(n,r){var s=Math.max(n.box.xMin,r.box.xMin),i=Math.max(n.box.yMin,r.box.yMin),o=Math.min(n.box.xMax,r.box.xMax),a=Math.min(n.box.yMax,r.box.yMax);if(s>=o||i>=a)return 0;var l=(o-s)*(a-i);return l/(n.box.width*n.box.height+r.box.width*r.box.height-l)},e}(VZ),xLe=function(t){function e(n){var r=t.call(this,n)||this;return r.keypointThreshold=n.keypointTrackerParams.keypointConfidenceThreshold,r.keypointFalloff=n.keypointTrackerParams.keypointFalloff,r.minNumKeyoints=n.keypointTrackerParams.minNumberOfKeypoints,r}return RZ(e,t),e.prototype.computeSimilarity=function(n){if(n.length===0||this.tracks.length===0)return[[]];for(var r=[],s=0,i=n;s<i.length;s++){for(var o=i[s],a=[],l=0,u=this.tracks;l<u.length;l++){var c=u[l];a.push(this.oks(o,c))}r.push(a)}return r},e.prototype.oks=function(n,r){for(var s=this.area(r.keypoints)+1e-6,i=0,o=0,a=0;a<n.keypoints.length;++a){var l=n.keypoints[a],u=r.keypoints[a];if(!(l.score<this.keypointThreshold||u.score<this.keypointThreshold)){o+=1;var c=Math.pow(l.x-u.x,2)+Math.pow(l.y-u.y,2),d=2*this.keypointFalloff[a];i+=Math.exp(-1*c/(2*s*Math.pow(d,2)))}}return o<this.minNumKeyoints?0:i/o},e.prototype.area=function(n){var r=this,s=n.filter(function(l){return l.score>r.keypointThreshold}),i=Math.min.apply(Math,Xf([1],s.map(function(l){return l.x}),!1)),o=Math.max.apply(Math,Xf([0],s.map(function(l){return l.x}),!1)),a=Math.min.apply(Math,Xf([1],s.map(function(l){return l.y}),!1));return(o-i)*(Math.max.apply(Math,Xf([0],s.map(function(l){return l.y}),!1))-a)},e}(VZ);function wLe(t){switch(t){case wu.BlazePose:return c1.reduce(function(e,n,r){return e[n]=r,e},{});case wu.PoseNet:case wu.MoveNet:return _u.reduce(function(e,n,r){return e[n]=r,e},{});default:throw new Error("Model ".concat(t," is not supported."))}}(function(t){t.Keypoint="keypoint",t.BoundingBox="boundingBox"})(rp||(rp={})),function(t){t.MoveNet="MoveNet",t.BlazePose="BlazePose",t.PoseNet="PoseNet"}(wu||(wu={}));var FV=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],jZ={modelType:"SinglePose.Lightning",enableSmoothing:!0},LV={},zV={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},F3={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},BV={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function bLe(t,e,n,r){for(var s={},i=0,o=_u;i<o.length;i++){var a=o[i];s[a]=[e[n[a]].y*r.height,e[n[a]].x*r.width]}if(function(b,S){return(b[S.left_hip].score>.2||b[S.right_hip].score>.2)&&(b[S.left_shoulder].score>.2||b[S.right_shoulder].score>.2)}(e,n)){var l=(s.left_hip[0]+s.right_hip[0])/2,u=(s.left_hip[1]+s.right_hip[1])/2,c=function(b,S,C,T,D){for(var P=["left_shoulder","right_shoulder","left_hip","right_hip"],I=0,E=0,M=0;M<P.length;M++)(B=Math.abs(T-C[P[M]][0]))>I&&(I=B),(V=Math.abs(D-C[P[M]][1]))>E&&(E=V);for(var O=0,j=0,R=0,z=Object.keys(C);R<z.length;R++){var B,V,H=z[R];b[S[H]].score<.2||((B=Math.abs(T-C[H][0]))>O&&(O=B),(V=Math.abs(D-C[H][1]))>j&&(j=V))}return[I,E,O,j]}(e,n,s,l,u),d=c[0],h=c[1],f=c[2],m=c[3],g=Math.max(1.9*h,1.9*d,1.2*f,1.2*m),x=[l-(g=Math.min(g,Math.max(u,r.width-u,l,r.height-l))),u-g];if(g>Math.max(r.width,r.height)/2)return QR(t==null,r);var w=2*g;return{yMin:x[0]/r.height,xMin:x[1]/r.width,yMax:(x[0]+w)/r.height,xMax:(x[1]+w)/r.width,height:(x[0]+w)/r.height-x[0]/r.height,width:(x[1]+w)/r.width-x[1]/r.width}}return QR(t==null,r)}function QR(t,e){var n,r,s,i;return t?e.width>e.height?(n=1,r=e.height/e.width,s=0,i=(e.width/2-e.height/2)/e.width):(n=e.width/e.height,r=1,s=(e.height/2-e.width/2)/e.height,i=0):e.width>e.height?(n=e.width/e.height,r=1,s=(e.height/2-e.width/2)/e.height,i=0):(n=1,r=e.height/e.width,s=0,i=(e.width/2-e.height/2)/e.width),{yMin:s,xMin:i,yMax:s+n,xMax:i+r,height:n,width:r}}function vLe(t){var e,n=t==null?jZ:Vn({},t);if(n.modelType==null)n.modelType="SinglePose.Lightning";else if(FV.indexOf(n.modelType)<0)throw new Error("Invalid architecture ".concat(n.modelType,". ")+"Should be one of ".concat(FV));if(n.enableSmoothing==null&&(n.enableSmoothing=!0),n.minPoseScore!=null&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(n.multiPoseMaxDimension!=null&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(n.modelType==="MultiPose.Lightning"&&n.enableTracking==null&&(n.enableTracking=!0),n.modelType==="MultiPose.Lightning"&&n.enableTracking===!0)if(n.trackerType==null&&(n.trackerType=rp.BoundingBox),n.trackerType===rp.Keypoint)n.trackerConfig!=null?n.trackerConfig=function(r){var s=UV(F3,r);return s.keypointTrackerParams=Vn({},F3.keypointTrackerParams),r.keypointTrackerParams!=null&&(r.keypointTrackerParams.keypointConfidenceThreshold!=null&&(s.keypointTrackerParams.keypointConfidenceThreshold=r.keypointTrackerParams.keypointConfidenceThreshold),r.keypointTrackerParams.keypointFalloff!=null&&(s.keypointTrackerParams.keypointFalloff=r.keypointTrackerParams.keypointFalloff),r.keypointTrackerParams.minNumberOfKeypoints!=null&&(s.keypointTrackerParams.minNumberOfKeypoints=r.keypointTrackerParams.minNumberOfKeypoints)),s}(n.trackerConfig):n.trackerConfig=F3;else{if(n.trackerType!==rp.BoundingBox)throw new Error("Tracker type not supported by MoveNet");n.trackerConfig!=null?n.trackerConfig=(e=n.trackerConfig,UV(BV,e)):n.trackerConfig=BV}return n}function UV(t,e){var n={maxTracks:t.maxTracks,maxAge:t.maxAge,minSimilarity:t.minSimilarity};return e.maxTracks!=null&&(n.maxTracks=e.maxTracks),e.maxAge!=null&&(n.maxAge=e.maxAge),e.minSimilarity!=null&&(n.minSimilarity=e.minSimilarity),n}var SLe=function(){function t(e,n){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=wLe(wu.MoveNet),n.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):n.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=n.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new ZR(zV),this.cropRegionFilterYMin=new Yd(.9),this.cropRegionFilterXMin=new Yd(.9),this.cropRegionFilterYMax=new Yd(.9),this.cropRegionFilterXMax=new Yd(.9)),this.enableSmoothing=n.enableSmoothing,n.minPoseScore?this.minPoseScore=n.minPoseScore:this.minPoseScore=.25,n.multiPoseMaxDimension?this.multiPoseMaxDimension=n.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=n.enableTracking,this.multiPoseModel&&this.enableTracking&&(n.trackerType===rp.Keypoint?this.tracker=new xLe(n.trackerConfig):n.trackerType===rp.BoundingBox&&(this.tracker=new yLe(n.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return t.prototype.runSinglePersonPoseModel=function(e){return mn(this,void 0,void 0,function(){var n,r,s,i,o;return gn(this,function(a){switch(a.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==4||n.shape[0]!==1||n.shape[1]!==1||n.shape[2]!==17||n.shape[3]!==3)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return e1()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=a.sent(),a.label=3;case 3:for(n.dispose(),s={keypoints:[],score:0},i=0,o=0;o<17;++o)s.keypoints[o]={y:r[3*o],x:r[3*o+1],score:r[3*o+2]},s.keypoints[o].score>.2&&(++i,s.score+=s.keypoints[o].score);return i>0&&(s.score/=i),[2,s]}})})},t.prototype.runMultiPersonPoseModel=function(e){return mn(this,void 0,void 0,function(){var n,r,s,i,o,a,l,u;return gn(this,function(c){switch(c.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==3||n.shape[0]!==1||n.shape[2]!==56)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return e1()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=c.sent(),c.label=3;case 3:for(n.dispose(),s=[],i=r.length/56,o=0;o<i;++o)for(s[o]={keypoints:[]},a=56*o+51,s[o].box={yMin:r[a],xMin:r[a+1],yMax:r[a+2],xMax:r[a+3],width:r[a+3]-r[a+1],height:r[a+2]-r[a]},l=56*o+55,s[o].score=r[l],s[o].keypoints=[],u=0;u<17;++u)s[o].keypoints[u]={y:r[56*o+3*u],x:r[56*o+3*u+1],score:r[56*o+3*u+2]};return[2,s]}})})},t.prototype.estimatePoses=function(e,n,r){return n===void 0&&(n=LV),mn(this,void 0,void 0,function(){var s,i,o,a,l,u;return gn(this,function(c){switch(c.label){case 0:return n=function(d){return d==null?LV:Vn({},d)}(n),e==null?(this.reset(),[2,[]]):(r==null?BZ(e)&&(r=1e6*e.currentTime):r*=1e3,s=RP(e),i=e0(s),o=Fr(s,0),e instanceof _n||s.dispose(),a=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(o,i,r)]);case 1:return a=c.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(o,i,r)];case 3:a=c.sent(),c.label=4;case 4:for(l=0;l<a.length;++l)for(u=0;u<a[l].keypoints.length;++u)a[l].keypoints[u].name=_u[u],a[l].keypoints[u].y*=i.height,a[l].keypoints[u].x*=i.width;return[2,a]}})})},t.prototype.estimateSinglePose=function(e,n,r){return mn(this,void 0,void 0,function(){var s,i,o,a,l=this;return gn(this,function(u){switch(u.label){case 0:return this.cropRegion||(this.cropRegion=QR(this.cropRegion==null,n)),s=Ve(function(){var c=$a([[l.cropRegion.yMin,l.cropRegion.xMin,l.cropRegion.yMax,l.cropRegion.xMax]]),d=_r([1],"int32"),h=[l.modelInputResolution.height,l.modelInputResolution.width];return lt(gi.cropAndResize(e,c,d,h,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(s)];case 1:if(i=u.sent(),s.dispose(),i.score<this.minPoseScore)return this.reset(),[2,[]];for(o=0;o<i.keypoints.length;++o)i.keypoints[o].y=this.cropRegion.yMin+i.keypoints[o].y*this.cropRegion.height,i.keypoints[o].x=this.cropRegion.xMin+i.keypoints[o].x*this.cropRegion.width;return r!=null&&this.enableSmoothing&&(i.keypoints=this.keypointFilter.apply(i.keypoints,r,1)),a=bLe(this.cropRegion,i.keypoints,this.keypointIndexByName,n),this.cropRegion=this.filterCropRegion(a),[2,[i]]}})})},t.prototype.estimateMultiplePoses=function(e,n,r){return mn(this,void 0,void 0,function(){var s,i,o,a,l,u,c,d,h,f,m,g=this;return gn(this,function(x){switch(x.label){case 0:return n.width>n.height?(i=this.multiPoseMaxDimension,o=Math.round(this.multiPoseMaxDimension*n.height/n.width),s=gi.resizeBilinear(e,[o,i]),l=i,u=32*Math.ceil(o/32),a=Nl(s,[[0,0],[0,u-o],[0,0],[0,0]])):(i=Math.round(this.multiPoseMaxDimension*n.width/n.height),o=this.multiPoseMaxDimension,s=gi.resizeBilinear(e,[o,i]),l=32*Math.ceil(i/32),u=o,a=Nl(s,[[0,0],[0,0],[0,l-i],[0,0]])),s.dispose(),e.dispose(),c=lt(a,"int32"),a.dispose(),[4,this.runMultiPersonPoseModel(c)];case 1:for(d=x.sent(),c.dispose(),d=d.filter(function(w){return w.score>=g.minPoseScore}),f=0;f<d.length;++f)for(h=0;h<d[f].keypoints.length;++h)d[f].keypoints[h].y*=u/o,d[f].keypoints[h].x*=l/i;if(this.enableTracking&&(this.tracker.apply(d,r),this.enableSmoothing)){for(f=0;f<d.length;++f)this.keypointFilterMap.has(d[f].id)||this.keypointFilterMap.set(d[f].id,new ZR(zV)),d[f].keypoints=this.keypointFilterMap.get(d[f].id).apply(d[f].keypoints,r,1);m=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(w,b){m.has(b)||g.keypointFilterMap.delete(b)})}return[2,d]}})})},t.prototype.filterCropRegion=function(e){if(e){var n=this.cropRegionFilterYMin.apply(e.yMin),r=this.cropRegionFilterXMin.apply(e.xMin),s=this.cropRegionFilterYMax.apply(e.yMax),i=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:n,xMin:r,yMax:s,xMax:i,height:s-n,width:i-r}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},t.prototype.dispose=function(){this.moveNetModel.dispose()},t.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},t.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},t}();function CLe(t){return t===void 0&&(t=jZ),mn(this,void 0,void 0,function(){var e,n,r,s;return gn(this,function(i){switch(i.label){case 0:return e=vLe(t),r=!0,e.modelUrl?(r=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Zg(e.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=i.sent(),[3,4];case 2:return s=void 0,e.modelType==="SinglePose.Lightning"?s="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":e.modelType==="SinglePose.Thunder"?s="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":e.modelType==="MultiPose.Lightning"&&(s="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,Zg(s,{fromTFHub:r})];case 3:n=i.sent(),i.label=4;case 4:return e1()==="webgl"&&We().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new SLe(n,e)]}})})}var VV={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},jV=["MobileNetV1","ResNet50"],WV={MobileNetV1:[8,16],ResNet50:[16]},ILe=[8,16,32],GV={MobileNetV1:[.5,.75,1],ResNet50:[1]},HV=[1,2,4],YV={maxPoses:1,flipHorizontal:!1},NLe={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},kLe=[-123.15,-115.9,-103.06];function L3(t){return Math.floor(t/2)}var TLe=function(){function t(e,n){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=n}return t.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},t.prototype.empty=function(){return this.numberOfElements===-1},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(e){for(;e>0&&this.less(L3(e),e);)this.exchange(e,L3(e)),e=L3(e)},t.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var n=2*e;if(n<this.numberOfElements&&this.less(n,n+1)&&n++,!this.less(e,n))break;this.exchange(e,n),e=n}},t.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},t.prototype.less=function(e,n){return this.getValueAt(e)<this.getValueAt(n)},t.prototype.exchange=function(e,n){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[n],this.priorityQueue[n]=r},t}();function ELe(t,e,n,r,s,i){for(var o=i.shape,a=o[0],l=o[1],u=!0,c=Math.max(n-s,0),d=Math.min(n+s+1,a),h=c;h<d;++h){for(var f=Math.max(r-s,0),m=Math.min(r+s+1,l),g=f;g<m;++g)if(i.get(h,g,t)>e){u=!1;break}if(!u)break}return u}function _Le(t){return mn(this,void 0,void 0,function(){return gn(this,function(e){return[2,Promise.all(t.map(function(n){return n.buffer()}))]})})}function WZ(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+17)}}function GZ(t,e,n){var r=WZ(t.heatmapY,t.heatmapX,t.id,n),s=r.y,i=r.x;return{x:t.heatmapX*e+i,y:t.heatmapY*e+s}}function HZ(t,e,n,r){var s=n.x,i=n.y;return t.some(function(o){var a,l,u,c,d,h,f=o.keypoints;return a=i,l=s,u=f[r].y,c=f[r].x,(d=u-a)*d+(h=c-l)*h<=e})}var KV=_u.reduce(function(t,e,n){return t[e]=n,t},{}),YZ=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(t){var e=t[0],n=t[1];return[KV[e],KV[n]]}),z3=YZ.map(function(t){return t[1]}),qV=YZ.map(function(t){return t[0]});function XV(t,e,n){return t<e?e:t>n?n:t}function B3(t,e,n,r){return{y:XV(Math.round(t.y/e),0,n-1),x:XV(Math.round(t.x/e),0,r-1)}}function ZV(t,e){return{x:t.x+e.x,y:t.y+e.y}}function QV(t,e,n,r,s,i,o,a){a===void 0&&(a=2);for(var l=r.shape,u=l[0],c=l[1],d={y:e.y,x:e.x},h=ZV(d,function(b,S,C){var T=C.shape[2]/2;return{y:C.get(S.y,S.x,b),x:C.get(S.y,S.x,T+b)}}(t,B3(d,i,u,c),o)),f=0;f<a;f++){var m=B3(h,i,u,c),g=WZ(m.y,m.x,n,s);h=ZV({x:m.x*i,y:m.y*i},{x:g.x,y:g.y})}var x=B3(h,i,u,c),w=r.get(x.y,x.x,n);return{y:h.y,x:h.x,name:_u[n],score:w}}function ALe(t,e,n,r,s,i){var o=e.shape[2],a=z3.length,l=new Array(o),u=t.part,c=t.score,d=GZ(u,r,n);l[u.id]={score:c,name:_u[u.id],y:d.y,x:d.x};for(var h=a-1;h>=0;--h){var f=z3[h],m=qV[h];l[f]&&!l[m]&&(l[m]=QV(h,l[f],m,e,n,r,i))}for(h=0;h<a;++h)f=qV[h],m=z3[h],l[f]&&!l[m]&&(l[m]=QV(h,l[f],m,e,n,r,s));return l}function $Le(t,e,n){return n.reduce(function(r,s,i){var o=s.y,a=s.x,l=s.score;return HZ(t,e,{y:o,x:a},i)||(r+=l),r},0)/n.length}function RLe(t,e,n,r,s,i,o,a){return o===void 0&&(o=.5),a===void 0&&(a=20),mn(this,void 0,void 0,function(){var l,u,c,d,h,f,m,g,x,w,b,S;return gn(this,function(C){switch(C.label){case 0:return[4,_Le([t,e,n,r])];case 1:for(l=C.sent(),u=l[0],c=l[1],d=l[2],h=l[3],f=[],m=function(T,D,P){for(var I=P.shape,E=I[0],M=I[1],O=I[2],j=new TLe(E*M*O,function(H){return H.score}),R=0;R<E;++R)for(var z=0;z<M;++z)for(var B=0;B<O;++B){var V=P.get(R,z,B);V<T||ELe(B,V,R,z,D,P)&&j.enqueue({score:V,part:{heatmapY:R,heatmapX:z,id:B}})}return j}(o,1,u),g=a*a;f.length<i&&!m.empty();)x=m.dequeue(),w=GZ(x.part,s,c),HZ(f,g,w,x.part.id)||(b=ALe(x,u,c,s,d,h),S=$Le(f,g,b),f.push({keypoints:b,score:S}));return[2,f]}})})}function KZ(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(e.length){case 0:t="fn main() ";break;case 1:t="fn main(".concat(e[0]," : i32)");break;default:throw Error("Unreachable")}return t}var MLe=function(){function t(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=wt(this.outputShape),this.dispatch=ct(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return t.prototype.getUserCode=function(){return`
        `.concat(KZ("index"),` {
          if (index < uniforms.size) {
            let y = B[index * 2];
            let x = B[index * 2 + 1];
            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;
            result[index] = A[outIndex];
          }
        }
        `)},t}();function DLe(t,e){if(bp()instanceof Sy)return function(n,r){var s=bp(),i=new MLe(r.shape),o=s.runWebGPUProgram(i,[n,r],"float32");return ci().makeTensorFromTensorInfo(o)}(t,e);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}var OLe=function(){function t(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,e.length!==2||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var n=[e[0],1];this.dispatchLayout=wt(n),this.dispatch=ct(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return t.prototype.getUserCode=function(){return`
    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {
      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;
      let outIndexX = outIndexY + uniforms.bShape.z;
      let outY = i32(B[outIndexY]);
      let outX = i32(B[outIndexX]);
      return vec2<i32>(outY, outX);
    }

    `.concat(KZ("index"),` {
      if (index < uniforms.size) {
        let indexY = index * `).concat(this.supportedLastDimension,`;
        let indexX = indexY + 1;
        let heatmapY = A[indexY];
        let heatmapX = A[indexX];
        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);
        result[indexY] = f32(out[0]);
        result[indexX] = f32(out[1]);
      }
    }
    `)},t}();function PLe(t,e){if(bp()instanceof Sy)return function(n,r){var s=bp(),i=new OLe(n.shape),o=s.runWebGPUProgram(i,[n,r],"float32");return ci().makeTensorFromTensorInfo(o)}(t,e);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}function qZ(t){var e=t.shape,n=e[0],r=e[1],s=e[2];return Ve(function(){var i,o,a=Me(t,[n*r,s]),l=Cp(a,0),u=Fr(yt(l,Mt(r,"int32")),1),c=Fr((i=l,o=r,Ve(function(){var d=yt(i,Mt(o,"int32"));return xt(i,_e(d,Mt(o,"int32")))})),1);return pr([u,c],1)})}function FLe(t,e,n){return Ve(function(){var r=function(s,i){for(var o=[],a=0;a<_u.length;a++){var l=s.get(a,0).valueOf(),u=s.get(a,1).valueOf(),c=LLe(l,u,a,i),d=c.x,h=c.y;o.push(h),o.push(d)}return $a(o,[_u.length,2])}(t,n);return Qe(lt(_e(t.toTensor(),Mt(e,"int32")),"float32"),r)})}function LLe(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+_u.length)}}function zLe(t,e,n){return mn(this,void 0,void 0,function(){var r,s,i,o,a,l,u,c,d,h;return gn(this,function(f){switch(f.label){case 0:return r=0,s=qZ(t),[4,Promise.all([t.buffer(),e.buffer(),s.buffer()])];case 1:return i=f.sent(),o=i[0],a=i[1],l=i[2],[4,(u=FLe(l,n,a)).buffer()];case 2:return c=f.sent(),d=Array.from(function(m,g){for(var x=g.shape[0],w=new Float32Array(x),b=0;b<x;b++){var S=g.get(b,0),C=g.get(b,1);w[b]=m.get(S,C,b)}return w}(o,l)),h=d.map(function(m,g){return r+=m,{y:c.get(g,0),x:c.get(g,1),score:m,name:_u[g]}}),s.dispose(),u.dispose(),[2,{keypoints:h,score:r/h.length}]}})})}function BLe(t,e,n){return mn(this,void 0,void 0,function(){var r,s,i;return gn(this,function(o){return r=qZ(t),s=function(a,l,u){return Ve(function(){var c=PLe(a,u);return Qe(lt(_e(a,Mt(l,"int32")),"float32"),c)})}(r,n,e),i=DLe(t,r),[2,[s,i]]})})}function JV(t,e){return(t-1)%e==0}var ej="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",tj="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function nj(t,e){return function(n,r){return(n-1)%r==0}(t,e)?t:Math.floor(t/e)*e+1}var rj=function(){function t(e,n){this.posenetModel=e;var r=this.posenetModel.inputs[0].shape;ae(r[1]===-1&&r[2]===-1,function(){return"Input shape [".concat(r[1],", ").concat(r[2],"] ")+"must both be equal to or -1"});var s,i,o=(s=n.inputResolution,i=n.outputStride,{height:nj(s.height,i),width:nj(s.width,i)});(function(a){ae(ILe.indexOf(a)>=0,function(){return"outputStride of ".concat(a," is invalid. ")+"It must be either 8 or 16."})})(n.outputStride),function(a,l){ae(JV(a.height,l),function(){return"height of ".concat(a.height," is invalid for output stride ")+"".concat(l,".")}),ae(JV(a.width,l),function(){return"width of ".concat(a.width," is invalid for output stride ")+"".concat(l,".")})}(o,n.outputStride),this.inputResolution=o,this.outputStride=n.outputStride,this.architecture=n.architecture}return t.prototype.estimatePoses=function(e,n){return n===void 0&&(n=YV),mn(this,void 0,void 0,function(){return gn(this,function(r){return[2,this.estimatePosesGPU(e,n,!1)]})})},t.prototype.estimatePosesGPU=function(e,n,r){return n===void 0&&(n=YV),r===void 0&&(r=!1),mn(this,void 0,void 0,function(){var s,i,o,a,l,u,c,d,h,f,m,g,x,w,b,S,C,T;return gn(this,function(D){switch(D.label){case 0:return s=function(P){var I=P;if(I.maxPoses==null&&(I.maxPoses=1),I.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(I.maxPoses,". Should be > 0."));if(I.maxPoses>1){if((I=Vn(Vn({},NLe),I)).scoreThreshold<0||I.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(I.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(I.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(I.nmsRadius,"."))}return I}(n),e==null?[2,r?[[],[]]:[]]:(this.maxPoses=s.maxPoses,i=XR(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),o=i.imageTensor,a=i.padding,l=this.architecture==="ResNet50"?Qe(o,kLe):zZ(o,[-1,1]),u=this.posenetModel.predict(l),this.architecture==="ResNet50"?(c=Nn(u[2],[0]),d=Nn(u[3],[0]),h=Nn(u[0],[0]),f=Nn(u[1],[0])):(c=Nn(u[0],[0]),d=Nn(u[1],[0]),h=Nn(u[2],[0]),f=Nn(u[3],[0])),m=Go(d),this.maxPoses!==1?[3,5]:r?[4,BLe(m,c,this.outputStride)]:[3,2]);case 1:return x=D.sent(),b=x[0],w=x[1],g=[b,w],[3,4];case 2:return[4,zLe(m,c,this.outputStride)];case 3:b=D.sent(),g=[b],D.label=4;case 4:return[3,7];case 5:if(r)throw new Error("GPU renderer only supports single pose!");return[4,RLe(m,c,h,f,this.outputStride,this.maxPoses,s.scoreThreshold,s.nmsRadius)];case 6:g=D.sent(),D.label=7;case 7:if(r){if(s.flipHorizontal===!0)throw new Error("flipHorizontal is not supported!");S=this.getCanvasInfo(e0(e),this.inputResolution,a)}else T=e0(e),C=function(P,I,E,M){var O=I.height,j=I.width,R=O/(E.height*(1-M.top-M.bottom)),z=j/(E.width*(1-M.left-M.right)),B=-M.top*E.height,V=-M.left*E.width;if(z===1&&R===1&&B===0&&V===0)return P;for(var H=0,K=P;H<K.length;H++)for(var ne=0,fe=K[H].keypoints;ne<fe.length;ne++){var ee=fe[ne];ee.x=(ee.x+V)*z,ee.y=(ee.y+B)*R}return P}(g,T,this.inputResolution,a),s.flipHorizontal&&(C=function(P,I){for(var E=0,M=P;E<M.length;E++)for(var O=0,j=M[E].keypoints;O<j.length;O++){var R=j[O];R.x=I.width-1-R.x}return P}(C,T));return o.dispose(),l.dispose(),Bt(u),c.dispose(),d.dispose(),h.dispose(),f.dispose(),m.dispose(),[2,r?[g,S]:C]}})})},t.prototype.getCanvasInfo=function(e,n,r){var s=e.height,i=e.width,o=s/(n.height*(1-r.top-r.bottom)),a=i/(n.width*(1-r.left-r.right)),l=-r.top*n.height;return[-r.left*n.width,l,a,o,e.width,e.height]},t.prototype.dispose=function(){this.posenetModel.dispose()},t.prototype.reset=function(){},t}();function ULe(t){return t===void 0&&(t=VV),mn(this,void 0,void 0,function(){var e,n,r,s,i;return gn(this,function(o){switch(o.label){case 0:return(e=function(c){var d=c||VV;if(d.architecture==null&&(d.architecture="MobileNetV1"),jV.indexOf(d.architecture)<0)throw new Error("Invalid architecture ".concat(d.architecture,". ")+"Should be one of ".concat(jV));if(d.inputResolution==null&&(d.inputResolution={height:257,width:257}),d.outputStride==null&&(d.outputStride=16),WV[d.architecture].indexOf(d.outputStride)<0)throw new Error("Invalid outputStride ".concat(d.outputStride,". ")+"Should be one of ".concat(WV[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.multiplier==null&&(d.multiplier=1),GV[d.architecture].indexOf(d.multiplier)<0)throw new Error("Invalid multiplier ".concat(d.multiplier,". ")+"Should be one of ".concat(GV[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.quantBytes==null&&(d.quantBytes=4),HV.indexOf(d.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(d.quantBytes,". ")+"Should be one of ".concat(HV," ")+"for architecture ".concat(d.architecture,"."));if(d.architecture==="MobileNetV1"&&d.outputStride===32&&d.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return d}(t)).architecture!=="ResNet50"?[3,2]:(a=e.outputStride,l=e.quantBytes,u="model-stride".concat(a,".json"),n=l===4?tj+"float/"+u:tj+"quant".concat(l,"/")+u,[4,Zg(e.modelUrl||n)]);case 1:return r=o.sent(),[2,new rj(r,e)];case 2:return s=function(c,d,h){var f={1:"100",.75:"075",.5:"050"},m="model-stride".concat(c,".json");return h===4?ej+"float/".concat(f[d],"/")+m:ej+"quant".concat(h,"/").concat(f[d],"/")+m}(e.outputStride,e.multiplier,e.quantBytes),[4,Zg(e.modelUrl||s)];case 3:return i=o.sent(),[2,new rj(i,e)]}var a,l,u})})}function VLe(t,e){return mn(this,void 0,void 0,function(){var n,r;return gn(this,function(s){switch(t){case wu.PoseNet:return[2,ULe(e)];case wu.BlazePose:if(r=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,gLe(e)];if(n.runtime==="mediapipe")return[2,VFe(e)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case wu.MoveNet:return[2,CLe(e)];default:throw new Error("".concat(t," is not a supported model name."))}})})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XZ={kernelName:j1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,wy(lt(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jLe={kernelName:S0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Fn(lt(n,"float32")),s=$s(xt(Mt(1),r));return tr(yt(t,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WLe={kernelName:C0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=$s(xt(Fn(lt(n,"float32")),1));return yt(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GLe={kernelName:Bp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=jt(n.shape,r.shape);return{a:()=>{let a=t;const l=os(n.shape,s);return l.length>0&&(a=Nt(a,l)),Me(a,n.shape)},b:()=>{let a=t;const l=os(r.shape,s);return l.length>0&&(a=Nt(a,l)),Me(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HLe={kernelName:W1,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,s)=>{n[s]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YLe={kernelName:G1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xn(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KLe={kernelName:H1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xn(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qLe={kernelName:I0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,$s(xt(Mt(1),Fn(lt(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XLe={kernelName:N0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=$s(Qe(Mt(1),Fn(lt(n,"float32"))));return yt(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZLe={kernelName:E0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=jt(n.shape,r.shape);return{a:()=>{const a=Qe(Fn(n),Fn(r));let l=_e(t,yt(r,a));const u=os(n.shape,s);return u.length>0&&(l=Nt(l,u)),Me(l,n.shape)},b:()=>{const a=Qe(Fn(n),Fn(r));let l=tr(_e(t,yt(n,a)));const u=os(r.shape,s);return u.length>0&&(l=Nt(l,u)),Me(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QLe={kernelName:k0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,Qe(Fn(lt(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JLe={kernelName:T0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,xt(Mt(1),Fn(lt(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eze(t,e,n,r,s,i){const o=pe(t,"dy","avgPool3dGrad"),a=pe(e,"input","avgPool3dGrad");let l=o,u=a,c=!1;a.rank===4&&(c=!0,l=Me(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=Me(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ae(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),ae(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),vi("avgPool3dGrad",s,i);const d={dy:l,input:u},h={filterSize:n,strides:r,pad:s,dimRoundingMode:i},f=$e.runKernel(QN,d,h);return c?Me(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const tze=Ae({avgPool3dGrad_:eze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nze={kernelName:K1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>tze(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rze(t,e,n,r,s){const i=pe(t,"dy","avgPoolGrad"),o=pe(e,"input","avgPoolGrad");ae(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,u=!1;o.rank===3&&(u=!0,a=Me(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ae(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),ae(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},d={filterSize:n,strides:r,pad:s},h=$e.runKernel(ZN,c,d);return u?Me(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const sze=Ae({avgPoolGrad_:rze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ize={kernelName:Y1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o}=n;return{x:()=>sze(t,r,s,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oze={kernelName:q1,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>dn(t,s,!1,!0),b:()=>dn(r,t,!0,!1)}:!i&&o?{a:()=>dn(t,s,!1,!1),b:()=>dn(t,r,!0,!1)}:i&&!o?{a:()=>dn(s,t,!1,!0),b:()=>dn(r,t,!1,!1)}:{a:()=>dn(s,t,!0,!0),b:()=>dn(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aze={kernelName:X1,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>sT(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lze={kernelName:lbe,gradFunc:(t,e,n)=>{const r=n,s=r.inputShape,i=r.shape,o=Array.from(i);for(let l=s.length-1;l>=0;l--)if(s[l]===i[l])o[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Nt(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uze={kernelName:_0,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cze={kernelName:A0,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dze={kernelName:$0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=n;return{x:()=>js(ku(Dh(r,s),Vp(r,i)),t,xn(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hze={kernelName:Z1,inputsToSave:["x"],gradFunc:XZ.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fze={kernelName:Q1,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:s}=n,i=Jt(s,e[0].shape)[0],o=r.map(l=>l[i]);return go(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pze={kernelName:J1,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return ae(ph(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>DO(r.shape,t,s,o,a,l),filter:()=>uP(r,t,s.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mze={kernelName:eb,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>mh(t,s,i,o,a,1,l),filter:()=>uP(t,r,s.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gze(t,e,n,r,s){let i=t;t.rank===4&&(i=Me(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=Me(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),ae(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),ae(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),ae(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),ae(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),ae(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:r,pad:s,filterShape:n};return $e.runKernel(sk,a,l)}const yze=Ae({conv3DBackpropFilter_:gze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xze={kernelName:tb,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i}=n;ae(ph(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=e;return{x:()=>_K(o.shape,t,a,s,i),filter:()=>yze(o,t,a.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wze={kernelName:R0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(tr(JO(lt(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bze={kernelName:M0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(eP(lt(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vze={kernelName:nb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:i,reverse:o}=n;return{x:()=>{const a=zn([s],r.rank);let l=FO(t,s,i,!o);return a!=null&&(l=yn(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sze={kernelName:rb,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:o}=n,a=r??[1,1];ae(ph(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return ae(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),ae(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),ae(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),ae(as(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),vi("depthwiseConv2d",i,o),{x:()=>uq(l.shape,t,u,s,i,a,o),filter:()=>lq(l,t,u.shape,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cze={kernelName:sb,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,i={x:r,filter:s,dy:t},o={x:r,filter:s,dy:t};return{x:()=>$e.runKernel(CI,i,n),filter:()=>$e.runKernel(II,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ize={kernelName:O0,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>$e.runKernel(pk,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nze={kernelName:P0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=_e(wi(tr(Fn(n))),2/Math.sqrt(Math.PI));return{x:()=>_e(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kze={kernelName:F0,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tze={kernelName:ob,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Me(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eze={kernelName:L0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,wi(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ze={kernelName:z0,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aze={kernelName:B0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=jt(n.shape,r.shape);return{a:()=>{const a=yt(t,lt(r,"float32")),l=os(n.shape,s);return l.length>0?Me(Nt(a,l),n.shape):a},b:()=>{let a=_e(t,lt(n,"float32"));const l=os(r.shape,s);l.length>0&&(a=Me(Nt(a,l),r.shape));const u=Fn(r);return tr(yt(a,lt(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ze={kernelName:ab,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,i,o,a]=e,l=a??Mt(1),u=os(i.shape,s.shape),c=[];if(i.rank===1){for(let C=0;C<s.shape.length-1;++C)c.push(s.shape[C]);c.push(1)}const d=xt(s,i),h=_e(t,l),f=XO(Qe(o,Mt(r))),m=_e(_e(_e(f,f),f),Mt(-.5));return{x:()=>i.rank===1?Me(_e(_e(t,Ca(Me(f,[1,1,1,i.shape[0]]),c)),l),s.shape):Me(_e(_e(t,f),l),s.shape),mean:()=>{let C=_e(_e(f,Mt(-1)),h);return i.rank===1&&(C=Nt(C,u)),Me(C,i.shape)},variance:()=>{let C=_e(_e(m,d),h);return i.rank===1&&(C=Nt(C,u)),Me(C,i.shape)},scale:()=>{const C=_e(d,f);let T=_e(t,C);return i.rank===1&&(T=Nt(T,u)),Me(T,i.shape)},offset:()=>{let C=t;return i.rank===1&&(C=Nt(C,u)),Me(C,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rze={kernelName:lb,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:i,batchDims:o}=n,a=Jt(i,r.shape)[0],l=(u,c,d)=>()=>{const h=u.shape,f=c.size,m=h.slice(0,a),g=m.length,x=h.slice(i,h.length).slice(1),w=x.length,b=sj(0,g),S=sj(g+1,g+1+w),C=ij([m,[f],x]),T=Me(d,C),D=Me(c,[f]),P=ij([[g],b,S]),I=yn(T,P);let E=oP(I,D,u.shape[a]);const M=Du(P);return E=yn(E,M),E};if(o===1){const u=r.shape[0],c=r.split(u,0);return{x:()=>xo(c.map((f,m)=>l(f,s.slice(m,1),t.slice(m,1))())).reshape(r.shape),indices:()=>s}}else return{x:l(r,s,t),indices:()=>s}}};function sj(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function ij(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mze={kernelName:U0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>xn(n),b:()=>xn(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dze={kernelName:V0,gradFunc:t=>({x:()=>lt(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oze={kernelName:j0,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pze={kernelName:W0,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fze={kernelName:G0,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lze={kernelName:cb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,i=Io(r,0);return{x:()=>js(i,t,_e(t,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zze={kernelName:Y0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,Qe(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bze={kernelName:H0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,lt(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uze={kernelName:ube,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const o=wi(r);return xt(t,_e(Nt(t,s,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vze(t,e,n,r=5,s=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:s,alpha:i,beta:o};return $e.runKernel(Sk,a,l)}const jze=Ae({localResponseNormalizationBackprop_:Vze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wze={kernelName:gb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>jze(r,s,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZZ(t,e,n,r){return e.rank<n.rank&&(e=Me(e,Cr(e.shape,r))),t.rank<n.rank&&(t=Me(t,Cr(t.shape,r))),{x:()=>_e(t,lt(Il(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oj={kernelName:yb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,i=e[0],o=e[1],a=Jt(s,i.shape),l=ZZ(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gze={kernelName:K0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>_e(t,lt(Dh(n,r),"float32")),b:()=>_e(t,lt(s1(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hze(t,e,n,r,s,i,o){const a=pe(t,"dy","maxPool3dGrad"),l=pe(e,"input","maxPool3dGrad"),u=pe(n,"output","maxPool3dGrad");let c=a,d=l,h=u,f=!1;l.rank===4&&(f=!0,c=Me(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=Me(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=Me(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),ae(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),ae(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),ae(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),vi("maxPool3dGrad",i,o);const m={dy:c,input:d,output:h},g={filterSize:r,strides:s,pad:i,dimRoundingMode:o},x=$e.runKernel(Ik,m,g);return f?Me(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const Yze=Ae({maxPool3dGrad_:Hze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kze={kernelName:wb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Yze(t,r,s,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qze(t,e,n,r,s,i,o){const a=pe(t,"dy","maxPoolGrad"),l=pe(e,"input","maxPoolGrad"),u=pe(n,"output","maxPoolGrad");ae(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),ae(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),ae(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),vi("maxPoolGrad",i,o);const c={dy:a,input:l,output:u},d={filterSize:r,strides:s,pad:i,dimRoundingMode:o};return $e.runKernel(Ck,c,d)}const Xze=Ae({maxPoolGrad_:qze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zze={kernelName:xb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>Xze(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qze={kernelName:bb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,i=Jt(s,r.shape),a=$r(r.shape,i)[1],l=Ue(a);return{x:()=>{const c=r.shape.slice();i.forEach(f=>{c[f]=1});const d=Me(t,c);return yt(_e(d,mo(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jze={kernelName:vb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[i,o]=e,a=Jt(s,i.shape),l=ZZ(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eBe={kernelName:q0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>_e(t,lt(Vp(n,r),"float32")),b:()=>_e(t,lt(Io(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tBe={kernelName:Sb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>Kt(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nBe={kernelName:X0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=jt(n.shape,r.shape);return{a:()=>{const a=os(n.shape,s);return a.length>0?Me(Nt(t,a),n.shape):t},b:()=>{const a=_e(t,tr(qb(yt(n,r)))),l=os(r.shape,s);return l.length>0?Me(Nt(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rBe={kernelName:Z0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=jt(n.shape,r.shape);return{a:()=>{const a=_e(t,lt(r,"float32")),l=os(n.shape,s);return l.length>0?Me(Nt(a,l),n.shape):a},b:()=>{const a=_e(t,lt(n,"float32")),l=os(r.shape,s);return l.length>0?Me(Nt(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sBe={kernelName:Cb,gradFunc:t=>({x:()=>tr(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iBe={kernelName:kb,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>_r(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oBe={kernelName:Nb,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aBe={kernelName:Tb,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return Da(t,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aj={kernelName:Eb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>Kt(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lBe={kernelName:Q0,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,i=n,o=r,a=jt(i.shape,o.shape);return{a:()=>{const c=lt(o,"float32");let d=_e(t,_e(c,Rc(i,xt(c,Mt(1)))));const h=os(i.shape,a);return h.length>0&&(d=Nt(d,h)),Me(d,i.shape)},b:()=>{const c=Io(i,0),d=js(c,Yo(i),xn(i));let h=_e(t,_e(s,d));const f=os(o.shape,a);return f.length>0&&(h=Nt(h,f)),Me(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uBe={kernelName:_b,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=Io(n,0);return{x:()=>js(s,t,_e(t,r)),alpha:()=>{let i=js(s,xn(t),_e(t,n));const o=os(r.shape,t.shape);return o.length>0&&(i=Nt(i,o)),Me(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cBe(t,e,n){const r=t.shape.slice();r[n]=1;const s=Me(e,r),i=$I(t,n,!0,!1),o=$I(t,n,!0,!0),a=_e(i,o);return _e(s,a)}function dBe(t,e,n){const r=t.shape.length,s=r-n.length,i=zn(n,r);let o=t;i!=null&&(o=yn(t,i));const a=o.shape.slice(),u=a.splice(r-n.length,n.length).reduce((h,f)=>h*f,1);a.push(u);const c=o.reshape(a);let d=cBe(c,e,s);if(d=d.reshape(o.shape),i!=null){const h=Du(i);d=yn(d,h)}return d}const hBe={kernelName:Ab,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;let i=[];return s==null?i=r.shape.map((o,a)=>a):typeof s=="number"?i=[s]:i=s,{x:()=>dBe(r,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fBe={kernelName:D0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=jt(n.shape,r.shape);return{a:()=>{const a=yt(t,lt(r,"float32")),l=os(n.shape,s);return l.length>0?Me(Nt(a,l),n.shape):a},b:()=>{let a=_e(t,lt(n,"float32"));const l=os(r.shape,s);l.length>0&&(a=Me(Nt(a,l),r.shape));const u=Fn(r);return tr(yt(a,lt(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pBe={kernelName:J0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,tr(Fn(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mBe={kernelName:ty,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=_e(Vp(n,6),wy(n));return{x:()=>_e(t,lt(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gBe={kernelName:ey,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,lt(wy(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yBe={kernelName:$b,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xBe={kernelName:Mb,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>$e.runKernel(Rk,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wBe={kernelName:Rb,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>$e.runKernel($k,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bBe={kernelName:Db,gradFunc:(t,e,n)=>{const{dims:r}=n,s=Jt(r,t.shape);return{x:()=>Ma(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vBe={kernelName:ny,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SBe={kernelName:ry,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>tr(yt(t,_e(Rc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CBe={kernelName:Ob,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>lt(xn(n),"float32"),t:()=>_e(t,lt(n,t.dtype)),e:()=>_e(t,lt(tT(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IBe={kernelName:sy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Io(n,Mt(0)),s=Mt(Qb),i=Mt(Jb),o=_e(t,i),a=_e(_e(t,s),wi(lt(n,"float32")));return js(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NBe={kernelName:ly,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,_e(n,xt(Mt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kBe={kernelName:ay,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TBe={kernelName:iy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(Xk(lt(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EBe={kernelName:oy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(PO(lt(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Be={kernelName:Pb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:i}=n,o=r.shape,[a,l]=Zb(r,s,i),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],o[c]-a[c]-l[c]]);return{x:()=>Nl(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ABe={kernelName:Bb,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,i=!0,o=_e(t,r);return{logits:()=>xt(o,_e(Nt(o,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Be={kernelName:uy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,Go(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lj={kernelName:Lb,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>qk(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uj={kernelName:zb,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>pr(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RBe={kernelName:cy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,_e($s(lt(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MBe={kernelName:zk,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,_e(lt(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DBe={kernelName:dy,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Mt(2);return{a:()=>_e(t,_e(s,xt(n,r))),b:()=>_e(t,_e(s,xt(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OBe={kernelName:gy,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PBe={kernelName:hy,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=jt(n.shape,r.shape);return{a:()=>{let a=t;const l=os(n.shape,s);return l.length>0&&(a=Nt(a,l)),Me(a,n.shape)},b:()=>{let a=t;const l=os(r.shape,s);return l.length>0&&(a=Nt(a,l)),Me(tr(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FBe={kernelName:Fb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:i}=n;Jt(i,r.shape).forEach(u=>{s[u]=1});const a=Me(t,s),l=_e(a,mo(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LBe={kernelName:fy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yt(t,Fn(Xk(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zBe={kernelName:py,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(xt(Mt(1),Fn(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BBe={kernelName:my,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let o=xn(r);if(r.rank===1)for(let a=0;a<s[0];++a)o=Qe(o,Kt(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)o=Qe(o,Kt(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)o=Qe(o,Kt(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)for(let c=0;c<s[3];++c)o=Qe(o,Kt(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UBe={kernelName:tp,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,i=Du(s);return{x:()=>yn(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VBe={kernelName:Ub,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>xo(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jBe={kernelName:Vb,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>WBe(t,n)}}};function WBe(t,e){const n=Pc(e,xn(e)),r=Xb(t,n);let s=Dh(e,Mt(0,"int32"));const i=r.rank-s.rank;for(let a=0;a<i;++a)s=Fr(s,a+1);s=ku(s,mo(r.shape,"bool"));const o=xn(r);return js(s,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GBe={kernelName:jb,gradFunc:t=>({x:()=>xn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HBe=[XZ,jLe,WLe,GLe,HLe,YLe,KLe,qLe,XLe,ZLe,QLe,JLe,nze,ize,oze,aze,lze,uze,cze,dze,hze,fze,mze,pze,xze,wze,bze,vze,Sze,Cze,fBe,Ize,Nze,kze,Tze,Eze,Aze,_ze,$ze,Rze,Mze,Dze,Oze,Pze,Fze,Lze,zze,Bze,Uze,Wze,oj,oj,Gze,Kze,Zze,Qze,Jze,eBe,tBe,nBe,rBe,sBe,iBe,oBe,aBe,aj,aj,lBe,uBe,hBe,pBe,mBe,gBe,yBe,xBe,wBe,bBe,vBe,SBe,CBe,IBe,NBe,kBe,TBe,EBe,_Be,ABe,$Be,lj,lj,uj,uj,RBe,DBe,MBe,OBe,PBe,FBe,LBe,zBe,BBe,UBe,VBe,jBe,GBe];for(const t of HBe)dbe(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.abs=function(){return this.throwIfDisposed(),Zr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.acos=function(){return this.throwIfDisposed(),cK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.acosh=function(){return this.throwIfDisposed(),dK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.add=function(t){return this.throwIfDisposed(),Qe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.all=function(t,e){return this.throwIfDisposed(),$O(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.any=function(t,e){return this.throwIfDisposed(),AI(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.argMax=function(t){return this.throwIfDisposed(),Cp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.argMin=function(t){return this.throwIfDisposed(),hK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.asScalar=function(){return this.throwIfDisposed(),ae(this.size===1,()=>"The array must have only 1 element."),Me(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.asType=function(t){return this.throwIfDisposed(),lt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.as1D=function(){return this.throwIfDisposed(),Me(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.as2D=function(t,e){return this.throwIfDisposed(),Me(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Me(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),Me(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),Me(this,[t,e,n,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.asin=function(){return this.throwIfDisposed(),fK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.asinh=function(){return this.throwIfDisposed(),pK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.atan=function(){return this.throwIfDisposed(),mK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.atan2=function(t){return this.throwIfDisposed(),gK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.atanh=function(){return this.throwIfDisposed(),yK(this)};Ze().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),Kk(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),qk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),Gb(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Dg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.cast=function(t){return this.throwIfDisposed(),lt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.ceil=function(){return this.throwIfDisposed(),CK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Vi(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof _n&&(t=[t]),pr([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.conv1d=function(t,e,n,r,s,i){return this.throwIfDisposed(),MO(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),OO(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.conv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),mh(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.cos=function(){return this.throwIfDisposed(),Xk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.cosh=function(){return this.throwIfDisposed(),PO(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),$I(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),FO(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),$K(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.depthwiseConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Hb(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),RK(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.divNoNan=function(t){return this.throwIfDisposed(),MK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.div=function(t){return this.throwIfDisposed(),yt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.dot=function(t){return this.throwIfDisposed(),DK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.elu=function(){return this.throwIfDisposed(),Yb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.equal=function(t){return this.throwIfDisposed(),Il(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.erf=function(){return this.throwIfDisposed(),LO(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),FK(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.exp=function(){return this.throwIfDisposed(),wi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.expandDims=function(t){return this.throwIfDisposed(),Fr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.expm1=function(){return this.throwIfDisposed(),LK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.fft=function(){return this.throwIfDisposed(),cT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.flatten=function(){return this.throwIfDisposed(),Me(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.floor=function(){return this.throwIfDisposed(),qb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.floorDiv=function(t){return this.throwIfDisposed(),AO(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Xb(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Dh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.greater=function(t){return this.throwIfDisposed(),Io(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.ifft=function(){return this.throwIfDisposed(),a1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.irfft=function(){return this.throwIfDisposed(),nP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.isFinite=function(){return this.throwIfDisposed(),zK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.isInf=function(){return this.throwIfDisposed(),BK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.isNaN=function(){return this.throwIfDisposed(),UK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Qk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.lessEqual=function(t){return this.throwIfDisposed(),Vp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.less=function(t){return this.throwIfDisposed(),s1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),VK(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.logSigmoid=function(){return this.throwIfDisposed(),jK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.logSoftmax=function(t){return this.throwIfDisposed(),UO(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),eT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.log=function(){return this.throwIfDisposed(),Yo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.log1p=function(){return this.throwIfDisposed(),Jk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.logicalAnd=function(t){return this.throwIfDisposed(),ku(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.logicalNot=function(){return this.throwIfDisposed(),tT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.logicalOr=function(t){return this.throwIfDisposed(),VO(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.logicalXor=function(t){return this.throwIfDisposed(),WK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),dn(this,t,e,n)};Ze().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),nT(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.max=function(t,e){return this.throwIfDisposed(),Aa(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.maximum=function(t){return this.throwIfDisposed(),Pc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.mean=function(t,e){return this.throwIfDisposed(),wr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.min=function(t,e){return this.throwIfDisposed(),r1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.minimum=function(t){return this.throwIfDisposed(),yh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),WO(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.mod=function(t){return this.throwIfDisposed(),HK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.mul=function(t){return this.throwIfDisposed(),_e(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.neg=function(){return this.throwIfDisposed(),tr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Kb(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.notEqual=function(t){return this.throwIfDisposed(),qg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),GO(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.onesLike=function(){return this.throwIfDisposed(),Ko(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.pad=function(t,e){return this.throwIfDisposed(),Nl(this,t,e)};Ze().prototype.pool=function(t,e,n,r,s,i){return this.throwIfDisposed(),YK(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.pow=function(t){return this.throwIfDisposed(),Rc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.prelu=function(t){return this.throwIfDisposed(),iT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.prod=function(t,e){return this.throwIfDisposed(),KK(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.reciprocal=function(){return this.throwIfDisposed(),qK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.relu=function(){return this.throwIfDisposed(),Ou(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.relu6=function(){return this.throwIfDisposed(),KO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.reshapeAs=function(t){return this.throwIfDisposed(),Me(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.reshape=function(t){return this.throwIfDisposed(),Me(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),hq(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),fq(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.reverse=function(t){return this.throwIfDisposed(),Ma(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.rfft=function(){return this.throwIfDisposed(),dT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.round=function(){return this.throwIfDisposed(),qO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.rsqrt=function(){return this.throwIfDisposed(),XO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.selu=function(){return this.throwIfDisposed(),ZO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.separableConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),QO(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.sigmoid=function(){return this.throwIfDisposed(),Go(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.sign=function(){return this.throwIfDisposed(),XK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.sin=function(){return this.throwIfDisposed(),JO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.sinh=function(){return this.throwIfDisposed(),eP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.slice=function(t,e){return this.throwIfDisposed(),Kt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.softmax=function(t){return this.throwIfDisposed(),uT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.softplus=function(){return this.throwIfDisposed(),xy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),sT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.split=function(t,e){return this.throwIfDisposed(),go(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.sqrt=function(){return this.throwIfDisposed(),$s(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.square=function(){return this.throwIfDisposed(),Fn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.squaredDifference=function(t){return this.throwIfDisposed(),rP(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.squeeze=function(t){return this.throwIfDisposed(),Nn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof _n?[this,t]:[this,...t];return xo(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.step=function(t){return this.throwIfDisposed(),wy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.stridedSlice=function(t,e,n,r,s,i,o,a){return this.throwIfDisposed(),ZK(this,t,e,n,r,s,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.sub=function(t){return this.throwIfDisposed(),xt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.sum=function(t,e){return this.throwIfDisposed(),Nt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.tan=function(){return this.throwIfDisposed(),QK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.tanh=function(){return this.throwIfDisposed(),Np(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.tile=function(t){return this.throwIfDisposed(),Ca(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.toBool=function(){return this.throwIfDisposed(),lt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.toFloat=function(){return this.throwIfDisposed(),lt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.toInt=function(){return this.throwIfDisposed(),lt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.topk=function(t,e){return this.throwIfDisposed(),tq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.transpose=function(t){return this.throwIfDisposed(),yn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.unique=function(t){return this.throwIfDisposed(),nq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),oP(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.unstack=function(t){return this.throwIfDisposed(),Da(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.where=function(t,e){return this.throwIfDisposed(),js(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ze().prototype.zerosLike=function(){return this.throwIfDisposed(),xn(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ou extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ou.prototype)}}class Ia extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ia.prototype)}}class Pe extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Pe.prototype)}}class sn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,sn.prototype)}}class MP extends Error{constructor(e){super(e),Object.setPrototypeOf(this,MP.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QZ{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ap(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function au(t,e){if(!t)throw new MP(e)}function cj(t,e){let n=0;for(const r of t)r===e&&n++;return n}function Pi(t){return t.length===1?t[0]:t}function $n(t){return Array.isArray(t)?t:[t]}function dc(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Uf(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let ca={};function DP(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function JR(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>JR(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:JR(r))}}}function tv(t,e={},n={},r="object",s=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in ca)o=ca[i];else if(o=e[i],o==null)throw new Pe(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new Pe(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in ca?[a,l]=ca.className:o in e&&([a,l]=e[o]),a==null)throw new Pe(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const f of Object.keys(ca))u[f]=ca[f];for(const f of Object.keys(n))u[f]=n[f];const c=i.config;c.customObjects=u;const d=Object.assign({},ca);for(const f of Object.keys(n))ca[f]=n[f];JR(i.config);const h=l(a,i.config,n,s);return ca=Object.assign({},d),h}else{const u=Object.assign({},ca);for(const d of Object.keys(n))ca[d]=n[d];const c=new a(i.config);return ca=Object.assign({},u),c}}}function YBe(t,e){return t<e?-1:t>e?1:0}function nS(t,e){return-1*YBe(t,e)}function nh(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function KBe(t){if(t==null)throw new Pe(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Xp(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new Pe(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function OP(t,e,n=0,r=1/0){return au(n>=0),au(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(s=>typeof s===e)}function ys(t,e){Array.isArray(t)?(ae(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>ys(n,`element ${r+1} of ${e}`))):ae(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${JZ(t)}.`)}function JZ(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>JZ(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function qBe(t,e,n){let r=n!=null?n():Oi(),s;return(...o)=>{const a=n!=null?n():Oi();return a-r<e||(r=a,s=t(...o)),s}}function eQ(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let XBe=0;function tQ(){return XBe++}const rS={};function GT(t=""){return t in rS||(rS[t]=0),rS[t]+=1,t+rS[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ZBe=["channelsFirst","channelsLast"],QBe=["nearest","bilinear"],JBe=["valid","same","causal"],e5e=["max","avg"],t5e=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Zm=new Map;function Mr(t){Xp(ZBe,"DataFormat",t)}function n5e(t){Xp(QBe,"InterpolationFormat",t)}function Qo(t){Xp(JBe,"PaddingMode",t)}function nQ(t){Xp(e5e,"PoolMode",t)}const $w=[],dj="/";function sp(t,e){$w.push(t);try{const n=e();return $w.pop(),n}catch(n){throw $w.pop(),n}}function r5e(){return $w.length===0?"":$w.join(dj)+dj}function rQ(t){if(!iQ(t))throw new Error("Not a valid tensor name: '"+t+"'");return r5e()+t}function sQ(t){if(!iQ(t))throw new Error("Not a valid tensor name: '"+t+"'");Zm.has(t)||Zm.set(t,0);const e=Zm.get(t);if(Zm.set(t,Zm.get(t)+1),e>0){const n=`${t}_${e}`;return Zm.set(n,1),n}else return t}const s5e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function iQ(t){return!!t.match(s5e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function i5e(t){return t===parseInt(t.toString(),10)}function rh(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function t0(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function wh(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function El(t,e){if(e<t)throw new Pe(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let U3;function Jr(){return U3==null&&(U3=bp().epsilon()),U3}function _l(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bu(t,e){return lt(t,e)}function nv(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),Me(t,n)}function o5e(t,e){return Ve(()=>{if(t.shape.length!==2)throw new Pe(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=nv(t,1);return eM(n,[1,e,1])})}function a5e(t){const e=[rh(t.shape)];return Me(t,e)}function l5e(t){if(t.rank<=1)throw new Pe(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],rh(t.shape,1)];return Me(t,e)}function ip(t,e,n){return Ve(()=>{switch(t.rank){case 1:return aT(t,e,n);case 2:return tP(t,[e,0],[n,t.shape[1]]);case 3:return lT(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return o1(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Kt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Kt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Pe(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function V3(t,e,n){return Ve(()=>{switch(t.rank){case 1:return aT(t,e,n);case 2:return tP(t,[0,e],[t.shape[0],n]);case 3:return lT(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return o1(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new Pe(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function sS(t,e,n,r){return Ve(()=>{switch(t.rank){case 1:return aT(t,e,n);case 2:switch(r){case 1:return ip(t,e,n);case 2:return V3(t,e,n);default:throw new Pe(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return ip(t,e,n);case 2:return lT(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return V3(t,e,n);default:throw new Pe(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return ip(t,e,n);case 2:return o1(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return o1(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return V3(t,e,n);default:throw new Pe(`The axis is not within the rank of the tensor ${r}`)}default:throw new Pe(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function PP(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),pr(t,e)}function hj(t,e){switch(t.rank){case 1:return IK([t,e]);case 2:return NK([t,e],0);case 3:return kK([t,e],0);case 4:return TK([t,e],0);default:throw new Pe(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function eM(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new Pe(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Ca(t,e)}function HT(t,e=0,n=1,r,s){return YO(t,e,n,r,s)}function vu(t,e,n,r){if(t.rank<2||e.rank<2)throw new sn(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new sn(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return $R({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?tM(t.rank,r,_l()):null,activation:n});{const s=t.shape.slice(),i=s.pop();t=Me(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),u=[...o,a],c=Array.from({length:e.rank},(m,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=Me(yn(e,c),[l,-1]);const d=[...s,...u];return Me($R({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?tM(t.rank,r,_l()):null,activation:n}),d)}}function oQ(t,e,n){return Ve(()=>(Array.isArray(e)?e=Br(e,"int32"):e=lt(e,"int32"),Xb(t,e,n)))}function rv(t){return _e(t,t)}function tM(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new Pe(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?Me(e,[1,r[0],1,1,1]):Me(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?Me(e,[1,1,1,1,r[0]]):Me(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?Me(e,[1,r[0],1,1]):Me(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?Me(e,[1,1,1,r[0]]):Me(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?Me(e,[1,r[0],1]):Me(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?Me(e,[1,1,r[0]]):Me(e,[1].concat(r))}else if(t<3)return e;throw new Pe(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ol(t,e,n){return Ve(()=>(n==null&&(n=_l()),Mr(n),Qe(t,tM(t.rank,e,n))))}function u5e(t,e=1){if(e!==1)throw new sn(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Yb(t)}function c5e(t){return Ve(()=>yt(t,Qe(Zr(t),1)))}function aQ(t,e,n,r){return Ve(()=>iq(t,e,n,r))}function d5e(t){return Ve(()=>{const e=Qe(.5,_e(.2,t));return Vi(e,0,1)})}function sv(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const h5e=["fanIn","fanOut","fanAvg"],f5e=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function p5e(t){Xp(h5e,"FanMode",t)}function m5e(t){Xp(f5e,"Distribution",t)}class Ua extends vy{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class lQ extends Ua{apply(e,n){return _r(e,n)}}lQ.className="Zeros";et(lQ);class FP extends Ua{apply(e,n){return mo(e,n)}}FP.className="Ones";et(FP);class uQ extends Ua{constructor(e){if(super(),typeof e!="object")throw new Pe(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new Pe(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return Ve(()=>_e(Mt(this.value),mo(e,n)))}getConfig(){return{value:this.value}}}uQ.className="Constant";et(uQ);class cQ extends Ua{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return jp(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}cQ.className="RandomUniform";et(cQ);class dQ extends Ua{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new sn(`randomNormal does not support dType ${n}.`);return HT(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}dQ.className="RandomNormal";et(dQ);class hQ extends Ua{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new sn(`truncatedNormal does not support dType ${n}.`);return iP(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}hQ.className="TruncatedNormal";et(hQ);class fQ extends Ua{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return Ve(()=>{if(e.length!==2||e[0]!==e[1])throw new Pe("Identity matrix initializer can only be used for 2D square matrices.");return _e(this.gain,BO(e[0]))})}getConfig(){return{gain:this.gain}}}fQ.className="Identity";et(fQ);function g5e(t,e="channelsLast"){let n,r;if(Mr(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const s=rh(t,2);n=t[1]*s,r=t[0]*s}else if(e==="channelsLast"){const s=rh(t,0,t.length-2);n=t[t.length-2]*s,r=t[t.length-1]*s}}else{const s=rh(t);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}class bo extends Ua{constructor(e){if(super(),e.scale<0)throw new Pe(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,p5e(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,m5e(this.distribution),this.seed=e.seed}apply(e,n){const r=g5e(e),s=r[0],i=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,s):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(s+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new sn(`${this.getClassName()} does not support dType ${n}.`);return iP(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return jp(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}bo.className="VarianceScaling";et(bo);class LP extends bo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bo.className}}LP.className="GlorotUniform";et(LP);class zP extends bo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bo.className}}zP.className="GlorotNormal";et(zP);class BP extends bo{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bo.className}}BP.className="HeNormal";et(BP);class UP extends bo{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bo.className}}UP.className="HeUniform";et(UP);class VP extends bo{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bo.className}}VP.className="LeCunNormal";et(VP);class jP extends bo{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bo.className}}jP.className="LeCunUniform";et(jP);class pQ extends Ua{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return Ve(()=>{if(e.length<2)throw new sn("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=Ue(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(s,r),Math.min(s,r)],a=HT(o,0,1,n,this.seed),l=pq.qr(a,!1);let u=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return u=_e(u,d.sign()),r<s&&(u=u.transpose()),_e(Mt(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}pQ.className="Orthogonal";et(pQ);const fj={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function pj(t,e={}){return tv(t,ba.getMap().classNameMap,e,"initializer")}function fr(t){return DP(t)}function or(t){if(typeof t=="string"){const e=t in fj?fj[t]:t;if(e==="GlorotNormal")return new zP;if(e==="GlorotUniform")return new LP;if(e==="HeNormal")return new BP;if(e==="HeUniform")return new UP;if(e==="LeCunNormal")return new VP;if(e==="LeCunUniform")return new jP;{const n={};return n.className=e,n.config={},pj(n)}}else return t instanceof Ua?t:pj(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nM(t){return Array.isArray(t)&&Array.isArray(t[0])}function BI(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function qt(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new Pe(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Sn(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new Pe(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UI(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mj="Variable";class y5e{constructor(e,n="float32",r=mj,s=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=tQ(),r=r??mj,this.originalName=rQ(r),this.name=sQ(this.originalName),this.trainable_=s,this.constraint=i,this.val=rq(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),x5e(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function x5e(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function rM(t){return t.map(e=>e.read())}function WP(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class es{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Au{constructor(e,n,r,s,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=a,this.id=tQ(),o!=null&&(this.originalName=rQ(o),this.name=sQ(this.originalName)),this.rank=n.length}}let w5e=0,YT=class{constructor(e,n){this.callArgs=n,this.id=w5e++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},b5e=0;class un extends vy{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=b5e++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=dc(r)+"_"+GT(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Ia(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new Pe(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Pi(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Pi(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ou(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ou(`Layer ${this.name} is not connected, no input to return.`);return Pi(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ou(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ou(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Pi(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=$n(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=$n(this.inputSpec);if(n.length!==r.length)throw new Pe(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let s=0;s<n.length;s++){const i=n[s],o=r[s];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new Pe(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new Pe(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new Pe(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new Pe(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const u in o.axes){const c=Number(u),d=o.axes[u],h=c>=0?l[c]:l[l.length+c];if(d!=null&&[d,null].indexOf(h)===-1)throw new Pe(`Input ${s} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${d} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const u=o.shape[l],c=i.shape[l];if(u!=null&&c!=null&&u!==c)throw new Pe(`Input ${s} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=$n(e),s=C5e(e),i=I5e(e);if(s===i)throw new Pe("Arguments to apply() must be all SymbolicTensors or all Tensors");return sp(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of $n(e))o.push(a.shape);this.build(Pi(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=$n(o),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(o=Pi(l),this.activityRegularizer!=null)throw new sn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=v5e(e),a=this.computeOutputShape(o);let l;const u=S5e(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,d)=>new Au(u,c,this,$n(e),n,this.name,d)):l=new Au(u,a,this,$n(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new sn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ou(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ou(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Ia(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return UI(this.weights)}build(e){this.built=!0}getWeights(e=!1){return rM(e?this.trainableWeights:this.weights)}setWeights(e){Ve(()=>{const n=this.weights;if(n.length!==e.length)throw new Pe(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],s=rM(n);for(let i=0;i<s.length;++i){const o=s[i],a=n[i],l=e[i];if(!nn(o.shape,l.shape))throw new Pe(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}WP(r)})}addWeight(e,n,r,s,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new Pe(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():or("zeros"));const u=s.apply(n,r),c=new y5e(u,r,e,o,a);return u.dispose(),i!=null&&this.addLoss(()=>i.apply(c.read())),o==null&&(o=!0),o?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=$n(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,r){if(!this.supportsMasking)return;const s=this.computeMask(e,r),i=$n(n),o=$n(s);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,r,s,i,o,a=null){const l=$n(e);n=$n(n),r=$n(r),s=$n(s),i=BI(i),o=BI(o);const u=[],c=[],d=[];for(const h of l)u.push(h.sourceLayer),c.push(h.nodeIndex),d.push(h.tensorIndex);new YT({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function v5e(t){t=$n(t);const e=[];for(const n of t)e.push(n.shape);return Pi(e)}function S5e(t){return"float32"}function mQ(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const o=r.inputTensors[i],a=r.inboundLayers[i],l=r.nodeIndices[i],u=mQ(o,a,l);for(const c of u)s.indexOf(c)===-1&&s.push(c)}return s}}}function C5e(t){let e=!0;for(const n of $n(t))if(!(n instanceof Au)){e=!1;break}return e}function I5e(t){let e=!0;for(const n of $n(t))if(n instanceof Au){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class iv extends un{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:GT("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Pe("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new Pe("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Pe("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const s=new Au(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new YT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new Pe(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}iv.className="InputLayer";et(iv);function N5e(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new Pe("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new iv({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function k5e(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return lt(e,t.dtype)}catch{throw new Pe(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Kd{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Kd)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=k5e(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new Pe(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Au){if(this.id2Value[e.id]==null)throw new Pe(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new Pe(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Au){if(this.id2Value[e.id]==null)throw new Pe(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new Pe(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Bt(this.id2Mask)}}const VI=new QZ,jI=new QZ;function T5e(t){VI!=null&&VI.setMaxEntries(t),jI!=null&&jI.setMaxEntries(t)}function aw(t,e,n,r){const s=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(m=>m.name),l=[],u=e.names();for(const m of a)u.indexOf(m)!==-1?l.push(e.getValue(m)):l.push(null);const c=a.join(",")+"|"+e.names().sort().join(",");let d=VI.get(c),h;if(d==null){const m=E5e(o,e);d=m.sorted,h=m.recipientCounts,VI.put(c,d),jI.put(c,h)}h={},s||Object.assign(h,jI.get(c));const f=new Kd(e);for(let m=0;m<d.length;++m){const g=d[m],x=g.sourceLayer;if(x instanceof iv)continue;const w=[],b=[],S=[];let C=!1;for(const E of g.inputs){const M=f.getValue(E),O=f.getMask(E);w.push(M),b.push(O),O!=null&&(C=!0),s||(h[E.name]--,h[E.name]===0&&!e.hasKey(E)&&a.indexOf(E.name)===-1&&!M.isDisposed&&E.sourceLayer.stateful!==!0&&S.push(M))}C&&(n=n||{},n.mask=b[0]);const T=$n(x.apply(w,n));let D=null;x.supportsMasking&&(D=x.computeMask(w,b));const P=A5e(g),I=Array.isArray(P)?P:[P];for(let E=0;E<I.length;++E){f.hasKey(I[E])||f.add(I[E],T[E],Array.isArray(D)?D[0]:D);const M=a.indexOf(I[E].name);M!==-1&&(l[M]=T[E])}s||Bt(S)}return f.disposeMasks(),i?l:l[0]}function E5e(t,e){ae(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const s=gj(t[0],e);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of t){const{sorted:o,recipientMap:a}=gj(i,e);for(const l of o)s.has(l.name)||(n.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:_5e(r)}}function _5e(t){const e={};for(const n in t)e[n]=t[n].size;return e}function gj(t,e){const n=new Set,r=[],s={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),r.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const u of a.inputs)s[u.name]==null&&(s[u.name]=new Set),s[u.name].add(a.name),!n.has(u.name)&&i.push(u)}}return{sorted:r,recipientMap:s}}function A5e(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const s of t.sourceLayer.inboundNodes[r].outputTensors)if(s.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $5e=We();$5e.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,T5e);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GP(t,e){return Ve(()=>$s(Nt(_e(t,t),e,!0)))}class ov extends vy{getConfig(){return{}}}class gQ extends ov{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ve(()=>{const n=GP(e,this.axis),r=Vi(n,0,this.maxValue);return _e(e,yt(r,Qe(Jr(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}gQ.className="MaxNorm";et(gQ);class yQ extends ov{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ve(()=>yt(e,Qe(Jr(),GP(e,this.axis))))}getConfig(){return{axis:this.axis}}}yQ.className="UnitNorm";et(yQ);class xQ extends ov{apply(e){return Ou(e)}}xQ.className="NonNeg";et(xQ);class wQ extends ov{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ve(()=>{const n=GP(e,this.axis),r=Qe(_e(this.rate,Vi(n,this.minValue,this.maxValue)),_e(1-this.rate,n));return _e(e,yt(r,Qe(Jr(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}wQ.className="MinMaxNorm";et(wQ);const yj={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function rs(t){return DP(t)}function xj(t,e={}){return tv(t,ba.getMap().classNameMap,e,"constraint")}function ss(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in yj?yj[t]:t,config:{}};return xj(n)}else return t instanceof ov?t:xj(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function xf(t){if(t==null)return;const e=[],n=[],r=[];for(const s in t){const i=t[s];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(s),r.push(o)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)t[n[i]]=s[i][0];Bt(r)}}function bQ(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var wj;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(wj||(wj={}));const R5e=125;class d1{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class M5e{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class D5e extends d1{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const s in n){const i=n[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let o;s in this.totals?o=this.totals[s]:this.totals[s]=0;const a=Ve(()=>Qe(this.totals[s],_e(i,r)));this.totals[s]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:Ve(()=>{const s=_e(yt(1,this.seen),this.totals[r]);n[r]=s,this.totals[r].dispose(),gs(n[r])}))}}class O5e extends d1{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),r.push(a)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[n[i]][r[i]].dispose(),this.history[n[i]][r[i]]=s[i][0]}}class P5e extends d1{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||Pq,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=R5e),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");mR(this.yieldEvery)&&(this.maybeWait=qBe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const s=[];this.yield!=null&&(await xf(r),s.push(this.yield(e,n,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await xf(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await xf(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await xf(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await xf(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):mR(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await xf(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await xf(e),await this.trainEnd(e))}}function vQ(t,e){return t==null&&(t={}),t instanceof d1?[t]:Array.isArray(t)&&t[0]instanceof d1?t:$n(t).map(r=>new P5e(r,e))}class ga{constructor(){}static registerCallbackConstructor(e,n){ae(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),ga.checkForDuplicate(n),ga.constructors[e]==null&&(ga.constructors[e]=[]),ga.constructors[e].push(n)}static checkForDuplicate(e){for(const n in ga.constructors)ga.constructors[+n].forEach(s=>{if(s===e)throw new Pe("Duplicate callback constructor.")})}static clear(){ga.constructors={}}static createCallbacks(e){const n=[];for(const r in ga.constructors){const s=+r;e>=s&&n.push(...ga.constructors[s])}return n.map(r=>new r)}}ga.constructors={};function SQ(t,e,n,r,s,i,o,a,l){const u=new O5e,c=[new D5e,...ga.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const d=new M5e(c);return d.setParams({epochs:n,initialEpoch:r,samples:s,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kc(t,e={},n=!1){return tv(t,ba.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WI(t,e){return Ve(()=>{t.dtype!=="float32"&&(t=lt(t,"float32"));const n=Nt(rv(t),e,!0),r=yy(n.shape,Jr()),s=$s(Pc(n,r));return yt(t,s)})}function KT(t,e){return Ve(()=>wr(rv(xt(e,t)),-1))}function HP(t,e){return Ve(()=>wr(Zr(xt(e,t)),-1))}function YP(t,e){return Ve(()=>{const n=xt(t,e),r=Vi(Zr(t),Jr(),Number.MAX_VALUE),s=Zr(yt(n,r));return _e(100,wr(s,-1))})}function F5e(t,e){return Ve(()=>{const n=Vi(e,Jr(),Number.MAX_VALUE),r=Yo(Qe(1,n)),s=Vi(t,Jr(),Number.MAX_VALUE),i=Yo(Qe(1,s));return wr(rv(xt(r,i)),-1)})}function L5e(t,e){return Ve(()=>{const n=Pc(0,xt(1,_e(t,e)));return wr(rv(n),-1)})}function z5e(t,e){return Ve(()=>{const n=Pc(0,xt(1,_e(t,e)));return wr(n,-1)})}function B5e(t,e){return Ve(()=>{const n=Nt(_e(t,e),-1),r=Aa(_e(xt(1,t),e),-1);return Pc(0,Qe(1,xt(r,n)))})}function U5e(t,e){return Ve(()=>{const n=Math.log(2),r=xt(e,t),s=xt(Qe(r,xy(_e(-2,r))),n);return wr(s,-1)})}function h1(t,e,n=!1){return Ve(()=>{if(n)e=uT(e);else{const r=Nt(e,e.shape.length-1,!0);e=yt(e,r)}return e=Vi(e,Jr(),1-Jr()),tr(Nt(_e(lt(t,"float32"),Yo(e)),e.shape.length-1))})}function GI(t,e,n=!1){return Ve(()=>{const r=lt(qb(a5e(t)),"int32");e=Vi(e,Jr(),1-Jr());const s=e.shape,i=Me(GO(r,s[s.length-1]),s);return h1(i,e,n)})}function V5e(t,e){if(!nn(t.shape,e.shape))throw new Pe(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Ve(()=>{const n=Ou(e),r=tr(Zr(e));return Qe(xt(n,_e(e,t)),Jk(wi(r)))})}function qT(t,e){return Ve(()=>{let n;return n=Vi(e,Jr(),1-Jr()),n=Yo(yt(n,xt(1,n))),wr(V5e(t,n),-1)})}function j5e(t,e){return Ve(()=>{const n=Vi(t,Jr(),1),r=Vi(e,Jr(),1);return Nt(_e(t,Yo(yt(n,r))),-1)})}function W5e(t,e){return Ve(()=>{const n=Yo(Qe(Jr(),e));return wr(xt(e,_e(t,n)),-1)})}function CQ(t,e){return Ve(()=>{const n=WI(t,-1),r=WI(e,-1),s=_e(n,r);return tr(Nt(s,-1))})}const HI={meanSquaredError:KT,meanAbsoluteError:HP,meanAbsolutePercentageError:YP,meanSquaredLogarithmicError:F5e,squaredHinge:L5e,hinge:z5e,categoricalHinge:B5e,logcosh:U5e,categoricalCrossentropy:h1,sparseCategoricalCrossentropy:GI,binaryCrossentropy:qT,kullbackLeiblerDivergence:j5e,poisson:W5e,cosineProximity:CQ};function j3(t){if(typeof t=="string"){if(t in HI)return HI[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Pe(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function IQ(t,e){return Ve(()=>{const n=_e(.5,Ko(e)),r=bu(Io(e,n),t.dtype);return wr(Il(t,r),-1)})}function NQ(t,e){return Ve(()=>bu(Il(Cp(t,-1),Cp(e,-1)),"float32"))}function G5e(t,e){return Ve(()=>lt(Nt(ku(Il(t,1),Il(e,1))),"float32"))}function H5e(t,e){return Ve(()=>lt(Nt(ku(Il(t,0),Il(e,1))),"float32"))}function Y5e(t,e){return Ve(()=>{const n=G5e(t,e),r=H5e(t,e),s=Qe(n,r);return lt(js(Io(s,0),yt(n,s),0),"float32")})}function K5e(t,e){return qT(t,e)}function q5e(t,e){return t.rank===e.rank&&(t=Nn(t,[t.rank-1])),e=Cp(e,-1),e.dtype!==t.dtype&&(e=lt(e,t.dtype)),lt(Il(t,e),"float32")}const X5e=KT,Z5e=KT,Q5e=HP,J5e=HP,eUe=YP,tUe=YP,kQ=h1,nUe=CQ,TQ=GI,YI={binaryAccuracy:IQ,categoricalAccuracy:NQ,precision:Y5e,categoricalCrossentropy:kQ,sparseCategoricalCrossentropy:TQ,mse:X5e,MSE:Z5e,mae:Q5e,MAE:J5e,mape:eUe,MAPE:tUe,cosine:nUe};function rUe(t){if(typeof t=="string"&&t in YI)return YI[t];if(typeof t!="string"&&t!=null)return t;throw new Pe(`Unknown metric ${t}`)}function iS(t){if(au(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(HI))if(HI[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(YI))if(YI[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sUe(t){const e={Adagrad:()=>Ym.adagrad(.01),Adadelta:()=>Ym.adadelta(1,.95,Jr()),Adam:()=>Ym.adam(.001,.9,.999,Jr()),Adamax:()=>Ym.adamax(.002,.9,.999,Jr(),0),RMSProp:()=>Ym.rmsprop(.001,.9,0,Jr()),SGD:()=>Ym.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new Pe(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const bj=1*1024*1024;function vj(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!sM(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>bj&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${bj}.`)}}function sM(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!sM(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!sM(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function iUe(t,e,n,r=console.log){const s=aUe(t),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let o;if(!s){i.push("Receives inputs"),o=[];for(const c in t.nodesByDepth)o.push(...t.nodesByDepth[c])}r("_".repeat(e)),KI(i,n,r),r("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)s?lUe(a[c],n,r):uUe(a[c],n,o,r),r((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=oUe(t),u=UI(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function oUe(t){let e;return t.collectedTrainableWeights!=null?e=UI(t.collectedTrainableWeights):e=UI(t.trainableWeights),e}function aUe(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let i=!1;for(const o of s.inboundNodes)if(r.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function KI(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function lUe(t,e,n){let r,s;try{s=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,s,r,t.countParams().toString()];KI(a,e,n)}function uUe(t,e,n,r){let s,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,m=d.nodeIndices[h],g=d.tensorIndices[h];o.push(`${f}[${m}][${g}]`)}const a=t.name,l=t.getClassName(),u=o.length===0?"":o[0],c=[`${a} (${l})`,i,s,t.countParams().toString(),u];KI(c,e,r);for(let d=1;d<o.length;++d)KI(["","","","",o[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function EQ(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function iM(t,e){if(t===null)return null;if(typeof t=="string")return Uf(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];EQ(e,s,i)?n.push(i):n.push(iM(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r];if(r==="name"&&typeof s=="string")n[r]=s;else{const i=Uf(r);n[i]=iM(s,i)}}return n}}function oM(t,e){if(t==null)return null;if(typeof t=="string")return dc(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];EQ(e,s,i)?n.push(i):n.push(oM(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r],i=dc(r);(r==="name"||r==="className")&&typeof s=="string"?n[i]=s:n[i]=oM(s,r)}return n}}/** @license See the LICENSE file. */const _Q="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cUe=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class al extends un{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=GT(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],nh(this.inputs).length!==this.inputs.length)throw new Pe(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);nh(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const S=b.sourceLayer,C=b.nodeIndex,T=b.tensorIndex;this.outputLayers.push(S),this.outputLayersNodeIndices.push(C),this.outputLayersTensorIndices.push(T)}for(const b of this.inputs){const S=b.sourceLayer,C=b.nodeIndex,T=b.tensorIndex;au(C===0,"input layer has >1 nodes"),au(T===0,"input layer has >1 tensors"),this.inputLayers.push(S),this.inputLayersNodeIndices.push(C),this.inputLayersTensorIndices.push(T)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const S=this.inputLayers[b];if(!(S instanceof iv))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${S.getClassName()}.`);this.inputNames.push(S.name),this.feedInputShapes.push(S.batchInputShape),this.feedInputNames.push(S.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},r={},s={},i={},o={},a=[],l=(b,S,C,T,D,P)=>{(T==null||D==null||P==null)&&(T=b.sourceLayer,D=b.nodeIndex,P=b.tensorIndex);const I=T.inboundNodes[D];if(C.indexOf(I)!==-1)throw new Ia(`The tensor ${b.name} at layer "${T.name}" is part of a cycle.`);if(S.indexOf(I)!==-1)return;this.containerNodes.add(al.nodeKey(T,D)),T.id in o||(o[T.id]=Object.keys(o).length),C.indexOf(I)===-1&&C.push(I);const E=I.inboundLayers.length;for(let M=0;M<E;M++){const O=I.inputTensors[M],j=I.inboundLayers[M],R=I.nodeIndices[M],z=I.tensorIndices[M];l(O,S,C,j,R,z)}for(S.push(I);C.indexOf(I)>=0;)C.splice(C.indexOf(I),1);a.push(I)},u=[],c=[];for(const b of this.outputs)l(b,u,c);const d=a.slice().reverse();for(const b of d){r[b.id]=b,b.id in n||(n[b.id]=0);let S=n[b.id];const C=s[b.outboundLayer.id]==null?0:s[b.outboundLayer.id];S=Math.max(S,C),s[b.outboundLayer.id]=S,i[b.outboundLayer.id]=b.outboundLayer,n[b.id]=S;for(let T=0;T<b.inboundLayers.length;T++){const D=b.inboundLayers[T],P=b.nodeIndices[T],I=D.inboundNodes[P],E=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(S+1,E),r[I.id]=I}}const h={};for(const b in n){const S=n[b];S in h||(h[S]=[]),h[S].push(r[b])}const f={};for(const b in s){const S=s[b];S in f||(f[S]=[]),f[S].push(i[b])}let m=Object.keys(f).map(b=>parseInt(b,10)).sort(nS);this.layers=[];for(const b of m){const S=f[b];S.sort((C,T)=>{const D=o[C.id],P=o[T.id];return D<P?-1:D>P?1:0});for(const C of S)C instanceof al&&this.internalContainerRefs.push(C),this.layers.push(C)}this.layersByDepth=f,m=Object.keys(h).map(b=>parseInt(b,10)).sort(nS);const g=this.inputs.slice(),x=[];for(const b of m)for(const S of h[b]){const C=S.outboundLayer;if(C!=null){for(const T of S.inputTensors)if(g.indexOf(T)===-1)throw new Ia(`Graph disconnected: cannot obtain value for tensor ${T} at layer "${C.name}". The following previous layers were accessed without issue: ${x}`);for(const T of S.outputTensors)g.push(T);x.push(C.name)}}this.nodesByDepth=h;const w=this.layers.map(b=>b.name);for(const b of w){const S=w.filter(C=>C===b).length;if(S!==1)throw new Ia(`The name "${b}" is used ${S} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new YT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Pe("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let s=0;const i=cUe(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const c=i?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(r[c]!=null)throw new Pe(`Duplicate weight name: ${c}`);r[c]=u,s++}const o=[];for(const a in e){let l=a;if(r[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(r[l]!=null)o.push([r[l],e[a]]);else if(n)throw new Pe(`Provided weight data has no target variable: ${a}`);delete r[l]}if(n){const a=[];for(const l in r)a.push(l);if(a.length>0)throw new Pe(`${a.length} of ${s} weights are not set: ${a}`)}WP(o)}parseWeights(e){for(const n in Object.keys(e)){const r=n.split("/"),s=["vars","layer_checkpoint_dependencies"],i=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!s.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${_Q}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=oM(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return Ve(()=>{e=$n(e);const r=new Kd;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return aw(this.outputs,r,n)})}computeMask(e,n){return Ve(()=>{e=$n(e);let r;return n==null?r=Ap(null,e.length):r=$n(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=BI(e);if(n.length!==this.inputLayers.length)throw new Pe(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";r[c]=u}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(nS);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(c.id)!==-1)continue;const d=[];for(let g=0;g<u.inboundLayers.length;g++){const x=u.inboundLayers[g],w=u.nodeIndices[g],b=u.tensorIndices[g],S=`${x.name}_${w}_${b}`,C=r[S];d.push(C)}const h=c.computeOutputShape(Pi(d)),f=BI(h),m=c.inboundNodes.indexOf(u);for(let g=0;g<f.length;g++){const x=`${c.name}_${m}_${g}`;r[x]=f[g]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],d=`${l.name}_${u}_${c}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];au(l in r),i.push(r[l])}return Pi(i)}runInternalGraph(e,n){n==null&&(n=Ap(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],d=n[l];r[u.id]=[c,d]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(nS);for(const l of s){const u=this.nodesByDepth[l];for(const c of u){const d=c.outboundLayer,h=c.inputTensors,f=c.outputTensors,m=new Array;for(const g of h)g.id in r&&m.push(r[g.id]);if(m.length===h.length){let g={},x,w,b,S;if(c.callArgs!=null&&(g=c.callArgs),m.length===1){const[C,T]=m[0];g.mask==null&&(g.mask=T),b=$n(d.call(C,g)),S=$n(d.computeMask(C,T)),x=[C],w=[T]}else x=m.map(C=>C[0]),w=m.map(C=>C[1]),g.mask==null&&(g.mask=w),b=$n(d.call(x,g)),S=$n(d.computeMask(x,w));if(d.activityRegularizer)throw new sn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let C=0;C<f.length;++C){const T=f[C],D=b[C],P=S[C];r[T.id]=[D,P]}}}}const i=[],o=[],a=[];for(const l of this.outputs){au(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];a.push(u.shape),i.push(u),o.push(c)}return[i,o,a]}buildNodeConversionMap(e){const n={};let r;for(const s of this.layers){r=s instanceof al?1:0;for(let i=0;i<s.inboundNodes.length;i++){const o=al.nodeKey(s,i);this.containerNodes.has(o)&&(n[o]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new Pe("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new Pe(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new Pe(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return Ve(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const s=al.nodeKey(n,r);this.containerNodes.has(s)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),u=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],f=al.nodeKey(o,d);let m={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),m=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(h.inboundLayers.length>0){const g=[];for(let x=0;x<h.inboundLayers.length;x++){const w=h.inboundLayers[x],b=h.nodeIndices[x],S=h.tensorIndices[x],C=al.nodeKey(w,b);let T=n[C];T==null&&(T=0),g.push([w.name,T,S,m])}u.push(g)}}}const c={};c.name=o.name,c.className=a,c.config=l,c.inboundNodes=u,r.push(c)}e.layers=r;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],u=al.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.inputLayersTensorIndices[o];s.push([a.name,c,d])}e.inputLayers=s;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],u=al.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,c,d])}return e.outputLayers=i,e}static fromConfig(e,n,r={},s=!1){const i={},o={};function a(x,w){x.name in o?o[x.name].push(w):o[x.name]=[w]}function l(x,w){const b=[];let S;for(const C of w){const T=C[0],D=C[1],P=C[2];if(S=C[3]==null?{}:C[3],!(T in i)){a(x,w);return}const I=i[T];if(I.inboundNodes.length<=D){a(x,w);return}const E=I.inboundNodes[D];b.push(E.outputTensors[P])}b.length>0&&x.apply(Pi(b),S)}function u(x){const w=x.name,b=kc(x,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(s),i[w]=b,x.inboundNodes.forEach(C=>{if(!(C instanceof Array))throw new Pe(`Corrupted configuration, expected array for nodeData: ${C}`);a(b,C)})}const c=n.name,d=n.layers;for(const x of d)u(x);for(;!KBe(o);)for(const x of d){const w=i[x.name];if(w.name in o){const b=o[w.name];delete o[w.name];for(const S of b)l(w,S)}}const h=[],f=[],m=n.inputLayers;for(const x of m){const w=x[0],b=x[1],S=x[2];au(w in i);const T=i[w].inboundNodes[b].outputTensors;h.push(T[S])}const g=n.outputLayers;for(const x of g){const w=x[0],b=x[1],S=x[2];au(w in i);const T=i[w].inboundNodes[b].outputTensors;f.push(T[S])}return new e({inputs:h,outputs:f,name:c})}get stateful(){if(this._stateful)throw new Pe("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Ve(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dUe(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const s=[];return e.forEach(i=>{i in t?s.push(t[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function AQ(t,e){return dUe(t,e,"classWeight")}async function $Q(t,e,n,r){if(n!=null){const s=Ve(()=>{if(t.shape.length===1)return Ic(t);if(t.shape.length===2){if(t.shape[1]>1)return Cp(t,1);if(t.shape[1]===1)return Me(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());Bt(s);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),Br(o,"float32")}else return null}function hUe(t,e){return _e(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fUe=32;function RQ(t,e){let n,r;const s=e;n=s.xs,r=s.ys,ae(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=Sj("input",t.inputNames,n),o=Sj("output",t.outputNames,r),a=i[0].shape[0];ae(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),ae(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)ae(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)ae(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function Sj(t,e,n){if(n instanceof _n)return[n];if(Array.isArray(n))return ae(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(n[s]==null)throw new Pe(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function pUe(t){if(t.length===3)throw new sn("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function mUe(t,e,n){const r=n.batchesPerEpoch!=null;if(ae(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),ae(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),ae(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),ae(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),ae(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const s=n.validationData!=null;let i,o;if(s)if(Cj(n.validationData))ae(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const x=pUe(n.validationData);i=x.xs,o=x.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;s?u=l.slice().concat(l.map(x=>"val_"+x)):u=l.slice();const c=vQ(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=SQ(c,d,n.epochs,null,null,gUe(e,n),null,s,u);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let m=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;m<n.epochs;){const x={};await h.onEpochBegin(m);let w=0,b=0;for(r||(g=await e.iterator());!r||w<n.batchesPerEpoch;){const S=await g.next();if(r&&S.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(S.value!=null){const{xs:C,ys:T}=RQ(t,S.value),D={};D.batch=b,D.size=C[0].shape[0],await h.onBatchBegin(b,D);const P=[];if(n.classWeight!=null){const M=AQ(n.classWeight,t.outputNames);for(let O=0;O<M.length;++O)P.push(await $Q(T[O],null,M[O]))}const I=C.concat(T).concat(P),E=a(I);Bt(I);for(let M=0;M<l.length;++M){const O=l[M],j=E[M];D[O]=j,gs(j)}await h.onBatchEnd(b,D),bQ(D),b++,w++}if(r?w>=n.batchesPerEpoch:S.done){if(s){let C;Cj(n.validationData)?C=$n(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):C=$n(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?fUe:n.validationBatchSize,verbose:0}));for(let T=0;T<t.metricsNames.length;++T)x[`val_${t.metricsNames[T]}`]=C[T]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(m,x),m++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function gUe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function Cj(t){return typeof t.iterator=="function"}function yUe(t){return typeof t.next=="function"}async function xUe(t,e,n){n=n||{};const r=n.batches!=null,s=t.testFunction;let i=[];if(n.verbose>0)throw new sn("Verbose mode is not implemented yet.");ae(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=yUe(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const u=await o.next();if(i=Ve(()=>{if(u.value){const{xs:c,ys:d}=RQ(t,u.value),h=c.concat(d),f=Ve(()=>s(h));if(Bt(h),l===0)for(let g=0;g<f.length;++g)i.push(Mt(0));const m=h[0].shape[0];for(let g=0;g<f.length;++g){const x=f[g],w=i[g];i[g]=Ve(()=>Qe(i[g],_e(m,x))),l>0&&Bt(w)}Bt(f),a+=m,++l}return i}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){const c=i[u];i[u]=yt(i[u],a),Bt(c)}return Pi(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function W3(t){ae(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Rx(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>ip(r,e,n-e)):ip(t,e,n-e)}function aM(t,e){return Ve(()=>t==null?null:Array.isArray(t)?t.map(n=>aM(n,e)):oQ(t,e.dtype==="int32"?e:lt(e,"int32")))}function G3(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function MQ(t){const e=[];t instanceof _n&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(nv(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function el(t,e){if(t==null)return;const n=[];if(e instanceof _n)n.push(e.id);else if(Array.isArray(e))e.forEach(s=>n.push(s.id));else if(e!=null)for(const s in e){const i=e[s];n.push(i.id)}const r=[];if(t instanceof _n)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(s=>{n.indexOf(s.id)===-1&&r.push(s)});else if(t!=null)for(const s in t){const i=t[s];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wUe(t){return t instanceof _n}function lM(t){return Array.isArray(t)}function Ij(t){return!wUe(t)&&!lM(t)}function Nj(t,e,n,r=!0,s=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(lM(t)&&t.length>0)o=!0;else if(Ij(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new Pe(`Error when checking model ${s} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(Ij(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new Pe(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(lM(t)){if(t=t,t.length!==e.length)throw new Pe(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new Pe(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=MQ(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new Pe(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[o][l];if(c!=null&&c>=0&&u!==c)throw new Pe(`${s} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function bUe(t,e,n){const r=nh(t.map(i=>i.shape[0]));r.sort();const s=nh(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new Pe(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(s.length>1)throw new Pe(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!nn(r,s))throw new Pe(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function vUe(t,e,n){const r=[KT,qT,h1];for(let s=0;s<t.length;++s){const i=t[s],o=e[s],a=n[s];if(o!=null){if(o===h1&&i.shape[i.shape.length-1]===1)throw new Pe(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const l=i.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const d=l[c],h=u[c];if(h!=null&&d!==h)throw new Pe(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function kj(t,e,n,r=!0,s=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new Pe(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new Pe(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new Pe(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[o][l];if(c!=null&&c!==u)throw new Pe(`Error when checking ${s}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function SUe(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const s of e){let i=n.hasOwnProperty(s)?n[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const CUe="layers-model";class Og extends al{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new Pe("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");iUe(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=sUe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Oh))throw new Pe("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new Pe(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(j3(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Pe(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>j3(a))}else{const o=j3(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],sp("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const s=SUe(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};sp("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=s[o];(u=>{const c="";let d,h,f;for(const m of u){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){const x=this.internalOutputShapes[o];x[x.length-1]===1||this.lossFunctions[o]===qT?["accuracy","acc"].indexOf(m)!==-1?h=IQ:["crossentropy","ce"].indexOf(m)!==-1&&(h=K5e):this.lossFunctions[o]===GI?["accuracy","acc"].indexOf(m)!==-1?h=q5e:["crossentropy","ce"].indexOf(m)!==-1&&(h=TQ):["accuracy","acc"].indexOf(m)!==-1?h=NQ:["crossentropy","ce"].indexOf(m)!==-1&&(h=kQ);let w;["accuracy","acc"].indexOf(m)!==-1?w="acc":["crossentropy","ce"].indexOf(m)!==-1&&(w="ce"),f=h,d=c+w}else f=rUe(m),d=c+iS(m);let g;sp(d,()=>{g=f}),i(o,d,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const s=r.batchSize==null?32:r.batchSize;W3(s);const o=this.standardizeUserDataXY(e,n,!0,s);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,s,r.verbose,r.steps);return Pi(u)}finally{el(o[0],e),el(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),xUe(this,e,n)}checkNumSamples(e,n,r,s="steps"){let i;if(r!=null){if(i=null,n!=null)throw new Pe(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new Pe(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new Pe("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),s=r?n:[n],i=this.retrieveSymbolicTensors(s),o=new Kd;if(e instanceof _n&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Pe(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new Pe(`No value is provided for the model's input ${l.name}`);o.add(l,u)}const a=aw(i,o);return r?a:a[0]}retrieveSymbolicTensors(e){const n=Ap(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw n.forEach((i,o)=>{i==null&&s.push(e[o])}),new Pe(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return n}predictLoop(e,n=32,r=!1){return Ve(()=>{const s=this.checkNumSamples(e);if(r)throw new sn("Verbose predictLoop() is not implemented yet.");const i=G3(s,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)Ve(()=>{const u=i[a][0],c=i[a][1],d=Rx(e,u,c),h=[];if(Array.isArray(d))for(let m=0;m<d.length;++m)h.push({key:this.inputs[m],value:d[m]});else h.push({key:this.inputs[0],value:d});const f=new Kd(h);return aw(this.outputs,f)}).forEach((u,c)=>o[c].push(u));return Pi(o.map(a=>pr(a,0)))})}predict(e,n={}){const r=MQ(e);kj(r,this.inputNames,this.feedInputShapes,!1);try{const s=n.batchSize==null?32:n.batchSize;return W3(s),this.predictLoop(r,s)}finally{el(r,e)}}predictOnBatch(e){kj(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,s){if(this.optimizer_==null)throw new Ia("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===GI?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=Nj(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=Nj(n,this.feedOutputNames,i,!1,"target"),bUe(e,n),vUe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new Pe(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,s,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){const c=AQ(s,this.outputNames);u=[];for(let d=0;d<c.length;++d)u.push(await $Q(l[d],null,c[d]))}return[a,l,u]}testLoop(e,n,r,s=0,i){return Ve(()=>{const o=this.checkNumSamples(n,r,i,"steps"),a=[];if(s>0)throw new sn("Verbose mode is not implemented yet.");if(i!=null)throw new sn("steps mode in testLoop() is not implemented yet");{const l=G3(o,r),u=Br(El(0,o));for(let c=0;c<l.length;++c){const d=l[c][0],h=l[c][1],f=ip(u,d,h-d),m=aM(n,f),g=e(m);if(c===0)for(let x=0;x<g.length;++x)a.push(Mt(0));for(let x=0;x<g.length;++x){const w=g[x];a[x]=Qe(a[x],_e(h-d,w))}}for(let c=0;c<a.length;++c)a[c]=yt(a[c],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(cj(e,s)>1){const o=cj(e.slice(0,r),s);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:r[g]});const h=new Kd(d),f=aw(this.outputs,h,{training:!0});let m;for(let g=0;g<this.lossFunctions.length;++g){const x=this.lossFunctions[g];let w=x(s[g],f[g]);i[g]!=null&&(w=hUe(w,i[g]));const b=wr(w);n.push(b),g===0?m=w:m=Qe(m,w)}for(let g=0;g<this.metricsTensors.length;++g){let x;if(this.outputs.length>1&&g<this.outputs.length)x=n[g];else{const w=this.metricsTensors[g][0],b=this.metricsTensors[g][1];x=wr(w(s[b],f[b]))}gs(x),o.push(x)}return m=wr(m),this.calculateLosses().forEach(g=>{m=Qe(m,g)}),m},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>Ve(()=>{const n=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let u=0;u<this.inputs.length;++u)o.push({key:this.inputs[u],value:s[u]});const a=new Kd(o),l=aw(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],d=wr(c(i[u],l[u]));u===0?r=d:r=Qe(r,d),n.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],d=this.metricsTensors[u][1],h=wr(c(i[d],l[d]));n.push(h)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,o,a,l,u,c,d,h;try{const f=r.batchSize==null?32:r.batchSize;W3(f);const g=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,f);s=g[0],i=g[1],h=g[2];let x=!1,w;if(r.validationData!=null&&r.validationData.length>0){if(x=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new sn("validationData including sample weights is not supported yet."):new Pe(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const M=await this.standardizeUserData(l,u,null,null,!0,f);c=M[0],d=M[1],w=c.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){x=!0;const E=Math.floor(s[0].shape[0]*(1-r.validationSplit)),M=s[0].shape[0];c=Rx(s,E,M),o=s,s=Rx(s,0,E),d=Rx(i,E,M),a=i,i=Rx(i,0,E),w=c.concat(d)}else r.validationSteps!=null&&(x=!0);const b=s.concat(i).concat(h);this.checkTrainableWeightsConsistency();const S=this.makeTrainFunction(),C=this.getDedupedMetricsNames();let T,D;x?(this.makeTestFunction(),T=this.testFunction,D=C.slice().concat(C.map(E=>"val_"+E))):(T=null,w=[],D=C.slice());const P=vQ(r.callbacks,r.yieldEvery);return await this.fitLoop(S,b,C,f,r.epochs,r.verbose,P,T,w,r.shuffle,D,r.initialEpoch,null,null)}finally{this.isTraining=!1,el(s,e),el(i,n),el(o,e),el(a,n),el(c,l),el(d,u),h!=null&&Bt(h)}}async fitLoop(e,n,r,s,i,o,a,l,u,c,d,h,f,m){s==null&&(s=32),i==null&&(i=1),c==null&&(c=!0),h==null&&(h=0);let g=!1;if(l!=null&&u!=null&&(g=!0),m!=null&&(g=!0,f==null))throw new Pe("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(n,s,f,"steps_per_epoch");let w;x!=null&&(w=El(0,x)),o==null&&(o=1);const{callbackList:b,history:S}=SQ(a,o,i,h,x,f,s,g,d);b.setModel(this),this.history=S,await b.onTrainBegin(),this.stopTraining_=!1;for(let C=h;C<i;++C){await b.onEpochBegin(C);const T={};if(f!=null)throw new sn("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new sn("batch shuffling is not implemneted yet");c&&X1e(w);const D=Br(w),P=G3(x,s);for(let I=0;I<P.length;++I){const E={};if(await b.onBatchBegin(I,E),Ve(()=>{const M=P[I][0],O=P[I][1],j=ip(D,M,O-M);E.batch=I,E.size=O-M;const R=aM(n,j),z=e(R);for(let B=0;B<r.length;++B){const V=r[B],H=z[B];E[V]=H,gs(H)}if(I===P.length-1&&g){const B=this.testLoop(l,u,s);for(let V=0;V<r.length;++V){const H=r[V],K=B[V];gs(K),T["val_"+H]=K}}}),await b.onBatchEnd(I,E),bQ(E),this.stopTraining_)break}D.dispose()}if(await b.onEpochEnd(C,T),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return mUe(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),s=r[0],i=r[1],a=this.makeTrainFunction()(s.concat(i)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return Bt(a),el(r[0],e),el(r[1],n),Pi(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let o=0;o<s.length;++o)r&&!s[o].trainable||n.push({name:s[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=DU().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-DU().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=dc(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>dc(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const s of n)if(typeof r[s]=="string")e[s]=dc(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[dc(iS(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>dc(iS(e)));{const e={};for(const n in this.metrics)e[n]=dc(iS(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=iM(e.optimizer_config),r=kc(n);let s;if(typeof e.loss=="string")s=Uf(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(o=>Uf(o));else if(e.loss!=null){s={};for(const o in e.loss)s[o]=Uf(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>Uf(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=Uf(e.metrics[o])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,n){if(typeof e=="string"){const u=tK(e);if(u.length===0)throw new Pe(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new Pe(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new Pe("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await IR(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:CUe,generatedBy:`TensorFlow.js tfjs-layers v${_Q}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:d}=await IR(await this.optimizer.getWeights(),u);r.specs.push(...d),r.data=QY([r.data,c])}return this.userDefinedMetadata!=null&&(vj(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){vj(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Og.className="Model";et(Og);class DQ extends Og{}DQ.className="Functional";et(DQ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class f1 extends Og{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:GT("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new Pe(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof f1||e instanceof Og;let r;if(n){if(r=e,r.outputs.length!==1)throw new Pe("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new Pe("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new Pe("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=N5e({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new Pe(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new Pe("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=mQ(this.outputs[0])}this.inboundNodes=[],new YT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Ap(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Sn(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Og({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new Ia("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new Ia("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new Ia("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new Ia("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},s=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new Pe("Legacy serialization format not supported yet.");i=n}else ae(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof f1))throw new sn(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const c=kc(l,void 0,s);s&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new Pe("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new Pe("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}f1.className="Sequential";et(f1);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Gs=class extends vy{getConfig(){return{}}};class OQ extends Gs{apply(e,n=1){return u5e(e,n)}}OQ.className="elu";et(OQ);class PQ extends Gs{apply(e){return ZO(e)}}PQ.className="selu";et(PQ);class FQ extends Gs{apply(e){return Ou(e)}}FQ.className="relu";et(FQ);class LQ extends Gs{apply(e){return Ve(()=>yh(6,Ou(e)))}}LQ.className="relu6";et(LQ);class zQ extends Gs{apply(e){return e}}zQ.className="linear";et(zQ);class BQ extends Gs{apply(e){return Go(e)}}BQ.className="sigmoid";et(BQ);class UQ extends Gs{apply(e){return d5e(e)}}UQ.className="hardSigmoid";et(UQ);class VQ extends Gs{apply(e){return xy(e)}}VQ.className="softplus";et(VQ);class jQ extends Gs{apply(e){return c5e(e)}}jQ.className="softsign";et(jQ);class WQ extends Gs{apply(e){return Np(e)}}WQ.className="tanh";et(WQ);let KP=class extends Gs{apply(e,n=-1){return uT(e,n)}};KP.className="softmax";et(KP);class GQ extends Gs{apply(e,n=-1){return UO(e,n)}}GQ.className="logSoftmax";et(GQ);class HQ extends Gs{apply(e){return Ve(()=>Ve(()=>{const n=Math.sqrt(2),r=_e(.5,Qe(1,LO(yt(e,n))));return _e(e,r)}))}}HQ.className="gelu";et(HQ);class YQ extends Gs{apply(e){return Ve(()=>_e(.5,_e(e,Qe(1,Np(_e($s(yt(2,Math.PI)),Qe(e,_e(.044715,Rc(e,3)))))))))}}YQ.className="gelu_new";et(YQ);class KQ extends Gs{apply(e){return Ve(()=>_e(e,Np(xy(e))))}}KQ.className="mish";et(KQ);class qQ extends Gs{apply(e,n=1){return Ve(()=>_e(Go(_e(e,n)),e))}}qQ.className="swish";et(qQ);function bh(t){return t.getClassName()}function H3(t,e={}){return tv(t,ba.getMap().classNameMap,e,"activation")}function vh(t){if(t==null){const e={};return e.className="linear",e.config={},H3(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},H3(e)}else return t instanceof Gs?t:H3(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function IUe(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class XQ extends vy{}class ZQ extends XQ{constructor(e){super(),IUe(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return Ve(()=>{let n=_r([1]);return this.hasL1&&(n=Qe(n,Nt(_e(this.l1,Zr(e))))),this.hasL2&&(n=Qe(n,Nt(_e(this.l2,rv(e))))),Me(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}ZQ.className="L1L2";et(ZQ);const Tj={l1l2:"L1L2"};function jn(t){return DP(t)}function Ej(t,e={}){return tv(t,ba.getMap().classNameMap,e,"regularizer")}function ar(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in Tj?Tj[t]:t,config:{}};return Ej(n)}else return t instanceof XQ?t:Ej(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QQ extends un{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=qt(e);let r=Ou(e);return this.maxValue!=null&&(r=Vi(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}QQ.className="ReLU";et(QQ);class JQ extends un{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=qt(e);return Qk(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}JQ.className="LeakyReLU";et(JQ);class eJ extends un{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=or(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=ar(e.alphaRegularizer),this.alphaConstraint=ss(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new Pe(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Sn(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)n[s-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new es({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=qt(e),iT(e,this.alpha.read())}getConfig(){const e={alphaInitializer:fr(this.alphaInitializer),alphaRegularizer:jn(this.alphaRegularizer),alphaConstraint:rs(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}eJ.className="PReLU";et(eJ);let tJ=class extends un{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new sn(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=qt(e);return Yb(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};tJ.className="ELU";et(tJ);class nJ extends un{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=qt(e);return _e(r,lt(Io(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}nJ.className="ThresholdedReLU";et(nJ);class rJ extends un{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new KP().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return Ve(()=>{let r=qt(e);const s=n.mask;if(s!=null){const i=_e(xt(mo(r.shape),lt(s,r.dtype)),Mt(-1e9));r=Qe(r,i)}return this.axis instanceof Array?this.axis.length>1?wi(xt(r,eT(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}rJ.className="Softmax";et(rJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pg(t,e,n){if(typeof t=="number")return Ap(t,e);if(t.length!==e)throw new Pe(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const s=t[r];if(!i5e(s))throw new Pe(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${s}`)}return t}function bl(t,e,n,r,s=1){if(t==null)return t;const i=e+(e-1)*(s-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+r-1)/r)}function lu(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+wh([n-e,0]);else if(r==="same")t=t*e;else throw new Pe(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qP(t,e){return Ve(()=>(Mr(e),e==="channelsFirst"?yn(t,[0,2,3,1]):t))}function sJ(t,e){return Ve(()=>(Mr(e),e==="channelsFirst"?yn(t,[0,2,3,4,1]):t))}function NUe(t,e,n,r=1,s="valid",i,o=1){return Ve(()=>{if(i==null&&(i=_l()),Mr(i),t.shape.length!==3)throw new Pe(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new Pe(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new Pe(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=yn(t,[0,2,1])),s==="causal")throw new sn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=MO(t,e,r,s==="same"?"same":"valid","NWC",o);return n!=null&&(a=Ol(a,n)),a})}function _j(t,e,n,r=[1,1],s="valid",i,o,a=null){return Ve(()=>{if(i==null&&(i=_l()),Mr(i),t.rank!==3&&t.rank!==4)throw new Pe(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new Pe(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=qP(t,i);if(s==="causal")throw new sn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=aq({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=yn(l,[0,3,1,2])),l})}function kUe(t,e,n,r=[1,1,1],s="valid",i,o){return Ve(()=>{if(i==null&&(i=_l()),Mr(i),t.rank!==4&&t.rank!==5)throw new Pe(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new Pe(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=sJ(t,i);if(s==="causal")throw new sn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=EK(a,e,r,s==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Ol(a,n)),i==="channelsFirst"&&(a=yn(a,[0,4,1,2,3])),a})}class XT extends un{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",XT.verifyArgs(n),this.rank=e,ys(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new sn(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Pg(n.kernelSize,e,"kernelSize"),this.strides=Pg(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Qo(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Mr(this.dataFormat),this.activation=vh(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=or(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=ss(n.biasConstraint),this.biasRegularizer=ar(n.biasRegularizer),this.activityRegularizer=ar(n.activityRegularizer),this.dilationRate=Pg(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Pe(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Pe(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Pe(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(au("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!OP(e.kernelSize,"number",1,3))throw new Pe(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:bh(this.activation),useBias:this.useBias,biasInitializer:fr(this.biasInitializer),biasRegularizer:jn(this.biasRegularizer),activityRegularizer:jn(this.activityRegularizer),biasConstraint:rs(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Ny extends XT{constructor(e,n){super(e,n),this.kernel=null,Ny.verifyArgs(n),this.filters=n.filters,ys(this.filters,"filters"),this.kernelInitializer=or(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=ss(n.kernelConstraint),this.kernelRegularizer=ar(n.kernelRegularizer)}build(e){e=Sn(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new Pe(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return Ve(()=>{e=qt(e);let r;const s=this.bias==null?null:this.bias.read(),i=eQ(this.activation.getClassName());if(i!=null&&this.rank===2)r=_j(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=NUe(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=_j(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=kUe(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new sn("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Sn(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const o=bl(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(n),s.push(this.filters)):(s.push(this.filters),s=s.concat(n)),s}getConfig(){const e={filters:this.filters,kernelInitializer:fr(this.kernelInitializer),kernelRegularizer:jn(this.kernelRegularizer),kernelConstraint:rs(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new Pe(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class av extends Ny{constructor(e){super(2,e),av.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!OP(e.kernelSize,"number",1,2))throw new Pe(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}av.className="Conv2D";et(av);class lv extends Ny{constructor(e){super(3,e),lv.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new Pe(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}lv.className="Conv3D";et(lv);class iJ extends av{constructor(e){if(super(e),this.inputSpec=[new es({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Pe(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Sn(e),e.length!==4)throw new Pe("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new Pe("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new es({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return Ve(()=>{let r=qt(e);if(r.shape.length!==4)throw new Pe(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=s[o],u=s[a],c=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],m=lu(l,h,c,this.padding),g=lu(u,f,d,this.padding),x=[i,m,g,this.filters];this.dataFormat!=="channelsLast"&&(r=yn(r,[0,2,3,1]));let w=OO(r,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=yn(w,[0,3,1,2])),this.bias!=null&&(w=Ol(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=Sn(e);const n=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[r]=this.filters,n[s]=lu(n[s],l,o,this.padding),n[i]=lu(n[i],u,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}iJ.className="Conv2DTranspose";et(iJ);class oJ extends lv{constructor(e){if(super(e),this.inputSpec=[new es({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Pe(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Sn(e),e.length!==5)throw new Pe("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new Pe("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new es({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return Ve(()=>{let r=qt(e);if(r.shape.length!==5)throw new Pe(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const u=s[l],c=s[o],d=s[a],h=this.kernelSize[0],f=this.kernelSize[1],m=this.kernelSize[2],g=this.strides[0],x=this.strides[1],w=this.strides[2],b=lu(u,g,h,this.padding),S=lu(c,x,f,this.padding),C=lu(d,w,m,this.padding),T=[i,b,S,C,this.filters];this.dataFormat!=="channelsLast"&&(r=yn(r,[0,2,3,4,1]));let D=AK(r,this.kernel.read(),T,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(D=yn(D,[0,4,1,2,3])),this.bias!==null&&(D=Ol(D,this.bias.read(),this.dataFormat)),this.activation!==null&&(D=this.activation.apply(D)),D})}computeOutputShape(e){e=Sn(e);const n=e.slice();let r,s,i,o;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,o=4):(r=4,s=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],d=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[s]=lu(n[s],c,a,this.padding),n[i]=lu(n[i],d,l,this.padding),n[o]=lu(n[o],h,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}oJ.className="Conv3DTranspose";et(oJ);class aJ extends Ny{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new Pe("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new Pe("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new Pe(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=or(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=ar(n.depthwiseRegularizer),this.depthwiseConstraint=ss(n.depthwiseConstraint),this.pointwiseInitializer=or(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=ar(n.pointwiseRegularizer),this.pointwiseConstraint=ss(n.pointwiseConstraint)}build(e){if(e=Sn(e),e.length<this.rank+2)throw new Pe(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new Pe(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new es({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return Ve(()=>{e=qt(e);let r;if(this.rank===1)throw new sn("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=yn(e,[0,2,3,1])),r=QO(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Ol(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=yn(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=fr(this.depthwiseInitializer),e.pointwiseInitializer=fr(this.pointwiseInitializer),e.depthwiseRegularizer=jn(this.depthwiseRegularizer),e.pointwiseRegularizer=jn(this.pointwiseRegularizer),e.depthwiseConstraint=rs(this.depthwiseConstraint),e.pointwiseConstraint=rs(this.pointwiseConstraint),e}}aJ.className="SeparableConv";class lJ extends aJ{constructor(e){super(2,e)}}lJ.className="SeparableConv2D";et(lJ);class ZT extends Ny{constructor(e){super(1,e),ZT.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!OP(e.kernelSize,"number",1,1))throw new Pe(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}ZT.className="Conv1D";et(ZT);class uJ extends un{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return Ve(()=>{if(e=qt(e),this.dataFormat==="channelsLast"){const r=sS(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return sS(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=sS(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return sS(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}uJ.className="Cropping2D";et(uJ);class cJ extends un{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Mr(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,n5e(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return Ve(()=>{let r=qt(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=yn(r,[0,2,3,1]);const i=this.size[0]*s[2],o=this.size[1]*s[3],a=this.interpolation==="nearest"?gi.resizeNearestNeighbor(r,[i,o]):gi.resizeBilinear(r,[i,o]);return yn(a,[0,3,1,2])}else{const i=this.size[0]*s[1],o=this.size[1]*s[2];return this.interpolation==="nearest"?gi.resizeNearestNeighbor(r,[i,o]):gi.resizeBilinear(r,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}cJ.className="UpSampling2D";et(cJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function TUe(t,e,n=[1,1],r="valid",s,i){return Ve(()=>{s==null&&(s=_l()),Mr(s);let o=qP(t,s);if(t.rank!==4)throw new Pe(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new Pe(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=Hb(o,e,n,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(o=yn(o,[0,3,1,2])),o})}class dJ extends XT{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=or(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=ss(e.depthwiseConstraint),this.depthwiseRegularizer=ar(e.depthwiseRegularizer)}build(e){if(e=Sn(e),e.length<4)throw new Pe(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new Pe(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Ve(()=>{e=qt(e);let r=TUe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Ol(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Sn(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=bl(n,this.kernelSize[0],this.padding,this.strides[0]),o=bl(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,o]:[e[0],i,o,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=fr(this.depthwiseInitializer),e.depthwiseRegularizer=jn(this.depthwiseRegularizer),e.depthwiseConstraint=rs(this.depthwiseRegularizer),e}}dJ.className="DepthwiseConv2D";et(dJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hJ(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new Pe("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),n=s(n),{inputs:t,initialState:e,constants:n}}function fJ(t,e,n,r=!1,s,i,o=!1,a=!1){return Ve(()=>{const l=e.shape.length;if(l<3)throw new Pe(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(El(2,l));e=yn(e,u),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=lt(lt(s,"bool"),"float32"),s.rank===l-1&&(s=Fr(s,-1)),s=yn(s,u)),r&&(e=Ma(e,0),s!=null&&(s=Ma(s,0)));const c=[];let d,h=n;const f=e.shape[0],m=Da(e);let g;s!=null&&(g=Da(s));for(let w=0;w<f;++w){const b=m[w],S=Ve(()=>t(b,h));if(s==null)d=S[0],h=S[1];else{const C=Ve(()=>{const T=g[w],D=xt(Ko(T),T),P=Qe(_e(S[0],T),_e(h[0],D)),I=h.map((E,M)=>Qe(_e(S[1][M],T),_e(E,D)));return{output:P,newStates:I}});d=C.output,h=C.newStates}a&&c.push(d)}let x;return a&&(x=xo(c,1)),[d,x,h]})}class Lh extends un{constructor(e){super(e);let n;if(e.cell==null)throw new Pe("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new QP({cells:e.cell}):n=e.cell,n.stateSize==null)throw new Pe("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new es({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return El(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){nM(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[s].concat(i)}else return s}computeMask(e,n){return Ve(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new sn("Constants support is not implemented in RNN yet.");nM(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new es({shape:[n,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!nn(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new Pe(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new es({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){Ve(()=>{if(!this.stateful)throw new ou("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new Pe("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>_r([r,s])):this.states_=[_r([r,this.cell.stateSize])];else if(e==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>_r([r,s])):this.states_[0]=_r([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Pe(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,o];if(!nn(i.shape,a))throw new Pe(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>gs(s.clone()))})}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=hJ(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let o=[],a=[];if(r!=null){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new es({shape:u.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(n.constants=s,o=o.concat(s),this.numConstants=s.length),o[0]instanceof Au){const u=[e].concat(o),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return Ve(()=>{const r=n==null?null:n.mask,s=n==null?null:n.training;let i=n==null?null:n.initialState;e=qt(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new Pe(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},u=fJ((m,g)=>{const x=this.cell.call([m].concat(g),a);return[x[0],x.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],d=u[1],h=u[2];this.stateful&&this.resetStates(h,s);const f=this.returnSequences?d:c;return this.returnState?[f].concat(h):f})}getInitialState(e){return Ve(()=>{let n=_r(e.shape);return n=Nt(n,[1,2]),n=nv(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?eM(n,[1,r]):n):this.cell.stateSize>1?[eM(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Lh.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const s=n.cell,i=kc(s,r);return new e(Object.assign(n,{cell:i}))}}Lh.className="RNN";et(Lh);class QT extends un{}class XP extends QT{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,ys(this.units,"units"),this.activation=vh(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=or(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=or(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=or(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=ar(e.kernelRegularizer),this.recurrentRegularizer=ar(e.recurrentRegularizer),this.biasRegularizer=ar(e.biasRegularizer),this.kernelConstraint=ss(e.kernelConstraint),this.recurrentConstraint=ss(e.recurrentConstraint),this.biasConstraint=ss(e.biasConstraint),this.dropout=t0([1,wh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=t0([1,wh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Sn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Ve(()=>{if(e=e,e.length!==2)throw new Pe(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Sh({ones:()=>Ko(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Sh({ones:()=>Ko(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=vu(_e(e,o),this.kernel.read()):i=vu(e,this.kernel.read()),this.bias!=null&&(i=Ol(i,this.bias.read())),a!=null&&(r=_e(r,a));let l=Qe(i,vu(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:bh(this.activation),useBias:this.useBias,kernelInitializer:fr(this.kernelInitializer),recurrentInitializer:fr(this.recurrentInitializer),biasInitializer:fr(this.biasInitializer),kernelRegularizer:jn(this.kernelRegularizer),recurrentRegularizer:jn(this.recurrentRegularizer),biasRegularizer:jn(this.biasRegularizer),activityRegularizer:jn(this.activityRegularizer),kernelConstraint:rs(this.kernelConstraint),recurrentConstraint:rs(this.recurrentConstraint),biasConstraint:rs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}XP.className="SimpleRNNCell";et(XP);class pJ extends Lh{constructor(e){e.cell=new XP(e),super(e)}call(e,n){return Ve(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return new e(n)}}pJ.className="SimpleRNN";et(pJ);class ZP extends QT{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Pe("GRUCell does not support reset_after parameter set to true.");this.units=e.units,ys(this.units,"units"),this.activation=vh(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=vh(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=or(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=or(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=or(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=ar(e.kernelRegularizer),this.recurrentRegularizer=ar(e.recurrentRegularizer),this.biasRegularizer=ar(e.biasRegularizer),this.kernelConstraint=ss(e.kernelConstraint),this.recurrentConstraint=ss(e.recurrentConstraint),this.biasConstraint=ss(e.biasConstraint),this.dropout=t0([1,wh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=t0([1,wh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Sn(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Ve(()=>{if(e=e,e.length!==2)throw new Pe(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Sh({ones:()=>Ko(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Sh({ones:()=>Ko(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=_e(e,i[0]));let c=vu(e,this.kernel.read());this.useBias&&(c=Ol(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=_e(s,o[0]));const d=this.recurrentKernel.read(),[h,f]=go(d,[2*this.units,this.units],d.rank-1),m=vu(s,h),[g,x,w]=go(c,3,c.rank-1),[b,S]=go(m,2,m.rank-1);a=this.recurrentActivation.apply(Qe(g,b)),l=this.recurrentActivation.apply(Qe(x,S));const C=vu(_e(l,s),f);u=this.activation.apply(Qe(w,C));const T=Qe(_e(a,s),_e(Qe(1,tr(a)),u));return[T,T]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:bh(this.activation),recurrentActivation:bh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:fr(this.kernelInitializer),recurrentInitializer:fr(this.recurrentInitializer),biasInitializer:fr(this.biasInitializer),kernelRegularizer:jn(this.kernelRegularizer),recurrentRegularizer:jn(this.recurrentRegularizer),biasRegularizer:jn(this.biasRegularizer),activityRegularizer:jn(this.activityRegularizer),kernelConstraint:rs(this.kernelConstraint),recurrentConstraint:rs(this.recurrentConstraint),biasConstraint:rs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}ZP.className="GRUCell";et(ZP);class mJ extends Lh{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new ZP(e),super(e)}call(e,n){return Ve(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}mJ.className="GRU";et(mJ);class JT extends QT{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,ys(this.units,"units"),this.activation=vh(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=vh(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=or(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=or(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=or(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=ar(e.kernelRegularizer),this.recurrentRegularizer=ar(e.recurrentRegularizer),this.biasRegularizer=ar(e.biasRegularizer),this.kernelConstraint=ss(e.kernelConstraint),this.recurrentConstraint=ss(e.recurrentConstraint),this.biasConstraint=ss(e.biasConstraint),this.dropout=t0([1,wh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=t0([1,wh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Sn(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;s=new(n=class extends Ua{apply(l,u){const c=i.apply([o]),d=new FP().apply([o]),h=i.apply([o*2]);return hj(hj(c,d),h)}},n.className="CustomInit",n)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return Ve(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new Pe(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Sh({ones:()=>Ko(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Sh({ones:()=>Ko(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,d;0<this.dropout&&this.dropout<1&&(e=_e(e,o[0]));let h=vu(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=_e(s,a[0])),h=Qe(h,vu(s,this.recurrentKernel.read())),this.useBias&&(h=Ol(h,this.bias.read()));const[f,m,g,x]=go(h,4,h.rank-1);l=this.recurrentActivation.apply(f),u=this.recurrentActivation.apply(m),c=Qe(_e(u,i),_e(l,this.activation.apply(g))),d=this.recurrentActivation.apply(x);const w=_e(d,this.activation.apply(c));return[w,w,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:bh(this.activation),recurrentActivation:bh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:fr(this.kernelInitializer),recurrentInitializer:fr(this.recurrentInitializer),biasInitializer:fr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:jn(this.kernelRegularizer),recurrentRegularizer:jn(this.recurrentRegularizer),biasRegularizer:jn(this.biasRegularizer),activityRegularizer:jn(this.activityRegularizer),kernelConstraint:rs(this.kernelConstraint),recurrentConstraint:rs(this.recurrentConstraint),biasConstraint:rs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}JT.className="LSTMCell";et(JT);class gJ extends Lh{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new JT(e),super(e)}call(e,n){return Ve(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}gJ.className="LSTM";et(gJ);class QP extends QT{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return Ve(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?o=[e[0]].concat(r):o=[o[0]].concat(r),o=l.call(o,n),i.push(o.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(e){nM(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,s)=>{sp(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,n,r={}){const s=[];for(const i of n.cells)s.push(kc(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return rM(e)}setWeights(e){const n=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let o=0;o<r.weights.length;++o)n.push([r.weights[o],i[o]])}WP(n)}}QP.className="StackedRNNCells";et(QP);function Sh(t){const{ones:e,rate:n,training:r=!1,count:s=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):aQ(e(),n),a=()=>sv(o,e,r);return!s||s<=1?gs(a().clone()):Array(s).fill(void 0).map(a).map(u=>gs(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var EUe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class yJ extends Lh{constructor(e){if(e.unroll)throw new sn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new sn("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new es({ndim:5})]}call(e,n){return Ve(()=>{if(this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new Pe("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return Ve(()=>{const{stateSize:n}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],o=_r(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){Ve(()=>{if(!this.stateful)throw new ou("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new Pe("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>_r(i)):this.states_=[_r(i)];else if(e==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>_r(i)):this.states_[0]=_r(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Pe(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=i;if(!nn(l.shape,u))throw new Pe(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>gs(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:s,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],d=bl(u,s[0],i,o[0],a[0]),h=bl(c,s[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[r,d,h]:[d,h,r]]}}yJ.className="ConvRNN2D";class JP extends JT{constructor(e){const{filters:n,kernelSize:r,strides:s,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,ys(this.filters,"filters"),this.kernelSize=Pg(r,2,"kernelSize"),this.kernelSize.forEach(l=>ys(l,"kernelSize")),this.strides=Pg(s||1,2,"strides"),this.strides.forEach(l=>ys(l,"strides")),this.padding=i||"valid",Qo(this.padding),this.dataFormat=o||"channelsLast",Mr(this.dataFormat),this.dilationRate=Pg(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>ys(l,"dilationRate"))}build(e){var n;e=Sn(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new Pe(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,o=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends Ua{apply(h,f){const m=u.apply([c]),g=mo([c]),x=u.apply([c*2]);return PP([m,g,x])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return Ve(()=>{if(e.length!==3)throw new Pe(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,s=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Sh({ones:()=>Ko(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(fe,ee,de)=>!ee||!ee[de]?fe:_e(ee[de],fe);let c=u(s,l,0),d=u(s,l,1),h=u(s,l,2),f=u(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Sh({ones:()=>Ko(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const m=this.recurrentDropoutMask;let g=u(i,m,0),x=u(i,m,1),w=u(i,m,2),b=u(i,m,3);const S=3,[C,T,D,P]=go(this.kernel.read(),a,S),[I,E,M,O]=this.useBias?go(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,C,I,this.padding),d=this.inputConv(d,T,E,this.padding),h=this.inputConv(h,D,M,this.padding),f=this.inputConv(f,P,O,this.padding);const[j,R,z,B]=go(this.recurrentKernel.read(),a,S);g=this.recurrentConv(g,j),x=this.recurrentConv(x,R),w=this.recurrentConv(w,z),b=this.recurrentConv(b,B);const V=this.recurrentActivation.apply(Qe(c,g)),H=this.recurrentActivation.apply(Qe(d,x)),K=Qe(_e(H,o),_e(V,this.activation.apply(Qe(h,w)))),ne=_e(this.recurrentActivation.apply(Qe(f,b)),this.activation.apply(K));return[ne,ne,K]})}getConfig(){const e=super.getConfig(),{units:n}=e,r=EUe(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},r),s)}inputConv(e,n,r,s){const i=mh(e,n,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Ol(i,r,this.dataFormat):i}recurrentConv(e,n){return mh(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}JP.className="ConvLSTM2DCell";et(JP);class xJ extends yJ{constructor(e){const n=new JP(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}xJ.className="ConvLSTM2D";et(xJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class e4 extends un{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?n[s]:this.noiseShape[s]);return r}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);const r=qt(e);if(0<this.rate&&this.rate<1){const s=n.training==null?!1:n.training,i=this.getNoiseShape(r);return sv(()=>aQ(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}e4.className="Dropout";et(e4);class wJ extends e4{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}wJ.className="SpatialDropout1D";et(wJ);class bJ extends un{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,ys(this.units,"units"),this.activation=vh(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=or(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=or(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=ss(e.kernelConstraint),this.biasConstraint=ss(e.biasConstraint),this.kernelRegularizer=ar(e.kernelRegularizer),this.biasRegularizer=ar(e.biasRegularizer),this.activityRegularizer=ar(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Sn(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Sn(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);const r=qt(e),s=eQ(this.activation.getClassName());let i;return s!=null?i=vu(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=vu(r,this.kernel.read()),this.bias!=null&&(i=Ol(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:bh(this.activation),useBias:this.useBias,kernelInitializer:fr(this.kernelInitializer),biasInitializer:fr(this.biasInitializer),kernelRegularizer:jn(this.kernelRegularizer),biasRegularizer:jn(this.biasRegularizer),activityRegularizer:jn(this.activityRegularizer),kernelConstraint:rs(this.kernelConstraint),biasConstraint:rs(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}bJ.className="Dense";et(bJ);class vJ extends un{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Sn(e);for(const n of e.slice(1))if(n==null)throw new Pe(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],rh(e,1)]}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);let r=qt(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=yn(r,s)}return l5e(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}vJ.className="Flatten";et(vJ);class SJ extends un{constructor(e){super(e),this.supportsMasking=!0,this.activation=vh(e.activation)}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);const r=qt(e);return this.activation.apply(r)})}getConfig(){const e={activation:bh(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}SJ.className="Activation";et(SJ);class CJ extends un{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return Ve(()=>(e=qt(e),o5e(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}CJ.className="RepeatVector";et(CJ);class IJ extends un{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",s=n.slice();let i=1,o=null;for(let l=0;l<s.length;++l){const u=s[l];if(this.isUnknown(u))if(o===null)o=l;else throw new Pe("Can only specifiy one unknown dimension.");else i*=u}const a=rh(e);if(o!==null){if(i===0||a%i!==0)throw new Pe(r);s[o]=a/i}else if(a!==i)throw new Pe(r);return s}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);const r=qt(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return Me(r,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}IJ.className="Reshape";et(IJ);class NJ extends un{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=El(1,e.dims.length+1);if(!nn(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new es({ndim:this.dims.length+1})]}computeOutputShape(e){e=Sn(e);const n=e.slice();return this.dims.forEach((r,s)=>{n[s+1]=e[r]}),n}call(e,n){return yn(qt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}NJ.className="Permute";et(NJ);class kJ extends un{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=qt(e);return AI(qg(r,this.maskValue),-1)}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);const r=qt(e),o=AI(qg(r,this.maskValue),-1,!0);return _e(r,lt(o,r.dtype))})}}kJ.className="Masking";et(kJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TJ extends un{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat($n(e.inputLength))}this.inputDim=e.inputDim,ys(this.inputDim,"inputDim"),this.outputDim=e.outputDim,ys(this.outputDim,"outputDim"),this.embeddingsInitializer=or(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=ar(e.embeddingsRegularizer),this.activityRegularizer=ar(e.activityRegularizer),this.embeddingsConstraint=ss(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return Ve(()=>this.maskZero?(e=qt(e),qg(e,xn(e))):null)}computeOutputShape(e){if(e=Sn(e),this.inputLength==null)return[...e,this.outputDim];const n=$n(this.inputLength);if(n.length!==e.length-1)throw new Pe(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<n.length;++s){const i=n[s],o=e[s+1];if(i!=null&&o!=null&&i!==o)throw new Pe(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[r]=o),r++}}return[e[0],...n,this.outputDim]}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);let r=qt(e);r.dtype!=="int32"&&(r=bu(r,"int32"));const s=oQ(this.embeddings.read(),Me(r,[r.size]));return Me(s,Sn(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:fr(this.embeddingsInitializer),embeddingsRegularizer:jn(this.embeddingsRegularizer),activityRegularizer:jn(this.activityRegularizer),embeddingsConstraint:rs(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}TJ.className="Embedding";et(TJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zp extends un{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new sn}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let s=0;s<n.length;++s){const i=e[e.length-n.length+s],o=n[s];if(i==null||o==null||i<0||o<0)r.push(null);else if(i===1)r.push(o);else if(o===1)r.push(i);else{if(i!==o)throw new Pe("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Sn(e)]),e=e,e.length<2)throw new Pe(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=nh(n),n.length>1)throw new Pe(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&nh(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return Ve(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=wh(s);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=nv(o,1);r.push(o)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,d=c[0],h=c.slice(1).concat([d]);let f=Me(l,[d].concat(rh(c.slice(1))));f=yn(f,[1,0]),f=Me(f,h),r.push(f),i=!0}else if(u>1){const c=El(1,u).concat([0]);r.push(yn(l,c)),i=!0}else r.push(l)}let o=this.mergeFunction(r);const a=o.rank;if(i){if(a==null){const l=o.shape,u=l.length,c=l[u-1],d=[c].concat(l.slice(0,l.length-1));o=Me(yn(Me(o,[-1,c]),[1,0]),d)}else if(a>1){const l=[a-1].concat(El(0,a-1));o=yn(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=nh(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return Ve(()=>{if(n==null)return null;if(!Array.isArray(n))throw new Pe("`mask` should be an Array");if(!Array.isArray(e))throw new Pe("`inputs` should be an Array");if(n.length!==e.length)throw new Pe(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(s=>s==null))return null;n=n.map(s=>s==null?s:Fr(s,0));let r=n[0];for(let s=1;s<n.length-1;++s)r=ku(r,n[s]);return r})}}class EJ extends Zp{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=Qe(n,e[r]);return n})}}EJ.className="Add";et(EJ);class _J extends Zp{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=_e(n,e[r]);return n})}}_J.className="Multiply";et(_J);class AJ extends Zp{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=Qe(n,e[r]);return _e(1/e.length,n)})}}AJ.className="Average";et(AJ);class $J extends Zp{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Pc(n,e[r]);return n})}}$J.className="Maximum";et($J);class RJ extends Zp{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=yh(n,e[r]);return n})}}RJ.className="Minimum";et(RJ);class MJ extends Zp{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new Pe("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const s of e)if(s!=null){n=!1;break}if(n)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let o=!1;for(const a of r)if(nn(a,i)){o=!0;break}o||r.push(i)}if(r.length>1)throw new Pe("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Ve(()=>PP(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new Pe("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of n.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new Pe("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Pe("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new Pe(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return Ve(()=>{let r=!0;if(n.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const s=[];for(let o=0;o<e.length;++o)n[o]==null?s.push(lt(Ko(e[o]),"bool")):n[o].rank<e[o].rank?s.push(Fr(n[o],-1)):s.push(n[o]);const i=pr(s,this.axis);return $O(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}MJ.className="Concatenate";et(MJ);function Mx(t,e){for(;t<0;)t+=e;return t}function _Ue(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new sn("batchDot is not implemented for tensors of 4D or higher rank yet");if(ae(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),ae(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new sn("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,s=e.shape.length;n==null&&(n=[r-1,s-2]);const i=n;return Ve(()=>{let o;if(r>s){o=r-s;const l=[];for(let u=0;u<o;++u)l.push(1);e=Me(e,e.shape.concat(l))}else if(s>r){o=s-r;const l=[];for(let u=0;u<o;++u)l.push(1);t=Me(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Nt(_e(t,e),i[0]):a=Nt(_e(yn(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,u=i[1]===e.shape.length-1;a=dn(t,e,l,u)}if(o>0){let l;r>s?l=r+s-3:l=r-1;const u=[];for(let c=l;c<l+o;++c)u.push(c);a=Nn(a,u)}return a.shape.length===1&&(a=Fr(a,1)),a})}class DJ extends Zp{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){ae(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new sn("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);if(n[s[0]]!==r[s[1]])throw new Pe(`Dimension incompatibility: ${n[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new Pe(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,o)=>Mx(i,e[o].shape.length)):s=[Mx(this.axes,n.shape.length),Mx(this.axes,r.shape.length)],this.normalize&&(n=WI(n,s[0]),r=WI(r,s[1])),_Ue(n,r,s)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[Mx(this.axes,e.length),Mx(this.axes,n.length)],r}computeOutputShape(e){ae(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new sn("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);n.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=n.concat(r);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}DJ.className="Dot";et(DJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class OJ extends un{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);const r=qt(e);return sv(()=>Qe(HT(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}OJ.className="GaussianNoise";et(OJ);class PJ extends un{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Ve(()=>{this.invokeCallHook(e,n);const r=qt(e);return this.rate>0&&this.rate<1?sv(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return _e(r,HT(r.shape,1,i))},()=>r,n.training||!1):r})}}PJ.className="GaussianDropout";et(PJ);class FJ extends un{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||qt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Ve(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return sv(()=>{const i=qt(e),a=-1.6732632423543772*1.0507009873554805;let l=Dh(jp(r),this.rate);l=bu(l,"float32");const u=((1-this.rate)*(1+this.rate*a**2))**-.5,c=-u*a*this.rate,d=Qe(_e(i,l),_e(Qe(l,-1),a));return Qe(_e(d,u),c)},()=>qt(e),n.training||!1)}return e})}}FJ.className="AlphaDropout";et(FJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function p1(t,e,n,r,s,i=.001){let o;if(t.rank===2)o=wK(t,e,n,r,s,i);else if(t.rank===3)o=bK(t,e,n,r,s,i);else if(t.rank===4)o=vK(t,e,n,r,s,i);else throw new sn(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function AUe(t,e,n,r,s=.001){return Ve(()=>{const i=rT(t,r),o=i.mean,a=i.variance;return[p1(t,o,a,n,e,s),o,a]})}function $Ue(t,e,n,r,s=.001){return Ve(()=>{const i=rT(t,r),o=i.mean,a=i.variance,l=[];for(const m of El(0,t.rank))r.indexOf(m)!==-1?l.push(1):l.push(t.shape[m]);const u=Me(o,l),c=Me(a,l),d=e==null?null:Me(e,l),h=n==null?null:Me(n,l);return[p1(t,u,c,h,d,s),o,a]})}function RUe(t,e,n,r,s=.001){return nn(r.slice().sort(),El(0,t.rank-1))?AUe(t,e,n,r,s):$Ue(t,e,n,r,s)}class LJ extends un{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=or(e.betaInitializer||"zeros"),this.gammaInitializer=or(e.gammaInitializer||"ones"),this.movingMeanInitializer=or(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=or(e.movingVarianceInitializer||"ones"),this.betaConstraint=ss(e.betaConstraint),this.gammaConstraint=ss(e.gammaConstraint),this.betaRegularizer=ar(e.betaRegularizer),this.gammaRegularizer=ar(e.gammaRegularizer)}build(e){e=Sn(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new Pe(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new es({ndim:e.length,axes:{[n]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return Ve(()=>{const r=n.training==null?!1:n.training,s=qt(e),i=s.shape,o=i.length,a=El(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const u=Ap(1,o);u[l]=i[l];const c=a.slice();c.sort();const d=!nn(c,El(0,o).slice(0,o-1)),h=()=>{if(d){const b=Me(this.movingMean.read(),u),S=Me(this.movingVariance.read(),u),C=this.center?Me(this.beta.read(),u):null,T=this.scale?Me(this.gamma.read(),u):null;return p1(s,b,S,C,T,this.epsilon)}else return p1(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[f,m,g]=RUe(s,this.gamma.read(),this.beta.read(),a,this.epsilon),x=(b,S,C)=>{Ve(()=>{const T=1-C,D=b.read(),P=_e(xt(D,S),T);b.write(xt(D,P))})};return(()=>{x(this.movingMean,m,this.momentum),x(this.movingVariance,g,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:fr(this.betaInitializer),gammaInitializer:fr(this.gammaInitializer),movingMeanInitializer:fr(this.movingMeanInitializer),movingVarianceInitializer:fr(this.movingVarianceInitializer),betaRegularizer:jn(this.betaRegularizer),gammaRegularizer:jn(this.gammaRegularizer),betaConstraint:rs(this.betaConstraint),gammaConstraint:rs(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}LJ.className="BatchNormalization";et(LJ);class zJ extends un{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=or(e.betaInitializer||"zeros"),this.gammaInitializer=or(e.gammaInitializer||"ones"),this.betaRegularizer=ar(e.betaRegularizer),this.gammaRegularizer=ar(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Sn(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==nh(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,n){const r=qt(e),s=r.shape,i=s.length;return Ve(()=>{let{mean:a,variance:l}=rT(r,this.axis,!0);const u=Ap(1,i);for(const g of this.axis)u[g]=s[g];const c=g=>g!=null&&g.shape.length!==i?Me(g,u):g;let d=this.scale?c(this.gamma.read()):null,h=this.center?c(this.beta.read()):null;const f=[],m=[];for(let g=0;g<i;++g)this.axis.indexOf(g)!==-1?(f.push(s[g]),m.push(1)):(f.push(1),m.push(s[g]));return a=Ca(a,f),l=Ca(l,f),d!=null&&(d=Ca(d,m)),h!=null&&(h=Ca(h,m)),p1(r,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:fr(this.betaInitializer),gammaInitializer:fr(this.gammaInitializer),betaRegularizer:jn(this.betaRegularizer),gammaRegularizer:jn(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}zJ.className="LayerNormalization";et(zJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MUe(t,e,n){return Ve(()=>{if(t.rank!==4)throw new Pe(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new Pe("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=_l()),n!=="channelsLast"&&n!=="channelsFirst")throw new Pe(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],Nl(t,r)})}class BJ extends un{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?_l():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Pe(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Pe(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new Pe(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new es({ndim:4})]}computeOutputShape(e){e=Sn(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return Ve(()=>MUe(qt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}BJ.className="ZeroPadding2D";et(BJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eE(t,e,n,r,s,i){return Ve(()=>{Mr(s),nQ(i),Qo(r),n==null&&(n=[1,1]),r==null&&(r="valid"),s==null&&(s=_l()),i==null&&(i="max"),t=qP(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=nT(t,e,n,a):o=Kk(t,e,n,a),s==="channelsFirst"&&(o=yn(o,[0,3,1,2])),o})}function UJ(t,e,n,r,s,i){return Ve(()=>{Mr(s),nQ(i),Qo(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),s==null&&(s=_l()),i==null&&(i="max"),t=sJ(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=GK(t,e,n,a):o=xK(t,e,n,a),s==="channelsFirst"&&(o=yn(o,[0,4,1,2,3])),o})}class VJ extends un{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new Pe(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(ys(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new Pe(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);ys(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Qo(this.padding),this.inputSpec=[new es({ndim:3})]}computeOutputShape(e){e=Sn(e);const n=bl(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return Ve(()=>{this.invokeCallHook(e,n),e=nv(qt(e),2);const r=this.poolingFunction(qt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Nn(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class jJ extends VJ{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Mr(i),Qo(s),eE(e,n,r,s,i,"max")}}jJ.className="MaxPooling1D";et(jJ);class WJ extends VJ{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Mr(i),Qo(s),eE(e,n,r,s,i,"avg")}}WJ.className="AveragePooling1D";et(WJ);class GJ extends un{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Pe(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];ys(this.poolSize,"poolSize"),ys(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Mr(this.dataFormat),Qo(this.padding),this.inputSpec=[new es({ndim:4})]}computeOutputShape(e){e=Sn(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=bl(n,this.poolSize[0],this.padding,this.strides[0]),r=bl(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return Ve(()=>(this.invokeCallHook(e,n),this.poolingFunction(qt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class HJ extends GJ{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Mr(i),Qo(s),eE(e,n,r,s,i,"max")}}HJ.className="MaxPooling2D";et(HJ);class YJ extends GJ{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Mr(i),Qo(s),eE(e,n,r,s,i,"avg")}}YJ.className="AveragePooling2D";et(YJ);class KJ extends un{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Pe(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];ys(this.poolSize,"poolSize"),ys(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Mr(this.dataFormat),Qo(this.padding),this.inputSpec=[new es({ndim:5})]}computeOutputShape(e){e=Sn(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=bl(n,this.poolSize[0],this.padding,this.strides[0]),r=bl(r,this.poolSize[1],this.padding,this.strides[1]),s=bl(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,s]:[e[0],n,r,s,e[4]]}call(e,n){return Ve(()=>(this.invokeCallHook(e,n),this.poolingFunction(qt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class qJ extends KJ{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Mr(i),Qo(s),UJ(e,n,r,s,i,"max")}}qJ.className="MaxPooling3D";et(qJ);class XJ extends KJ{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Mr(i),Qo(s),UJ(e,n,r,s,i,"avg")}}XJ.className="AveragePooling3D";et(XJ);class ZJ extends un{constructor(e){super(e),this.inputSpec=[new es({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new sn}}class QJ extends ZJ{constructor(e){super(e||{})}call(e,n){return Ve(()=>{const r=qt(e);return wr(r,1)})}}QJ.className="GlobalAveragePooling1D";et(QJ);class JJ extends ZJ{constructor(e){super(e||{})}call(e,n){return Ve(()=>{const r=qt(e);return Aa(r,1)})}}JJ.className="GlobalMaxPooling1D";et(JJ);class eee extends un{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Mr(this.dataFormat),this.inputSpec=[new es({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new sn}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class tee extends eee{call(e,n){return Ve(()=>{const r=qt(e);return this.dataFormat==="channelsLast"?wr(r,[1,2]):wr(r,[2,3])})}}tee.className="GlobalAveragePooling2D";et(tee);class nee extends eee{call(e,n){return Ve(()=>{const r=qt(e);return this.dataFormat==="channelsLast"?Aa(r,[1,2]):Aa(r,[2,3])})}}nee.className="GlobalMaxPooling2D";et(nee);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ree extends un{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const s=n.layer,i=kc(s,r);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class see extends ree{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Sn(e),e.length<3)throw new Pe(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Sn(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,n){return Ve(()=>(e=qt(e),fJ((o,a)=>[qt(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}see.className="TimeDistributed";et(see);function DUe(t){Xp(t5e,"BidirectionalMergeMode",t)}const OUe="concat";class iee extends ree{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=kc(r),n.goBackwards=n.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=n,this.backwardLayer=kc(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?OUe:e.mergeMode,DUe(this.mergeMode),e.weights)throw new sn("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,s,i;return this.returnState&&(i=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):Pi(s)}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=hJ(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,n);const o=[],a=[];if(r!=null){const u=r.length;if(u%2>0)throw new Pe("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push(...r);const c=r.map(d=>new es({shape:d.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(s!=null)throw new sn("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Au;for(const u of o)if(u instanceof Au!==l)throw new Pe("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(o),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return Ve(()=>{const r=n.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let o;this.returnState&&(Array.isArray(s)&&(o=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=Ma(i,1));let a;return this.mergeMode==="concat"?a=PP([s,i]):this.mergeMode==="sum"?a=Qe(s,i):this.mergeMode==="ave"?a=_e(.5,Qe(s,i)):this.mergeMode==="mul"?a=_e(s,i):this.mergeMode==null&&(a=[s,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){sp(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),sp(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=kc(n.layer);if(delete n.layer,n.numConstants!=null)throw new sn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=n;return s.layer=r,new e(s)}}iee.className="Bidirectional";et(iee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oee extends un{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Ve(()=>(e=qt(e),e.dtype!=="float32"&&(e=bu(e,"float32")),Qe(_e(e,this.scale),this.offset)))}}oee.className="Rescaling";et(oee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:PUe,cropAndResize:FUe}=gi;class aee extends un{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,s,i,o,a,l){return Ve(()=>{let u,c=!1;const d=n/o,h=r/a,f=(s+n)/o,m=(i+r)/a,g=[d,h,f,m],x=[];e.rank===3?(c=!0,u=xo([e])):u=e;for(let T=0;T<u.shape[0];T++)x.push(g);const w=wl(x,[x.length,4]),b=Xg(0,x.length,1,"int32"),C=FUe(u,w,b,[s,i],"nearest");return bu(c?qt(Da(C)):C,l)})}upsize(e,n,r,s){return Ve(()=>{const i=PUe(e,[n,r]);return bu(i,s)})}call(e,n){return Ve(()=>{const r=qt(e),s=r.dtype,i=r.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,o,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Sn(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}aee.className="CenterCrop";et(aee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function LUe(t,e,n,r){let s=qt(t);if(s.dtype!=="int32"&&(s=bu(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=Fr(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=Fr(s,-1)),s.rank>2)throw new Pe(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=AR(a,r,n,o):l=AR(a,[],n,o),e!=="tfIdf")return l;if(r)return _e(l,r);throw new Pe("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lee extends un{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Sn(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return Ve(()=>{e=qt(e),e.dtype!=="int32"&&(e=bu(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new Pe(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=qt(n.countWeights)}const s=Aa(e),i=r1(e),o=Io(this.numTokens,s).bufferSync().get(0),a=Dh(i,0).bufferSync().get(0);if(!(o&&a))throw new Pe(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return LUe(e,this.outputMode,this.numTokens,r)})}}lee.className="CategoryEncoding";et(lee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zUe=["bilinear","nearest"],Aj=new Set(zUe);class uee extends un{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(Aj.has(e.interpolation))this.interpolation=e.interpolation;else throw new Pe(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Sn(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Ve(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return gi.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return gi.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Aj]} are supported`)})}}uee.className="Resizing";et(uee);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cee{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}cee.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dee extends un{constructor(e){super(e),this.randomGenerator=new cee(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}dee.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const BUe=["bilinear","nearest"],$j=new Set(BUe);class hee extends dee{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new Pe(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new Pe(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Pe(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if($j.has(r))this.interpolation=r;else throw new Pe(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Sn(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return Ve(()=>{const r=qt(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=jp([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return gi.resizeBilinear(e,o);case"nearest":return gi.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...$j]} are supported`)}})}}hee.className="RandomWidth";et(hee);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Rj;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(Rj||(Rj={}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UUe=aP;class tE extends KN{nextDataId(){return tE.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new cO(this,ci())}write(e,n,r){this.firstUse&&(this.firstUse=!1,We().get("IS_NODE")&&Uo(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&b0(r[0])){const i=r.map(o=>Cc(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return{dataId:s,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,s,i){this.data.set(e,{values:n,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return kl(s,i)}return IC(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Cl(s));return Zt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Zt(e.shape,e.dtype,n)}makeOutput(e,n,r){return ci().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Oi();return e(),{kernelMs:Oi()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){kt([e],"where");const n=this.readSync(e.dataId);return UUe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}tE.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */TO("cpu",()=>new tE,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fee=Rn(O0,t=>t>=0?t:Math.exp(t)-1),VUe={kernelName:O0,backendName:"cpu",kernelFunc:fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r;kt([s],"leakyRelu");const o=Ue(s.shape),a=n.data.get(s.dataId).values,l=is("float32",o);for(let u=0;u<a.length;u++)l[u]=a[u]<0?i*a[u]:a[u];return n.makeTensorInfo(s.shape,"float32",l)}const jUe={kernelName:cb,backendName:"cpu",kernelFunc:pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WUe=Rr((t,e)=>t<0?e*t:t);function mee(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;kt([r,s],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,[a,l]=WUe(r.shape,s.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const GUe={kernelName:_b,backendName:"cpu",kernelFunc:mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gee=Rn(ey,t=>Math.max(0,t)),HUe={kernelName:ey,backendName:"cpu",kernelFunc:gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yee=Rn(ty,t=>Math.min(Math.max(0,t),6)),YUe={kernelName:ty,backendName:"cpu",kernelFunc:yee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qI(t,e,n,r,s){if(n==="linear")return Tu({inputs:{x:e},backend:t});if(n==="relu")return gee({inputs:{x:e},backend:t});if(n==="elu")return fee({inputs:{x:e},backend:t});if(n==="relu6")return yee({inputs:{x:e},backend:t});if(n==="prelu")return mee({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return pee({inputs:{x:e},backend:t,attrs:{alpha:s}});if(n==="sigmoid")return KX({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=Ue(s.shape),a=hO(i,o),l=Ue(a);ae(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(s.dataId);const u=n.data.get(s.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=a,d.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const KUe={kernelName:$b,backendName:"cpu",kernelFunc:Yn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;kt([s,i],"matMul");const l=s.shape.length,u=i.shape.length,c=o?s.shape[l-2]:s.shape[l-1],d=a?i.shape[u-1]:i.shape[u-2],h=o?s.shape[l-1]:s.shape[l-2],f=a?i.shape[u-2]:i.shape[u-1],m=s.shape.slice(0,-2),g=i.shape.slice(0,-2),x=Ue(m),w=Ue(g),S=jt(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,f]);ae(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const C=o?[x,c,h]:[x,h,c],T=a?[w,f,d]:[w,d,f],D=Yn({inputs:{x:s},backend:n,attrs:{shape:C}}),P=Yn({inputs:{x:i},backend:n,attrs:{shape:T}}),I=o?D.shape[1]:D.shape[2],E=o?D.shape[2]:D.shape[1],M=a?P.shape[1]:P.shape[2],O=Math.max(x,w),j=n.data.get(D.dataId).values,R=n.data.get(P.dataId).values,z=$t(D.shape),B=$t(P.shape),[V,H,K]=o?[z[0],1,z[1]]:[z[0],z[1],1],[ne,fe,ee]=a?[1,B[1],B[0]]:[B[1],1,B[0]],de=E*M,ge=Zt([O,E,M],D.dtype),Z=ge.values,we=n.blockSize;for(let Ee=0;Ee<O;Ee++){const Le=Ee%x,De=Ee%w;for(let Be=0;Be<E;Be+=we){const se=Math.min(Be+we,E);for(let le=0;le<M;le+=we){const ye=Math.min(le+we,M);for(let ve=0;ve<I;ve+=we){const xe=Math.min(ve+we,I);for(let Ie=Be;Ie<se;Ie++)for(let te=le;te<ye;te++){let L=0;for(let U=ve;U<xe;U++){const re=j[Le*V+Ie*H+U*K],q=R[U*ne+te*fe+De*ee];L+=re*q}Z[Ee*de+(Ie*M+te)]+=L}}}}}return n.disposeIntermediateTensorInfo(D),n.disposeIntermediateTensorInfo(P),n.makeTensorInfo(S,ge.dtype,ge.values)}const qUe={kernelName:q1,backendName:"cpu",kernelFunc:xee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XUe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;let h,f,m;const g=[];h=xee({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:u},backend:n}),o&&(f=Jg({inputs:{a:h,b:o},backend:n}),g.push(h),h=f),c&&(m=qI(n,h,c,a,d),g.push(h),h=m);for(const w of g)n.disposeIntermediateTensorInfo(w);return h}const ZUe={kernelName:Zw,backendName:"cpu",kernelFunc:XUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QUe=Rn(S0,t=>Math.acos(t)),JUe={kernelName:S0,backendName:"cpu",kernelFunc:QUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eVe=Rn(C0,t=>Math.acosh(t)),tVe={kernelName:C0,backendName:"cpu",kernelFunc:eVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nVe(t){const{inputs:e,backend:n}=t,r=e;kt(e,"addN");const s=r.map(a=>n.data.get(a.dataId).values),i=Zt(r[0].shape,r[0].dtype),o=i.values;for(let a=0;a<r.length;a++){const l=s[a];for(let u=0;u<o.length;u++)o[u]+=l[u]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const rVe={kernelName:W1,backendName:"cpu",kernelFunc:nVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;kt(s,"all");const a=Jt(i,s.shape);let l=a;const u=zn(l,s.shape.length);let c=s;u!=null&&(c=ji({inputs:{x:s},backend:n,attrs:{perm:u}}),l=qn(l.length,s.shape.length)),Wr("all",l,c.shape.length);const[d,h]=$r(c.shape,l),f=Ue(h),m=As(Ue(d),c.dtype),g=n.data.get(c.dataId).values;for(let w=0;w<m.length;++w){const b=w*f;let S=g[b];for(let C=0;C<f;++C){const T=g[b+C];S=S&&T}m[w]=S}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,m);if(o){const w=Cr(d,a),b=Yn({inputs:{x},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(x),b}return x}const iVe={kernelName:qN,backendName:"cpu",kernelFunc:sVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;kt(s,"any");const a=Jt(i,s.shape);let l=a;const u=zn(l,s.shape.length);let c=s;u!=null&&(c=ji({inputs:{x:s},backend:n,attrs:{perm:u}}),l=qn(l.length,s.shape.length)),Wr("any",l,c.shape.length);const[d,h]=$r(c.shape,l),f=Ue(h),m=As(Ue(d),c.dtype),g=n.data.get(c.dataId).values;for(let w=0;w<m.length;++w){const b=w*f;let S=g[b];for(let C=0;C<f;++C){const T=g[b+C];S=S||T}m[w]=S}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,m);if(o){const w=Cr(d,a),b=Yn({inputs:{x},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(x),b}return x}const aVe={kernelName:XN,backendName:"cpu",kernelFunc:oVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;kt(s,"argMax");let o=Jt(i,s.shape);const a=zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=ji({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=qn(o.length,l.shape.length)),o=[o[0]],Wr("argMax",o,l.shape.length);const[c,d]=$r(l.shape,o),h=Ue(c),f=As(h,"int32"),m=Ue(d),g=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const w=x*m;let b=g[w],S=0;for(let C=0;C<m;++C){const T=g[w+C];T>b&&(b=T,S=C)}f[x]=S}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",f)}const uVe={kernelName:G1,backendName:"cpu",kernelFunc:lVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;kt(s,"argMin");let o=Jt(i,s.shape);const a=zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=ji({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=qn(o.length,l.shape.length)),o=[o[0]],Wr("argMin",o,l.shape.length);const[c,d]=$r(l.shape,o),h=Ue(c),f=As(h,"int32"),m=Ue(d),g=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const w=x*m;let b=g[w],S=0;for(let C=0;C<m;++C){const T=g[w+C];T<b&&(b=T,S=C)}f[x]=S}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",f)}const dVe={kernelName:H1,backendName:"cpu",kernelFunc:cVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hVe=Rn(I0,t=>Math.asin(t)),fVe={kernelName:I0,backendName:"cpu",kernelFunc:hVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pVe=Rn(N0,t=>Math.asinh(t)),mVe={kernelName:N0,backendName:"cpu",kernelFunc:pVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gVe=Rn(k0,t=>Math.atan(t)),yVe={kernelName:k0,backendName:"cpu",kernelFunc:gVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xVe=Rr((t,e)=>Math.atan2(t,e)),wVe=ls(E0,xVe),bVe={kernelName:E0,backendName:"cpu",kernelFunc:wVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vVe=Rn(T0,t=>Math.atanh(t)),SVe={kernelName:T0,backendName:"cpu",kernelFunc:vVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(t,e,n,r,s,i){const o=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,c=s.effectiveFilterHeight,d=s.effectiveFilterWidth,h=s.padInfo.top,f=s.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Zt(s.outShape,n),x=g.values,w=s.outShape[1]*s.outShape[2]*s.outShape[3],b=s.outShape[2]*s.outShape[3],S=s.outShape[3];for(let C=0;C<s.batchSize;++C){const T=C*w,D=C*r[0];for(let P=0;P<s.inChannels;++P)for(let I=0;I<s.outHeight;++I){const E=I*o-h,M=Math.max(0,E),O=Math.min(s.inHeight,c+E),j=T+I*b;for(let R=0;R<s.outWidth;++R){const z=R*a-f,B=Math.max(0,z),V=Math.min(s.inWidth,d+z);let H=m,K=0,ne=0;for(let ee=M;ee<O;ee+=l){const de=D+ee*r[1];for(let ge=B;ge<V;ge+=u){const Z=de+ge*r[2],we=t[Z+P];i==="max"&&we>H?H=we:i==="avg"&&(K+=we,ne++)}if(isNaN(H))break}const fe=j+R*S+P;x[fe]=i==="avg"?K/ne:H}}}return g}function wee(t,e,n,r,s=!1,i=!1){const o=Zt(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=r.padInfo.top,m=r.padInfo.left,g=Zt(e,n,t);for(let x=0;x<r.batchSize;++x)for(let w=0;w<r.inChannels;++w)for(let b=0;b<r.outHeight;++b){const S=b*a-f;let C=S;for(;C<0;)C+=u;const T=Math.min(r.inHeight,d+S);for(let D=0;D<r.outWidth;++D){const P=D*l-m;let I=P;for(;I<0;)I+=c;const E=Math.min(r.inWidth,h+P);let M=Number.NEGATIVE_INFINITY,O=-1;for(let j=C;j<T;j+=u){const R=j-S;for(let z=I;z<E;z+=c){const B=z-P,V=g.get(x,j,z,w);V>M&&(M=V,s?O=i?((x*r.inHeight+j)*r.inWidth+z)*r.inChannels+w:(j*r.inWidth+z)*r.inChannels+w:O=R*h+B)}}o.set(O,x,b,D,w)}}return o}function bee(t,e,n,r,s,i){const o=s.strideDepth,a=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,c=s.dilationHeight,d=s.dilationWidth,h=s.effectiveFilterDepth,f=s.effectiveFilterHeight,m=s.effectiveFilterWidth,g=s.padInfo.front,x=s.padInfo.top,w=s.padInfo.left,b=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,S=Zt(s.outShape,n),C=S.values,T=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],D=s.outShape[2]*s.outShape[3]*s.outShape[4],P=s.outShape[3]*s.outShape[4],I=s.outShape[4];for(let E=0;E<s.batchSize;++E){const M=E*T,O=E*r[0];for(let j=0;j<s.inChannels;++j)for(let R=0;R<s.outDepth;++R){const z=R*o-g;let B=z;for(;B<0;)B+=u;const V=Math.min(s.inDepth,h+z),H=M+R*D;for(let K=0;K<s.outHeight;++K){const ne=K*a-x;let fe=ne;for(;fe<0;)fe+=c;const ee=Math.min(s.inHeight,f+ne),de=H+K*P;for(let ge=0;ge<s.outWidth;++ge){const Z=ge*l-w;let we=Z;for(;we<0;)we+=d;const Ee=Math.min(s.inWidth,m+Z),Le=de+ge*I;let De=b,Be=0,se=0;for(let ye=B;ye<V;ye+=u){const ve=O+ye*r[1];for(let xe=fe;xe<ee;xe+=c){const Ie=ve+xe*r[2];for(let te=we;te<Ee;te+=d){const L=Ie+te*r[3],U=t[L+j];if(i==="max"&&U>De?De=U:i==="avg"&&(Be+=U,se++),isNaN(De))break}if(isNaN(De))break}if(isNaN(De))break}const le=Le+j;C[le]=i==="avg"?Be/Math.max(se,1):De}}}}return S}function CVe(t,e){const n=Zt(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,m=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let x=0;x<e.inChannels;++x)for(let w=0;w<e.outDepth;++w){const b=w*r-h;let S=b;for(;S<0;)S+=o;const C=Math.min(e.inDepth,u+b);for(let T=0;T<e.outHeight;++T){const D=T*s-f;let P=D;for(;P<0;)P+=a;const I=Math.min(e.inHeight,c+D);for(let E=0;E<e.outWidth;++E){const M=E*i-m;let O=M;for(;O<0;)O+=l;const j=Math.min(e.inWidth,d+M);let R=Number.NEGATIVE_INFINITY,z=-1;for(let B=S;B<C;B+=o){const V=B-b;for(let H=P;H<I;H+=a){const K=H-D;for(let ne=O;ne<j;ne+=l){const fe=ne-M,ee=t.get(g,B,H,ne,x);ee>=R&&(R=ee,z=V*c*d+K*c+fe)}}}n.set(z,g,w,T,E,x)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;kt(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ae(as(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ws(s.shape,i,o,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&nn(c.inShape,c.outShape))d=Tu({inputs:{x:s},backend:n});else{const h=n.data.get(s.dataId).values,f=$t(s.shape),m=t4(h,s.shape,s.dtype,f,c,"avg");d=n.makeTensorInfo(c.outShape,s.dtype,m.values)}return d}const NVe={kernelName:Y1,backendName:"cpu",kernelFunc:IVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;kt(s,"avgPool3d");const c=Xo(s.shape,i,o,1,a,l,u),d=n.data.get(s.dataId).values,h=bee(d,s.shape,s.dtype,$t(s.shape),c,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const TVe={kernelName:K1,backendName:"cpu",kernelFunc:kVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EVe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;kt([s,i],"avgPool3DGrad");const c=Xo(i.shape,o,a,1,l,u),d=c.strideDepth,h=c.strideHeight,f=c.strideWidth,m=c.filterDepth,g=c.filterHeight,x=c.filterWidth,w=c.dilationDepth,b=c.dilationHeight,S=c.dilationWidth,C=c.effectiveFilterDepth,T=c.effectiveFilterHeight,D=c.effectiveFilterWidth,P=C-1-c.padInfo.front,I=D-1-c.padInfo.left,E=T-1-c.padInfo.top,M=Zt(i.shape,"float32"),O=1/(m*g*x),j=n.bufferSync(s);for(let R=0;R<c.batchSize;++R)for(let z=0;z<c.inChannels;++z)for(let B=0;B<c.inDepth;++B)for(let V=0;V<c.inHeight;++V)for(let H=0;H<c.inWidth;++H){const K=B-P,ne=V-E,fe=H-I;let ee=0;for(let de=0;de<C;de+=w){const ge=(K+de)/d;if(!(ge<0||ge>=c.outDepth||Math.floor(ge)!==ge))for(let Z=0;Z<T;Z+=b){const we=(ne+Z)/h;if(!(we<0||we>=c.outHeight||Math.floor(we)!==we))for(let Ee=0;Ee<D;Ee+=S){const Le=(fe+Ee)/f;if(Le<0||Le>=c.outWidth||Math.floor(Le)!==Le)continue;const De=j.get(R,ge,we,Le,z);ee+=De}}}M.set(ee*O,R,B,V,H,z)}return n.makeTensorInfo(M.shape,M.dtype,M.values)}const _Ve={kernelName:QN,backendName:"cpu",kernelFunc:EVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AVe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;kt([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Ws(o.shape,a,l,1,u),d=c.strideHeight,h=c.strideWidth,f=c.filterHeight,m=c.filterWidth,g=c.dilationHeight,x=c.dilationWidth,w=c.effectiveFilterHeight,b=c.effectiveFilterWidth,S=b-1-c.padInfo.left,C=w-1-c.padInfo.top,T=Zt(o.shape,"float32"),D=1/(f*m),P=n.data.get(s.dataId).values,I=Zt(s.shape,"float32",P);for(let E=0;E<c.batchSize;++E)for(let M=0;M<c.inChannels;++M)for(let O=0;O<c.inHeight;++O)for(let j=0;j<c.inWidth;++j){const R=O-C,z=j-S;let B=0;for(let V=0;V<w;V+=g){const H=(R+V)/d;if(!(H<0||H>=c.outHeight||Math.floor(H)!==H))for(let K=0;K<b;K+=x){const ne=(z+K)/h;if(ne<0||ne>=c.outWidth||Math.floor(ne)!==ne)continue;const fe=I.get(E,H,ne,M);B+=fe}}T.set(B*D,E,O,j,M)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const $Ve={kernelName:ZN,backendName:"cpu",kernelFunc:AVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:i,offset:o,mean:a,variance:l}=e;ae(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ae(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ae(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),kt([s,a,l,i,o],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),m=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),x=m.length,w=f.length,b=h.length,S=d.length;let C=0,T=0,D=0,P=0;for(let I=0;I<c.length;++I)g[I]=m[C++]+(c[I]-d[T++])*f[D++]/Math.sqrt(h[P++]+u),C>=x&&(C=0),T>=S&&(T=0),D>=w&&(D=0),P>=b&&(P=0);return n.makeTensorInfo(s.shape,s.dtype,g)}const MVe={kernelName:ab,backendName:"cpu",kernelFunc:RVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;kt([s],"batchToSpaceND");const a=i.reduce((w,b)=>w*b),l=Wp(s.shape,i,a),u=Gp(l.length,i.length),c=Hp(s.shape,i,a),d=NT(o,i.length),h=kT(c,o,i.length),f=Yn({inputs:{x:s},backend:n,attrs:{shape:l}}),m=ji({inputs:{x:f},backend:n,attrs:{perm:u}}),g=Yn({inputs:{x:m},backend:n,attrs:{shape:c}}),x=_p({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}const OVe={kernelName:X1,backendName:"cpu",kernelFunc:DVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=NP(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const FVe={kernelName:JN,backendName:"cpu",kernelFunc:PVe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LVe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=jt(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const zVe={kernelName:tk,backendName:"cpu",kernelFunc:LVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BVe=Rn($0,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),UVe={kernelName:$0,backendName:"cpu",kernelFunc:BVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VVe=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(Ue(e.shape)),s=n.data.get(e.dataId),i=s.complexTensorInfos.real,o=s.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],d=l[u];r[u]=Math.hypot(c,d)}return n.makeOutput(r,e.shape,"float32")},jVe={kernelName:Z1,backendName:"cpu",kernelFunc:VVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const WVe={kernelName:bk,backendName:"cpu",kernelFunc:n0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Jt(s,e[0].shape)[0],o=e.map(g=>g.shape);ST(o,i);let a=zi(e.map(g=>g.shape),i);if(Ue(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(g=>Ue(g.shape)>0);if(l.length===1)return Tu({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(C=>Ep({inputs:{input:C},backend:n})),x=l.map(C=>n0({inputs:{input:C},backend:n})),w=r0({inputs:g,backend:n,attrs:{axis:i}}),b=r0({inputs:x,backend:n,attrs:{axis:i}}),S=ho({inputs:{real:w,imag:b},backend:n});return g.forEach(C=>n.disposeIntermediateTensorInfo(C)),x.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(b),S}const u=l.map(g=>{const w=[-1,Ue(g.shape.slice(i))];return Yn({inputs:{x:g},backend:n,attrs:{shape:w}})}),c=u.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=zi(u.map(g=>g.shape),1);const d=u[0].shape[0]===1,h=vX(c,a,e[0].dtype,d),f=zi(l.map(g=>g.shape),i),m=n.makeTensorInfo(f,e[0].dtype,h);return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const GVe={kernelName:Q1,backendName:"cpu",kernelFunc:r0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;kt([s,i],"conv2d");const d=Co(l),h=Kn(s.shape,i.shape,o,u,a,c,!1,d),f=h.filterHeight,m=h.filterWidth,g=h.dilationHeight,x=h.dilationWidth,w=h.padInfo.left,b=h.padInfo.top,S=h.dataFormat==="channelsLast",C=new ns(h.outShape,s.dtype),T=$t(s.shape),D=$t(i.shape),P=T[0],I=S?T[1]:T[2],E=S?T[2]:1,M=S?1:T[1],O=C.strides[0],j=S?C.strides[1]:C.strides[2],R=S?C.strides[2]:1,z=S?1:C.strides[1],B=n.data.get(s.dataId).values,V=n.data.get(i.dataId).values,H=C.values;for(let K=0;K<h.batchSize;++K){const ne=K*P,fe=K*O;for(let ee=0;ee<h.outHeight;++ee){const de=fe+ee*j,ge=ee*h.strideHeight-b;for(let Z=0;Z<f;++Z){const we=ge+Z*g;if(we<0||we>=h.inHeight)continue;const Ee=Z*D[0],Le=ne+we*I;for(let De=0;De<h.outWidth;++De){const Be=de+De*R,se=De*h.strideWidth-w;for(let le=0;le<m;++le){const ye=se+le*x;if(ye<0||ye>=h.inWidth)continue;const ve=Ee+le*D[1],xe=Le+ye*E;let Ie=ve;for(let te=0;te<h.inChannels;++te){const L=B[xe+te*M];for(let U=0;U<h.outChannels;++U)H[Be+U*z]+=L*V[Ie+U];Ie+=h.outChannels}}}}}}return n.makeTensorInfo(C.shape,C.dtype,H)}const HVe={kernelName:J1,backendName:"cpu",kernelFunc:vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;kt([s,i],"conv2dBackpropFilter");const d=Co(l),h=Kn(s.shape,c,o,1,a,u,!1,d),{strideHeight:f,strideWidth:m,filterHeight:g,filterWidth:x}=h,w=h.dataFormat==="channelsLast",b=new ns(h.filterShape,"float32"),S=h.padInfo.left,C=h.padInfo.top,T=n.data.get(s.dataId).values,D=n.data.get(i.dataId).values,P=new ns(s.shape,s.dtype,T),I=new ns(i.shape,i.dtype,D);for(let E=0;E<g;++E){const M=Math.max(0,Math.ceil((C-E)/f)),O=Math.min(h.outHeight,(h.inHeight+C-E)/f);for(let j=0;j<x;++j){const R=Math.max(0,Math.ceil((S-j)/m)),z=Math.min(h.outWidth,(h.inWidth+S-j)/m);for(let B=0;B<h.inChannels;++B)for(let V=0;V<h.outChannels;++V){let H=0;for(let K=0;K<h.batchSize;++K)for(let ne=M;ne<O;++ne){const fe=E+ne*f-C;for(let ee=R;ee<z;++ee){const de=j+ee*m-S;w?H+=P.get(K,fe,de,B)*I.get(K,ne,ee,V):H+=P.get(K,B,fe,de)*I.get(K,V,ne,ee)}}b.set(H,E,j,B,V)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const KVe={kernelName:rk,backendName:"cpu",kernelFunc:YVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qVe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;kt([s,i],"conv2dBackpropInput");const d=$t(i.shape),h=$t(s.shape);let f=Co(u);const m=Kn(o,i.shape,a,1,l,c,!1,f),g=new ns(m.inShape,"float32"),x=g.values,w=n.data.get(s.dataId).values,b=n.data.get(i.dataId).values,[S,C,T]=d,{batchSize:D,filterHeight:P,filterWidth:I,inChannels:E,inHeight:M,inWidth:O,outChannels:j,outHeight:R,outWidth:z,strideHeight:B,strideWidth:V}=m;f=m.dataFormat;const H=P-1-m.padInfo.top,K=I-1-m.padInfo.left,ne=f==="channelsLast",fe=g.strides[0],ee=ne?g.strides[1]:g.strides[2],de=ne?g.strides[2]:1,ge=ne?1:g.strides[1],Z=h[0],we=ne?h[1]:h[2],Ee=ne?h[2]:1,Le=ne?1:h[1];for(let De=0;De<D;++De)for(let Be=0;Be<E;++Be)for(let se=0;se<M;++se){const le=se-H,ye=Math.max(0,Math.ceil(le/B)),ve=Math.min(R,(P+le)/B);for(let xe=0;xe<O;++xe){const Ie=xe-K,te=Math.max(0,Math.ceil(Ie/V)),L=Math.min(z,(I+Ie)/V);let U=0;for(let q=ye;q<ve;++q){const ie=q*B-le;for(let me=te;me<L;++me){const je=me*V-Ie,He=Z*De+we*q+Ee*me,Ge=S*(P-1-ie)+C*(I-1-je)+T*Be;for(let Je=0;Je<j;++Je){const N=w[He+Le*Je],k=b[Ge+Je];U+=N*k}}}const re=fe*De+ee*se+de*xe+ge*Be;x[re]=U}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const XVe={kernelName:eb,backendName:"cpu",kernelFunc:qVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r;kt([s,i],"conv3d");const u=Dl(s.shape,i.shape,o,l,a),{filterDepth:c,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:m,dilationWidth:g,padInfo:x}=u,w=x.front,b=x.left,S=x.top,C=new ns(u.outShape,s.dtype),T=n.data.get(s.dataId).values,D=n.data.get(i.dataId).values,P=C.values,I=$t(s.shape),E=$t(i.shape);for(let M=0;M<u.batchSize;++M){const O=M*I[0],j=M*C.strides[0];for(let R=0;R<u.outDepth;++R){const z=j+R*C.strides[1],B=R*u.strideDepth-w;for(let V=0;V<c;++V){const H=B+V*f;if(H<0||H>=u.inDepth)continue;const K=V*E[0],ne=O+H*I[1];for(let fe=0;fe<u.outHeight;++fe){const ee=z+fe*C.strides[2],de=fe*u.strideHeight-S;for(let ge=0;ge<d;++ge){const Z=de+ge*m;if(Z<0||Z>=u.inHeight)continue;const we=K+ge*E[1],Ee=ne+Z*I[2];for(let Le=0;Le<u.outWidth;++Le){const De=ee+Le*u.outChannels,Be=Le*u.strideWidth-b;for(let se=0;se<h;++se){const le=Be+se*g;if(le<0||le>=u.inWidth)continue;const ye=we+se*E[2],ve=Ee+le*u.inChannels;let xe=ye;for(let Ie=0;Ie<u.inChannels;++Ie){const te=T[ve+Ie];for(let L=0;L<u.outChannels;++L)P[De+L]+=te*D[xe+L];xe+=u.outChannels}}}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const QVe={kernelName:tb,backendName:"cpu",kernelFunc:ZVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r;kt([s,i],"conv3dBackpropFilterV2");const u=$t(s.shape),c=$t(i.shape),d=Dl(s.shape,l,o,1,a),h=d.strideDepth,f=d.strideHeight,m=d.strideWidth,g=d.filterDepth,x=d.filterHeight,w=d.filterWidth,b=new ns(d.filterShape,"float32"),S=b.values,[C,T,D,P]=b.strides,I=n.data.get(i.dataId).values,[E,M,O,j]=c,R=n.data.get(s.dataId).values,[z,B,V,H]=u,K=d.padInfo.front,ne=d.padInfo.left,fe=d.padInfo.top;for(let ee=0;ee<g;++ee){const de=Math.max(0,Math.ceil((K-ee)/h)),ge=Math.min(d.outDepth,(d.inDepth+K-ee)/h),Z=ee*C;for(let we=0;we<x;++we){const Ee=Math.max(0,Math.ceil((fe-we)/f)),Le=Math.min(d.outHeight,(d.inHeight+fe-we)/f),De=we*T+Z;for(let Be=0;Be<w;++Be){const se=Math.max(0,Math.ceil((ne-Be)/m)),le=Math.min(d.outWidth,(d.inWidth+ne-Be)/m),ye=Be*D+De;for(let ve=0;ve<d.inChannels;++ve){const xe=ve*P+ye;for(let Ie=0;Ie<d.outChannels;++Ie){let te=0;for(let L=0;L<d.batchSize;++L){const U=L*z,re=L*E;for(let q=de;q<ge;++q){const me=(ee+q*h-K)*B+U,je=q*M+re;for(let He=Ee;He<Le;++He){const Je=(we+He*f-fe)*V+me,N=He*O+je;for(let k=se;k<le;++k){const J=(Be+k*m-ne)*H+Je,ce=k*j+N;te+=R[J+ve]*I[ce+Ie]}}}}S[xe+Ie]=te}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const eje={kernelName:sk,backendName:"cpu",kernelFunc:JVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tje(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r;kt([s],"conv3dBackpropInputV2");const u=$t(s.shape),c=$t(i.shape),d=Dl(l,i.shape,a,1,o),h=new ns(d.inShape,"float32"),f=h.values,[m,g,x,w]=h.strides,b=n.data.get(s.dataId).values,[S,C,T,D]=u,P=n.data.get(i.dataId).values,[I,E,M,O]=c,{batchSize:j,filterDepth:R,filterHeight:z,filterWidth:B,inChannels:V,inDepth:H,inHeight:K,inWidth:ne,outChannels:fe,outDepth:ee,outHeight:de,outWidth:ge,strideDepth:Z,strideHeight:we,strideWidth:Ee}=d,Le=R-1-d.padInfo.front,De=z-1-d.padInfo.top,Be=B-1-d.padInfo.left;for(let se=0;se<j;++se)for(let le=0;le<V;++le)for(let ye=0;ye<H;++ye){const ve=ye-Le,xe=Math.max(0,Math.ceil(ve/Z)),Ie=Math.min(ee,(R+ve)/Z);for(let te=0;te<K;++te){const L=te-De,U=Math.max(0,Math.ceil(L/we)),re=Math.min(de,(z+L)/we);for(let q=0;q<ne;++q){const ie=q-Be,me=Math.max(0,Math.ceil(ie/Ee)),je=Math.min(ge,(B+ie)/Ee);let He=0;for(let Ge=xe;Ge<Ie;++Ge){const Je=Ge*Z-ve;for(let N=U;N<re;++N){const k=N*we-L;for(let $=me;$<je;++$){const J=$*Ee-ie,ce=S*se+C*Ge+T*N+D*$,be=I*(R-1-Je)+E*(z-1-k)+M*(B-1-J)+O*le;for(let Ne=0;Ne<fe;++Ne){const at=b[ce+Ne],St=P[be+Ne];He+=at*St}}}}f[m*se+g*ye+x*te+w*q+le]=He}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const nje={kernelName:ik,backendName:"cpu",kernelFunc:tje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rje=Rn(R0,t=>Math.cos(t)),sje={kernelName:R0,backendName:"cpu",kernelFunc:rje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ije=Rn(M0,t=>Math.cosh(t)),oje={kernelName:M0,backendName:"cpu",kernelFunc:ije};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aje(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[c,d,h,f]=s.shape,m=i.shape[0],[g,x]=a,w=Zt([m,g,x,f],"float32"),b=n.data.get(i.dataId).values,S=n.data.get(o.dataId).values,C=n.data.get(s.dataId).values,T=$t(s.shape),D=$t(w.shape);for(let P=0;P<m;P++){const I=P*4,E=b[I],M=b[I+1],O=b[I+2],j=b[I+3],R=S[P];if(R>=c)continue;const z=g>1?(O-E)*(d-1)/(g-1):0,B=x>1?(j-M)*(h-1)/(x-1):0;for(let V=0;V<g;V++){const H=g>1?E*(d-1)+V*z:.5*(E+O)*(d-1);if(H<0||H>d-1){for(let K=0;K<x;K++)for(let ne=0;ne<f;ne++){const fe=ne+K*D[2]+V*D[1]+P*D[0];w.values[fe]=u}continue}if(l==="bilinear"){const K=Math.floor(H),ne=Math.ceil(H),fe=H-K;for(let ee=0;ee<x;ee++){const de=x>1?M*(h-1)+ee*B:.5*(M+j)*(h-1);if(de<0||de>h-1){for(let Ee=0;Ee<f;Ee++){const Le=Ee+ee*D[2]+V*D[1]+P*D[0];w.values[Le]=u}continue}const ge=Math.floor(de),Z=Math.ceil(de),we=de-ge;for(let Ee=0;Ee<f;Ee++){let Le=Ee+ge*T[2]+K*T[1]+R*T[0];const De=C[Le];Le=Ee+Z*T[2]+K*T[1]+R*T[0];const Be=C[Le];Le=Ee+ge*T[2]+ne*T[1]+R*T[0];const se=C[Le];Le=Ee+Z*T[2]+ne*T[1]+R*T[0];const le=C[Le],ye=De+(Be-De)*we,ve=se+(le-se)*we;Le=Ee+ee*D[2]+V*D[1]+P*D[0],w.values[Le]=ye+(ve-ye)*fe}}}else for(let K=0;K<x;++K){const ne=x>1?M*(h-1)+K*B:.5*(M+j)*(h-1);if(ne<0||ne>h-1){for(let de=0;de<f;de++){const ge=de+K*D[2]+V*D[1]+P*D[0];w.values[ge]=u}continue}const fe=Math.round(ne),ee=Math.round(H);for(let de=0;de<f;de++){const ge=de+fe*T[2]+ee*T[1]+R*T[0],Z=de+K*D[2]+V*D[1]+P*D[0];w.values[Z]=C[ge]}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const lje={kernelName:ak,backendName:"cpu",kernelFunc:aje};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uje(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;kt(s,"cumprod");const l=zn([i],s.shape.length);let u=s;l!=null&&(u=ji({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=qn(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=ws(u.dtype,"int32"),h=pO(Ue(u.shape),d),f=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],g=a?(w,b)=>w+m-b-1:(w,b)=>w+b;for(let w=0;w<f.length;w+=m)for(let b=0;b<m;b++){const S=g(w,b);if(b===0)h[S]=o?1:f[S];else{const C=g(w,b-1);h[S]=o?f[C]*h[C]:f[S]*h[C]}}const x=n.makeTensorInfo(u.shape,d,h);if(l!=null){const w=Du(l),b=ji({inputs:{x},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),b}return x}const cje={kernelName:ok,backendName:"cpu",kernelFunc:uje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dje(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;kt(s,"cumsum");const l=zn([i],s.shape.length);let u=s;l!=null&&(u=ji({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=qn(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=ws(u.dtype,"int32"),h=As(Ue(u.shape),d),f=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],g=a?(w,b)=>w+m-b-1:(w,b)=>w+b;for(let w=0;w<f.length;w+=m)for(let b=0;b<m;b++){const S=g(w,b);if(b===0)h[S]=o?0:f[S];else{const C=g(w,b-1);h[S]=o?f[C]+h[C]:f[S]+h[C]}}const x=n.makeTensorInfo(u.shape,d,h);if(l!=null){const w=Du(l),b=ji({inputs:{x},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),b}return x}const hje={kernelName:nb,backendName:"cpu",kernelFunc:dje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fje(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=NP(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(i),c=xX(l,u,o,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const pje={kernelName:lk,backendName:"cpu",kernelFunc:fje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mje(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r;ae(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],l=s.shape[1],u=s.shape[2],c=s.shape[3],d=l*i,h=u*i,f=c/(i*i),m=n.data.get(s.dataId).values,g=new Float32Array(a*d*h*f);let x=0;for(let w=0;w<a;++w)for(let b=0;b<d;++b){const S=Math.floor(b/i),C=b%i;for(let T=0;T<h;++T){const D=Math.floor(T/i),P=T%i,I=(C*i+P)*f;for(let E=0;E<f;++E){const O=E+I+c*(D+u*(S+l*w));g[x++]=m[O]}}}return n.makeTensorInfo([a,d,h,f],s.dtype,g)}const gje={kernelName:uk,backendName:"cpu",kernelFunc:mje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;kt([s,i],"depthwiseConv2DNative");const c=$t(s.shape),d=$t(i.shape);let h=l;h==null&&(h=[1,1]),ae(as(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=Kn(s.shape,i.shape,o,h,a,u,!0),{filterHeight:m,filterWidth:g,dilationHeight:x,dilationWidth:w,padInfo:b}=f,S=b.left,C=b.top,T=f.outChannels/f.inChannels,D=new ns(f.outShape,s.dtype),P=n.data.get(s.dataId).values,I=n.data.get(i.dataId).values,E=D.values;for(let M=0;M<f.batchSize;++M){const O=M*c[0],j=M*D.strides[0];for(let R=0;R<f.outHeight;++R){const z=j+R*D.strides[1],B=R*f.strideHeight-C;for(let V=0;V<m;++V){const H=B+V*x;if(H<0||H>=f.inHeight)continue;const K=V*d[0],ne=O+H*c[1];for(let fe=0;fe<f.outWidth;++fe){const ee=z+fe*D.strides[2],de=fe*f.strideWidth-S;for(let ge=0;ge<g;++ge){const Z=de+ge*w;if(Z<0||Z>=f.inWidth)continue;const we=K+ge*d[1],Ee=ne+Z*f.inChannels;let Le=ee,De=we;for(let Be=0;Be<f.inChannels;++Be){const se=P[Ee+Be];for(let le=0;le<T;++le)E[Le+le]+=se*I[De+le];Le+=T,De+=T}}}}}}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const yje={kernelName:rb,backendName:"cpu",kernelFunc:See};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xje(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;kt([s,i],"depthwiseConv2dNativeBackpropFilter");const d=Kn(s.shape,c,o,a,l,u,!0),{strideHeight:h,strideWidth:f,filterHeight:m,filterWidth:g}=d,x=new ns(d.filterShape,"float32"),w=d.padInfo.left,b=d.padInfo.top,S=d.outChannels/d.inChannels,C=n.data.get(s.dataId).values,T=new ns(s.shape,s.dtype,C),D=n.data.get(i.dataId).values,P=new ns(i.shape,i.dtype,D);for(let I=0;I<m;++I){const E=Math.max(0,Math.ceil((b-I)/h)),M=Math.min(d.outHeight,(d.inHeight+b-I)/h);for(let O=0;O<g;++O){const j=Math.max(0,Math.ceil((w-O)/f)),R=Math.min(d.outWidth,(d.inWidth+w-O)/f);for(let z=0;z<d.outChannels;++z){const B=Math.trunc(z/S),V=z%S;let H=0;for(let K=0;K<d.batchSize;++K)for(let ne=E;ne<M;++ne){const fe=I+ne*h-b;for(let ee=j;ee<R;++ee){const de=O+ee*f-w;H+=T.get(K,fe,de,B)*P.get(K,ne,ee,z)}}x.set(H,I,O,B,V)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const wje={kernelName:ck,backendName:"cpu",kernelFunc:xje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bje(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;kt([s,i],"depthwiseConv2DNativeBackpropInput");const d=$t(s.shape),h=$t(i.shape),f=Kn(c,i.shape,o,a,l,u,!0),m=new ns(f.inShape,"float32"),g=m.values,[x,w,b]=m.strides,S=n.data.get(s.dataId).values,[C,T,D]=d,P=n.data.get(i.dataId).values,[I,E,M]=h,{batchSize:O,filterHeight:j,filterWidth:R,inChannels:z,inHeight:B,inWidth:V,outChannels:H,outHeight:K,outWidth:ne,strideHeight:fe,strideWidth:ee}=f,de=j-1-f.padInfo.top,ge=R-1-f.padInfo.left,Z=H/z;for(let we=0;we<O;++we)for(let Ee=0;Ee<z;++Ee)for(let Le=0;Le<B;++Le){const De=Le-de,Be=Math.max(0,Math.ceil(De/fe)),se=Math.min(K,(j+De)/fe);for(let le=0;le<V;++le){const ye=le-ge,ve=Math.max(0,Math.ceil(ye/ee)),xe=Math.min(ne,(R+ye)/ee);let Ie=0;for(let te=Be;te<se;++te){const L=te*fe-De;for(let U=ve;U<xe;++U){const re=U*ee-ye,q=C*we+T*te+D*U,ie=I*(j-1-L)+E*(R-1-re)+M*Ee;for(let me=0;me<Z;++me){const je=Ee*Z+me,He=S[q+je],Ge=P[ie+me];Ie+=He*Ge}}}g[x*we+w*Le+b*le+Ee]=Ie}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const vje={kernelName:dk,backendName:"cpu",kernelFunc:bje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sje(t){const{inputs:e,backend:n}=t,{x:r}=e,s=Ue(r.shape),i=n.data.get(r.dataId).values,o=Zt([s,s],r.dtype),a=o.values;for(let u=0;u<i.length;u++)a[u*s+u]=i[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Cje={kernelName:hk,backendName:"cpu",kernelFunc:Sje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ije={kernelName:sb,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s}=t,{strides:i,pad:o,dilations:a}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,d=l.data.get(s.dataId).values,h=s.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:x,outHeight:w,outWidth:b,padInfo:S,strideHeight:C,strideWidth:T,filterHeight:D,filterWidth:P,dilationHeight:I,dilationWidth:E,outShape:M}=Mh(r.shape,s.shape,i,o,"NHWC",a),O=Ue(M),j=M.length,R=br(r.dtype,O);for(let B=0;B<f;++B)for(let V=0;V<w;++V){const H=V*C-S.top;for(let K=0;K<b;++K){const ne=K*T-S.left;for(let fe=0;fe<x;++fe){let ee=Number.MIN_SAFE_INTEGER;for(let ge=0;ge<D;++ge){const Z=H+ge*I;if(Z>=0&&Z<m)for(let we=0;we<P;++we){const Ee=ne+we*E;if(Ee>=0&&Ee<g){const Le=xu([B,Z,Ee,fe],c,$t(r.shape)),De=xu([ge,we,fe],h,$t(s.shape)),Be=u[Le]+d[De];Be>ee&&(ee=Be)}}}const de=xu([B,V,K,fe],j,$t(M));R[de]=ee}}}return{dataId:l.write(Up(R,r.dtype),M,r.dtype),shape:M,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nje={kernelName:II,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,u=e,c=_a(r.shape,u.data.get(r.dataId).values),d=_a(s.shape,u.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:x,outWidth:w,padInfo:b,strideHeight:S,strideWidth:C,filterHeight:T,filterWidth:D,dilationHeight:P,dilationWidth:I,outShape:E}=Mh(r.shape,s.shape,o,a,"NHWC",l);ae(i.rank===E.length,()=>`Error in ${II}, dy must have the same rank as output ${E.length}, but got ${i.rank}`);const M=_a(E,u.data.get(i.dataId).values),O=AY(s.shape,s.dtype);for(let R=0;R<h;++R)for(let z=0;z<x;++z){const B=z*S-b.top;for(let V=0;V<w;++V){const H=V*C-b.left;for(let K=0;K<g;++K){let ne=Number.MIN_SAFE_INTEGER,fe=0,ee=0;for(let de=0;de<T;++de){const ge=B+de*P;if(ge>=0&&ge<f)for(let Z=0;Z<D;++Z){const we=H+Z*I;if(we>=0&&we<m){const Ee=c[R][ge][we][K]+d[de][Z][K];Ee>ne&&(ne=Ee,fe=de,ee=Z)}}}O[fe][ee][K]+=M[R][z][V][K]}}}return{dataId:u.write(Up(O,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kje={kernelName:CI,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,u=e,c=_a(r.shape,u.data.get(r.dataId).values),d=_a(s.shape,u.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:x,outWidth:w,padInfo:b,strideHeight:S,strideWidth:C,filterHeight:T,filterWidth:D,dilationHeight:P,dilationWidth:I,outShape:E}=Mh(r.shape,s.shape,o,a,"NHWC",l);ae(i.rank===E.length,()=>`Error in ${CI}, dy must have the same rank as output ${E.length}, but got ${i.rank}`);const M=_a(E,u.data.get(i.dataId).values),O=AY(r.shape,r.dtype);for(let R=0;R<h;++R)for(let z=0;z<x;++z){const B=z*S-b.top;for(let V=0;V<w;++V){const H=V*C-b.left;for(let K=0;K<g;++K){let ne=Number.MIN_SAFE_INTEGER,fe=B<0?0:B,ee=H<0?0:H;for(let de=0;de<T;++de){const ge=B+de*P;if(ge>=0&&ge<f)for(let Z=0;Z<D;++Z){const we=H+Z*I;if(we>=0&&we<m){const Ee=c[R][ge][we][K]+d[de][Z][K];Ee>ne&&(ne=Ee,fe=ge,ee=we)}}}O[R][fe][ee][K]+=M[R][z][V][K]}}}return{dataId:u.write(Up(O,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tje(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:i,options:o}=r,{contextOptions:a,imageOptions:l}=o||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);const[h,f]=s.shape.slice(0,2),m=s.shape.length===2?1:s.shape[2],g=n.data.get(s.dataId).values,x=s.dtype==="float32"?255:1,w=new Uint8ClampedArray(f*h*4);for(let S=0;S<h*f;++S){const C=[0,0,0,255*u];for(let D=0;D<m;D++){const P=g[S*m+D];if(s.dtype==="float32"){if(P<0||P>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${P}.`)}else if(s.dtype==="int32"&&(P<0||P>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${P}.`);m===1?(C[0]=P*x,C[1]=P*x,C[2]=P*x):C[D]=P*x}const T=S*4;w[T+0]=Math.round(C[0]),w[T+1]=Math.round(C[1]),w[T+2]=Math.round(C[2]),w[T+3]=Math.round(C[3])}i.width=f,i.height=h;const b=new ImageData(w,f,h);return d.putImageData(b,0,0),s}const Eje={kernelName:gO,backendName:"cpu",kernelFunc:Tje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uv(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;kt(s,"sum");let a;s.dtype==="bool"?a=xh({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):a=Tu({inputs:{x:s},backend:n});const l=a.shape.length,u=Jt(i,a.shape),c=zn(u,l);let d=u,h=a;c!=null&&(h=ji({inputs:{x:a},backend:n,attrs:{perm:c}}),d=qn(d.length,l)),Wr("sum",d,h.shape.length);const[f,m]=$r(h.shape,d),g=ws(h.dtype,"int32");let x=OI(n,f,g);const w=Ue(m),b=n.data.get(x.dataId).values,S=n.data.get(h.dataId).values;for(let C=0;C<b.length;++C){const T=C*w;let D=0;for(let P=0;P<w;++P)D+=S[T+P];b[C]=D}if(o){const C=Cr(x.shape,u),T=x;x=Yn({inputs:{x},backend:n,attrs:{shape:C}}),n.disposeIntermediateTensorInfo(T)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(h),x}const _je={kernelName:Fb,backendName:"cpu",kernelFunc:uv};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aje(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=MT(s,i.length);OT(o.length,l,i);const{path:u,steps:c}=PT(a,l),d=c.length;let h=null,f=o.length;const m=[];for(let g=0;g<d;++g){for(const x of c[g]){const{permutationIndices:w,expandDims:b}=DT(f,l[x]);let S;FT(w)?S=i[x]:(S=ji({inputs:{x:i[x]},backend:n,attrs:{perm:w}}),m.push(S));const C=S.shape.slice();for(let T=0;T<b.length;++T)C.splice(b[T],0,1);nn(S.shape,C)||(S=Yn({inputs:{x:S},backend:n,attrs:{shape:C}}),m.push(S)),h===null?h=S:(h=jT({inputs:{a:S,b:h},backend:n}),m.push(h))}g<d-1&&(u[g]>=0&&(h=uv({inputs:{x:h},backend:n,attrs:{axis:u[g]-(o.length-f),keepDims:!1}}),m.push(h)),f--)}for(const g of m)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const $je={kernelName:fk,backendName:"cpu",kernelFunc:Aje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rje(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;kt([r,s],"eluGrad");const i=new Float32Array(Ue(s.shape)),o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const u=o[l];u>=0?i[l]=a[l]:i[l]=a[l]*(u+1)}return n.makeTensorInfo(s.shape,"float32",i)}const Mje={kernelName:pk,backendName:"cpu",kernelFunc:Rje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dje=TT,Oje=ET,Pje=_T,Fje=AT,Lje=$T,zje=RT,Bje=Rn(P0,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+Dje*n);return e*(1-((((zje*r+Lje)*r+Fje)*r+Pje)*r+Oje)*r*Math.exp(-n*n))}),Uje={kernelName:P0,backendName:"cpu",kernelFunc:Bje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XI(t){const{inputs:e,backend:n,attrs:r}=t,{input:s}=e,{dim:i}=r,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(ae(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Yn({inputs:{x:s},backend:n,attrs:{shape:a}})}const Vje={kernelName:ob,backendName:"cpu",kernelFunc:XI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jje=Rr((t,e)=>t/e),n4=ls(D0,jje),uM={kernelName:D0,backendName:"cpu",kernelFunc:n4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t,e,n){const r=t.shape,s=r[0],i=r[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[s,i],c=Ue(u),d=is("float32",c),h=is("float32",c);for(let x=0;x<s;x++){const w=_p({inputs:{x:a},backend:n,attrs:{begin:[x,0],size:[1,i]}}),b=_p({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,i]}}),S=ho({inputs:{real:w,imag:b},backend:n}),{real:C,imag:T}=Wje(S,e,n),D=kl(C,T);for(let P=0;P<i;P++){const I=wP(D,P);d[x*i+P]=I.real,h[x*i+P]=I.imag}n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(S)}const f=n.makeTensorInfo(u,"float32",d),m=n.makeTensorInfo(u,"float32",h),g=ho({inputs:{real:f,imag:m},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}function Wje(t,e,n){const r=Ue(t.shape),s=n.data.get(t.dataId),i=n.data.get(s.complexTensorInfos.real.dataId).values,o=n.data.get(s.complexTensorInfos.imag.dataId).values;if(Gje(r)){const a=cM(i,o,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",Ah(r,"float32")),h=Tu({inputs:{x:d},backend:n}),f=uM.kernelFunc({inputs:{a:u,b:d},backend:n}),m=uM.kernelFunc({inputs:{a:c,b:h},backend:n}),g=n.data.get(f.dataId).values,x=n.data.get(m.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),{real:g,imag:x}}return a}else{const a=kl(i,o),l=Hje(a,r,e);return Uq(l)}}function Gje(t){return(t&t-1)===0}function cM(t,e,n,r,s){if(n===1)return{real:t,imag:e};const i=kl(t,e),o=n/2,a=Vq(i),l=a.real,u=a.imag,c=[l.length],d=s.makeTensorInfo(c,"float32",l),h=s.makeTensorInfo(c,"float32",u),f=ho({inputs:{real:d,imag:h},backend:s}),m=jq(i),g=m.real,x=m.imag,w=[g.length],b=s.makeTensorInfo(w,"float32",g),S=s.makeTensorInfo(w,"float32",x),C=ho({inputs:{real:b,imag:S},backend:s}),T=cM(l,u,o,r,s),D=T.real,P=T.imag,I=[D.length],E=s.makeTensorInfo(I,"float32",D),M=s.makeTensorInfo(I,"float32",P),O=ho({inputs:{real:E,imag:M},backend:s}),j=cM(g,x,o,r,s),R=j.real,z=j.imag,B=[R.length],V=s.makeTensorInfo(B,"float32",R),H=s.makeTensorInfo(B,"float32",z),K=ho({inputs:{real:V,imag:H},backend:s}),ne=Gq(n,r),fe=[ne.real.length],ee=s.makeTensorInfo(fe,"float32",ne.real),de=s.makeTensorInfo(fe,"float32",ne.imag),ge=ho({inputs:{real:ee,imag:de},backend:s}),Z=jT({inputs:{a:ge,b:K},backend:s}),we=Jg({inputs:{a:O,b:Z},backend:s}),Ee=_P({inputs:{a:O,b:Z},backend:s}),Le=Ep({inputs:{input:we},backend:s}),De=Ep({inputs:{input:Ee},backend:s}),Be=n0({inputs:{input:we},backend:s}),se=n0({inputs:{input:Ee},backend:s}),le=r0({inputs:[Le,De],backend:s,attrs:{axis:0}}),ye=r0({inputs:[Be,se],backend:s,attrs:{axis:0}}),ve=s.data.get(le.dataId).values,xe=s.data.get(ye.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo(C),s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(O),s.disposeIntermediateTensorInfo(V),s.disposeIntermediateTensorInfo(H),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(ee),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(we),s.disposeIntermediateTensorInfo(Ee),s.disposeIntermediateTensorInfo(Le),s.disposeIntermediateTensorInfo(Be),s.disposeIntermediateTensorInfo(De),s.disposeIntermediateTensorInfo(se),s.disposeIntermediateTensorInfo(le),s.disposeIntermediateTensorInfo(ye),{real:ve,imag:xe}}function Hje(t,e,n){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,o=0;for(let a=0;a<e;a++){const l=Hq(s*a,e,n),u=wP(t,a);i+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}n&&(i/=e,o/=e),Wq(r,i,o,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yje(t){const{inputs:e,backend:n}=t,{input:r}=e,s=Ue(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Yn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=Cee(a,!1,n),u=Yn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const Kje={kernelName:mk,backendName:"cpu",kernelFunc:Yje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4(t){const{backend:e,attrs:n}=t,{shape:r,value:s,dtype:i}=n,o=i||zp(s),a=br(o,Ue(r));return Xje(a,s,o),e.makeTensorInfo(r,o,a)}const qje={kernelName:gk,backendName:"cpu",kernelFunc:r4};function Xje(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zje={kernelName:yk,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,s=n,i=is(r.dtype,Ue(r.shape)),[o,a,l,u]=r.shape,c=s.data.get(r.dataId).values;for(let h=0;h<o;h++){const f=h*l*a*u;for(let m=0;m<a;m++){const g=m*(l*u);for(let x=0;x<l;x++){const w=x*u;for(let b=0;b<u;b++){const S=Math.round(l-x-1),C=f+g+w+b;let T=c[C];if(S>=0&&S<l){const D=S*u,P=f+g+D+b;T=c[P]}i[C]=T}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qje(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=r;let g=vee({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(o){const x=g;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const w=Yn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=Jg({inputs:{a:g,b:w},backend:n}),n.disposeIntermediateTensorInfo(w)}else g=Jg({inputs:{a:g,b:o},backend:n});n.disposeIntermediateTensorInfo(x)}if(f){const x=g;if(c==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const w=Yn({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=qI(n,g,f,w,m),n.disposeIntermediateTensorInfo(w)}else g=qI(n,g,f,a,m);n.disposeIntermediateTensorInfo(x)}return g}const Jje={kernelName:Qw,backendName:"cpu",kernelFunc:Qje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=r;let g=See({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(o){const x=g;g=Jg({inputs:{a:g,b:o},backend:n}),n.disposeIntermediateTensorInfo(x)}if(f){const x=g;g=qI(n,g,f,a,m),n.disposeIntermediateTensorInfo(x)}return g}const t6e={kernelName:Jw,backendName:"cpu",kernelFunc:e6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n6e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=Ue(r.shape),o=s.shape,a=o[o.length-1],[l,u,c,d]=xT(r,s);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const h=n.data.get(s.dataId).values,f=n.bufferSync(r),m=_X(h,f,r.dtype,u,a,c,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,m.values)}const r6e={kernelName:xk,backendName:"cpu",kernelFunc:n6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r;kt([s,i],"gatherV2");const l=Jt(o,s.shape)[0],u=n.data.get(i.dataId).values,c=s.shape[l];for(let C=0;C<u.length;++C){const T=u[C];ae(T<=c-1&&T>=0,()=>`GatherV2: the index value ${T} is not in [0, ${c-1}]`)}let d=a;a==null&&(d=0);const h=Ue(i.shape),f=zT(s,i,l,d),m=Yn({inputs:{x:s},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=Yn({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),x=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],w=n.bufferSync(g),b=n.bufferSync(m),S=AX(b,w,x);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,S.dtype,S.values)}const i6e={kernelName:lb,backendName:"cpu",kernelFunc:s6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6e(t){const{inputs:e,backend:n}=t,{input:r}=e,s=Ue(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Yn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=Cee(a,!0,n),u=Yn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const a6e={kernelName:wk,backendName:"cpu",kernelFunc:o6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l6e=Rn(j0,t=>Number.isFinite(t)?1:0,"bool"),u6e={kernelName:j0,backendName:"cpu",kernelFunc:l6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c6e=Rn(W0,t=>Math.abs(t)===1/0?1:0,"bool"),d6e={kernelName:W0,backendName:"cpu",kernelFunc:c6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h6e=Rn(G0,t=>Number.isNaN(t)?1:0,"bool"),f6e={kernelName:G0,backendName:"cpu",kernelFunc:h6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=OX(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const m6e={kernelName:vk,backendName:"cpu",kernelFunc:p6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g6e=Rn(Y0,t=>Math.log1p(t)),y6e={kernelName:Y0,backendName:"cpu",kernelFunc:g6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x6e=Rr((t,e)=>t&&e),w6e=ls(fb,x6e,null,"bool"),b6e={kernelName:fb,backendName:"cpu",kernelFunc:w6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v6e=Rn(pb,t=>t?0:1,"bool"),S6e={kernelName:pb,backendName:"cpu",kernelFunc:v6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C6e=Rr((t,e)=>t||e),I6e=ls(mb,C6e,null,"bool"),N6e={kernelName:mb,backendName:"cpu",kernelFunc:I6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r;kt(s,"LRN");const u=s.shape[3],c=u-1,d=n.data.get(s.dataId).values,h=Ue(s.shape),f=new Float32Array(h);function m(g){const x=g%u;let w=g-x+Math.max(0,x-i);const b=g-x+Math.min(x+i,c);let S=0;for(;w<=b;w++){const C=d[w];S+=C*C}return S}for(let g=0;g<h;g++){const x=m(g),w=d[g]*Math.pow(o+a*x,-l);f[g]=w}return n.makeTensorInfo(s.shape,s.dtype,f)}const T6e={kernelName:gb,backendName:"cpu",kernelFunc:k6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r;kt(o,"LRNGrad");const d=Ue(o.shape),h=o.shape[3],f=n.data.get(o.dataId).values,m=n.data.get(s.dataId).values,g=n.data.get(i.dataId).values,x=new Float32Array(d),w=d;for(let b=0;b<w;b++){const S=b%h,C=b-S+Math.max(0,S-a),T=b-S+Math.min(h,S+a+1);let D=0;for(let P=C;P<T;P++)D+=Math.pow(m[P],2);D=u*D+l;for(let P=C;P<T;P++){let I=-2*u*c*m[P]*g[b]/D;b===P&&(I+=Math.pow(D,-c)),I*=f[b],x[P]+=I}}return n.makeTensorInfo(o.shape,s.dtype,x)}const _6e={kernelName:Sk,backendName:"cpu",kernelFunc:E6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=n;let l=s.shape;const u=l.length,c=Jt(i,l);let d=c;const h=zn(d,u);let f=a.data.get(s.dataId).values;if(h!=null){const C=new Array(u);for(let T=0;T<C.length;T++)C[T]=l[h[T]];f=TP(f,l,s.dtype,h,C),d=qn(d.length,u),l=C}kt(s,"max"),Wr("max",d,u);const[m,g]=$r(l,d),x=Ue(g),w=FX(f,x,m,s.dtype),b=a.write(w,m,s.dtype);let S=m;return o&&(S=Cr(m,c)),{dataId:b,shape:S,dtype:s.dtype}}const A6e={kernelName:yb,backendName:"cpu",kernelFunc:Iee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;kt(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ae(as(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ws(s.shape,i,o,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&nn(c.inShape,c.outShape))d=Tu({inputs:{x:s},backend:n});else{const h=n.data.get(s.dataId).values,f=$t(s.shape),m=t4(h,s.shape,s.dtype,f,c,"max");d=n.makeTensorInfo(c.outShape,s.dtype,m.values)}return d}const R6e={kernelName:xb,backendName:"cpu",kernelFunc:$6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;kt(s,"maxPool3d");const c=Xo(s.shape,i,o,1,a,l,u),d=n.data.get(s.dataId).values,h=bee(d,s.shape,s.dtype,$t(s.shape),c,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const D6e={kernelName:wb,backendName:"cpu",kernelFunc:M6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;kt([s,i],"maxPool3DGrad");const c=Xo(i.shape,o,a,1,l,u),d=n.bufferSync(i),h=CVe(d,c),f=c.strideDepth,m=c.strideHeight,g=c.strideWidth,x=c.dilationDepth,w=c.dilationHeight,b=c.dilationWidth,S=c.effectiveFilterDepth,C=c.effectiveFilterHeight,T=c.effectiveFilterWidth,D=S-1-c.padInfo.front,P=T-1-c.padInfo.left,I=C-1-c.padInfo.top,E=Zt(i.shape,"float32"),M=n.bufferSync(s);for(let O=0;O<c.batchSize;++O)for(let j=0;j<c.inChannels;++j)for(let R=0;R<c.inDepth;++R)for(let z=0;z<c.inHeight;++z)for(let B=0;B<c.inWidth;++B){const V=R-D,H=z-I,K=B-P;let ne=0;for(let fe=0;fe<S;fe+=x){const ee=(V+fe)/f;if(!(ee<0||ee>=c.outDepth||Math.floor(ee)!==ee))for(let de=0;de<C;de+=w){const ge=(H+de)/m;if(!(ge<0||ge>=c.outHeight||Math.floor(ge)!==ge))for(let Z=0;Z<T;Z+=b){const we=(K+Z)/g;if(we<0||we>=c.outWidth||Math.floor(we)!==we)continue;const Ee=S*C*T-1-h.get(O,ee,ge,we,j),Le=fe*C*T+de*T+Z,De=Ee===Le?1:0;if(De===0)continue;const Be=M.get(O,ee,ge,we,j);ne+=Be*De}}}E.set(ne,O,R,z,B,j)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const P6e={kernelName:Ik,backendName:"cpu",kernelFunc:O6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;kt([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=Ws(a.shape,l,u,1,c,d),f=n.data.get(a.dataId).values,m=Zt(h.outShape,a.dtype,wee(f,a.shape,a.dtype,h).values),g=h.strideHeight,x=h.strideWidth,w=h.dilationHeight,b=h.dilationWidth,S=h.effectiveFilterHeight,C=h.effectiveFilterWidth,T=C-1-h.padInfo.left,D=S-1-h.padInfo.top,P=Zt(a.shape,"float32"),I=n.data.get(s.dataId).values,E=Zt(s.shape,"float32",I);for(let M=0;M<h.batchSize;++M)for(let O=0;O<h.inChannels;++O)for(let j=0;j<h.inHeight;++j)for(let R=0;R<h.inWidth;++R){const z=j-D,B=R-T;let V=0;for(let H=0;H<S;H+=w){const K=(z+H)/g;if(!(K<0||K>=h.outHeight||Math.floor(K)!==K))for(let ne=0;ne<C;ne+=b){const fe=(B+ne)/x;if(fe<0||fe>=h.outWidth||Math.floor(fe)!==fe)continue;const ee=S*C-1-m.get(M,K,fe,O),de=H*C+ne,ge=ee===de?1:0;if(ge===0)continue;const Z=E.get(M,K,fe,O);V+=Z*ge}}P.set(V,M,j,R,O)}return n.makeTensorInfo(P.shape,P.dtype,P.values)}const L6e={kernelName:Ck,backendName:"cpu",kernelFunc:F6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6e(t,e,n,r,s){const i=$t(e),o=t4(t,e,n,i,s,"max"),a=wee(t,e,n,s,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B6e={kernelName:Nk,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;kt(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Ws(r.shape,s,i,[1,1],o),[d,h]=z6e(u,r.shape,r.dtype,a,c),f=l.write(d,c.outShape,r.dtype),m=l.write(h,c.outShape,r.dtype);return[{dataId:f,shape:c.outShape,dtype:r.dtype},{dataId:m,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=Jt(i,s.shape),u=$r(s.shape,a)[1],c=Ue(u),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));d.push(h);const f=xh({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});d.push(f);const m=n4({inputs:{a:f,b:h},backend:n});d.push(m);const g=uv({inputs:{x:m},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),g}const V6e={kernelName:bb,backendName:"cpu",kernelFunc:U6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;kt(s,"min");const a=Jt(i,s.shape);let l=a;const u=zn(l,s.shape.length);let c=s;u!=null&&(c=ji({inputs:{x:s},backend:n,attrs:{perm:u}}),l=qn(l.length,s.shape.length)),Wr("min",l,c.shape.length);const[d,h]=$r(c.shape,l),f=Ue(h),m=As(Ue(d),c.dtype),g=n.data.get(c.dataId).values;for(let w=0;w<m.length;++w){const b=w*f;let S=g[b];for(let C=0;C<f;++C){const T=g[b+C];(Number.isNaN(T)||T<S)&&(S=T)}m[w]=S}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,m);if(o){const w=Cr(d,a),b=Yn({inputs:{x},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(x),b}return x}const W6e={kernelName:vb,backendName:"cpu",kernelFunc:j6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,mode:o}=r;kt(s,"mirrorPad");const a=i.map((S,C)=>S[0]+s.shape[C]+S[1]),l=i.map(S=>S[0]),u=i.map((S,C)=>S[0]+s.shape[C]),c=o==="reflect"?0:1,d=n.data.get(s.dataId).values,h=s.shape.length,f=$t(s.shape),m=Ue(a),g=a.length,x=$t(a),w=is(s.dtype,m);for(let S=0;S<m;S++){let C=v0(S,g,x);for(let D=0;D<g;D++)C[D]<l[D]?C[D]=l[D]*2-C[D]-c:C[D]>=u[D]&&(C[D]=(u[D]-1)*2-C[D]+c);C=C.map((D,P)=>D-l[P]);const T=xu(C,h,f);w[S]=d[T]}return{dataId:n.write(w,a,s.dtype),shape:a,dtype:s.dtype}}const H6e={kernelName:Sb,backendName:"cpu",kernelFunc:G6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y6e=Rr((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),K6e=ls(X0,Y6e),q6e={kernelName:X0,backendName:"cpu",kernelFunc:K6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nee(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=s.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Jt([a],s.shape),u=Iee({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=Cr(u.shape,l),d=Yn({inputs:{x:u},backend:n,attrs:{shape:c}}),h=_P({inputs:{a:s,b:d},backend:n}),f=NX({inputs:{x:h},backend:n}),m=uv({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=Yn({inputs:{x:m},backend:n,attrs:{shape:c}}),x=n4({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}const X6e={kernelName:Bb,backendName:"cpu",kernelFunc:Nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r;kt(s,"multinomial");const l=a?s:Nee({inputs:{logits:s},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,h=[u,i],f=As(Ue(h),"int32");for(let m=0;m<u;++m){const g=m*c,x=new Float32Array(c-1);x[0]=d[g];for(let S=1;S<x.length;++S)x[S]=x[S-1]+d[g+S];const w=oT.alea(o.toString()),b=m*i;for(let S=0;S<i;++S){const C=w();f[b+S]=x.length;for(let T=0;T<x.length;T++)if(C<x[T]){f[b+S]=T;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const Q6e={kernelName:kk,backendName:"cpu",kernelFunc:Z6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J6e=gT;function e8e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r;kt(s,"NonMaxSuppression");const u=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:d}=J6e(u,c,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const t8e={kernelName:Tk,backendName:"cpu",kernelFunc:e8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8e=cP;function r8e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;kt(s,"NonMaxSuppressionPadded");const c=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:f}=n8e(c,d,o,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const s8e={kernelName:yO,backendName:"cpu",kernelFunc:r8e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8e=yT;function o8e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;kt(s,"NonMaxSuppressionWithScore");const c=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,h=o,f=a,m=l,g=u,{selectedIndices:x,selectedScores:w}=i8e(c,d,h,f,m,g);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const a8e={kernelName:Ek,backendName:"cpu",kernelFunc:o8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l8e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r;kt(s,"oneHot");const u=Ue(s.shape),c=new Float32Array(u*o);c.fill(l);const d=n.data.get(s.dataId).values;for(let h=0;h<u;++h)d[h]>=0&&d[h]<o&&(c[h*o+d[h]]=a);return n.makeTensorInfo([...s.shape,o],i,c)}const u8e={kernelName:kb,backendName:"cpu",kernelFunc:l8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZI(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Ep({inputs:{input:r},backend:n}),i=ZI({inputs:{x:s},backend:n}),o=n0({inputs:{input:r},backend:n}),a=ZI({inputs:{x:o},backend:n}),l=ho({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return r4({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const c8e={kernelName:jb,backendName:"cpu",kernelFunc:ZI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Ep({inputs:{input:r},backend:n}),i=kee({inputs:{x:s},backend:n}),o=n0({inputs:{input:r},backend:n}),a=ZI({inputs:{x:o},backend:n}),l=ho({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return r4({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const d8e={kernelName:Nb,backendName:"cpu",kernelFunc:kee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return XI({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Wi(i,c.shape,"All tensors passed to stack must have matching shapes"),ae(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=XI({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=r0({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const h8e={kernelName:Tb,backendName:"cpu",kernelFunc:Tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;kt(s,"pad");const a=i.map((b,S)=>b[0]+s.shape[S]+b[1]),l=i.map(b=>b[0]),u=n.data.get(s.dataId).values,c=Ue(s.shape),d=s.shape.length,h=$t(s.shape),f=Ue(a),m=a.length,g=$t(a),x=is(s.dtype,f);o!==0&&x.fill(o);for(let b=0;b<c;b++){const C=v0(b,d,h).map((D,P)=>D+l[P]),T=xu(C,m,g);x[T]=u[b]}return{dataId:n.write(x,a,s.dtype),shape:a,dtype:s.dtype}}const Eee={kernelName:Eb,backendName:"cpu",kernelFunc:f8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p8e=Rr((t,e)=>Math.pow(t,e)),m8e=ls(Q0,p8e),g8e={kernelName:Q0,backendName:"cpu",kernelFunc:m8e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8e(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(w=>n.data.get(w.dataId).values),u=s.map(w=>w.shape),c=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,[h,f,m]=jX(l,u,c,i.shape,i.dtype,d,o.shape),g=h.map(w=>n.makeTensorInfo([w.length],"int32",w)),x=n.makeTensorInfo(m,i.dtype,f);return g.concat([x])}const x8e={kernelName:xO,backendName:"cpu",kernelFunc:y8e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8e(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=WX(o,r.shape,r.dtype,a,s.shape,l,i.shape),d=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[d,h]}const b8e={kernelName:wO,backendName:"cpu",kernelFunc:w8e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8e(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(x=>n.data.get(x.dataId).values),f=a.map(x=>x.shape),[m,g]=GX(u,s.shape,c,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(m,i.dtype,g)}const S8e={kernelName:bO,backendName:"cpu",kernelFunc:v8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:i,step:o}=n,a=HX(r,s,o,i);return e.makeTensorInfo([a.length],i,a)}const I8e={kernelName:_k,backendName:"cpu",kernelFunc:C8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N8e=Rn(J0,t=>1/t),k8e={kernelName:J0,backendName:"cpu",kernelFunc:N8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;kt(s,"resizeBilinear");const l=$t(s.shape),[u,c]=a,[d,h,f,m]=s.shape,g=n.data.get(s.dataId).values,x=new Float32Array(Ue([d,u,c,m])),w=[i&&u>1?h-1:h,i&&c>1?f-1:f],b=[i&&u>1?u-1:u,i&&c>1?c-1:c];let S=0;const C=w[0]/b[0],T=w[1]/b[1];for(let D=0;D<d;D++)for(let P=0;P<u;P++){let I;o?I=C*(P+.5)-.5:I=C*P;const E=Math.max(0,Math.floor(I)),M=I-E,O=Math.min(h-1,Math.ceil(I)),j=D*l[0]+E*l[1],R=D*l[0]+O*l[1];for(let z=0;z<c;z++){let B;o?B=T*(z+.5)-.5:B=T*z;const V=Math.max(0,Math.floor(B)),H=B-V,K=Math.min(f-1,Math.ceil(B)),ne=j+V*l[2],fe=R+V*l[2],ee=j+K*l[2],de=R+K*l[2];for(let ge=0;ge<m;ge++){const Z=g[ne+ge],we=g[fe+ge],Ee=g[ee+ge],Le=g[de+ge],De=Z+(Ee-Z)*H,Be=we+(Le-we)*H,se=De+(Be-De)*M;x[S++]=se}}}return n.makeTensorInfo([d,u,c,m],"float32",x)}const E8e={kernelName:Mb,backendName:"cpu",kernelFunc:T8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;kt([i,s],"resizeBilinearGrad");const a=$t(s.shape),[l,u,c,d]=s.shape,[,h,f]=i.shape,m=new Float32Array(l*u*c*d),g=[o&&h>1?u-1:u,o&&f>1?c-1:c],x=[o&&h>1?h-1:h,o&&f>1?f-1:f],w=g[0]/x[0],b=g[1]/x[1],S=n.data.get(i.dataId).values;let C=0;for(let T=0;T<l;T++){const D=T*a[0];for(let P=0;P<h;P++){const I=P*w,E=Math.floor(I),M=Math.min(Math.ceil(I),u-1),O=D+E*a[1],j=D+M*a[1],R=I-E,z=1-R;for(let B=0;B<f;B++){const V=B*b,H=Math.floor(V),K=Math.min(Math.ceil(V),c-1),ne=V-H,fe=1-ne,ee=O+H*a[2],de=O+K*a[2],ge=j+H*a[2],Z=j+K*a[2],we=z*fe,Ee=z*ne,Le=R*fe,De=R*ne;for(let Be=0;Be<d;Be++){const se=S[C++];m[ee+Be]+=se*we,m[de+Be]+=se*Ee,m[ge+Be]+=se*Le,m[Z+Be]+=se*De}}}}return n.makeTensorInfo([l,c,u,d],"float32",m)}const A8e={kernelName:Rk,backendName:"cpu",kernelFunc:_8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;kt(s,"resizeNearestNeighbor");const l=$t(s.shape),[u,c]=a,[d,h,f,m]=s.shape,g=n.data.get(s.dataId).values,x=new Float32Array(d*u*c*m),w=[i&&u>1?h-1:h,i&&c>1?f-1:f],b=[i&&u>1?u-1:u,i&&c>1?c-1:c],S=w[0]/b[0],C=w[1]/b[1];let T=0;for(let D=0;D<d;D++){const P=D*l[0];for(let I=0;I<u;I++){const E=o?S*(I+.5):S*I;let M=Math.min(h-1,i?Math.round(E):Math.floor(E));o&&(M=Math.max(0,M));const O=P+M*l[1];for(let j=0;j<c;j++){const R=o?C*(j+.5):C*j;let z=Math.min(f-1,i?Math.round(R):Math.floor(R));o&&(z=Math.max(0,z));const B=O+z*l[2];for(let V=0;V<m;V++){const H=g[B+V];x[T++]=H}}}}return n.makeTensorInfo([d,u,c,m],s.dtype,x)}const R8e={kernelName:Rb,backendName:"cpu",kernelFunc:$8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;kt([i,s],"resizeNearestNeighborGrad");const a=$t(s.shape),l=$t(i.shape),[u,c,d,h]=s.shape,[,f,m]=i.shape,g=new Float32Array(u*c*d*h),x=n.data.get(i.dataId).values,w=[o&&f>1?c-1:c,o&&m>1?d-1:d],b=[o&&f>1?f-1:f,o&&m>1?m-1:m],S=w[0]/b[0],C=w[1]/b[1],T=1/S,D=1/C,P=Math.ceil(T)*2+2,I=Math.ceil(D)*2+2;for(let E=0;E<u;E++){const M=E*a[0];for(let O=0;O<c;O++){const j=M+O*a[1],R=Math.floor(O*T),z=Math.floor(R-P/2);for(let B=0;B<d;B++){const V=j+B*a[2],H=Math.floor(B*D),K=Math.floor(H-I/2);for(let ne=0;ne<h;ne++){let fe=0;for(let ee=0;ee<P;ee++){const de=ee+z;if(de<0||de>=f)continue;const ge=M+de*l[1],Z=de*S,we=Math.min(c-1,o?Math.round(Z):Math.floor(Z));if(O===we)for(let Ee=0;Ee<I;Ee++){const Le=Ee+K;if(Le<0||Le>=m)continue;const De=ge+Le*l[2],Be=Le*C,se=Math.min(d-1,o?Math.round(Be):Math.floor(Be));B===se&&(fe+=x[De+ne])}}g[V+ne]=fe}}}}return n.makeTensorInfo(s.shape,s.dtype,g)}const D8e={kernelName:$k,backendName:"cpu",kernelFunc:M8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r;kt(s,"reverse");const o=s.shape.length,a=Jt(i,s.shape);if(o===0)return Tu({inputs:{x:s},backend:n});const l=new ns(s.shape,s.dtype),u=n.bufferSync(s);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),h=d.slice();a.forEach(f=>h[f]=s.shape[f]-1-h[f]),l.set(u.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const P8e={kernelName:Db,backendName:"cpu",kernelFunc:O8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F8e={kernelName:Gk,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=is(r.dtype,Ue(r.shape)),[u,c,d,h]=r.shape,[f,m]=IT(o,c,d),g=255,x=Math.sin(s),w=Math.cos(s),b=a.data.get(r.dataId).values;for(let C=0;C<u;C++){const T=C*d*c*h;for(let D=0;D<c;D++){const P=D*(d*h);for(let I=0;I<d;I++){const E=I*h;for(let M=0;M<h;M++){const O=[u,D,I,M],j=O[2],R=O[1];let z=(j-f)*w-(R-m)*x,B=(j-f)*x+(R-m)*w;z=Math.round(z+f),B=Math.round(B+m);let V=i;if(typeof i!="number"&&(M===3?V=g:V=i[M]),z>=0&&z<d&&B>=0&&B<c){const K=B*(d*h),ne=z*h,fe=T+K+ne+M;V=b[fe]}const H=T+P+E+M;l[H]=V}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L8e=Rn(ny,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),z8e={kernelName:ny,backendName:"cpu",kernelFunc:L8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Pu(i,s,o),h=!0,f=n.bufferSync(s),m=n.bufferSync(i),g=qf(f,m,o,d,u,l,a,c,0,h);return n.makeTensorInfo(o,g.dtype,g.values)}const U8e={kernelName:Mk,backendName:"cpu",kernelFunc:B8e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8e(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<e?n=s+1:r=s;return r}function j8e(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<=e?n=s+1:r=s;return r}function W8e(t,e,n,r,s,i){const o=br("int32",n*s);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),u=a*s;for(let c=0;c<s;++c)o[u+c]=i==="left"?V8e(l,e[c+u]):j8e(l,e[c+u])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8e(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=W8e(a,l,s.shape[0],s.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",u)}const H8e={kernelName:Ok,backendName:"cpu",kernelFunc:G8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8e(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e;kt([r,s,i],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=ws(s.dtype,i.dtype),d=As(Ue(s.shape),c);let h=0;const f=o===0||o>1||s.shape.length===1?1:Ue(s.shape.slice(1));for(let m=0;m<a.length;m++)for(let g=0;g<f;g++)a[m]===1?d[h++]=l[m]:d[h++]=u[m];return n.makeTensorInfo(s.shape,c,d)}const K8e={kernelName:Ob,backendName:"cpu",kernelFunc:Y8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q8e=Qb,X8e=Jb,Z8e=Rn(sy,t=>t>=0?X8e*t:q8e*(Math.exp(t)-1)),Q8e={kernelName:sy,backendName:"cpu",kernelFunc:Z8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J8e=Rn(ay,t=>t<0?-1:t>0?1:0),eWe={kernelName:ay,backendName:"cpu",kernelFunc:J8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tWe=Rn(iy,t=>Math.sin(t)),nWe={kernelName:iy,backendName:"cpu",kernelFunc:tWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rWe=Rn(oy,t=>Math.sinh(t)),sWe={kernelName:oy,backendName:"cpu",kernelFunc:rWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iWe=11920928955078125e-23,Mj=Math.log(iWe)+2,oWe=Rn(uy,t=>{const e=t>-Mj,n=t<Mj,r=Math.exp(t);let s;return n?s=r:e?s=t:s=Math.log(1+r),s}),aWe={kernelName:uy,backendName:"cpu",kernelFunc:oWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;kt([s],"spaceToBatchND");const a=Ue(i),l=[[0,0]];l.push(...o);for(let D=1+i.length;D<s.shape.length;++D)l.push([0,0]);const u=Eee.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),c=Wp(u.shape,i,a,!1),d=Gp(c.length,i.length,!1),h=Hp(u.shape,i,a,!1),g=Yn({inputs:{x:u},backend:n,attrs:{shape:c}}),b=ji({inputs:{x:g},backend:n,attrs:{perm:d}}),T=Yn({inputs:{x:b},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),T}const uWe={kernelName:Lb,backendName:"cpu",kernelFunc:lWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cWe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values[0],[d,h,f,m,g]=XX(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(x=>Number(x)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const dWe={kernelName:vO,backendName:"cpu",kernelFunc:cWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hWe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(s.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,c,d]=ZX(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const fWe={kernelName:SO,backendName:"cpu",kernelFunc:hWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pWe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=EP(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const mWe={kernelName:Pk,backendName:"cpu",kernelFunc:pWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gWe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=EP(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const yWe={kernelName:Fk,backendName:"cpu",kernelFunc:gWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xWe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Pu(i,s,a),f=!1,m=n.bufferSync(s);let g;switch(i.dtype){case"bool":{const x=n.bufferSync(i),w=!!n.data.get(o.dataId).values[0];g=qf(m,x,a,h,c,u,l,d,w,f);break}case"float32":{const x=n.bufferSync(i),w=n.data.get(o.dataId).values[0];g=qf(m,x,a,h,c,u,l,d,w,f);break}case"int32":{const x=n.bufferSync(i),w=n.data.get(o.dataId).values[0];g=qf(m,x,a,h,c,u,l,d,w,f);break}case"string":{const x=n.bufferSync(i),w=Cl(n.data.get(o.dataId).values[0]);g=qf(m,x,a,h,c,u,l,d,w,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const wWe={kernelName:Lk,backendName:"cpu",kernelFunc:xWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Jt(o,s.shape)[0],l=LT(s,i,a),u=new Array(s.shape.length).fill(0),c=s.shape.slice();return l.map(d=>{const h=[...c];h[a]=d;const f=_p({inputs:{x:s},backend:n,attrs:{begin:u,size:h}});return u[a]+=d,f})}const vWe={kernelName:zb,backendName:"cpu",kernelFunc:bWe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SWe={kernelName:zk,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;kt(n,"square");const s=r.data.get(n.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];i[a]=l*l}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CWe=Rn(gy,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),IWe={kernelName:gy,backendName:"cpu",kernelFunc:CWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r;kt(s,"stridedSlice");const{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:x,isSimpleSlice:w,begin:b,end:S,strides:C}=vT(s.shape,i,o,a,l,u,c,d,h);let T;if(g)T=Yn({inputs:{x:s},backend:n,attrs:{shape:m}});else if(x||w){ae(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const D=bT(b,S,C),P=_p({inputs:{x:s},backend:n,attrs:{begin:b,size:D}});T=Yn({inputs:{x:P},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(P)}else{const D=n.bufferSync(s),P=eZ(f,D,C,b);T=n.makeTensorInfo(m,P.dtype,P.values)}return T}const kWe={kernelName:Uk,backendName:"cpu",kernelFunc:NWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TWe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,h=n.data.get(c.dataId).values,f=n.data.get(d.dataId).values,[m,g]=tZ(h,f,s,i,o,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",g)]}const EWe={kernelName:Vk,backendName:"cpu",kernelFunc:TWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _We(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[u,c,d]=nZ(a,l,s),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const AWe={kernelName:CO,backendName:"cpu",kernelFunc:_We};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $We(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=rZ(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const RWe={kernelName:IO,backendName:"cpu",kernelFunc:$We};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MWe=Rn(fy,t=>Math.tan(t)),DWe={kernelName:fy,backendName:"cpu",kernelFunc:MWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OWe=Rn(py,t=>Math.tanh(t)),PWe={kernelName:py,backendName:"cpu",kernelFunc:OWe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FWe(t){const{inputs:e,backend:n}=t,{tensor:r,indices:s,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=Pu(i,s,r.shape),d=!1,h=n.bufferSync(s),f=n.bufferSync(i),m=n.bufferSync(r),g=qf(h,f,r.shape,c,l,a,o,u,m,d);return n.makeTensorInfo(r.shape,g.dtype,g.values)}const LWe={kernelName:Dk,backendName:"cpu",kernelFunc:FWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;kt(s,"tile");const o=iZ(n.bufferSync(s),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const BWe={kernelName:my,backendName:"cpu",kernelFunc:zWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r;kt(s,"topk");const a=n.data.get(s.dataId).values,[l,u]=aZ(a,s.shape,s.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const VWe={kernelName:jk,backendName:"cpu",kernelFunc:UWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jWe(t){const{inputs:e,attrs:n,backend:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=n,[c,d,h,f]=s.shape,[m,g]=u??[d,h],x=[c,m,g,f],w=$t(s.shape),b=w[0],S=w[1],C=w[2],T=$t(x),D=T[0],P=T[1],I=T[2],E=is(s.dtype,Ue(x));E.fill(l);const M=r.data.get(s.dataId).values,O=r.data.get(i.dataId).values;for(let R=0;R<c;++R){const z=i.shape[0]===1?O:O.subarray(R*8,R*8+8);for(let B=0;B<m;++B)for(let V=0;V<g;++V)for(let H=0;H<f;++H){let K;const ne=z[6]*V+z[7]*B+1;if(ne===0)continue;const fe=(z[0]*V+z[1]*B+z[2])/ne,ee=(z[3]*V+z[4]*B+z[5])/ne,de=Dj(fe,h,a),ge=Dj(ee,d,a);switch(o){case"nearest":K=qWe(M,d,h,b,S,C,R,ge,de,H,l);break;case"bilinear":K=XWe(M,d,h,b,S,C,R,ge,de,H,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const Z=R*D+B*P+V*I+H;E[Z]=K}return r.makeTensorInfo(x,s.dtype,E)}return{dataId:r.write(E,x,s.dtype),shape:s.shape,dtype:s.dtype}}const WWe={kernelName:Wk,backendName:"cpu",kernelFunc:jWe};function Dj(t,e,n){switch(n){case"reflect":return GWe(t,e);case"wrap":return HWe(t,e);case"nearest":return KWe(t,e);case"constant":default:return YWe(t)}}function GWe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return yp(0,n,e-1)}function HWe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return yp(0,n,e-1)}function YWe(t,e){return t}function KWe(t,e){return yp(0,t,e-1)}function lw(t,e,n,r,s,i,o,a,l,u,c){const d=o*r+a*s+l*i+u;return 0<=a&&a<e&&0<=l&&l<n?t[d]:c}function qWe(t,e,n,r,s,i,o,a,l,u,c){const d=Math.round(a),h=Math.round(l);return lw(t,e,n,r,s,i,o,d,h,u,c)}function XWe(t,e,n,r,s,i,o,a,l,u,c){const d=Math.floor(a),h=Math.floor(l),f=d+1,m=h+1,g=(m-l)*lw(t,e,n,r,s,i,o,d,h,u,c)+(l-h)*lw(t,e,n,r,s,i,o,d,m,u,c),x=(m-l)*lw(t,e,n,r,s,i,o,f,h,u,c)+(l-h)*lw(t,e,n,r,s,i,o,f,m,u,c);return(f-a)*g+(a-d)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZWe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;kt(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:u}=lZ(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const QWe={kernelName:NO,backendName:"cpu",kernelFunc:ZWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JWe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s.shape.length,a=s.shape[i],l=new Array(o-1);let u=0;for(let f=0;f<o;f++)f!==i&&(l[u++]=s.shape[f]);const c=new Array(o).fill(0),d=s.shape.slice();d[i]=1;const h=new Array(a);for(let f=0;f<h.length;f++){c[i]=f;const m=_p({inputs:{x:s},backend:n,attrs:{begin:c,size:d}});h[f]=Yn({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return h}const e9e={kernelName:Ub,backendName:"cpu",kernelFunc:JWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r;kt(s,"unsortedSegmentSum");const a=s.shape.length,l=i.shape.length,u=[],c=[],d=a-l;let h=i;for(let m=0;m<d;++m){const g=XI({inputs:{input:h},backend:n,attrs:{dim:m+1}});h=g,c.push(g)}for(let m=0;m<o;++m){const g=Ah(m,"int32"),x=n.makeTensorInfo([],"int32",g),w=CX({inputs:{a:x,b:h},backend:n}),b=xh({inputs:{x:w},backend:n,attrs:{dtype:"float32"}}),S=jT({inputs:{a:b,b:s},backend:n}),C=uv({inputs:{x:S},backend:n,attrs:{axis:0,keepDims:!1}});u.push(C),c.push(x),c.push(w),c.push(b),c.push(S),c.push(C)}const f=Tee({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const n9e={kernelName:Vb,backendName:"cpu",kernelFunc:t9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r9e=[ZUe,t3e,JUe,tVe,a3e,rVe,iVe,aVe,uVe,dVe,fVe,mVe,yVe,bVe,SVe,NVe,TVe,_Ve,$Ve,qUe,MVe,OVe,FVe,u3e,zVe,i3e,d3e,UVe,n3e,jVe,GVe,HVe,KVe,XVe,QVe,eje,nje,sje,oje,lje,cje,hje,pje,gje,yje,wje,vje,Cje,Ije,Nje,kje,Eje,$je,VUe,Mje,h3e,Uje,f3e,Vje,m3e,Kje,qje,Zje,y3e,w3e,Jje,t6e,r6e,i6e,v3e,C3e,r3e,a6e,WVe,u6e,d6e,f6e,jUe,N3e,T3e,m6e,_3e,y6e,b6e,S6e,N6e,T6e,_6e,A6e,$3e,R6e,D6e,P6e,L6e,B6e,V6e,W6e,M3e,H6e,q6e,Q6e,O3e,F3e,t8e,s8e,a8e,z3e,u8e,d8e,h8e,Eee,g8e,GUe,V3e,x8e,b8e,S8e,I8e,s3e,uM,k8e,HUe,YUe,KUe,E8e,A8e,R8e,D8e,P8e,F8e,z8e,X3e,U8e,H8e,K8e,Q8e,Q3e,eWe,nWe,sWe,J3e,X6e,aWe,uWe,dWe,fWe,mWe,yWe,wWe,vWe,n$e,SWe,s$e,o$e,IWe,kWe,EWe,AWe,RWe,c$e,_je,DWe,PWe,LWe,BWe,VWe,WWe,B3e,QWe,e9e,n9e,c8e];for(const t of r9e)kO(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vf={},oS={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function s9e(t,e){Vf[t]=e}function Al(t,e){if(!(t in Vf)||e!=null){const r=o9e(t,e);if(r!==null)Vf[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Vf[t];return n==null||n.isContextLost()?(delete Vf[t],Al(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Vf[t])}function i9e(t){if(!We().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function o9e(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??i9e(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Vf[t]},!1),We().getBool("SOFTWARE_WEBGL_ENABLED")&&(oS.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",oS)||n.getContext("experimental-webgl",oS):n.getContext("webgl2",oS)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var m1;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(m1||(m1={}));var jo;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(jo||(jo={}));var ks;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(ks||(ks={}));function cv(t,e){return[e,t]}function a9e(t,e){return t*e}function aS(t){const e=Ue(t),n=Math.ceil(e/4);return pR(n)}function ky(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function l9e(t,e){const[n,r]=ky(t,e);return n*r*4}function s4(t,e){const n=t;let r,s,i,o,a,l,u,c,d,h;return We().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bt(t,e){const n=e();return We().getBool("DEBUG")&&u9e(t),n}function u9e(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+f9e(t,e))}const c9e=596e-10,d9e=65504;function h9e(t){return!!(We().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||c9e<Math.abs(t)&&Math.abs(t)<d9e)}function f9e(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function lS(t,e){return zc(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function p9e(t,e){const n=zc(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(bt(t,()=>t.shaderSource(n,e)),bt(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function m9e(t,e){const n=zc(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(bt(t,()=>t.shaderSource(n,e)),bt(t,()=>t.compileShader(n)),We().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw _ee(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const g9e=/ERROR: [0-9]+:([0-9]+):/g;function _ee(t,e){const n=g9e.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),i=s.length.toString().length+2,o=s.map((d,h)=>$g((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${$g(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function y9e(t){return zc(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function x9e(t,e){if(bt(t,()=>t.linkProgram(e)),!We().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Y3(t,e){if(bt(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function w9e(t,e){const n=zc(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return bt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),bt(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function b9e(t,e){const n=zc(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return bt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),bt(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function v9e(t){return zc(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function S9e(t,e){const n=We().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function C9e(t){return zc(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function Oj(t,e,n,r,s,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(bt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),bt(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,i,o)),bt(t,()=>t.enableVertexAttribArray(a)),!0)}function I9e(t,e,n){_9e(t,n),bt(t,()=>t.activeTexture(t.TEXTURE0+n)),bt(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function N9e(t,e,n){return zc(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function k9e(t,e,n){return t.getUniformLocation(e,n)}function T9e(t,e,n,r){bt(t,()=>I9e(t,e,r)),bt(t,()=>t.uniform1i(n,r))}function K3(t,e,n){bt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),bt(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function Pj(t,e){bt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),bt(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function uS(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+E9e(t,e))}function E9e(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function zc(t,e,n){const r=bt(t,()=>e());if(r==null)throw new Error(n);return r}function _9e(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function s0(t,e=2){return Ue(t.slice(0,t.length-e))}function i0(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function cS(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[s0(t),...i0(t)]),e}function A9e(t,e=!1){let n=We().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=We().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&We().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?dO(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=_h(t).newShape);let s=Ue(t),i=null;t.length<=1&&s<=n?i=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=s0(t);let l=2,u=2;t.length&&([l,u]=i0(t)),s=a*(l/2)*(u/2),i=pR(s).map(c=>c*2)}else i=pR(s);return i}function dS(t){return t%2===0}function QI(t,e){if(t=t.slice(-2),e=e.slice(-2),nn(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||dS(n)&&dS(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&dS(t[0])&&dS(e[0])}let q3,X3;function $9e(t){if(q3==null){const e=Al(t);q3=e.getParameter(e.MAX_TEXTURE_SIZE)}return q3}function R9e(t){if(X3==null){const e=Al(t);X3=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,X3)}function M9e(t){if(t===0)return 0;let e;const n=Al(t);return Na(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Na(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Na(t,e){return t.getExtension(e)!=null}function Fj(t){try{if(Al(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function D9e(t){if(t===0)return!1;const e=Al(t);if(t===1){if(!Na(e,"OES_texture_float"))return!1}else if(!Na(e,"EXT_color_buffer_float"))return!1;return dM(e)}function O9e(t){if(t===0)return!1;const e=Al(t);if(t===1){if(!Na(e,"OES_texture_float")||!Na(e,"WEBGL_color_buffer_float"))return!1}else{if(Na(e,"EXT_color_buffer_float"))return dM(e);const r="EXT_color_buffer_half_float";if(Na(e,r)){const s=e.getExtension(r);return P9e(e,s)}return!1}return dM(e)}function dM(t){const e=s4(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function P9e(t,e){const n=s4(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),a}function F9e(t){return t!==2?!1:Al(t).fenceSync!=null}function dv(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&ae(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Et=We();Et.registerFlag("HAS_WEBGL",()=>Et.getNumber("WEBGL_VERSION")>0);Et.registerFlag("WEBGL_VERSION",()=>Fj(2)?2:Fj(1)?1:0);Et.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Et.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Et.get("WEBGL_VERSION")===2);Et.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Et.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Et.registerFlag("WEBGL_PACK",()=>Et.getBool("HAS_WEBGL"));Et.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_CLIP",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_REDUCE",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_LAZILY_UNPACK",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_CONV_IM2COL",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>$9e(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>R9e(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Et.getNumber("WEBGL_VERSION");return t===0?0:M9e(t)});Et.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Et.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!GY());Et.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>D9e(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Et.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Et.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Et.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>O9e(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_FENCE_API_ENABLED",()=>F9e(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Et.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Et.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Et.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>GY()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Et.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Et.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Et.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Et.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Et.registerFlag("WEBGL_EXP_CONV",()=>!1);Et.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Et.getBool("IS_TEST"));Et.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Et.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Et.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Et.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Si(){let t,e,n,r,s,i,o,a,l,u;return We().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=We().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(t,e,n="index"){const r=$t(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / ${s}`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s}`:`index -= ${t[i]} * ${s}`;return`${o}; ${a};`}).join("")}function nE(t,e,n="index"){const r=$t(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function L9e(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let i=n-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function z9e(t,e,n="index"){const r=t.map((i,o)=>o),s=L9e(r,e);return s.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${s[o]}`,l=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s[o]}`:`index -= ${t[o]} * ${s[o]}`;return`${a}; ${l};`}).join("")}function i4(t){const e=$t(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function o4(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const Aee=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:$ee}=vTe;function B9e(t,e,n){const r=[];if(t.forEach(f=>{const m=Ue(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${m>1?`[${m}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=a4(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=r.join(`
`),i=t.map(f=>U9e(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=Si(),l=W9e(a);let u,c,d=Y9e(a);return e.isPacked?(u=V9e(e.logicalShape,o,n.enableShapeUniforms),c=H9e(a)):(u=j9e(e.logicalShape,o,n.enableShapeUniforms),c=G9e(a)),n.packedInputs&&(d+=Z9e),[d,l,c,s,u,i,n.userCode].join(`
`)}function Ty(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return uGe(t,e);case 1:return dGe(t,e);case 2:return fGe(t,e);case 3:return mGe(t,e);case 4:return yGe(t,e);case 5:return xGe(t);case 6:return wGe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function Ree(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return lGe(t);case 1:return cGe(t,e);case 2:return hGe(t,e);case 3:return pGe(t,e);default:return gGe(t,e)}}function U9e(t,e,n=!1,r){let s="";n?s+=Ree(t,r):s+=Ty(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?s+=bGe(t,e):s+=vGe(t,e)),s}function V9e(t,e,n){switch(t.length){case 0:return Mee();case 1:return Q9e(t,e,n);case 2:return oGe(t,e,n);case 3:return eGe(t,e,n);default:return nGe(t,e,n)}}function j9e(t,e,n){switch(t.length){case 0:return Mee();case 1:return J9e(t,e,n);case 2:return aGe(t,e,n);case 3:return tGe(t,e,n);case 4:return rGe(t,e,n);case 5:return sGe(t,e);case 6:return iGe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function W9e(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function G9e(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function H9e(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Y9e(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${K9e}
    ${q9e}
    ${X9e}
  `}const K9e=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,q9e=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,X9e=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Z9e=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Mee(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Q9e(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function J9e(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function eGe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),i=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function tGe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${nE(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=Qp(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function nGe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),i=s*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],a=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function rGe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${nE(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Qp(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function sGe(t,e){const n=Qp(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function iGe(t,e){const n=Qp(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function oGe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(nn(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function aGe(t,e,n){return nn(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Jp(t){return`offset${t}`}function lGe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Si();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function uGe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,i]=t.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Jp(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function cGe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,i=Si();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function dGe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Ey(t)}
      }
    `;const s=t.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Jp(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function hGe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=Si();if(i!=null&&nn(n,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function fGe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&nn(n,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=i[0],f=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=_h(n),l=o;if(l.length<n.length){const h=_y(t,l),f=["row","col"];return`
      ${Ty(h,e)}
      float ${s}(int row, int col) {
        return ${s}(${Ay(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Ey(t)}
      }
    `;const u=i[0],c=i[1],d=Jp(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function pGe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],m=_y(t,h),g=["b","row","col"];return`
        ${Ree(m,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Ay(g,f)});
        }
      `}const a=Si();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function mGe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=_h(n),u=a;if(u.length<n.length){const g=_y(t,u),x=["row","col","depth"];return`
        ${Ty(g,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Ay(x,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Ey(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],h=c[1],f=t.shapeInfo.flatOffset;if(h===i&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const m=Jp(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${m};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function gGe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=Si();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",m=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<o-1;g++)f=`int b${g}, `+f,h*=i[o-g-1],m=`b${g} * ${h} + `+m;return`
    vec4 ${r}(${f}) {
      int index = ${m};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function yGe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:u}=_h(n);if(l.length<n.length){const b=_y(t,l),S=["row","col","depth","depth2"];return`
      ${Ty(b,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Ay(S,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Ey(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],m=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,x=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${m}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===i&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const w=Jp(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${g}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${w});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${w});
      return sampleTexture(${r}, uv);
    }
  `}function xGe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:u}=_h(e);if(l.length<e.length){const g=_y(t,l),x=["row","col","depth","depth2","depth3"];return`
      ${Ty(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Ay(x,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${Ey(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Jp(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${m};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function wGe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:i}=_h(e);if(s.length<e.length){const x=_y(t,s),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${Ty(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Ay(w,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Ey(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],m=h[1];if(m===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Jp(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ey(t){const e=t.name,n=Ue(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function bGe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=$ee(t.shapeInfo.logicalShape,e.logicalShape),l=Ln(o),u=o-i;let c;const d=["x","y","z","w","u","v"];i===0?c="":o<2&&a.length>=1?c="coords = 0;":c=a.map(b=>`coords.${d[b+u]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((b,S)=>`coords.${d[S+u]}`).join(", ");let f="return outputValue;";const g=Ue(t.shapeInfo.logicalShape)===1,w=Ue(e.logicalShape)===1;if(i===1&&!g&&!w)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!w)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const b=i-2,S=i-1;a.indexOf(b)>-1&&a.indexOf(S)>-1?f="return vec4(outputValue.x);":a.indexOf(b)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(S)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${h});
      ${f}
    }
  `}function vGe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&nn(o,i))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=Ln(l),c=$ee(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(g=>`coords.${f[g+d]} = 0;`).join(`
`);let m="";return l<2&&a>0?m="coords":m=t.shapeInfo.logicalShape.map((g,x)=>`coords.${f[x+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${r}(${m});
    }
  `}function Ln(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function a4(t,e,n){const{newShape:r,keptDims:s}=_h(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):r,l=!t&&i>1&&!nn(e,n)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function _y(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Ay(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SGe(t,e,n,r){const s=n.map((c,d)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=s.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=B9e(s,o,e),l=m9e(t.gl,a),u=t.createProgram(l);return We().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o},Dee(t,e,u)))}function Dee(t,e,n){const r=[],s=[];let i,o,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),We().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,c),h.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),o=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function Lj(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,i=e[r],o=i.shape;if(!nn(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!nn(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function CGe(t,e,n,r,s){e.program.enableShapeUniforms||(Lj(e.inShapeInfos,n),Lj([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),We().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:m}=a4(e.program.packedInputs,u.shape,u.texData.texShape);switch(m.length){case 1:t.gl.uniform1iv(h,new Int32Array(m));break;case 2:t.gl.uniform2iv(h,new Int32Array(m));break;case 3:t.gl.uniform3iv(h,new Int32Array(m));break;case 4:t.gl.uniform4iv(h,new Int32Array(m));break}}if(f&&t.gl.uniform2i(f,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(Ue(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let m=u.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),t.gl.uniform1fv(c,m)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=$t(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=s[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function IGe(t,e,n){let r="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=a4(t.packedInputs,o.shape,l);let h="",f="",m="";if(c.length===1&&t.packedInputs){const T=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${T[0]>1}_${T[1]>1}`}else if(c.length===2&&!t.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const T=$t(c);m=`${T[0]===l[1]}_${T[T.length-1]===l[1]}`}const g=o.shape.length,x=c.length===2&&nn(o.shape,l),w=Ue(o.shape)===1,b=gh(o.shape,n.shape),S=!t.packedInputs&&g===n.shape.length&&nn(l,n.texData.texShape),C=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${S}_${u?d:""}_${c.length}_${w}_${b}_${x}_${h}_${f}_${m}_${C}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${a}`}});const s=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+s+`${We().getNumber("WEBGL_VERSION")}`,i}function Hs(t){return We().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NGe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=m1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Si();this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?nE(["r","c","d"],e):Qp(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kGe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=m1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Si();this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?nE(["r","c","d"],e):Qp(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TGe{constructor(e){this.variableNames=["A"],this.outTexUsage=jo.DOWNLOAD;const n=Si();this.outputShape=e,this.userCode=`
      ${Aee}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EGe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=jo.DOWNLOAD;const n=Si();this.outputShape=e,this.userCode=`
      ${Aee}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ge={R:0,G:1,B:2,A:3};class zj{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Si();this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const l=r[a];o+=`
          if(offset == ${a}) {
            result = values[${_Ge[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?o4():i4(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AGe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Si();this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length);let s="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?o4():i4(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ge(t){const e=Si(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return p9e(t,n)}function RGe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return w9e(t,e)}function MGe(t){const e=new Uint16Array([0,1,2,2,1,3]);return b9e(t,e)}function hv(t,e,n,r,s,i){S9e(e,n);const o=v9e(t),a=t.TEXTURE_2D;return bt(t,()=>t.bindTexture(a,o)),bt(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),bt(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),bt(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),bt(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),We().getNumber("WEBGL_VERSION")===1?bt(t,()=>t.texImage2D(a,0,r,e,n,0,s,i,null)):bt(t,()=>t.texStorage2D(a,1,r,e,n)),bt(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function Oee(t){return t.internalFormatFloat}function DGe(t,e,n,r){const[s,i]=cv(e,n);return hv(t,s,i,Oee(r),r.textureFormatFloat,t.FLOAT)}function Pee(t){return t.internalFormatHalfFloat}function OGe(t,e,n,r){const[s,i]=cv(e,n);return hv(t,s,i,Pee(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Fee(t){return t.downloadTextureFormat}function PGe(t,e,n,r){const[s,i]=cv(e,n);return hv(t,s,i,Fee(r),t.RGBA,t.UNSIGNED_BYTE)}function Lee(t){return t.internalFormatPackedFloat}function FGe(t,e,n,r){const[s,i]=ky(e,n);return hv(t,s,i,Lee(r),t.RGBA,t.FLOAT)}function zee(t){return t.internalFormatPackedHalfFloat}function LGe(t,e,n,r){const[s,i]=ky(e,n);return hv(t,s,i,zee(r),t.RGBA,r.textureTypeHalfFloat)}function zGe(t,e,n){return bt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Oj(t,e,"clipSpacePos",n,3,20,0)&&Oj(t,e,"uv",n,2,20,12)}function BGe(t,e,n,r,s,i){bt(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;s instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*r*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(s),We().getNumber("WEBGL_VERSION")===2?bt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,o)):bt(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,o)),bt(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function UGe(t,e,n){bt(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?We().getNumber("WEBGL_VERSION")===2?bt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):bt(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):We().getNumber("WEBGL_VERSION")===2?bt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):bt(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),bt(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function VGe(t,e,n,r){const s=t.createBuffer();bt(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return bt(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),bt(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),bt(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function jGe(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function WGe(t,e,n,r){const[s,i]=cv(e,n),o=4,a=new Uint8Array(a9e(e*n,o));return bt(t,()=>t.readPixels(0,0,s,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function GGe(t,e,n,r,s,i,o,a){const l=t,u=new Float32Array(l9e(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function HGe(t,e,n){const r=new Float32Array(e*n*4);return bt(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z3{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=We().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,s9e(n,e)):this.gl=Al(n),e=this.gl,We().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>bt(i,()=>i.createVertexArray()),this.bindVertexArray=o=>bt(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>bt(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>bt(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>bt(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>bt(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>bt(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>bt(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),We().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=lS(this.gl,i),Na(this.gl,o))this.textureHalfFloatExtension=lS(this.gl,o);else if(We().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Na(this.gl,s))this.colorBufferHalfFloatExtension=lS(this.gl,s);else if(We().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Na(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Na(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=RGe(this.gl),this.indexBuffer=MGe(this.gl),this.framebuffer=C9e(this.gl),this.textureConfig=s4(this.gl,this.textureHalfFloatExtension)}get debug(){return We().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;bt(e,()=>e.finish()),bt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),bt(e,()=>e.deleteFramebuffer(this.framebuffer)),bt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),bt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),bt(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),DGe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),OGe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),PGe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),UGe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),BGe(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),LGe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),FGe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(Pj(this.gl,this.framebuffer),this.outputTexture=null),bt(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>WGe(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,i,o){return GGe(this.gl,e,n,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return jGe(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=VGe(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(We().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},n=i}else We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>HGe(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=$Ge(n));const r=y9e(n);bt(n,()=>n.attachShader(r,this.vertexShader)),bt(n,()=>n.attachShader(r,e)),x9e(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Y3(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;bt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),zGe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(bt(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Y3(this.gl,this.program),bt(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?N9e(this.gl,e,n):k9e(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),bt(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),T9e(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,i]=ky(n,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Y3(this.gl,this.program),uS(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}bt(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),bt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=lS(this.gl,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await IU(()=>this.disposed||this.isQueryAvailable(e,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=YGe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in We().platform&&(r=We().platform.setTimeoutCustom.bind(We().platform)),IU(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),K3(this.gl,e,this.framebuffer),this.debug&&uS(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(K3(this.gl,this.outputTexture,this.framebuffer),this.debug&&uS(this.gl)):Pj(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;K3(s,e,this.framebuffer),this.debug&&uS(s),this.outputTexture=e,bt(s,()=>s.viewport(0,0,n,r)),bt(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),bt(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function YGe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:KGe,bincountImpl:Bee,bincountReduceImpl:qGe,bitwiseAndImpl:XGe,castImpl:ZGe,ceilImpl:QGe,concatImpl:JGe,equalImpl:e7e,expImpl:t7e,expm1Impl:n7e,floorImpl:r7e,gatherNdImpl:s7e,gatherV2Impl:i7e,greaterImpl:o7e,greaterEqualImpl:a7e,lessImpl:l7e,lessEqualImpl:u7e,linSpaceImpl:c7e,logImpl:d7e,maxImpl:h7e,maximumImpl:f7e,minimumImpl:p7e,multiplyImpl:m7e,negImpl:g7e,notEqualImpl:y7e,prodImpl:x7e,raggedGatherImpl:w7e,raggedRangeImpl:b7e,raggedTensorToTensorImpl:v7e,rangeImpl:S7e,rsqrtImpl:C7e,scatterImpl:I7e,sigmoidImpl:N7e,simpleAbsImpl:Uee,sliceImpl:k7e,sparseFillEmptyRowsImpl:T7e,sparseReshapeImpl:E7e,sparseSegmentReductionImpl:Vee,sqrtImpl:_7e,staticRegexReplaceImpl:A7e,stridedSliceImpl:$7e,stringNGramsImpl:R7e,stringSplitImpl:M7e,stringToHashBucketFastImpl:D7e,subImpl:O7e,tileImpl:P7e,topKImpl:F7e,transposeImpl:l4,uniqueImpl:L7e}=uZ;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function mi(t,e){return e===1?[t]:jee(t,e)}function z7e(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B7e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Hs(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=mi("rc",this.rank),r=Ln(this.rank),s=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wee{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${U7e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?o4():i4(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function U7e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?z9e(["r","c","d"],"inputShape"):Qp(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V7e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=Uj(n,r),i=Vj(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=Bj(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return s===ks.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===ks.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===ks.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===ks.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===ks.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const i=Uj(r,s),o=Vj(n,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=Bj(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=We().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[o],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function j7e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function Bj(t,e,n,r,s){const i=W7e(e,r);let o;if(s){const[l,u]=ky(t[0],t[1]);o=l*u}else{const[l,u]=cv(t[0],t[1]);o=l*u}const a=j7e(n,i);return o*a}function W7e(t,e){switch(t){case ks.PACKED_2X2_FLOAT32:return Lee(e);case ks.PACKED_2X2_FLOAT16:return zee(e);case ks.UNPACKED_FLOAT32:return Oee(e);case ks.UNPACKED_FLOAT16:return Pee(e);case ks.PACKED_4X1_UNSIGNED_BYTE:return Fee(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function G7e(t){return We().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?ks.PACKED_2X2_FLOAT32:ks.UNPACKED_FLOAT32:t?ks.PACKED_2X2_FLOAT16:ks.UNPACKED_FLOAT16}function Uj(t,e){if(t===jo.UPLOAD)return ks.PACKED_2X2_FLOAT32;if(t===jo.RENDER||t==null)return G7e(e);if(t===jo.DOWNLOAD||t===jo.PIXELS)return ks.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function Vj(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pu{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Va="if (isnan(x)) return x;",H7e="return x;",jj="return abs(x);",Y7e="return (x >= 0.0) ? x : (exp(x) - 1.0);",K7e=Va+`
  return (x < 0.0) ? 0.0 : x;
`,q7e=Va+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ud="return x;",X7e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z7e="return x;",Q7e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,J7e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,eHe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,tHe="return 1.0 / (1.0 + exp(-1.0 * x));";class qd{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nHe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length);const n=e.length,r=mi("rc",n),s=Ln(n),i=z7e(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rHe=aP,sHe=1e-7,iHe=1e-4,hS={};function oHe(t){return t in hS||(hS[t]={}),hS[t]}const aHe=We().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),lHe=600;function uHe(){return We().global.screen==null?1024:We().global.screen.height*We().global.screen.width*window.devicePixelRatio*lHe/1024/1024}class rE extends KN{nextDataId(){return rE.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!We().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Z3)n=e;else{const r=Al(We().getNumber("WEBGL_VERSION"),e);n=new Z3(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Al(We().getNumber("WEBGL_VERSION"));n=new Z3(r),this.binaryCache=oHe(We().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new V7e(this.gpgpu),this.numMBBeforeWarning=uHe(),this.texData=new cO(this,ci())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,i,o){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,i]},l.texShape=[s,i];const u=cS(n),c=new zj(u,!1,o),d=this.runWebGLProgram(c,[a],r,[[s,i]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((We().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||We().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:jo.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,i){if(We().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:jo.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let h;l?h=new qd(a,Ud):h=new pu(a,Ud);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:s}],s),m=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),m}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Oi());let d;if(s==="complex64"){const h=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=kl(h,f)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Oi()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const m=this.pendingRead.get(e);return new Promise(g=>m.push(g))}const n=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let m;l?m=new qd(s,Ud):m=new pu(s,Ud);const g=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:o}],o),x=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),x}if(r!=null)return this.convertAndCacheOnCPU(e);if(We().getBool("DEBUG")&&!We().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&We().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(o!=="complex64"&&We().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const m=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...aS(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const m=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=m[0],x=m[1];d=kl(g,x)}else if(u==null)d=this.getValuesFromTexture(e);else{const m=Ue(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const m=this.gpgpu.gl;bt(m,()=>m.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(m=>m(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ci().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new qd(i,Ud):f=new pu(i,Ud);const m=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),g=this.readToGPU(m,n);return this.disposeIntermediateTensorInfo(m),g}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=ci().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Cl(s));return Zt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Zt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!h9e(r))throw We().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),i=Ue(n);if(We().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...aS(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),m}const o=We().getBool("WEBGL_PACK")&&s===!0,a=o?cS(n):n,l=o?new EGe(a):new TGe(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=$c(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=$c(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=EY(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Oi(),endMs:null}}endTimer(e){return We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Oi(),e)}async getQueryTime(e){if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,i,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=aHe){return We().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Ue(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Uo("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return rHe(e.shape,n)}packedUnaryOp(e,n,r){const s=new qd(e.shape,n),i=this.compileAndRun(s,[e],r);return ci().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=Uee(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(We().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,jj,e.dtype);const n=new pu(e.shape,jj),r=this.compileAndRun(n,[e]);return ci().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&b0(r[0])){const i=r.map(o=>Cc(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return ci().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new nHe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new B7e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[s0(e.shape),...i0(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[s0(n),...i0(n)],o=new Wee(i,r),a=!0,l=[r],u=this.runWebGLProgram(o,[s],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(n!=null){const h=Ue(i),f=n[0]*n[1]*4;ae(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=cS(i);let l;s?l=new kGe(a):l=new NGe(a);const u=!0,c=[n??aS(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,c,u,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===m1.DENSE){const w=o??aS(e.outputShape);l.texShape=w.map(b=>b*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Ue(a.shape)===0)return l.values=is(a.dtype,0),a;const u=[],c=n.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(w.dataId);if(b.texture==null){if(!e.packedInputs&&Ue(w.shape)<=We().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!b.isPacked!=!!e.packedInputs)w=b.isPacked?this.unpackTensor(w):this.packTensor(w),u.push(w),b=this.texData.get(w.dataId);else if(b.isPacked&&!QI(b.shape,w.shape)){const S=w,C=w.shape;w.shape=b.shape,w=this.packedReshape(w,C),u.push(w),b=this.texData.get(w.dataId),S.shape=C}return{shape:w.shape,texData:b,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=IGe(e,c,d),f=this.getAndSaveBinary(h,()=>SGe(this.gpgpu,e,c,d)),m=this.activeTimers!=null;let g;m&&(g=this.startTimer()),We().get("ENGINE_COMPILE_ONLY")||CGe(this.gpgpu,f,c,d,s),u.forEach(w=>this.disposeIntermediateTensorInfo(w)),m&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const x=We().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const w=Oi();w-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!We().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const w=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),w}return a}compileAndRun(e,n,r,s,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(We().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ve(()=>{if(!We().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=We().getBool("DEBUG");We().set("DEBUG",!1);const n=this.abs(Mt(1e-8)).dataSync()[0];if(We().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?sHe:iHe}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Oi());let d=n.texShape;if(d==null&&(d=A9e(r,l),n.texShape=d),i!=null){const h=cS(r);let f,m=d[1],g=d[0];const x=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!x)&&([m,g]=ky(d[0],d[1])),l?f=new AGe(h,x):f=new zj(h,x);const w=x?[g,m]:d,b=this.makeTensorInfo(w,s),S=this.texData.get(b.dataId);x?S.usage=jo.PIXELS:S.usage=jo.UPLOAD,S.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,g,i);const C=[[g,m]],D=this.runWebGLProgram(f,[b],s,C,!0),P=this.texData.get(D.dataId);n.texShape=P.texShape,n.isPacked=P.isPacked,n.usage=P.usage,We().get("ENGINE_COMPILE_ONLY")?this.disposeData(D.dataId):(n.texture=P.texture,n.values=null,this.texData.delete(D.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=Oi()-c)}else{const h=this.acquireTexture(d,a,s,l);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=cHe(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*SI(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await Pq(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(_ee(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=Dee(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,l=ci().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,i,o,a);return ci().makeTensorFromDataId(u,n,r,l)}}rE.nextDataId=0;function cHe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */HY()&&TO("webgl",()=>new rE,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u4=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class $p{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=jt(n,r),this.enableShapeUniforms=Hs(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const em=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class $y{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=jt(n,r);const i=this.outputShape.length;this.enableShapeUniforms=Hs(i);let o="";if(s)if(i===0||Ue(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${Ln(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=mi("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vo(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const dHe={kernelName:V0,backendName:"webgl",kernelFunc:vo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zh(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),a=vo({inputs:{x:r},backend:n}),l=vo({inputs:{x:s},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const hHe={kernelName:nk,backendName:"webgl",kernelFunc:zh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gee="return (a < 0.) ? b * a : a;",Hee=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function fHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",Ah(i,"float32")),a=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $y(Hee,s.shape,o.shape):new $p(Gee,s.shape,o.shape),l=n.runWebGLProgram(a,[s,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const pHe={kernelName:cb,backendName:"webgl",kernelFunc:fHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yee="return (a < 0.) ? b * a : a;",Kee=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function mHe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $y(Kee,r.shape,s.shape):new $p(Yee,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],"float32")}const gHe={kernelName:_b,backendName:"webgl",kernelFunc:mHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ry="if (isnan(x)) return x;";function bn({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,l=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,l);return a.makeTensorInfo(o.shape,l,h)}const u=We().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new qd(o.shape,e):c=new pu(o.shape,t),a.runWebGLProgram(c,[o],l)}}function Ms({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:u}=o,c=a;if(r&&l.dtype==="complex64"){const m=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[x,w]=[[m.complexTensorInfos.real,g.complexTensorInfos.real],[m.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(S=>{const[C,T]=S,D={dataId:C.dataId,dtype:C.dtype,shape:l.shape},P={dataId:T.dataId,dtype:T.dtype,shape:u.shape},I=new $p(t,l.shape,u.shape);return c.runWebGLProgram(I,[D,P],ws(C.dtype,T.dtype))}),b=zh({inputs:{real:x,imag:w},backend:c});return c.disposeIntermediateTensorInfo(x),c.disposeIntermediateTensorInfo(w),b}const d=i||ws(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const m=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,x=l.dtype==="string"?Tl(m):m,w=l.dtype==="string"?Tl(g):g,[b,S]=s(l.shape,u.shape,x,w,d),C=c.makeTensorInfo(S,d),T=c.texData.get(C.dataId);return T.values=b,C}const h=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new $y(e,l.shape,u.shape,n):f=new $p(t,l.shape,u.shape),c.runWebGLProgram(f,[l,u],d)}}function g1(t,e=!1){if(t==="linear")return e?Z7e:H7e;if(t==="relu")return e?J7e:K7e;if(t==="elu")return e?Q7e:Y7e;if(t==="relu6")return e?eHe:q7e;if(t==="prelu")return e?Kee:Yee;if(t==="leakyrelu")return e?Hee:Gee;if(t==="sigmoid")return e?tHe:X7e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qee{constructor(e,n,r,s=!1,i=!1,o=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Hs(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),h=s?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",m=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",w="";a&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:x=`vec4 activation(vec4 x) {
          ${a}
        }`,w="result = activation(result);");const b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let S="rc.x",C="rc.x";e[0]<n[0]?S=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(C=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${S};
        int batchB = ${C};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${g[0]});
          result += (${m[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wj={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Gj{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=jt(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hj="return a * b;";function c4(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=ws(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new Gj(Wj.REAL,r.shape,s.shape),c=new Gj(Wj.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],h=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),m=zh({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=m7e(r.shape,s.shape,a.values,l.values,i),d=n.makeTensorInfo(c,i),h=n.texData.get(d.dataId);return h.values=u,d}let o;return We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new $y(Hj,r.shape,s.shape):o=new $p(Hj,r.shape,s.shape),n.runWebGLProgram(o,[r,s],i)}const yHe={kernelName:Z0,backendName:"webgl",kernelFunc:c4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xHe(t,e,n){const r=[s0(t.shape),...i0(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},i=[s0(e),...i0(e)],o=new Wee(i,r),a=!0,l=[r],u=n.runWebGLProgram(o,[s],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pt(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=n,a=Ue(s.shape),l=hO(i,a),u=Ue(l);ae(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(s.dataId);return c.isPacked&&!QI(s.shape,l)&&!(c.texture!==null&&QI(c.shape,l))?xHe(s,l,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const wHe={kernelName:$b,backendName:"webgl",kernelFunc:pt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yj{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Yg(d)?d.toPrecision(2):d}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bHe{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vHe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=CT(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function tm(t,e,n,r){const s=vHe(t.shape);let i=t;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:l,outSize:u}=s[o];let c,d;n==="mean"?c=o===0?new Yj({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new Yj({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new bHe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=i,i=r.runWebGLProgram(c,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SHe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const s=Ln(this.rank),i=CHe(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function CHe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IHe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=Ln(this.rank),i=jee("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=i[c];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sE(t,e,n){const r=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IHe(t.shape,e):new SHe(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NHe(t,e,n,r){const s=e,i=t.shape.length,o=Jt(s,t.shape);let a=o;const l=zn(a,i),u=l!=null;let c=t;u&&(c=sE(t,l,r),a=qn(a.length,i)),Wr("sum",a,i);const[d,h]=$r(c.shape,a);let f=d;n&&(f=Cr(d,o));const m=Ue(h),x=Ue(t.shape)/m,w=pt({inputs:{x:c},attrs:{shape:[x,m]},backend:r}),b=Yk(t.dtype),S=tm(w,b,"sum",r),C=pt({inputs:{x:S},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(S),u&&r.disposeIntermediateTensorInfo(c),C}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iE(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return NHe(s,i,o,n)}const kHe={kernelName:Fb,backendName:"webgl",kernelFunc:iE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bi(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,o=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[i[c]];let u;if(o.shouldExecuteOnCPU([s])){const d=o.texData.get(s.dataId).values,h=l4(d,s.shape,s.dtype,i,l);u=o.makeTensorInfo(l,s.dtype);const f=o.texData.get(u.dataId);f.values=h}else u=sE(s,i,o);return u}const THe={kernelName:tp,backendName:"webgl",kernelFunc:bi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xee=1e3;function JI({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],f=n?t.shape[u-1]:t.shape[u-2],m=r?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),x=e.shape.slice(0,-2),w=Ue(g),b=Ue(x),C=jt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,m]);ae(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const T=n?[w,d,f]:[w,f,d],D=r?[b,m,h]:[b,h,m],P=pt({inputs:{x:t},backend:s,attrs:{shape:T}}),I=pt({inputs:{x:e},backend:s,attrs:{shape:D}}),E=[P,I],M=Math.max(w,b),O=n?P.shape[1]:P.shape[2],j=i!=null,R=o!=null,z=l==="leakyrelu",B=l!=null?g1(l,!0):null,V=j||R||z||B!=null;let H;if((f===1||m===1)&&O>Xee&&V===!1){let ne=P,fe=I;n&&(ne=bi({inputs:{x:P},backend:s,attrs:{perm:[0,2,1]}}),E.push(ne)),r&&(fe=bi({inputs:{x:I},backend:s,attrs:{perm:[0,2,1]}}),E.push(fe));const ee=m!==1,de=m===1;let ge=ne;ee&&(ge=pt({inputs:{x:ne},backend:s,attrs:{shape:[M,O,1]}}),E.push(ge));const Z=m===1?2:1;let we=fe;de&&(we=pt({inputs:{x:fe},backend:s,attrs:{shape:[M,1,O]}}),E.push(we));const Ee=c4({inputs:{a:ge,b:we},backend:s});H=iE({inputs:{x:Ee},backend:s,attrs:{axis:Z,keepDims:!0}}),E.push(Ee)}else{const ne=ws(t.dtype,e.dtype),fe=new qee(T,D,[M,f,m],n,r,j,B,R,z),ee=[P,I];if(i!=null&&ee.push(i),R&&ee.push(o),z){const de=s.makeTensorInfo([],"float32",Ah(a,"float32"));ee.push(de),E.push(de)}H=s.runWebGLProgram(fe,ee,ne)}const K=pt({inputs:{x:H},backend:s,attrs:{shape:C}});E.push(H);for(const ne of E)s.disposeIntermediateTensorInfo(ne);return K}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EHe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return JI({a:s,b:i,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const _He={kernelName:Zw,backendName:"webgl",kernelFunc:EHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kj="return abs(x);";function AHe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=Uee(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let s;return We().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new qd(r.shape,Kj):s=new pu(r.shape,Kj),n.runWebGLProgram(s,[r],r.dtype)}const $He={kernelName:j1,backendName:"webgl",kernelFunc:AHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RHe=Va+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,MHe=bn({opSnippet:RHe}),DHe={kernelName:S0,backendName:"webgl",kernelFunc:MHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OHe=Va+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,PHe=bn({opSnippet:OHe}),FHe={kernelName:C0,backendName:"webgl",kernelFunc:PHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qj="return a + b;",LHe=Ms({opSnippet:qj,packedOpSnippet:qj,supportsComplex:!0,cpuKernelImpl:KGe}),zHe={kernelName:Bp,backendName:"webgl",kernelFunc:LHe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BHe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UHe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PC(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return vo({inputs:{x:r[0]},backend:n});if(r.length>We().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=PC({inputs:r.slice(0,l),backend:n}),c=PC({inputs:r.slice(l),backend:n});return PC({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>ws(l,u)),i=r.map(l=>l.shape),a=We().getBool("WEBGL_PACK")?new UHe(r[0].shape,i):new BHe(r[0].shape,i);return n.runWebGLProgram(a,r,s)}const VHe={kernelName:W1,backendName:"webgl",kernelFunc:PC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Jt(i,s.shape);let u=l;const c=zn(u,a);let d=s;c!=null&&(d=bi({inputs:{x:s},backend:n,attrs:{perm:c}}),u=qn(u.length,a)),Wr("all",u,a);const[h,f]=$r(d.shape,u),m=Ue(f),g=pt({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),x=tm(g,g.dtype,"all",n);let w;if(o){const b=Cr(h,l);w=pt({inputs:{x},backend:n,attrs:{shape:b}})}else w=pt({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),w}const WHe={kernelName:qN,backendName:"webgl",kernelFunc:jHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Jt(i,s.shape);let u=l;const c=zn(u,a);let d=s;c!=null&&(d=bi({inputs:{x:s},backend:n,attrs:{perm:c}}),u=qn(u.length,a)),Wr("any",u,a);const[h,f]=$r(d.shape,u),m=Ue(f),g=pt({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),x=tm(g,g.dtype,"any",n);let w;if(o){const b=Cr(h,l);w=pt({inputs:{x},backend:n,attrs:{shape:b}})}else w=pt({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),w}const HHe={kernelName:XN,backendName:"webgl",kernelFunc:GHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YHe{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KHe{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ae(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=Ln(l),c=mi("coords",l);let d,h;if(o===1){h=l+1;const I=Ln(h);d=`
        ${I} sourceLocR = ${I}(${c.join()}, 0);
        ++${c[l-1]};
        ${I} sourceLocG = ${I}(${c.join()}, 0);
        ++${c[l-2]};
        ${I} sourceLocA = ${I}(${c.join()}, 0);
        --${c[l-1]};
        ${I} sourceLocB = ${I}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),m="."+f[h-1],g=f.map(I=>"int "+I),x=mi("sourceLocR",h-1).concat("inIdx.r"),w=mi("sourceLocG",h-1).concat("inIdx.g"),b=mi("sourceLocB",h-1).concat("inIdx.b"),S=mi("sourceLocA",h-1).concat("inIdx.a"),C=r==="max"?"greaterThan":"lessThan",T=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${S.join()})));`,D=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${S.join()}) : 0.)`,P=s?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${P}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${D};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${T}
          vec4 candidate = ${D};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${C}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e,n,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=CT(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},l=new YHe(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=Zee(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function Qee(t,e,n,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=CT(i),a=new KHe(s,o,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=Qee(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function Jee(t,e,n,r){const s=[n];if(Wr("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!We().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[u,c]=$r(l.shape,s),d=Ue(c),h=pt({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(h);const f=Zee(t,h,r);i.push(f);const m=pt({inputs:{x:f},backend:t,attrs:{shape:u}});return i.forEach(g=>t.disposeIntermediateTensorInfo(g)),m}return Qee(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Jt(i,s.shape);const a=zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=bi({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=qn(o.length,l.shape.length)),Wr("argMax",[o[0]],l.shape.length);const c=Jee(n,l,o[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const XHe={kernelName:G1,backendName:"webgl",kernelFunc:qHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Jt(i,s.shape);const a=zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=bi({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=qn(o.length,l.shape.length)),Wr("argMin",[o[0]],l.shape.length);const c=Jee(n,l,o[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const QHe={kernelName:H1,backendName:"webgl",kernelFunc:ZHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JHe=Va+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,eYe=bn({opSnippet:JHe}),tYe={kernelName:I0,backendName:"webgl",kernelFunc:eYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nYe=Va+"return log(x + sqrt(x * x + 1.0));",rYe=bn({opSnippet:nYe}),sYe={kernelName:N0,backendName:"webgl",kernelFunc:rYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iYe=Va+`
  return atan(x);
`,oYe=bn({opSnippet:iYe}),aYe={kernelName:k0,backendName:"webgl",kernelFunc:oYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lYe=u4+`
  return atan(a, b);
`,uYe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+em+`
  return result;
`,cYe=Ms({opSnippet:lYe,packedOpSnippet:uYe}),dYe={kernelName:E0,backendName:"webgl",kernelFunc:cYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hYe=Va+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,fYe=bn({opSnippet:hYe}),pYe={kernelName:T0,backendName:"webgl",kernelFunc:fYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y1{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(g||(b="-1.0 / 1e-20"),r){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?x:w:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const T=Math.floor(o/4)*4,D=o%4,P=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${m});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${T}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${P}
          }

          int xC = xCCorner + ${T};
          if (${D===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${P}
          } else if (${D===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${P}
          } else if (${D===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${P}
          }
        }
        setOutput(${C});
      }
    `}}class d4{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,m=e.effectiveFilterHeight,g=e.effectiveFilterWidth,x=e.padInfo.front,w=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const S=n==="avg";let C="0.0";if(S||(C="-1.0 / 1e-20"),r){const M=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${x}, ${w}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${M} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const T="max";let D=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(D="avgValue / max(count, 1.0)");const P=Math.floor(o/4)*4,I=o%4,E=`
      if (${S}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${T}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${x}, ${w}, ${b});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${P}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${E}
            }

            int xC = xCCorner + ${P};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${E}
            }
          }
        }
        setOutput(${D});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mYe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;dv(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ae(as(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ws(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&nn(c.inShape,c.outShape))return vo({inputs:{x:s},backend:n});const d=new y1(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const gYe={kernelName:Y1,backendName:"webgl",kernelFunc:mYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yYe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=Xo(s.shape,i,o,c,a,l,u),h=new d4(d,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}const xYe={kernelName:K1,backendName:"webgl",kernelFunc:yYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wYe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class bYe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=d-1-e.padInfo.front,g=h-1-e.padInfo.top,x=f-1-e.padInfo.left,w=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${g}, ${x});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vYe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Xo(o.shape,a,l,d,u,c),f=new bYe(h);return n.runWebGLProgram(f,[s],o.dtype)}const SYe={kernelName:QN,backendName:"webgl",kernelFunc:vYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CYe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;dv([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Ws(o.shape,a,l,1,u),d=new wYe(c);return n.runWebGLProgram(d,[s],o.dtype)}const IYe={kernelName:ZN,backendName:"webgl",kernelFunc:CYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NYe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return JI({a:s,b:i,transposeA:o,transposeB:a,backend:n})}const kYe={kernelName:q1,backendName:"webgl",kernelFunc:NYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TYe{constructor(e,n,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],jt(e,n),jt(e,r);let a="0.0";s!=null&&(jt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(jt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EYe{constructor(e,n,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],jt(e,n),jt(e,r);let a="vec4(0.0)";s!=null&&(jt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(jt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ye=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=t;ae(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ae(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ae(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,i];let c=null;o!=null&&(c=o.shape,u.push(o));let d=null;a!=null&&(d=a.shape,u.push(a));const h=We().getBool("WEBGL_PACK_NORMALIZATION")?new EYe(r.shape,s.shape,i.shape,c,d,l):new TYe(r.shape,s.shape,i.shape,c,d,l);return e.runWebGLProgram(h,u,u[0].dtype)},AYe={kernelName:ab,backendName:"webgl",kernelFunc:_Ye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ye{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=Ln(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=RYe(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${hM[a]} = start[${a}] + coords.${hM[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const hM=["x","y","z","w","u","v"];function RYe(t){if(t===1)return"sourceLoc";if(t<=6)return hM.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MYe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Ln(this.rank),r=mi("coords",this.rank),s=mi("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DYe(t,e,n,r){const s=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=yP(e,$t(t.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function My(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r,[a,l]=Zb(s,i,o);if(wT(s,a,l),Ue(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),h=k7e(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,h)}const{isPacked:u}=n.texData.get(s.dataId),c=gP(s.shape,a,l);if(u||!c){const d=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new MYe(l):new $Ye(l),h=[a];return n.runWebGLProgram(d,[s],s.dtype,h)}return n.uploadToGPU(s.dataId),DYe(s,a,l,n)}const OYe={kernelName:Pb,backendName:"webgl",kernelFunc:My};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PYe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;ae(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((b,S)=>b*S),l=Wp(s.shape,i,a),u=Gp(l.length,i.length),c=Hp(s.shape,i,a),d=NT(o,i.length),h=kT(c,o,i.length),f=[],m=pt({inputs:{x:s},backend:n,attrs:{shape:l}}),g=bi({inputs:{x:m},backend:n,attrs:{perm:u}}),x=pt({inputs:{x:g},backend:n,attrs:{shape:c}}),w=My({inputs:{x},backend:n,attrs:{begin:d,size:h}});return f.push(m),f.push(g),f.push(x),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),w},FYe={kernelName:X1,backendName:"webgl",kernelFunc:PYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LYe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.readSync(s.dataId),l=n.readSync(i.dataId),u=Bee(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const zYe={kernelName:JN,backendName:"webgl",kernelFunc:LYe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BYe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,UYe=`
  return float(int(a.r) & int(b.r));
`;function VYe(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=We().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=We().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||o===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(s.dataId).values,[c,d]=XGe(r.shape,s.shape,l,u,r.dtype),h=n.makeTensorInfo(d,r.dtype),f=n.texData.get(h.dataId);return f.values=c,h}let a;return i?a=new $y(BYe,r.shape,s.shape,!1):a=new $p(UYe,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const jYe={kernelName:ek,backendName:"webgl",kernelFunc:VYe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WYe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.readSync(r.dataId),o=n.readSync(s.dataId),a=jt(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const GYe={kernelName:tk,backendName:"webgl",kernelFunc:WYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HYe="return float(a != b);",ete=Ms({opSnippet:HYe,cpuKernelImpl:y7e,dtype:"bool"}),YYe={kernelName:Ib,backendName:"webgl",kernelFunc:ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fv(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return vo({inputs:{x:s.complexTensorInfos.real},backend:n})}const KYe={kernelName:Ak,backendName:"webgl",kernelFunc:fv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qYe="return float(int(x));";function XYe(t,e){const n=new pu(t.shape,qYe),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fM(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return vo({inputs:{x:s},backend:n});const o=_r(s.shape),a=fM({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=zh({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const o=fv({inputs:{input:s},backend:n}),a=fM({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!fO(s.dtype,i)){const o=vo({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId).values,[a,l,u]=ZGe(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,u)}if(i==="int32")return XYe(s,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",is("bool",1)),l=ete({inputs:{a:s,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const ZYe={kernelName:_0,backendName:"webgl",kernelFunc:fM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xj="return ceil(x);",QYe=bn({opSnippet:Xj,packedOpSnippet:Xj,cpuKernelImpl:QGe}),JYe={kernelName:A0,backendName:"webgl",kernelFunc:QYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eKe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tKe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;We().getBool("WEBGL_PACK_CLIP")?a=new tKe(s.shape):a=new eKe(s.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[s],s.dtype,l)}const rKe={kernelName:$0,backendName:"webgl",kernelFunc:nKe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sKe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zj(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function iKe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),i=new sKe(r.shape),o=[Zj(r,s.complexTensorInfos.real),Zj(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const oKe={kernelName:Z1,backendName:"webgl",kernelFunc:iKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aKe{constructor(e){this.outputShape=[],this.outputShape=zi(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=n.length,i=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lKe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=zi(e,n);const r=this.outputShape,s=r.length,i=Ln(s),o=mi("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((g,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const u=a[n],c=a.slice(-2),d=a.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const x=l[g-1];h+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${fS(a,u,x)}),
            vec2(${fS(c,u,x)}));
        }`}const f=l.length,m=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${fS(a,u,m)}),
          vec2(${fS(c,u,m)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function fS(t,e,n){const r=t.indexOf(e);return t.map((i,o)=>o===r?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oE(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return vo({inputs:{x:s.complexTensorInfos.imag},backend:n})}const uKe={kernelName:bk,backendName:"webgl",kernelFunc:oE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uw(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(b=>fv({inputs:{input:b},backend:n})),m=t.map(b=>oE({inputs:{input:b},backend:n})),g=uw(f,e,n),x=uw(m,e,n),w=zh({inputs:{real:g,imag:x},backend:n});return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),m.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),w}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const f=t.map(C=>{const D=[-1,Ue(C.shape.slice(e))];return pt({inputs:{x:C},backend:n,attrs:{shape:D}})}),m=f.map(C=>({vals:n.readSync(C.dataId),shape:C.shape})),g=zi(f.map(C=>C.shape),1),x=f[0].shape[0]===1,w=JGe(m,g,r,x),b=zi(t.map(C=>C.shape),e),S=n.makeTensorInfo(b,r,w);return f.forEach(C=>n.disposeIntermediateTensorInfo(C)),S}const i=t.filter(f=>Ue(f.shape)>0),o=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new pu(t[0].shape,Ud):new qd(t[0].shape,Ud);return n.runWebGLProgram(f,t,r)}const a=We().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let g=0;g<i.length;g+=a){const x=i.slice(g,g+a);f.push(uw(x,e,n))}const m=uw(f,e,n);for(const g of f)n.disposeIntermediateTensorInfo(g);return m}if(o){const f=new lKe(i.map(m=>m.shape),e);return n.runWebGLProgram(f,i,r)}const{tensors2D:l,outShape:u}=cKe(i,e,n),c=new aKe(l.map(f=>f.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=pt({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),h}function cKe(t,e,n){const r=zi(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>pt({inputs:{x:i},attrs:{shape:[-1,Ue(i.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Jt(s,e[0].shape)[0],o=e.map(u=>u.shape);ST(o,i);const a=zi(e.map(u=>u.shape),i);if(Ue(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>Ue(u.shape)>0);return l.length===1?vo({inputs:{x:l[0]},backend:n}):uw(l,i,n)}const dKe={kernelName:Q1,backendName:"webgl",kernelFunc:tte};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nte{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,x=e.dataFormat==="channelsLast",w=x?1:2,b=x?2:3,S=x?3:1;let C="",T="";r&&(s?C=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?C=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:C=`
          float activation(float x) {
            ${r}
          }
        `,T="result = activation(result);");const D=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${C}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${S}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${D}
        ${T}
        setOutput(result);
      }
    `}}class hKe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rte{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hs(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<c;x++)h+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<c;x++)h+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(d+1)/2;x++){const w=x*2;if(h+=`
           xC = xCCorner + ${w*l};
           `,a===1){if(w<c&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,l===1&&w>0?h+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<c)){const b=o%2===0?dO(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:h+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):b===1?h+=`
                     xC${w+1} = xTexelC${w};
                     `:h+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<c&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<c&&(h+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<c&&(h+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<c&&(h+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",m="";r&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${m}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fKe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Hs(this.outputShape.length);const{dataFormat:r}=n,s=Si(),i=r==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eN(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function ste({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",m=!1,g=!1;let x;const w=[];if(i!=null){const C=eN(i.shape,f);C!=null&&(i=pt({inputs:{x:i},backend:r,attrs:{shape:C}}),w.push(i))}if(s!=null){const C=eN(s.shape,f);C!=null&&(s=pt({inputs:{x:s},backend:r,attrs:{shape:C}}),w.push(s))}if(!((d===1||h===1)&&c>Xee)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&nn(u.shape.slice(-3),l.slice(-3))){const C=l[0]*l[1]*(l[2]+1),T={dataId:t.dataId,shape:[1,C,n.inChannels],dtype:t.dtype},D=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,ae(QI(u.shape,T.shape),()=>`packed reshape ${u.shape} to ${T.shape} isn't free`);const P=pt({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});w.push(P);const I=JI({a:T,b:P,backend:r,transposeA:m,transposeB:g,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),E=r.texData.get(I.dataId);ae(E.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=D,E.shape=n.outShape,x=vo({inputs:{x:I},backend:r}),x.shape=n.outShape,w.push(I)}else{const C=n.outHeight*n.outWidth,T=pt({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,C,n.inChannels]:[n.batchSize,n.inChannels,C]}}),D=pt({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),P=JI({a:f?T:D,b:f?D:T,transposeA:!f,transposeB:g,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});x=pt({inputs:{x:P},backend:r,attrs:{shape:n.outShape}}),w.push(T),w.push(D),w.push(P)}for(const C of w)r.disposeIntermediateTensorInfo(C);return x}function ite({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:h,dataFormat:f}=n,m=f==="channelsLast",g=l*u*c,x=h*d,w=[n.batchSize,g,x],b=!0,S=!1,C=[];if(i!=null){const K=eN(i.shape,m);K!=null&&(i=pt({inputs:{x:i},backend:r,attrs:{shape:K}}),C.push(i))}if(s!=null){const K=eN(s.shape,m);K!=null&&(s=pt({inputs:{x:s},backend:r,attrs:{shape:K}}),C.push(s))}const T=pt({inputs:{x:e},backend:r,attrs:{shape:[1,g,Ue(e.shape)/g]}});C.push(T);const D=new fKe(w,n),P=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=r.runWebGLProgram(D,[t],"float32",P),E=pt({inputs:{x:I},backend:r,attrs:{shape:w}});C.push(I),C.push(E);const M=s!=null,O=i!=null,j=a==="leakyrelu",R=a?g1(a,!0):null,z=new qee(m?E.shape:T.shape,m?T.shape:E.shape,m?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],b,S,M,R,O,j),B=m?[E,T]:[T,E];if(s&&B.push(s),O&&B.push(i),j){const K=r.makeTensorInfo([],"float32",Ah(o,"float32"));B.push(K),C.push(K)}const V=r.runWebGLProgram(z,B,"float32"),H=pt({inputs:{x:V},backend:r,attrs:{shape:n.outShape}});C.push(V);for(const K of C)r.disposeIntermediateTensorInfo(K);return H}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Co(l),h=Kn(s.shape,i.shape,o,u,a,c,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=ste({x:s,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&We().getBool("WEBGL_EXP_CONV")){const g=new rte(h),x=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(g,[s,i],"float32",x)}else if(We().getBool("WEBGL_CONV_IM2COL"))f=ite({x:s,filter:i,convInfo:h,backend:n});else{const g=new nte(h);f=n.runWebGLProgram(g,[s,i],"float32")}const m=pt({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),m}const mKe={kernelName:J1,backendName:"webgl",kernelFunc:pKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gKe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class yKe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,c=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class xKe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class wKe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Co(l),h=Kn(s.shape,c,o,1,a,u,!1,d),f=new gKe(h);return n.runWebGLProgram(f,[s,i],"float32")}const vKe={kernelName:rk,backendName:"webgl",kernelFunc:bKe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SKe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Hs(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CKe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Co(u),h=Kn(o,i.shape,a,1,l,c,!1,d);if(We().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],m=new SKe(h);return n.runWebGLProgram(m,[s,i],"float32",f)}else{const f=new yKe(h);return n.runWebGLProgram(f,[s,i],"float32")}}const IKe={kernelName:eb,backendName:"webgl",kernelFunc:CKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Dl(s.shape,i.shape,o,l,a),c=new hKe(u);return n.runWebGLProgram(c,[s,i],"float32")}const kKe={kernelName:tb,backendName:"webgl",kernelFunc:NKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r,u=Dl(s.shape,l,o,1,a),c=new xKe(u);return n.runWebGLProgram(c,[s,i],"float32")}const EKe={kernelName:sk,backendName:"webgl",kernelFunc:TKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ke(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r,u=Dl(l,i.shape,a,1,o),c=new wKe(u);return n.runWebGLProgram(c,[s,i],"float32")}const AKe={kernelName:ik,backendName:"webgl",kernelFunc:_Ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ke=Ry+`
  return cos(x);
`,RKe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${em}
  return result;
`,MKe=bn({opSnippet:$Ke,packedOpSnippet:RKe}),DKe={kernelName:R0,backendName:"webgl",kernelFunc:MKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OKe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,PKe=bn({opSnippet:OKe}),FKe={kernelName:M0,backendName:"webgl",kernelFunc:PKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LKe{constructor(e,n,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,u]=e,[c]=n,[d,h]=r;this.outputShape=[c,d,h,u];const f=s==="bilinear"?1:0,[m,g]=[`${a-1}.0`,`${l-1}.0`],[x,w,b]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[S,C,T]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${S});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${C};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${T};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zKe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new LKe(s.shape,i.shape,a,l,u);return n.runWebGLProgram(c,[s,i,o],"float32")},BKe={kernelName:ak,backendName:"webgl",kernelFunc:zKe};var x1;(function(t){t.Prod="*",t.Sum="+"})(x1||(x1={}));class Qj{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===x1.Prod?"1.0":"0.0",a=r?o:`getX(${Jj(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Ln(i)} coords = getOutputCoords();
        int end = ${e6(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${e6(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${Jj(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Jj(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function e6(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(t,e,n,r,s,i){const o=e.shape.length,a=zn([r],o);let l=e;a!=null&&(l=bi({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=qn(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=vo({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const f=new Qj(t,l.shape,!1,i),m=[[h]],g=d;d=n.runWebGLProgram(f,[d],d.dtype,m),n.disposeIntermediateTensorInfo(g)}if(s){const h=new Qj(t,l.shape,s,i),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=Du(a),f=bi({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return ote(x1.Prod,s,n,i,o,a)}const VKe={kernelName:ok,backendName:"webgl",kernelFunc:UKe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return ote(x1.Sum,s,n,i,o,a)}const WKe={kernelName:nb,backendName:"webgl",kernelFunc:jKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(i.dataId),c=Bee(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(i),c=qGe(l,u,o,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const HKe={kernelName:lk,backendName:"webgl",kernelFunc:GKe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YKe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],l=o==="NHWC"?s.shape[1]:s.shape[2],u=o==="NHWC"?s.shape[2]:s.shape[3],c=o==="NHWC"?s.shape[3]:s.shape[1],d=l*i,h=u*i,f=c/(i*i),m=o==="NHWC"?[a,d,h,f]:[a,f,d,h],g=new YKe(m,i,o);return n.runWebGLProgram(g,[s],s.dtype)}const qKe={kernelName:uk,backendName:"webgl",kernelFunc:KKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ate{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hs(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lte{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hs(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<d;w++)f+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;f+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let w=0;w<d;w++)f+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(h+1)/2;w++){const b=w*2;if(f+=`
          xC = xCCorner + ${b*u};
          `,l===1){if(b<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?f+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<d)){const S=a%2===0?dO(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${S};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:f+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):S===1?f+=`
                    xC${b+1} = xTexelC${b};
                    `:f+=`
                    xCOffset = xC + ${S};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<d&&(f+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<d&&(f+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<d&&(f+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let m="",g="";r&&(s?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:m=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),ae(as(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const d=Kn(s.shape,i.shape,o,c,a,u,!0);let h;We().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new lte(d):h=new ate(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[s,i],"float32",f)}const ZKe={kernelName:rb,backendName:"webgl",kernelFunc:XKe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QKe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class JKe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eqe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=Kn(s.shape,c,o,a,l,u,!0),h=new QKe(d);return n.runWebGLProgram(h,[s,i],"float32")}const tqe={kernelName:ck,backendName:"webgl",kernelFunc:eqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nqe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=Kn(c,i.shape,o,a,l,u,!0),h=new JKe(d);return n.runWebGLProgram(h,[s,i],"float32")}const rqe={kernelName:dk,backendName:"webgl",kernelFunc:nqe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sqe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iqe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],i=Ue(r.shape),o=pt({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new sqe(i),l=n.runWebGLProgram(a,[o],o.dtype),u=pt({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const oqe={kernelName:hk,backendName:"webgl",kernelFunc:iqe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aqe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:h}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lqe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Mh(s.shape,i.shape,o,a,"NHWC",l);let c;const d=new aqe(u);c=n.runWebGLProgram(d,[s,i],"float32");const h=pt({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}const uqe={kernelName:sb,backendName:"webgl",kernelFunc:lqe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cqe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=MT(s,i.length);OT(o.length,l,i);const{path:u,steps:c}=PT(a,l),d=c.length;let h=null,f=o.length;const m=[];for(let g=0;g<d;++g){for(const x of c[g]){const{permutationIndices:w,expandDims:b}=DT(f,l[x]);let S;FT(w)?S=i[x]:(S=bi({inputs:{x:i[x]},backend:n,attrs:{perm:w}}),m.push(S));const C=S.shape.slice();for(let T=0;T<b.length;++T)C.splice(b[T],0,1);nn(S.shape,C)||(S=pt({inputs:{x:S},backend:n,attrs:{shape:C}}),m.push(S)),h===null?h=S:(h=c4({inputs:{a:S,b:h},backend:n}),m.push(h))}g<d-1&&(u[g]>=0&&(h=iE({inputs:{x:h},backend:n,attrs:{axis:u[g]-(o.length-f),keepDims:!1}}),m.push(h)),f--)}for(const g of m)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const dqe={kernelName:fk,backendName:"webgl",kernelFunc:cqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hqe="return (x >= 0.0) ? x : (exp(x) - 1.0);",fqe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,pqe=bn({opSnippet:hqe,packedOpSnippet:fqe}),mqe={kernelName:O0,backendName:"webgl",kernelFunc:pqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gqe="return (b >= 0.0) ? a : a * (b + 1.0);",yqe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,xqe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $y(yqe,r.shape,s.shape):new $p(gqe,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)},wqe={kernelName:pk,backendName:"webgl",kernelFunc:xqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bqe=`
  return vec4(equal(a, b));
`,vqe="return float(a == b);",Sqe=Ms({opSnippet:vqe,packedOpSnippet:bqe,dtype:"bool",cpuKernelImpl:e7e}),Cqe={kernelName:ib,backendName:"webgl",kernelFunc:Sqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iqe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${TT};
  float a1 = ${ET};
  float a2 = ${_T};
  float a3 = ${AT};
  float a4 = ${$T};
  float a5 = ${RT};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Nqe=bn({opSnippet:Iqe}),kqe={kernelName:P0,backendName:"webgl",kernelFunc:Nqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tqe=Ry+`
  return exp(x);
`,Eqe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ute=bn({opSnippet:Tqe,packedOpSnippet:Eqe,cpuKernelImpl:t7e,dtype:"float32"}),_qe={kernelName:F0,backendName:"webgl",kernelFunc:ute};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pM(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(ae(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),pt({inputs:{x:i},backend:r,attrs:{shape:a}})}const Aqe={kernelName:ob,backendName:"webgl",kernelFunc:pM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t6="return exp(x) - 1.0;",$qe=bn({opSnippet:t6,packedOpSnippet:t6,cpuKernelImpl:n7e}),Rqe={kernelName:L0,backendName:"webgl",kernelFunc:$qe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n6{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(t,e,n){const r=n.texData.get(t.dataId),s=Ue(t.shape),i=t.shape[t.shape.length-1],o=s/i,a=pt({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,u=new n6("real",l,e),c=new n6("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),m=zh({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const g=pt({inputs:{x:m},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(m),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mqe(t){const{inputs:e,backend:n}=t,{input:r}=e;return cte(r,!1,n)}const Dqe={kernelName:mk,backendName:"webgl",kernelFunc:Mqe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oqe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pv(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:i}=n;if(i=i||zp(s),i==="string"){const o=br(i,Ue(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new Oqe(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const Pqe={kernelName:gk,backendName:"webgl",kernelFunc:pv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fqe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lqe={kernelName:yk,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new Fqe(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6="return floor(x);",zqe=bn({opSnippet:r6,packedOpSnippet:r6,cpuKernelImpl:r7e}),Bqe={kernelName:z0,backendName:"webgl",kernelFunc:zqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uqe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Vqe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,jqe=Ms({opSnippet:Uqe,packedOpSnippet:Vqe,dtype:"int32"}),Wqe={kernelName:B0,backendName:"webgl",kernelFunc:jqe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gqe{constructor(e){this.variableNames=["A"];const n=Si(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hqe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Si(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yqe={kernelName:NI,backendName:"webgl",kernelFunc:Kqe};let Qm,Q3=We().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Kqe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,i];if(a||o){const g=We().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Qm==null||g!==Q3)&&(Q3=g,Qm=document.createElement("canvas").getContext("2d",{willReadFrequently:Q3})),Qm.canvas.width=l,Qm.canvas.height=u,Qm.drawImage(s,0,0,l,u),s=Qm.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=jo.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),s);const f=We().getBool("WEBGL_PACK")?new Hqe(d):new Gqe(d),m=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qqe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=r,g=Co(c),x=Kn(s.shape,i.shape,l,d,u,h,!1,g);let w;const b=[],S=o!=null,C=a!=null,T=f==="leakyrelu",D=()=>{const I=[s,i],E=(M,O)=>{if(O==="NCHW"&&M.shape.length===1&&M.shape[0]!==1){const j=pt({inputs:{x:M},backend:n,attrs:{shape:[M.shape[0],1,1]}});return b.push(j),j}return M};if(S&&I.push(E(o,c)),C&&I.push(E(a,c)),T){const M=n.makeTensorInfo([],"float32",Ah(m,"float32"));I.push(M),b.push(M)}return I};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))w=ste({x:s,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:m});else if(x.strideWidth<=2&&g==="channelsLast"&&We().getBool("WEBGL_EXP_CONV")){const I=f?g1(f,!0):null,E=new rte(x,S,I,C,T),M=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],O=D();w=n.runWebGLProgram(E,O,"float32",M)}else if(We().getBool("WEBGL_CONV_IM2COL"))w=ite({x:s,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:m});else{const I=f?g1(f,!1):null,E=new nte(x,S,I,C,T),M=D();w=n.runWebGLProgram(E,M,"float32")}const P=pt({inputs:{x:w},backend:n,attrs:{shape:x.outShape}});return b.push(w),b.forEach(I=>n.disposeIntermediateTensorInfo(I)),P}const Xqe={kernelName:Qw,backendName:"webgl",kernelFunc:qqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zqe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r,m=[];let g=c;g==null&&(g=[1,1]),ae(as(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const x=Kn(s.shape,i.shape,l,g,u,d,!0),w=We().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,b=h?g1(h,w):null,S=[s,i],C=o!=null,T=a!=null,D=h==="leakyrelu";if(C&&S.push(o),T&&S.push(a),D){const M=n.makeTensorInfo([],"float32",Ah(f,"float32"));S.push(M),m.push(M)}let P;w?P=new lte(x,C,b,T,D):P=new ate(x,C,b,T,D);const I=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],E=n.runWebGLProgram(P,S,"float32",I);return m.forEach(M=>n.disposeIntermediateTensorInfo(M)),E}const Qqe={kernelName:Jw,backendName:"webgl",kernelFunc:Zqe};class Jqe{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=Ln(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eXe(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=Ue(r.shape),[l,u,c,d]=xT(r,s),h=pt({inputs:{x:s},backend:n,attrs:{shape:[u,o]}}),f=pt({inputs:{x:r},backend:n,attrs:{shape:[Ue(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const w=n.readSync(s.dataId),b=n.bufferSync(r),S=s7e(w,b,r.dtype,u,o,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,S.values)}const m=new Jqe(o,d,[u,c],r.shape),g=n.runWebGLProgram(m,[f,h],f.dtype),x=pt({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),x}const tXe={kernelName:xk,backendName:"webgl",kernelFunc:eXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nXe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=Ln(this.rank),s=rXe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function rXe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,l=Jt(o,s.shape)[0];if(We().get("DEBUG")){const b=n.readSync(i.dataId),S=s.shape[l];for(let C=0;C<b.length;++C){const T=b[C];ae(T<=S-1&&T>=0,()=>`GatherV2: the index value ${T} is not in [0, ${S-1}]`)}}const u=zT(s,i,l,a),c=Ue(i.shape),d=[],h=pt({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=pt({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(f);const m=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const b=n.bufferSync(f),S=n.bufferSync(h),C=i7e(S,b,m);return d.forEach(T=>n.disposeIntermediateTensorInfo(T)),n.makeTensorInfo(u.outputShape,C.dtype,C.values)}const g=new nXe(h.shape,m),x=n.runWebGLProgram(g,[h,f],h.dtype);d.push(x);const w=pt({inputs:{x},backend:n,attrs:{shape:u.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),w}const sXe={kernelName:lb,backendName:"webgl",kernelFunc:dte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iXe="return float(a > b);",oXe=`
  return vec4(greaterThan(a, b));
`,aXe=Ms({opSnippet:iXe,packedOpSnippet:oXe,cpuKernelImpl:o7e,dtype:"bool"}),lXe={kernelName:ub,backendName:"webgl",kernelFunc:aXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uXe="return float(a >= b);",cXe=`
  return vec4(greaterThanEqual(a, b));
`,dXe=Ms({opSnippet:uXe,packedOpSnippet:cXe,dtype:"bool",cpuKernelImpl:a7e}),hXe={kernelName:U0,backendName:"webgl",kernelFunc:dXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fXe(t){const{inputs:e,backend:n}=t,{input:r}=e;return cte(r,!0,n)}const pXe={kernelName:wk,backendName:"webgl",kernelFunc:fXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mXe="return float(!isnan(x) && !isinf(x));",gXe=bn({opSnippet:mXe,dtype:"bool"}),yXe={kernelName:j0,backendName:"webgl",kernelFunc:gXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xXe="return float(isinf(x));",wXe=bn({opSnippet:xXe,dtype:"bool"}),bXe={kernelName:W0,backendName:"webgl",kernelFunc:wXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vXe="return float(isnan(x));",SXe=bn({opSnippet:vXe,dtype:"bool"}),CXe={kernelName:G0,backendName:"webgl",kernelFunc:SXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IXe="return float(a < b);",NXe=`
  return vec4(lessThan(a, b));
`,kXe=Ms({opSnippet:IXe,packedOpSnippet:NXe,cpuKernelImpl:l7e,dtype:"bool"}),TXe={kernelName:db,backendName:"webgl",kernelFunc:kXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EXe="return float(a <= b);",_Xe=`
  return vec4(lessThanEqual(a, b));
`,AXe=Ms({opSnippet:EXe,packedOpSnippet:_Xe,cpuKernelImpl:u7e,dtype:"bool"}),$Xe={kernelName:hb,backendName:"webgl",kernelFunc:AXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RXe(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=c7e(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const MXe={kernelName:vk,backendName:"webgl",kernelFunc:RXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DXe=Ry+`
  return x < 0.0 ? 0./0. : log(x);
`,OXe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,PXe=bn({opSnippet:DXe,packedOpSnippet:OXe,cpuKernelImpl:d7e}),FXe={kernelName:H0,backendName:"webgl",kernelFunc:PXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LXe=Ry+`
  return log(1.0 + x);
`,zXe=bn({opSnippet:LXe}),BXe={kernelName:Y0,backendName:"webgl",kernelFunc:zXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UXe="return float(a >= 1.0 && b >= 1.0);",VXe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,jXe=Ms({opSnippet:UXe,packedOpSnippet:VXe,dtype:"bool"}),WXe={kernelName:fb,backendName:"webgl",kernelFunc:jXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GXe="return float(!(x >= 1.0));",HXe=bn({opSnippet:GXe}),YXe={kernelName:pb,backendName:"webgl",kernelFunc:HXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KXe="return float(a >= 1.0 || b >= 1.0);",qXe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,XXe=Ms({opSnippet:KXe,packedOpSnippet:qXe,dtype:"bool"}),ZXe={kernelName:mb,backendName:"webgl",kernelFunc:XXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QXe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JXe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eZe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r,u=We().getBool("WEBGL_PACK_NORMALIZATION")?new JXe(s.shape,i,o,a,l):new QXe(s.shape,i,o,a,l);return n.runWebGLProgram(u,[s],s.dtype)},tZe={kernelName:gb,backendName:"webgl",kernelFunc:eZe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nZe{constructor(e,n,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rZe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new nZe(s.shape,a,l,u,c);return n.runWebGLProgram(d,[s,i,o],s.dtype)},sZe={kernelName:Sk,backendName:"webgl",kernelFunc:rZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iZe(t,e,n,r){const s=Ue(e),o=Ue(t.shape)/s,a=pt({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=tm(a,t.dtype,"max",r),u=pt({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,l=Jt(i,s.shape);let u=l;const c=zn(u,a),d=c!=null,h=n.shouldExecuteOnCPU([s]);let f=s;if(d){if(h){const S=n.texData.get(f.dataId).values,C=new Array(a);for(let P=0;P<C.length;P++)C[P]=s.shape[c[P]];const T=l4(S,s.shape,s.dtype,c,C);f=n.makeTensorInfo(C,s.dtype);const D=n.texData.get(f.dataId);D.values=T}else f=sE(s,c,n);u=qn(u.length,a)}Wr("max",u,a);const[m,g]=$r(f.shape,u);let x=m;o&&(x=Cr(m,l));let w;if(h){const S=n.texData.get(f.dataId).values,C=h7e(S,Ue(g),x,s.dtype);w=n.makeTensorInfo(x,s.dtype);const T=n.texData.get(w.dataId);T.values=C}else w=iZe(f,g,x,n);return d&&n.disposeIntermediateTensorInfo(f),w}const oZe={kernelName:yb,backendName:"webgl",kernelFunc:hte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aZe=u4+`
  return max(a, b);
`,lZe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+em+`
  return result;
`,uZe=Ms({opSnippet:aZe,packedOpSnippet:lZe,cpuKernelImpl:f7e}),cZe={kernelName:K0,backendName:"webgl",kernelFunc:uZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dZe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;dv(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ae(as(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ws(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&nn(c.inShape,c.outShape))return vo({inputs:{x:s},backend:n});const d=new y1(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const hZe={kernelName:xb,backendName:"webgl",kernelFunc:dZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Xo(s.shape,i,o,c,a,u,l),h=new d4(d,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}const pZe={kernelName:wb,backendName:"webgl",kernelFunc:fZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mZe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class gZe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=u-1-e.padInfo.top,f=c-1-e.padInfo.left,m=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yZe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Xo(o.shape,a,l,d,u,c),f=new d4(h,"max",!0),m=n.runWebGLProgram(f,[o],o.dtype),g=new gZe(h),x=n.runWebGLProgram(g,[s,m],o.dtype);return n.disposeIntermediateTensorInfo(m),x}const xZe={kernelName:Ik,backendName:"webgl",kernelFunc:yZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wZe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;dv([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=Ws(a.shape,l,u,1,c,d),f=!0,m=new y1(h,"max",f),g=n.runWebGLProgram(m,[a],a.dtype),x=new mZe(h),w=n.runWebGLProgram(x,[s,g],a.dtype);return n.disposeIntermediateTensorInfo(g),w}const bZe={kernelName:Ck,backendName:"webgl",kernelFunc:wZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZe(t,e,n,r){let s=new y1(n,"max",!1);const i=r.runWebGLProgram(s,[t],"float32");s=new y1(n,"max",!0,!0,e);const o=r.runWebGLProgram(s,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SZe={kernelName:Nk,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;ae(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];ae(as(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ws(r.shape,s,i,u,o),[d,h]=vZe(r,a,c,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CZe(t,e,n,r){const s=Ue(e),o=Ue(t.shape)/s,a=pt({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=tm(a,"float32","mean",r),u=pt({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IZe={kernelName:bb,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:i}=e,o=n,a=r.shape.length,l=Jt(i,r.shape);let u=l;const c=zn(u,a),d=c!=null,h=o.shouldExecuteOnCPU([r]),f=[];let m=r;if(d){if(h){const C=o.texData.get(m.dataId).values,T=new Array(a);for(let I=0;I<T.length;I++)T[I]=r.shape[c[I]];const D=l4(C,r.shape,r.dtype,c,T);m=o.makeTensorInfo(T,r.dtype);const P=o.texData.get(m.dataId);P.values=D}else m=sE(r,c,o);f.push(m),u=qn(u.length,a)}Wr("sum",u,a);const[g,x]=$r(m.shape,u);let w=g;s&&(w=Cr(g,l));const b=CZe(m,x,w,o);for(const S of f)o.disposeIntermediateTensorInfo(S);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Jt(i,s.shape);let u=l;const c=zn(u,a);let d=s;c!=null&&(d=bi({inputs:{x:s},backend:n,attrs:{perm:c}}),u=qn(u.length,s.shape.length)),Wr("min",u,a);const[h,f]=$r(d.shape,u),m=Ue(f),g=pt({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),x=tm(g,g.dtype,"min",n);let w;if(o){const b=Cr(h,l);w=pt({inputs:{x},backend:n,attrs:{shape:b}})}else w=pt({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),w}const kZe={kernelName:vb,backendName:"webgl",kernelFunc:NZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TZe=u4+`
  return min(a, b);
`,EZe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+em+`
  return result;
`,_Ze=Ms({opSnippet:TZe,packedOpSnippet:EZe,cpuKernelImpl:p7e}),AZe={kernelName:q0,backendName:"webgl",kernelFunc:_Ze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ze{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,i=Ln(s),o=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RZe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const s=e.length,i=Ln(s),o=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=mi("rc",s),u=mi("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1;let f="";if(s===1){const m=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const m=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${m}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${c}) {
            ${m}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MZe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:i}=n,o=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RZe(r.shape,s,i):new $Ze(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},DZe={kernelName:Sb,backendName:"webgl",kernelFunc:MZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OZe=`if (b == 0.0) return NAN;
  return mod(a, b);`,PZe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+em+`
  return result;
`,FZe=Ms({opSnippet:OZe,packedOpSnippet:PZe}),LZe={kernelName:X0,backendName:"webgl",kernelFunc:FZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zZe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BZe=`
if (a == b) {
  return 1.0;
};
return a / b;`,UZe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,fte=Ms({opSnippet:BZe,packedOpSnippet:UZe,checkOutOfBounds:!0}),VZe={kernelName:D0,backendName:"webgl",kernelFunc:fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s6="return a - b;",pte=Ms({opSnippet:s6,packedOpSnippet:s6,supportsComplex:!0,cpuKernelImpl:O7e}),jZe={kernelName:hy,backendName:"webgl",kernelFunc:pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=Jt([i],s.shape),a=hte({inputs:{x:s},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=Cr(a.shape,o),u=pt({inputs:{x:a},backend:n,attrs:{shape:l}}),c=pte({inputs:{a:s,b:u},backend:n}),d=ute({inputs:{x:c},backend:n}),h=iE({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=pt({inputs:{x:h},backend:n,attrs:{shape:l}}),m=fte({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}const WZe={kernelName:Bb,backendName:"webgl",kernelFunc:mte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GZe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,l=a?s:mte({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new zZe(u,c,i),h=[[o]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const HZe={kernelName:kk,backendName:"webgl",kernelFunc:GZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YZe=Va+`
  return -x;
`,KZe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function qZe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,a]=g7e(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let s;return We().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new qd(r.shape,KZe):s=new pu(r.shape,YZe),n.runWebGLProgram(s,[r],r.dtype)}const XZe={kernelName:Cb,backendName:"webgl",kernelFunc:qZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZZe=gT;function QZe(t){Uo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),{selectedIndices:d}=ZZe(u,c,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const JZe={kernelName:Tk,backendName:"webgl",kernelFunc:QZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQe=cP;function tQe(t){Uo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:f}=eQe(c,d,o,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const nQe={kernelName:yO,backendName:"webgl",kernelFunc:tQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rQe=yT;function sQe(t){Uo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(i.dataId),h=o,f=a,m=l,g=u,{selectedIndices:x,selectedScores:w}=rQe(c,d,h,f,m,g);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const iQe={kernelName:Ek,backendName:"webgl",kernelFunc:sQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oQe{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQe=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r,u=Ue(s.shape),c=new oQe(u,o,a,l),d=pt({inputs:{x:s},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...s.shape,o],m=pt({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),m},lQe={kernelName:kb,backendName:"webgl",kernelFunc:aQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tN(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=fv({inputs:{input:r},backend:n}),i=tN({inputs:{x:s},backend:n}),o=oE({inputs:{input:r},backend:n}),a=tN({inputs:{x:o},backend:n}),l=zh({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return pv({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const uQe={kernelName:jb,backendName:"webgl",kernelFunc:tN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gte(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=fv({inputs:{input:r},backend:n}),i=gte({inputs:{x:s},backend:n}),o=oE({inputs:{input:r},backend:n}),a=tN({inputs:{x:o},backend:n}),l=zh({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return pv({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const cQe={kernelName:Nb,backendName:"webgl",kernelFunc:gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return pM({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Wi(i,c.shape,"All tensors passed to stack must have matching shapes"),ae(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=pM({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=tte({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const hQe={kernelName:Tb,backendName:"webgl",kernelFunc:dQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fQe{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,i=Ln(s),o=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pQe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,x)=>g[0]+e[x]+g[1]);const s=e.length,i=Ln(s),o=n.map(g=>g[0]).join(","),a=n.map((g,x)=>g[0]+e[x]).join(","),l=mi("rc",s),u=mi("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let m="";for(let g=0,x=s===1?2:4;g<x;g++)m+=`
        ${h[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${d});
        }
      `;m+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yte=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;if(Ue(s.shape)===0){const u=i.map((c,d)=>c[0]+s.shape[d]+c[1]);return pv({backend:n,attrs:{shape:u,value:o,dtype:s.dtype}})}const a=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pQe(s.shape,i,o):new fQe(s.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[s],s.dtype,l)},mQe={kernelName:Eb,backendName:"webgl",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gQe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,yQe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+em+`
  return result;
`,xQe=Ms({opSnippet:gQe,packedOpSnippet:yQe}),wQe={kernelName:Q0,backendName:"webgl",kernelFunc:xQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bQe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=[],u=Jt(i,s.shape);let c=u;const d=zn(c,a);let h=s;d!=null&&(h=bi({inputs:{x:s},backend:n,attrs:{perm:d}}),c=qn(c.length,a),l.push(h)),Wr("prod",c,a);let f;if(n.shouldExecuteOnCPU([h])){const m=n.texData.get(h.dataId).values,{outVals:g,outShape:x,outDtype:w}=x7e(h.shape,h.dtype,m,c);f=n.makeTensorInfo(x,w,g)}else{const[m,g]=$r(h.shape,c),x=Ue(g),w=pt({inputs:{x:h},backend:n,attrs:{shape:[-1,x]}}),b=Yk(s.dtype),S=tm(w,b,"prod",n);f=pt({inputs:{x:S},backend:n,attrs:{shape:m}}),l.push(w),l.push(S)}if(o){l.push(f);const m=Cr(f.shape,u);f=pt({inputs:{x:f},backend:n,attrs:{shape:m}})}return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const vQe={kernelName:Ab,backendName:"webgl",kernelFunc:bQe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SQe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(w=>n.readSync(w.dataId)),u=s.map(w=>w.shape),c=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,f,m]=w7e(l,u,c,i.shape,i.dtype,d,o.shape,a),g=h.map(w=>n.makeTensorInfo([w.length],"int32",w)),x=n.makeTensorInfo(m,i.dtype,f);return g.concat([x])}const CQe={kernelName:xO,backendName:"webgl",kernelFunc:SQe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=b7e(o,r.shape,r.dtype,a,s.shape,l,i.shape),d=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[d,h]}const NQe={kernelName:wO,backendName:"webgl",kernelFunc:IQe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kQe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(x=>n.readSync(x.dataId)),f=a.map(x=>x.shape),[m,g]=v7e(u,s.shape,c,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(m,i.dtype,g)}const TQe={kernelName:bO,backendName:"webgl",kernelFunc:kQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xte=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:o}=n,a=S7e(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},EQe={kernelName:_k,backendName:"webgl",kernelFunc:xte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Qe="return 1.0 / x;",AQe=bn({opSnippet:_Qe}),$Qe={kernelName:J0,backendName:"webgl",kernelFunc:AQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RQe=Va+`
  return (x < 0.0) ? 0.0 : x;
`,MQe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,DQe=bn({opSnippet:RQe,packedOpSnippet:MQe}),OQe={kernelName:ey,backendName:"webgl",kernelFunc:DQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PQe=Va+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,FQe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,LQe=bn({opSnippet:PQe,packedOpSnippet:FQe}),zQe={kernelName:ty,backendName:"webgl",kernelFunc:LQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BQe{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UQe{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=We().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new UQe(s.shape,l,u,i,o):new BQe(s.shape,l,u,i,o);return n.runWebGLProgram(c,[s],"float32")}const jQe={kernelName:Mb,backendName:"webgl",kernelFunc:VQe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WQe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,f=1/d,m=Math.ceil(h)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new WQe(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const HQe={kernelName:Rk,backendName:"webgl",kernelFunc:GQe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YQe{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KQe{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qQe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=We().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new KQe(s.shape,l,u,i,o):new YQe(s.shape,l,u,i,o);return n.runWebGLProgram(c,[s],s.dtype)}const XQe={kernelName:Rb,backendName:"webgl",kernelFunc:qQe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZQe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,f=1/d,m=Math.ceil(h)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new ZQe(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const JQe={kernelName:$k,backendName:"webgl",kernelFunc:QQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eJe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>s(l)).join(","),o=Ln(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tJe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=mi("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Ln(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${i}){
            result.g = ${u(s.slice())};
          }
          if(${o}) {
            result.b = ${c(s.slice())};
            if(${i}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(m){return h(m)}function u(m){return m[r-1]="("+m[r-1]+" + 1)",h(m)}function c(m){return m[r-2]="("+m[r-2]+" + 1)",h(m)}function d(m){return m[r-1]="("+m[r-1]+" + 1)",m[r-2]="("+m[r-2]+" + 1)",h(m)}function h(m){const g=e.map((b,S)=>f(S,m)),x=g.join(","),w=g.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${w}))`}function f(m,g){return n.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${g[m]} - 1`:`${g[m]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nJe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r,o=s.shape.length,a=Jt(i,s.shape);if(o===0)return vo({inputs:{x:s},backend:n});const l=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tJe(s.shape,a):new eJe(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const rJe={kernelName:Db,backendName:"webgl",kernelFunc:nJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sJe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iJe={kernelName:Gk,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=new sJe(r.shape,i),[u,c]=IT(o,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oJe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,aJe=bn({opSnippet:oJe}),lJe={kernelName:ny,backendName:"webgl",kernelFunc:aJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJe="return inversesqrt(x);",cJe=bn({opSnippet:uJe,cpuKernelImpl:C7e}),dJe={kernelName:ry,backendName:"webgl",kernelFunc:cJe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h4{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=Ln(i.length),c=Ln(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const m=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const x=`getDefaultValue(${g})`,w=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hJe{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=Ln(i.length),c=Ln(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const m=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const x=`getDefaultValue(${g})`,w=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${m};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Pu(i,s,o),h=[d/u,u];if(d===0)return n.makeTensorInfo(o,s.dtype);const f=pt({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),m=pt({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;We().getBool("WEBGL_PACK")?x=new hJe(l,a,f.shape.length,m.shape.length,c,h):x=new h4(l,a,f.shape.length,m.shape.length,c,h);const w=n.runWebGLProgram(x,[m,f,g],m.dtype),b=pt({inputs:{x:w},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(g),b}const pJe={kernelName:Mk,backendName:"webgl",kernelFunc:fJe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mJe{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=We().getNumber("WEBGL_VERSION")===2?i:o,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gJe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=new mJe(s.shape[0],s.shape[1],i.shape[1],o),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,i],"int32",l)}const yJe={kernelName:Ok,backendName:"webgl",kernelFunc:gJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xJe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),i=u.join()}const o=Ln(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,o=new xJe(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(o,[r,s,i],ws(s.dtype,i.dtype))}const bJe={kernelName:Ob,backendName:"webgl",kernelFunc:wJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vJe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Qb};
  float scale = ${Jb};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,SJe=bn({opSnippet:vJe}),CJe={kernelName:sy,backendName:"webgl",kernelFunc:SJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IJe=Ry+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,NJe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,kJe=bn({opSnippet:IJe,packedOpSnippet:NJe,cpuKernelImpl:N7e}),TJe={kernelName:ly,backendName:"webgl",kernelFunc:kJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,_Je=bn({opSnippet:EJe}),AJe={kernelName:ay,backendName:"webgl",kernelFunc:_Je};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Je=Ry+`
  return sin(x);
`,RJe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${em}
  return result;
`,MJe=bn({opSnippet:$Je,packedOpSnippet:RJe}),DJe={kernelName:iy,backendName:"webgl",kernelFunc:MJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OJe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,PJe=bn({opSnippet:OJe}),FJe={kernelName:oy,backendName:"webgl",kernelFunc:PJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,zJe=bn({opSnippet:LJe}),BJe={kernelName:uy,backendName:"webgl",kernelFunc:zJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;ae(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((w,b)=>w*b),l=[[0,0]];l.push(...o);for(let w=1+i.length;w<s.shape.length;++w)l.push([0,0]);const u=[],c=yte({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=Wp(c.shape,i,a,!1),h=Gp(d.length,i.length,!1),f=Hp(c.shape,i,a,!1),m=pt({inputs:{x:c},backend:n,attrs:{shape:d}}),g=bi({inputs:{x:m},backend:n,attrs:{perm:h}}),x=pt({inputs:{x:g},backend:n,attrs:{shape:f}});return u.push(c),u.push(m),u.push(g),u.forEach(w=>n.disposeIntermediateTensorInfo(w)),x},VJe={kernelName:Lb,backendName:"webgl",kernelFunc:UJe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jJe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[d,h,f,m,g]=T7e(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(x=>Number(x)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const WJe={kernelName:vO,backendName:"webgl",kernelFunc:jJe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,c,d]=E7e(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const HJe={kernelName:SO,backendName:"webgl",kernelFunc:GJe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=Vee(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const KJe={kernelName:Pk,backendName:"webgl",kernelFunc:YJe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=Vee(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const XJe={kernelName:Fk,backendName:"webgl",kernelFunc:qJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Pu(i,s,a),f=!1;if(i.dtype==="string"){const w=n.bufferSync(s),b=n.bufferSync(i),S=Cl(n.readSync(o.dataId)[0]),C=I7e(w,b,a,h,c,u,l,d,S,f);return n.makeTensorInfo(a,C.dtype,C.values)}const m=new h4(u,l,s.shape.length,i.shape.length,d,[h,1],f),g=n.runWebGLProgram(m,[i,s,o],i.dtype),x=pt({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),x}const QJe={kernelName:Lk,backendName:"webgl",kernelFunc:ZJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JJe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Jt(o,s.shape)[0],l=LT(s,i,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const m=My({inputs:{x:s},backend:n,attrs:{begin:c,size:f}});return c[a]+=h,m})}const eet={kernelName:zb,backendName:"webgl",kernelFunc:JJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i6="return sqrt(x);",tet=bn({opSnippet:i6,packedOpSnippet:i6,cpuKernelImpl:_7e}),net={kernelName:cy,backendName:"webgl",kernelFunc:tet};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ret="return x * x;",set=bn({opSnippet:ret}),iet={kernelName:zk,backendName:"webgl",kernelFunc:set};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6="return (a - b) * (a - b);",oet=Ms({opSnippet:o6,packedOpSnippet:o6}),aet={kernelName:dy,backendName:"webgl",kernelFunc:oet};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uet(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(s.dataId),o=Tl(i),a=A7e(o,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const cet={kernelName:Bk,backendName:"webgl",kernelFunc:uet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function det({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=Va+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new pu(r.shape,s);return n.runWebGLProgram(i,[r],r.dtype)}const het={kernelName:gy,backendName:"webgl",kernelFunc:det};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fet{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=Ln(r.length),o=Ln(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pet(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:x,isSimpleSlice:w,begin:b,end:S,strides:C}=vT(s.shape,i,o,a,l,u,c,d,h);let T;if(g)T=pt({inputs:{x:s},backend:n,attrs:{shape:m}});else if(x||w){ae(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const P=bT(b,S,C),I=My({inputs:{x:s},backend:n,attrs:{begin:b,size:P}});T=pt({inputs:{x:I},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([s])){const I=n.readSync(s.dataId),E=Zt(s.shape,s.dtype,I),M=$7e(f,E,C,b);T=n.makeTensorInfo(m,s.dtype,M.values)}else{const I=new fet(b,C,f);T=n.runWebGLProgram(I,[s],s.dtype)}const D=pt({inputs:{x:T},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(T),D}const met={kernelName:Uk,backendName:"webgl",kernelFunc:pet};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function get(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,h=n.readSync(c.dataId),f=n.readSync(d.dataId),[m,g]=R7e(h,f,s,i,o,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",g)]}const yet={kernelName:Vk,backendName:"webgl",kernelFunc:get};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xet(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[u,c,d]=M7e(a,l,s),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const wet={kernelName:CO,backendName:"webgl",kernelFunc:xet};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bet(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=D7e(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const vet={kernelName:IO,backendName:"webgl",kernelFunc:bet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cet="return tan(x);",Iet=bn({opSnippet:Cet}),Net={kernelName:fy,backendName:"webgl",kernelFunc:Iet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ket=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Tet=bn({opSnippet:ket}),Eet={kernelName:py,backendName:"webgl",kernelFunc:Tet};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _et(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Pu(o,i,s.shape),h=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,i.dtype);const f=pt({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),m=pt({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),g=pt({inputs:{x:s},backend:n,attrs:{shape:h}}),x=new h4(l,a,f.shape.length,m.shape.length,c,h,!1,!0),w=n.runWebGLProgram(x,[m,f,g],g.dtype),b=pt({inputs:{x:w},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),b}const Aet={kernelName:Dk,backendName:"webgl",kernelFunc:_et};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $et{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const s=Ln(this.rank),i=Ret(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function Ret(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(h=>Cl(h)):l,c=Zt(s.shape,s.dtype,u),d=P7e(c,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new $et(s.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}const Met={kernelName:my,backendName:"webgl",kernelFunc:wte};class Det{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Oet{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wf(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function a6(t){let e=1;for(;e<t;)e*=2;return e}function Pet(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r,a=We().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=We().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<a||i>l){const M=n.readSync(s.dataId),[O,j]=F7e(M,u,s.dtype,i,o);return[n.makeTensorInfo(O.shape,O.dtype,O.values),n.makeTensorInfo(j.shape,j.dtype,j.values)]}if(i===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,pv({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(s):s,g=Ue(u)/c,x=pt({inputs:{x:f},attrs:{shape:[g,c]},backend:n});h&&wf(n,f);const w=a6(i),b=a6(c);let S=null;const C=()=>S===null?[x,x]:[x,S],T=(M,O,j)=>{const R=C(),z=new Det(j),V=[[c],[S===null?1:0],[Number.NEGATIVE_INFINITY],[M],[O]],H=S;S=n.runWebGLProgram(z,R,"int32",V),wf(n,H)};for(let M=1;M<w;M*=2){const O=M*2;for(let j=M;j>=1;j/=2)T(O,j,[g,b])}for(let M=b;M>w;M/=2){const O=C(),j=new Oet([g,M/2]),z=[[c],[S===null?1:0],[w]],B=S;S=n.runWebGLProgram(j,O,"int32",z),wf(n,B);const V=w/2,H=V*2;for(let K=V;K>=1;K/=2)T(H,K,S.shape)}let D=S;S=My({inputs:{x:S},backend:n,attrs:{begin:0,size:[g,i]}}),wf(n,D);let P=dte({inputs:{x,indices:S},backend:n,attrs:{axis:1,batchDims:1}});wf(n,x);const I=u.slice(0,-1);I.push(i),D=S,S=pt({inputs:{x:S},attrs:{shape:I},backend:n}),wf(n,D);const E=P;return P=pt({inputs:{x:P},attrs:{shape:I},backend:n}),wf(n,E),[P,S]}const Fet={kernelName:jk,backendName:"webgl",kernelFunc:Pet};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Let{constructor(e,n,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zet(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,h,f]=s.shape,[m,g]=u??[d,h],x=[c,m,g,f],w=new Let(d,h,o,a,l,x);return n.runWebGLProgram(w,[s,i],"float32")}const Bet={kernelName:Wk,backendName:"webgl",kernelFunc:zet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uet(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;dv(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:l,indices:u}=L7e(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const Vet={kernelName:NO,backendName:"webgl",kernelFunc:Uet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jet(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[i],u=new Array(a-1);let c=0;for(let g=0;g<a;g++)g!==i&&(u[c++]=o.shape[g]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const m=new Array(l);for(let g=0;g<m.length;g++){h[i]=g;const x=My({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),w=pt({inputs:{x},backend:n,attrs:{shape:u}});m[g]=w,d.push(x)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const Wet={kernelName:Ub,backendName:"webgl",kernelFunc:jet};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Get{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";i%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Het(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,l=[];let u=0;const c=zn([u],a);let d=s;c!=null&&(d=bi({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=qn(1,a)[0]);const h=bP(d.shape,u,o),f=Ue([d.shape[u]]),m=pt({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(m);const g=Yk(s.dtype),x=(C,T,D,P,I)=>{const E=C.shape[0],M=C.shape[1],O=sX(M,I),j={windowSize:O,inSize:M,batchSize:E,numSegments:I},R=new Get(j,T),z=n.compileAndRun(R,[C,D],P);if(l.push(z),z.shape[1]===I)return z;const B=xte({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),V=wte({inputs:{x:B},backend:n,attrs:{reps:[M/O]}});return l.push(B),l.push(V),x(z,T,V,P,I)},w=x(m,"unsortedSegmentSum",i,g,o),b=pt({inputs:{x:w},backend:n,attrs:{shape:h}});let S=b;if(c!=null){l.push(b);const C=Du(c);S=bi({inputs:{x:S},backend:n,attrs:{perm:C}})}return l.forEach(C=>n.disposeIntermediateTensorInfo(C)),S}const Yet={kernelName:Vb,backendName:"webgl",kernelFunc:Het};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ket=[_He,$He,DHe,FHe,zHe,VHe,WHe,HHe,XHe,QHe,tYe,sYe,aYe,dYe,pYe,gYe,xYe,SYe,IYe,kYe,AYe,FYe,zYe,jYe,GYe,ZYe,JYe,rKe,hHe,oKe,dKe,mKe,vKe,IKe,kKe,EKe,AKe,DKe,FKe,BKe,VKe,WKe,HKe,qKe,ZKe,tqe,rqe,oqe,uqe,dqe,mqe,wqe,Cqe,kqe,_qe,Aqe,Rqe,Dqe,Pqe,Lqe,Bqe,Wqe,Yqe,Xqe,Qqe,tXe,sXe,lXe,hXe,dHe,pXe,uKe,yXe,bXe,CXe,pHe,TXe,$Xe,MXe,FXe,BXe,WXe,YXe,ZXe,tZe,sZe,oZe,cZe,hZe,pZe,xZe,bZe,SZe,IZe,kZe,AZe,DZe,LZe,HZe,yHe,XZe,JZe,nQe,iQe,YYe,lQe,cQe,hQe,mQe,wQe,gHe,vQe,CQe,NQe,TQe,EQe,KYe,VZe,$Qe,OQe,zQe,wHe,jQe,HQe,XQe,JQe,rJe,iJe,lJe,dJe,pJe,yJe,bJe,CJe,TJe,AJe,DJe,FJe,OYe,WZe,BJe,VJe,WJe,HJe,KJe,XJe,QJe,eet,net,iet,aet,cet,het,met,yet,wet,vet,jZe,kHe,Net,Eet,Aet,Met,Fet,Bet,THe,Vet,Wet,Yet,uQe];for(const t of Ket)kO(t);const qet=()=>{const t=W.useRef(null),e=W.useRef(null),[n,r]=W.useState(0),[s,i]=W.useState(null);W.useEffect(()=>{(async()=>{const c=await VLe(wu.BlazePose,{runtime:"mediapipe",modelType:"full",solutionPath:"https://cdn.jsdelivr.net/npm/@mediapipe/pose"});setInterval(async()=>{var d,h;if(((h=(d=t.current)==null?void 0:d.video)==null?void 0:h.readyState)===4){const f=t.current.video,m=await c.estimatePoses(f);m.length>0&&o(m[0])}},100)})()},[]);const o=u=>{const c=u.keypoints,d=c[CC.POSE_LANDMARKS.LEFT_HIP],h=c[CC.POSE_LANDMARKS.LEFT_SHOULDER],f=c[CC.POSE_LANDMARKS.LEFT_ELBOW];if(d&&h&&f){const m=a(d,h,f);l(u,m),m>160&&i("down"),m<30&&s==="down"&&(i("up"),r(g=>g+1))}},a=(u,c,d)=>{const h=Math.atan2(d.y-c.y,d.x-c.x)-Math.atan2(u.y-c.y,u.x-c.x);let f=Math.abs(h*180/Math.PI);return f>180&&(f=360-f),f},l=(u,c)=>{var h;const d=(h=e.current)==null?void 0:h.getContext("2d");d&&(d.clearRect(0,0,e.current.width,e.current.height),d.fillStyle="white",d.font="20px Arial",d.fillText(`Reps: ${n}`,20,40),d.fillText(`Stage: ${s}`,20,70),d.fillText(`Angle: ${Math.round(c)}`,20,100))};return he.jsxs("div",{className:"pose-tracker",children:[he.jsx(H1e,{ref:t,style:{width:640,height:480}}),he.jsx("canvas",{ref:e,width:640,height:480})]})},Xet=()=>{const[t,e]=W.useState(!1),[n,r]=W.useState(!1),[s,i]=W.useState(0),o=()=>r(l=>!l),a=()=>{i(0),r(!1)};return he.jsx("div",{className:"min-h-[calc(100vh-4rem)] p-6",children:he.jsxs("div",{className:"max-w-7xl mx-auto",children:[he.jsxs(xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[he.jsx("h1",{className:"text-4xl font-bold mb-4",children:"AI Personal Trainer"}),he.jsx("p",{className:"text-gray-400",children:"Get real-time form feedback and exercise tracking"})]}),he.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[he.jsx("div",{className:"lg:col-span-2",children:he.jsx(xi.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-gray-800/50 backdrop-blur-sm rounded-xl overflow-hidden",children:t?he.jsxs("div",{className:"relative",children:[he.jsx(qet,{setRepCount:i,isTracking:n})," ",he.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center space-x-4",children:[he.jsx("button",{onClick:o,className:`p-4 rounded-full ${n?"bg-red-500":"bg-purple-600"} hover:bg-opacity-90 transition-colors`,children:n?he.jsx(eie,{className:"h-6 w-6"}):he.jsx($M,{className:"h-6 w-6"})}),he.jsx("button",{onClick:a,className:"p-4 rounded-full bg-gray-700 hover:bg-gray-600 transition-colors",children:he.jsx(nie,{className:"h-6 w-6"})})]}),he.jsx("button",{onClick:()=>e(!1),className:"absolute top-4 right-4 p-2 bg-gray-900/50 backdrop-blur-sm rounded-full hover:bg-gray-700",children:he.jsx(tie,{className:"h-5 w-5"})})]}):he.jsxs("div",{className:"flex flex-col items-center justify-center h-96 border-2 border-dashed border-gray-700 rounded-lg",children:[he.jsx(Gse,{className:"h-12 w-12 text-gray-400 mb-4"}),he.jsx("button",{onClick:()=>e(!0),className:"px-6 py-3 bg-purple-600 rounded-lg hover:bg-purple-700 transition-colors",children:"Enable Camera"})]})})}),he.jsxs(xi.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[he.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-xl p-6",children:[he.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Exercise Analysis"}),he.jsxs("div",{className:"space-y-6",children:[he.jsxs("div",{children:[he.jsx("h3",{className:"font-medium mb-2",children:"Rep Counter"}),he.jsx("div",{className:"text-5xl font-bold text-center py-4",children:s})]}),he.jsxs("div",{children:[he.jsx("h3",{className:"font-medium mb-2",children:"Real-time Feedback"}),he.jsx("div",{className:"p-4 bg-gray-700/50 rounded-lg",children:he.jsx("p",{className:"text-gray-300",children:n?"Tracking your movement... Keep up the good form!":"Start tracking to receive real-time feedback"})})]})]})]}),he.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-xl p-6",children:[he.jsx("h3",{className:"font-medium mb-4",children:"Exercise History"}),he.jsx("div",{className:"space-y-2",children:[{name:"Squats",reps:15},{name:"Push-ups",reps:20},{name:"Lunges",reps:12}].map((l,u)=>he.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700/50 rounded-lg",children:[he.jsxs("div",{children:[he.jsx("div",{className:"font-medium",children:l.name}),he.jsxs("div",{className:"text-sm text-gray-400",children:[l.reps," reps"]})]}),he.jsx("div",{className:"text-purple-400",children:""})]},u))})]})]})]})]})})},Zet=()=>he.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-gray-900 p-6",children:he.jsx("div",{className:"max-w-7xl mx-auto",children:he.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[he.jsx("div",{className:"col-span-full lg:col-span-1",children:he.jsxs(xi.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-gray-800 rounded-xl p-6",children:[he.jsxs("div",{className:"flex items-center justify-between mb-6",children:[he.jsx("h2",{className:"text-2xl font-bold",children:"RepCoins Balance"}),he.jsx(Kse,{className:"h-6 w-6 text-yellow-500"})]}),he.jsx("div",{className:"text-4xl font-bold mb-4",children:"1,234 RC"}),he.jsx("div",{className:"text-sm text-gray-400",children:" $123.40 USD"}),he.jsxs("div",{className:"mt-6 space-y-4",children:[he.jsx("button",{className:"w-full py-3 bg-purple-600 rounded-lg hover:bg-purple-700 transition-colors",children:"Send RepCoins"}),he.jsx("button",{className:"w-full py-3 border border-purple-600 rounded-lg hover:bg-purple-600/10 transition-colors",children:"Receive RepCoins"})]})]})}),he.jsx("div",{className:"col-span-full lg:col-span-2",children:he.jsxs(xi.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-gray-800 rounded-xl p-6",children:[he.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Transaction History"}),he.jsxs("div",{className:"space-y-4",children:[he.jsx(J3,{type:"received",amount:"100",from:"Workout Reward",time:"2 hours ago"}),he.jsx(J3,{type:"sent",amount:"50",from:"Premium Class",time:"1 day ago"}),he.jsx(J3,{type:"received",amount:"75",from:"Challenge Completion",time:"3 days ago"})]})]})})]})})}),J3=({type:t,amount:e,from:n,time:r})=>{const s=t==="received";return he.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[he.jsxs("div",{className:"flex items-center space-x-4",children:[he.jsx("div",{className:`p-2 rounded-full ${s?"bg-green-500/20":"bg-red-500/20"}`,children:s?he.jsx(Vse,{className:"h-5 w-5 text-green-500"}):he.jsx(jse,{className:"h-5 w-5 text-red-500"})}),he.jsxs("div",{children:[he.jsx("div",{className:"font-medium",children:n}),he.jsxs("div",{className:"text-sm text-gray-400 flex items-center",children:[he.jsx(B8,{className:"h-4 w-4 mr-1"}),r]})]})]}),he.jsxs("div",{className:`font-bold ${s?"text-green-500":"text-red-500"}`,children:[s?"+":"-",e," RC"]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function mv(t){return t+.5|0}const Xd=(t,e,n)=>Math.max(Math.min(t,n),e);function cw(t){return Xd(mv(t*2.55),0,255)}function sh(t){return Xd(mv(t*255),0,255)}function hc(t){return Xd(mv(t/2.55)/100,0,1)}function l6(t){return Xd(mv(t*100),0,100)}const da={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},mM=[..."0123456789ABCDEF"],Qet=t=>mM[t&15],Jet=t=>mM[(t&240)>>4]+mM[t&15],pS=t=>(t&240)>>4===(t&15),ett=t=>pS(t.r)&&pS(t.g)&&pS(t.b)&&pS(t.a);function ttt(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&da[t[1]]*17,g:255&da[t[2]]*17,b:255&da[t[3]]*17,a:e===5?da[t[4]]*17:255}:(e===7||e===9)&&(n={r:da[t[1]]<<4|da[t[2]],g:da[t[3]]<<4|da[t[4]],b:da[t[5]]<<4|da[t[6]],a:e===9?da[t[7]]<<4|da[t[8]]:255})),n}const ntt=(t,e)=>t<255?e(t):"";function rtt(t){var e=ett(t)?Qet:Jet;return t?"#"+e(t.r)+e(t.g)+e(t.b)+ntt(t.a,e):void 0}const stt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function bte(t,e,n){const r=e*Math.min(n,1-n),s=(i,o=(i+t/30)%12)=>n-r*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function itt(t,e,n){const r=(s,i=(s+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[r(5),r(3),r(1)]}function ott(t,e,n){const r=bte(t,1,.5);let s;for(e+n>1&&(s=1/(e+n),e*=s,n*=s),s=0;s<3;s++)r[s]*=1-e-n,r[s]+=e;return r}function att(t,e,n,r,s){return t===s?(e-n)/r+(e<n?6:0):e===s?(n-t)/r+2:(t-e)/r+4}function f4(t){const n=t.r/255,r=t.g/255,s=t.b/255,i=Math.max(n,r,s),o=Math.min(n,r,s),a=(i+o)/2;let l,u,c;return i!==o&&(c=i-o,u=a>.5?c/(2-i-o):c/(i+o),l=att(n,r,s,c,i),l=l*60+.5),[l|0,u||0,a]}function p4(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(sh)}function m4(t,e,n){return p4(bte,t,e,n)}function ltt(t,e,n){return p4(ott,t,e,n)}function utt(t,e,n){return p4(itt,t,e,n)}function vte(t){return(t%360+360)%360}function ctt(t){const e=stt.exec(t);let n=255,r;if(!e)return;e[5]!==r&&(n=e[6]?cw(+e[5]):sh(+e[5]));const s=vte(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=ltt(s,i,o):e[1]==="hsv"?r=utt(s,i,o):r=m4(s,i,o),{r:r[0],g:r[1],b:r[2],a:n}}function dtt(t,e){var n=f4(t);n[0]=vte(n[0]+e),n=m4(n),t.r=n[0],t.g=n[1],t.b=n[2]}function htt(t){if(!t)return;const e=f4(t),n=e[0],r=l6(e[1]),s=l6(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${s}%, ${hc(t.a)})`:`hsl(${n}, ${r}%, ${s}%)`}const u6={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},c6={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function ftt(){const t={},e=Object.keys(c6),n=Object.keys(u6);let r,s,i,o,a;for(r=0;r<e.length;r++){for(o=a=e[r],s=0;s<n.length;s++)i=n[s],a=a.replace(i,u6[i]);i=parseInt(c6[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let mS;function ptt(t){mS||(mS=ftt(),mS.transparent=[0,0,0,0]);const e=mS[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const mtt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function gtt(t){const e=mtt.exec(t);let n=255,r,s,i;if(e){if(e[7]!==r){const o=+e[7];n=e[8]?cw(o):Xd(o*255,0,255)}return r=+e[1],s=+e[3],i=+e[5],r=255&(e[2]?cw(r):Xd(r,0,255)),s=255&(e[4]?cw(s):Xd(s,0,255)),i=255&(e[6]?cw(i):Xd(i,0,255)),{r,g:s,b:i,a:n}}}function ytt(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${hc(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const e$=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Jm=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function xtt(t,e,n){const r=Jm(hc(t.r)),s=Jm(hc(t.g)),i=Jm(hc(t.b));return{r:sh(e$(r+n*(Jm(hc(e.r))-r))),g:sh(e$(s+n*(Jm(hc(e.g))-s))),b:sh(e$(i+n*(Jm(hc(e.b))-i))),a:t.a+n*(e.a-t.a)}}function gS(t,e,n){if(t){let r=f4(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,e===0?360:1)),r=m4(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function Ste(t,e){return t&&Object.assign(e||{},t)}function d6(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=sh(t[3]))):(e=Ste(t,{r:0,g:0,b:0,a:1}),e.a=sh(e.a)),e}function wtt(t){return t.charAt(0)==="r"?gtt(t):ctt(t)}class w1{constructor(e){if(e instanceof w1)return e;const n=typeof e;let r;n==="object"?r=d6(e):n==="string"&&(r=ttt(e)||ptt(e)||wtt(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=Ste(this._rgb);return e&&(e.a=hc(e.a)),e}set rgb(e){this._rgb=d6(e)}rgbString(){return this._valid?ytt(this._rgb):void 0}hexString(){return this._valid?rtt(this._rgb):void 0}hslString(){return this._valid?htt(this._rgb):void 0}mix(e,n){if(e){const r=this.rgb,s=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=r.a-s.a,u=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-u,r.r=255&u*r.r+i*s.r+.5,r.g=255&u*r.g+i*s.g+.5,r.b=255&u*r.b+i*s.b+.5,r.a=o*r.a+(1-o)*s.a,this.rgb=r}return this}interpolate(e,n){return e&&(this._rgb=xtt(this._rgb,e._rgb,n)),this}clone(){return new w1(this.rgb)}alpha(e){return this._rgb.a=sh(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=mv(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return gS(this._rgb,2,e),this}darken(e){return gS(this._rgb,2,-e),this}saturate(e){return gS(this._rgb,1,e),this}desaturate(e){return gS(this._rgb,1,-e),this}rotate(e){return dtt(this._rgb,e),this}}/*!
 * Chart.js v4.4.8
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function rc(){}const btt=(()=>{let t=0;return()=>t++})();function Jn(t){return t==null}function Ts(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function An(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Oa(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Xl(t,e){return Oa(t)?t:e}function vn(t,e){return typeof t>"u"?e:t}const vtt=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function ir(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Dn(t,e,n,r){let s,i,o;if(Ts(t))for(i=t.length,s=0;s<i;s++)e.call(n,t[s],s);else if(An(t))for(o=Object.keys(t),i=o.length,s=0;s<i;s++)e.call(n,t[o[s]],o[s])}function nN(t,e){let n,r,s,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(s=t[n],i=e[n],s.datasetIndex!==i.datasetIndex||s.index!==i.index)return!1;return!0}function rN(t){if(Ts(t))return t.map(rN);if(An(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let s=0;for(;s<r;++s)e[n[s]]=rN(t[n[s]]);return e}return t}function Cte(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Stt(t,e,n,r){if(!Cte(t))return;const s=e[t],i=n[t];An(s)&&An(i)?b1(s,i,r):e[t]=rN(i)}function b1(t,e,n){const r=Ts(e)?e:[e],s=r.length;if(!An(t))return t;n=n||{};const i=n.merger||Stt;let o;for(let a=0;a<s;++a){if(o=r[a],!An(o))continue;const l=Object.keys(o);for(let u=0,c=l.length;u<c;++u)i(l[u],t,o,n)}return t}function Rw(t,e){return b1(t,e,{merger:Ctt})}function Ctt(t,e,n){if(!Cte(t))return;const r=e[t],s=n[t];An(r)&&An(s)?Rw(r,s):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=rN(s))}const h6={"":t=>t,x:t=>t.x,y:t=>t.y};function Itt(t){const e=t.split("."),n=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function Ntt(t){const e=Itt(t);return n=>{for(const r of e){if(r==="")break;n=n&&n[r]}return n}}function sN(t,e){return(h6[e]||(h6[e]=Ntt(e)))(t)}function g4(t){return t.charAt(0).toUpperCase()+t.slice(1)}const iN=t=>typeof t<"u",Ch=t=>typeof t=="function",f6=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function ktt(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const _s=Math.PI,Su=2*_s,Ttt=Su+_s,oN=Number.POSITIVE_INFINITY,Ett=_s/180,yl=_s/2,bf=_s/4,p6=_s*2/3,Ite=Math.log10,o0=Math.sign;function Mw(t,e,n){return Math.abs(t-e)<n}function m6(t){const e=Math.round(t);t=Mw(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(Ite(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function _tt(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(n|0)&&e.push(n),e.sort((s,i)=>s-i).pop(),e}function Att(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function v1(t){return!Att(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function $tt(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function Rtt(t,e,n){let r,s,i;for(r=0,s=t.length;r<s;r++)i=t[r][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function Zf(t){return t*(_s/180)}function Mtt(t){return t*(180/_s)}function g6(t){if(!Oa(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Dtt(t,e){const n=e.x-t.x,r=e.y-t.y,s=Math.sqrt(n*n+r*r);let i=Math.atan2(r,n);return i<-.5*_s&&(i+=Su),{angle:i,distance:s}}function gM(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Ott(t,e){return(t-e+Ttt)%Su-_s}function Md(t){return(t%Su+Su)%Su}function Nte(t,e,n,r){const s=Md(t),i=Md(e),o=Md(n),a=Md(i-s),l=Md(o-s),u=Md(s-i),c=Md(s-o);return s===i||s===o||r&&i===o||a>l&&u<c}function ka(t,e,n){return Math.max(e,Math.min(n,t))}function Ptt(t){return ka(t,-32768,32767)}function dw(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}function y4(t,e,n){n=n||(o=>t[o]<e);let r=t.length-1,s=0,i;for(;r-s>1;)i=s+r>>1,n(i)?s=i:r=i;return{lo:s,hi:r}}const Qf=(t,e,n,r)=>y4(t,n,r?s=>{const i=t[s][e];return i<n||i===n&&t[s+1][e]===n}:s=>t[s][e]<n),Ftt=(t,e,n)=>y4(t,n,r=>t[r][e]>=n);function Ltt(t,e,n){let r=0,s=t.length;for(;r<s&&t[r]<e;)r++;for(;s>r&&t[s-1]>n;)s--;return r>0||s<t.length?t.slice(r,s):t}const kte=["push","pop","shift","splice","unshift"];function ztt(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),kte.forEach(n=>{const r="_onData"+g4(n),s=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=s.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...i)}),o}})})}function y6(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(kte.forEach(i=>{delete t[i]}),delete t._chartjs)}function Btt(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Tte=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function Ete(t,e){let n=[],r=!1;return function(...s){n=s,r||(r=!0,Tte.call(window,()=>{r=!1,t.apply(e,n)}))}}function Utt(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const x4=t=>t==="start"?"left":t==="end"?"right":"center",ui=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Vtt=(t,e,n,r)=>t===(r?"left":"right")?n:t==="center"?(e+n)/2:e;function jtt(t,e,n){const r=e.length;let s=0,i=r;if(t._sorted){const{iScale:o,vScale:a,_parsed:l}=t,u=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,c=o.axis,{min:d,max:h,minDefined:f,maxDefined:m}=o.getUserBounds();if(f){if(s=Math.min(Qf(l,c,d).lo,n?r:Qf(e,c,o.getPixelForValue(d)).lo),u){const g=l.slice(0,s+1).reverse().findIndex(x=>!Jn(x[a.axis]));s-=Math.max(0,g)}s=ka(s,0,r-1)}if(m){let g=Math.max(Qf(l,o.axis,h,!0).hi+1,n?0:Qf(e,c,o.getPixelForValue(h),!0).hi+1);if(u){const x=l.slice(g-1).findIndex(w=>!Jn(w[a.axis]));g+=Math.max(0,x)}i=ka(g,s,r)-s}else i=r-s}return{start:s,count:i}}function Wtt(t){const{xScale:e,yScale:n,_scaleRanges:r}=t,s={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!r)return t._scaleRanges=s,!0;const i=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,s),i}const yS=t=>t===0||t===1,x6=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Su/n)),w6=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Su/n)+1,Dw={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*yl)+1,easeOutSine:t=>Math.sin(t*yl),easeInOutSine:t=>-.5*(Math.cos(_s*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>yS(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>yS(t)?t:x6(t,.075,.3),easeOutElastic:t=>yS(t)?t:w6(t,.075,.3),easeInOutElastic(t){return yS(t)?t:t<.5?.5*x6(t*2,.1125,.45):.5+.5*w6(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Dw.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Dw.easeInBounce(t*2)*.5:Dw.easeOutBounce(t*2-1)*.5+.5};function w4(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function b6(t){return w4(t)?t:new w1(t)}function t$(t){return w4(t)?t:new w1(t).saturate(.5).darken(.1).hexString()}const Gtt=["x","y","borderWidth","radius","tension"],Htt=["color","borderColor","backgroundColor"];function Ytt(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Htt},numbers:{type:"number",properties:Gtt}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Ktt(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const v6=new Map;function qtt(t,e){e=e||{};const n=t+JSON.stringify(e);let r=v6.get(n);return r||(r=new Intl.NumberFormat(t,e),v6.set(n,r)),r}function _te(t,e,n){return qtt(e,n).format(t)}const Xtt={values(t){return Ts(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const r=this.chart.options.locale;let s,i=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(s="scientific"),i=Ztt(t,n)}const o=Ite(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),_te(t,r,l)}};function Ztt(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Ate={formatters:Xtt};function Qtt(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ate.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Rp=Object.create(null),yM=Object.create(null);function Ow(t,e){if(!e)return t;const n=e.split(".");for(let r=0,s=n.length;r<s;++r){const i=n[r];t=t[i]||(t[i]=Object.create(null))}return t}function n$(t,e,n){return typeof e=="string"?b1(Ow(t,e),n):b1(Ow(t,""),e)}class Jtt{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>t$(s.backgroundColor),this.hoverBorderColor=(r,s)=>t$(s.borderColor),this.hoverColor=(r,s)=>t$(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return n$(this,e,n)}get(e){return Ow(this,e)}describe(e,n){return n$(yM,e,n)}override(e,n){return n$(Rp,e,n)}route(e,n,r,s){const i=Ow(this,e),o=Ow(this,r),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],u=o[s];return An(l)?Object.assign({},u,l):vn(l,u)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Ur=new Jtt({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ytt,Ktt,Qtt]);function ent(t){return!t||Jn(t.size)||Jn(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function S6(t,e,n,r,s){let i=e[s];return i||(i=e[s]=t.measureText(s).width,n.push(s)),i>r&&(r=i),r}function vf(t,e,n){const r=t.currentDevicePixelRatio,s=n!==0?Math.max(n/2,.5):0;return Math.round((e-s)*r)/r+s}function C6(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function xM(t,e,n,r){$te(t,e,n,r,null)}function $te(t,e,n,r,s){let i,o,a,l,u,c,d,h;const f=e.pointStyle,m=e.rotation,g=e.radius;let x=(m||0)*Ett;if(f&&typeof f=="object"&&(i=f.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,r),t.rotate(x),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(g)||g<=0)){switch(t.beginPath(),f){default:s?t.ellipse(n,r,s/2,g,0,0,Su):t.arc(n,r,g,0,Su),t.closePath();break;case"triangle":c=s?s/2:g,t.moveTo(n+Math.sin(x)*c,r-Math.cos(x)*g),x+=p6,t.lineTo(n+Math.sin(x)*c,r-Math.cos(x)*g),x+=p6,t.lineTo(n+Math.sin(x)*c,r-Math.cos(x)*g),t.closePath();break;case"rectRounded":u=g*.516,l=g-u,o=Math.cos(x+bf)*l,d=Math.cos(x+bf)*(s?s/2-u:l),a=Math.sin(x+bf)*l,h=Math.sin(x+bf)*(s?s/2-u:l),t.arc(n-d,r-a,u,x-_s,x-yl),t.arc(n+h,r-o,u,x-yl,x),t.arc(n+d,r+a,u,x,x+yl),t.arc(n-h,r+o,u,x+yl,x+_s),t.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*g,c=s?s/2:l,t.rect(n-c,r-l,2*c,2*l);break}x+=bf;case"rectRot":d=Math.cos(x)*(s?s/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,h=Math.sin(x)*(s?s/2:g),t.moveTo(n-d,r-a),t.lineTo(n+h,r-o),t.lineTo(n+d,r+a),t.lineTo(n-h,r+o),t.closePath();break;case"crossRot":x+=bf;case"cross":d=Math.cos(x)*(s?s/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,h=Math.sin(x)*(s?s/2:g),t.moveTo(n-d,r-a),t.lineTo(n+d,r+a),t.moveTo(n+h,r-o),t.lineTo(n-h,r+o);break;case"star":d=Math.cos(x)*(s?s/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,h=Math.sin(x)*(s?s/2:g),t.moveTo(n-d,r-a),t.lineTo(n+d,r+a),t.moveTo(n+h,r-o),t.lineTo(n-h,r+o),x+=bf,d=Math.cos(x)*(s?s/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,h=Math.sin(x)*(s?s/2:g),t.moveTo(n-d,r-a),t.lineTo(n+d,r+a),t.moveTo(n+h,r-o),t.lineTo(n-h,r+o);break;case"line":o=s?s/2:Math.cos(x)*g,a=Math.sin(x)*g,t.moveTo(n-o,r-a),t.lineTo(n+o,r+a);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(x)*(s?s/2:g),r+Math.sin(x)*g);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function S1(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function b4(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function v4(t){t.restore()}function tnt(t,e,n,r,s){if(!e)return t.lineTo(n.x,n.y);if(s==="middle"){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else s==="after"!=!!r?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function nnt(t,e,n,r){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function rnt(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Jn(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function snt(t,e,n,r,s){if(s.strikethrough||s.underline){const i=t.measureText(r),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,c=s.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=s.decorationWidth||2,t.moveTo(o,c),t.lineTo(a,c),t.stroke()}}function int(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function C1(t,e,n,r,s,i={}){const o=Ts(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,u;for(t.save(),t.font=s.string,rnt(t,i),l=0;l<o.length;++l)u=o[l],i.backdrop&&int(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),Jn(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(u,n,r,i.maxWidth)),t.fillText(u,n,r,i.maxWidth),snt(t,n,r,u,i),r+=Number(s.lineHeight);t.restore()}function wM(t,e){const{x:n,y:r,w:s,h:i,radius:o}=e;t.arc(n+o.topLeft,r+o.topLeft,o.topLeft,1.5*_s,_s,!0),t.lineTo(n,r+i-o.bottomLeft),t.arc(n+o.bottomLeft,r+i-o.bottomLeft,o.bottomLeft,_s,yl,!0),t.lineTo(n+s-o.bottomRight,r+i),t.arc(n+s-o.bottomRight,r+i-o.bottomRight,o.bottomRight,yl,0,!0),t.lineTo(n+s,r+o.topRight),t.arc(n+s-o.topRight,r+o.topRight,o.topRight,0,-yl,!0),t.lineTo(n+o.topLeft,r)}const ont=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ant=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function lnt(t,e){const n=(""+t).match(ont);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const unt=t=>+t||0;function Rte(t,e){const n={},r=An(e),s=r?Object.keys(e):e,i=An(t)?r?o=>vn(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of s)n[o]=unt(i(o));return n}function cnt(t){return Rte(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Pw(t){return Rte(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Pa(t){const e=cnt(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function yi(t,e){t=t||{},e=e||Ur.font;let n=vn(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let r=vn(t.style,e.style);r&&!(""+r).match(ant)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:vn(t.family,e.family),lineHeight:lnt(vn(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:vn(t.weight,e.weight),string:""};return s.string=ent(s),s}function xS(t,e,n,r){let s,i,o;for(s=0,i=t.length;s<i;++s)if(o=t[s],o!==void 0&&o!==void 0)return o}function dnt(t,e,n){const{min:r,max:s}=t,i=vtt(e,(s-r)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(r,-Math.abs(i)),max:o(s,i)}}function nm(t,e){return Object.assign(Object.create(t),e)}function S4(t,e=[""],n,r,s=()=>t[0]){const i=n||t;typeof r>"u"&&(r=Pte("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:r,_getTarget:s,override:a=>S4([a,...t],e,i,r)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return Dte(a,l,()=>wnt(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return N6(a).includes(l)},ownKeys(a){return N6(a)},set(a,l,u){const c=a._storage||(a._storage=s());return a[l]=c[l]=u,delete a._keys,!0}})}function a0(t,e,n,r){const s={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Mte(t,r),setContext:i=>a0(t,i,n,r),override:i=>a0(t.override(i),e,n,r)};return new Proxy(s,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return Dte(i,o,()=>fnt(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function Mte(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=t;return{allKeys:s,scriptable:n,indexable:r,isScriptable:Ch(n)?n:()=>n,isIndexable:Ch(r)?r:()=>r}}const hnt=(t,e)=>t?t+g4(e):e,C4=(t,e)=>An(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Dte(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const r=n();return t[e]=r,r}function fnt(t,e,n){const{_proxy:r,_context:s,_subProxy:i,_descriptors:o}=t;let a=r[e];return Ch(a)&&o.isScriptable(e)&&(a=pnt(e,a,t,n)),Ts(a)&&a.length&&(a=mnt(e,a,t,o.isIndexable)),C4(e,a)&&(a=a0(a,s,i&&i[e],o)),a}function pnt(t,e,n,r){const{_proxy:s,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||r);return a.delete(t),C4(t,l)&&(l=I4(s._scopes,s,t,l)),l}function mnt(t,e,n,r){const{_proxy:s,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&r(t))return e[i.index%e.length];if(An(e[0])){const l=e,u=s._scopes.filter(c=>c!==l);e=[];for(const c of l){const d=I4(u,s,t,c);e.push(a0(d,i,o&&o[t],a))}}return e}function Ote(t,e,n){return Ch(t)?t(e,n):t}const gnt=(t,e)=>t===!0?e:typeof t=="string"?sN(e,t):void 0;function ynt(t,e,n,r,s){for(const i of e){const o=gnt(n,i);if(o){t.add(o);const a=Ote(o._fallback,n,s);if(typeof a<"u"&&a!==n&&a!==r)return a}else if(o===!1&&typeof r<"u"&&n!==r)return null}return!1}function I4(t,e,n,r){const s=e._rootScopes,i=Ote(e._fallback,n,r),o=[...t,...s],a=new Set;a.add(r);let l=I6(a,o,n,i||n,r);return l===null||typeof i<"u"&&i!==n&&(l=I6(a,o,i,l,r),l===null)?!1:S4(Array.from(a),[""],s,i,()=>xnt(e,n,r))}function I6(t,e,n,r,s){for(;n;)n=ynt(t,e,n,r,s);return n}function xnt(t,e,n){const r=t._getTarget();e in r||(r[e]={});const s=r[e];return Ts(s)&&An(n)?n:s||{}}function wnt(t,e,n,r){let s;for(const i of e)if(s=Pte(hnt(i,t),n),typeof s<"u")return C4(t,s)?I4(n,r,t,s):s}function Pte(t,e){for(const n of e){if(!n)continue;const r=n[t];if(typeof r<"u")return r}}function N6(t){let e=t._keys;return e||(e=t._keys=bnt(t._scopes)),e}function bnt(t){const e=new Set;for(const n of t)for(const r of Object.keys(n).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}const vnt=Number.EPSILON||1e-14,l0=(t,e)=>e<t.length&&!t[e].skip&&t[e],Fte=t=>t==="x"?"y":"x";function Snt(t,e,n,r){const s=t.skip?e:t,i=e,o=n.skip?e:n,a=gM(i,s),l=gM(o,i);let u=a/(a+l),c=l/(a+l);u=isNaN(u)?0:u,c=isNaN(c)?0:c;const d=r*u,h=r*c;return{previous:{x:i.x-d*(o.x-s.x),y:i.y-d*(o.y-s.y)},next:{x:i.x+h*(o.x-s.x),y:i.y+h*(o.y-s.y)}}}function Cnt(t,e,n){const r=t.length;let s,i,o,a,l,u=l0(t,0);for(let c=0;c<r-1;++c)if(l=u,u=l0(t,c+1),!(!l||!u)){if(Mw(e[c],0,vnt)){n[c]=n[c+1]=0;continue}s=n[c]/e[c],i=n[c+1]/e[c],a=Math.pow(s,2)+Math.pow(i,2),!(a<=9)&&(o=3/Math.sqrt(a),n[c]=s*o*e[c],n[c+1]=i*o*e[c])}}function Int(t,e,n="x"){const r=Fte(n),s=t.length;let i,o,a,l=l0(t,0);for(let u=0;u<s;++u){if(o=a,a=l,l=l0(t,u+1),!a)continue;const c=a[n],d=a[r];o&&(i=(c-o[n])/3,a[`cp1${n}`]=c-i,a[`cp1${r}`]=d-i*e[u]),l&&(i=(l[n]-c)/3,a[`cp2${n}`]=c+i,a[`cp2${r}`]=d+i*e[u])}}function Nnt(t,e="x"){const n=Fte(e),r=t.length,s=Array(r).fill(0),i=Array(r);let o,a,l,u=l0(t,0);for(o=0;o<r;++o)if(a=l,l=u,u=l0(t,o+1),!!l){if(u){const c=u[e]-l[e];s[o]=c!==0?(u[n]-l[n])/c:0}i[o]=a?u?o0(s[o-1])!==o0(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}Cnt(t,s,i),Int(t,i,e)}function wS(t,e,n){return Math.max(Math.min(t,n),e)}function knt(t,e){let n,r,s,i,o,a=S1(t[0],e);for(n=0,r=t.length;n<r;++n)o=i,i=a,a=n<r-1&&S1(t[n+1],e),i&&(s=t[n],o&&(s.cp1x=wS(s.cp1x,e.left,e.right),s.cp1y=wS(s.cp1y,e.top,e.bottom)),a&&(s.cp2x=wS(s.cp2x,e.left,e.right),s.cp2y=wS(s.cp2y,e.top,e.bottom)))}function Tnt(t,e,n,r,s){let i,o,a,l;if(e.spanGaps&&(t=t.filter(u=>!u.skip)),e.cubicInterpolationMode==="monotone")Nnt(t,s);else{let u=r?t[t.length-1]:t[0];for(i=0,o=t.length;i<o;++i)a=t[i],l=Snt(u,a,t[Math.min(i+1,o-(r?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,u=a}e.capBezierPoints&&knt(t,n)}function N4(){return typeof window<"u"&&typeof document<"u"}function k4(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function aN(t,e,n){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[n])):r=t,r}const aE=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Ent(t,e){return aE(t).getPropertyValue(e)}const _nt=["top","right","bottom","left"];function op(t,e,n){const r={};n=n?"-"+n:"";for(let s=0;s<4;s++){const i=_nt[s];r[i]=parseFloat(t[e+"-"+i+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const Ant=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function $nt(t,e){const n=t.touches,r=n&&n.length?n[0]:t,{offsetX:s,offsetY:i}=r;let o=!1,a,l;if(Ant(s,i,t.target))a=s,l=i;else{const u=e.getBoundingClientRect();a=r.clientX-u.left,l=r.clientY-u.top,o=!0}return{x:a,y:l,box:o}}function Df(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:r}=e,s=aE(n),i=s.boxSizing==="border-box",o=op(s,"padding"),a=op(s,"border","width"),{x:l,y:u,box:c}=$nt(t,n),d=o.left+(c&&a.left),h=o.top+(c&&a.top);let{width:f,height:m}=e;return i&&(f-=o.width+a.width,m-=o.height+a.height),{x:Math.round((l-d)/f*n.width/r),y:Math.round((u-h)/m*n.height/r)}}function Rnt(t,e,n){let r,s;if(e===void 0||n===void 0){const i=t&&k4(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=aE(i),l=op(a,"border","width"),u=op(a,"padding");e=o.width-u.width-l.width,n=o.height-u.height-l.height,r=aN(a.maxWidth,i,"clientWidth"),s=aN(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:r||oN,maxHeight:s||oN}}const bS=t=>Math.round(t*10)/10;function Mnt(t,e,n,r){const s=aE(t),i=op(s,"margin"),o=aN(s.maxWidth,t,"clientWidth")||oN,a=aN(s.maxHeight,t,"clientHeight")||oN,l=Rnt(t,e,n);let{width:u,height:c}=l;if(s.boxSizing==="content-box"){const h=op(s,"border","width"),f=op(s,"padding");u-=f.width+h.width,c-=f.height+h.height}return u=Math.max(0,u-i.width),c=Math.max(0,r?u/r:c-i.height),u=bS(Math.min(u,o,l.maxWidth)),c=bS(Math.min(c,a,l.maxHeight)),u&&!c&&(c=bS(u/2)),(e!==void 0||n!==void 0)&&r&&l.height&&c>l.height&&(c=l.height,u=bS(Math.floor(c*r))),{width:u,height:c}}function k6(t,e,n){const r=e||1,s=Math.floor(t.height*r),i=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||o.height!==s||o.width!==i?(t.currentDevicePixelRatio=r,o.height=s,o.width=i,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const Dnt=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};N4()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function T6(t,e){const n=Ent(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Of(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function Ont(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:r==="middle"?n<.5?t.y:e.y:r==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function Pnt(t,e,n,r){const s={x:t.cp2x,y:t.cp2y},i={x:e.cp1x,y:e.cp1y},o=Of(t,s,n),a=Of(s,i,n),l=Of(i,e,n),u=Of(o,a,n),c=Of(a,l,n);return Of(u,c,n)}const Fnt=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},Lnt=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Fg(t,e,n){return t?Fnt(e,n):Lnt()}function Lte(t,e){let n,r;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function zte(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Bte(t){return t==="angle"?{between:Nte,compare:Ott,normalize:Md}:{between:dw,compare:(e,n)=>e-n,normalize:e=>e}}function E6({start:t,end:e,count:n,loop:r,style:s}){return{start:t%n,end:e%n,loop:r&&(e-t+1)%n===0,style:s}}function znt(t,e,n){const{property:r,start:s,end:i}=n,{between:o,normalize:a}=Bte(r),l=e.length;let{start:u,end:c,loop:d}=t,h,f;if(d){for(u+=l,c+=l,h=0,f=l;h<f&&o(a(e[u%l][r]),s,i);++h)u--,c--;u%=l,c%=l}return c<u&&(c+=l),{start:u,end:c,loop:d,style:t.style}}function Bnt(t,e,n){if(!n)return[t];const{property:r,start:s,end:i}=n,o=e.length,{compare:a,between:l,normalize:u}=Bte(r),{start:c,end:d,loop:h,style:f}=znt(t,e,n),m=[];let g=!1,x=null,w,b,S;const C=()=>l(s,S,w)&&a(s,S)!==0,T=()=>a(i,w)===0||l(i,S,w),D=()=>g||C(),P=()=>!g||T();for(let I=c,E=c;I<=d;++I)b=e[I%o],!b.skip&&(w=u(b[r]),w!==S&&(g=l(w,s,i),x===null&&D()&&(x=a(w,s)===0?I:E),x!==null&&P()&&(m.push(E6({start:x,end:I,loop:h,count:o,style:f})),x=null),E=I,S=w));return x!==null&&m.push(E6({start:x,end:d,loop:h,count:o,style:f})),m}function Unt(t,e){const n=[],r=t.segments;for(let s=0;s<r.length;s++){const i=Bnt(r[s],t.points,e);i.length&&n.push(...i)}return n}function Vnt(t,e,n,r){let s=0,i=e-1;if(n&&!r)for(;s<e&&!t[s].skip;)s++;for(;s<e&&t[s].skip;)s++;for(s%=e,n&&(i+=s);i>s&&t[i%e].skip;)i--;return i%=e,{start:s,end:i}}function jnt(t,e,n,r){const s=t.length,i=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const u=t[l%s];u.skip||u.stop?a.skip||(r=!1,i.push({start:e%s,end:(l-1)%s,loop:r}),e=o=u.stop?l:null):(o=l,a.skip&&(e=l)),a=u}return o!==null&&i.push({start:e%s,end:o%s,loop:r}),i}function Wnt(t,e){const n=t.points,r=t.options.spanGaps,s=n.length;if(!s)return[];const i=!!t._loop,{start:o,end:a}=Vnt(n,s,i,r);if(r===!0)return _6(t,[{start:o,end:a,loop:i}],n,e);const l=a<o?a+s:a,u=!!t._fullLoop&&o===0&&a===s-1;return _6(t,jnt(n,o,l,u),n,e)}function _6(t,e,n,r){return!r||!r.setContext||!n?e:Gnt(t,e,n,r)}function Gnt(t,e,n,r){const s=t._chart.getContext(),i=A6(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,u=[];let c=i,d=e[0].start,h=d;function f(m,g,x,w){const b=a?-1:1;if(m!==g){for(m+=l;n[m%l].skip;)m-=b;for(;n[g%l].skip;)g+=b;m%l!==g%l&&(u.push({start:m%l,end:g%l,loop:x,style:w}),c=w,d=g%l)}}for(const m of e){d=a?d:m.start;let g=n[d%l],x;for(h=d+1;h<=m.end;h++){const w=n[h%l];x=A6(r.setContext(nm(s,{type:"segment",p0:g,p1:w,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:o}))),Hnt(x,c)&&f(d,h-1,m.loop,c),g=w,c=x}d<h-1&&f(d,h-1,m.loop,c)}return u}function A6(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Hnt(t,e){if(!e)return!1;const n=[],r=function(s,i){return w4(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(t,r)!==JSON.stringify(e,r)}/*!
 * Chart.js v4.4.8
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Ynt{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,r,s){const i=n.listeners[s],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(r-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Tte.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const i=r.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(s.draw(),this._notify(s,r,e,"progress")),i.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let r=n.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,r)),r}listen(e,n,r){this._getAnims(e).listeners[n].push(r)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const r=n.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ic=new Ynt;const $6="transparent",Knt={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=b6(t||$6),s=r.valid&&b6(e||$6);return s&&s.valid?s.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class qnt{constructor(e,n,r,s){const i=n[r];s=xS([e.to,s,i,e.from]);const o=xS([e.from,i,s]);this._active=!0,this._fn=e.fn||Knt[e.type||typeof o],this._easing=Dw[e.easing]||Dw.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,n,r){if(this._active){this._notify(!1);const s=this._target[this._prop],i=r-this._start,o=this._duration-i;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=xS([e.to,n,s,e.from]),this._from=xS([e.from,s,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,r=this._duration,s=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<r),!this._active){this._target[s]=a,this._notify(!0);return}if(n<0){this._target[s]=i;return}l=n/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,r)=>{e.push({res:n,rej:r})})}_notify(e){const n=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][n]()}}class Ute{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!An(e))return;const n=Object.keys(Ur.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const i=e[s];if(!An(i))return;const o={};for(const a of n)o[a]=i[a];(Ts(i.properties)&&i.properties||[s]).forEach(a=>{(a===s||!r.has(a))&&r.set(a,o)})})}_animateOptions(e,n){const r=n.options,s=Znt(e,r);if(!s)return[];const i=this._createAnimations(s,r);return r.$shared&&Xnt(e.options.$animations,r).then(()=>{e.options=r},()=>{}),i}_createAnimations(e,n){const r=this._properties,s=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const u=o[l];if(u.charAt(0)==="$")continue;if(u==="options"){s.push(...this._animateOptions(e,n));continue}const c=n[u];let d=i[u];const h=r.get(u);if(d)if(h&&d.active()){d.update(h,c,a);continue}else d.cancel();if(!h||!h.duration){e[u]=c;continue}i[u]=d=new qnt(h,e,u,c),s.push(d)}return s}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const r=this._createAnimations(e,n);if(r.length)return ic.add(this._chart,r),!0}}function Xnt(t,e){const n=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const i=t[r[s]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function Znt(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function R6(t,e){const n=t&&t.options||{},r=n.reverse,s=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:r?i:s,end:r?s:i}}function Qnt(t,e,n){if(n===!1)return!1;const r=R6(t,n),s=R6(e,n);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function Jnt(t){let e,n,r,s;return An(t)?(e=t.top,n=t.right,r=t.bottom,s=t.left):e=n=r=s=t,{top:e,right:n,bottom:r,left:s,disabled:t===!1}}function Vte(t,e){const n=[],r=t._getSortedDatasetMetas(e);let s,i;for(s=0,i=r.length;s<i;++s)n.push(r[s].index);return n}function M6(t,e,n,r={}){const s=t.keys,i=r.mode==="single";let o,a,l,u;if(e===null)return;let c=!1;for(o=0,a=s.length;o<a;++o){if(l=+s[o],l===n){if(c=!0,r.all)continue;break}u=t.values[l],Oa(u)&&(i||e===0||o0(e)===o0(u))&&(e+=u)}return!c&&!r.all?0:e}function ert(t,e){const{iScale:n,vScale:r}=e,s=n.axis==="x"?"x":"y",i=r.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,u,c;for(l=0,u=o.length;l<u;++l)c=o[l],a[l]={[s]:c,[i]:t[c]};return a}function r$(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function trt(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function nrt(t){const{min:e,max:n,minDefined:r,maxDefined:s}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?n:Number.POSITIVE_INFINITY}}function rrt(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function D6(t,e,n,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const i=t[s.index];if(n&&i>0||!n&&i<0)return s.index}return null}function O6(t,e){const{chart:n,_cachedMeta:r}=t,s=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=r,l=i.axis,u=o.axis,c=trt(i,o,r),d=e.length;let h;for(let f=0;f<d;++f){const m=e[f],{[l]:g,[u]:x}=m,w=m._stacks||(m._stacks={});h=w[u]=rrt(s,c,g),h[a]=x,h._top=D6(h,o,!0,r.type),h._bottom=D6(h,o,!1,r.type);const b=h._visualValues||(h._visualValues={});b[a]=x}}function s$(t,e){const n=t.scales;return Object.keys(n).filter(r=>n[r].axis===e).shift()}function srt(t,e){return nm(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function irt(t,e,n){return nm(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Dx(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const s of e){const i=s._stacks;if(!i||i[r]===void 0||i[r][n]===void 0)return;delete i[r][n],i[r]._visualValues!==void 0&&i[r]._visualValues[n]!==void 0&&delete i[r]._visualValues[n]}}}const i$=t=>t==="reset"||t==="none",P6=(t,e)=>e?t:Object.assign({},t),ort=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Vte(n,!0),values:null};class Fw{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=r$(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Dx(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,r=this.getDataset(),s=(d,h,f,m)=>d==="x"?h:d==="r"?m:f,i=n.xAxisID=vn(r.xAxisID,s$(e,"x")),o=n.yAxisID=vn(r.yAxisID,s$(e,"y")),a=n.rAxisID=vn(r.rAxisID,s$(e,"r")),l=n.indexAxis,u=n.iAxisID=s(l,i,o,a),c=n.vAxisID=s(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&y6(this._data,this),e._stacked&&Dx(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if(An(n)){const s=this._cachedMeta;this._data=ert(n,s)}else if(r!==n){if(r){y6(r,this);const s=this._cachedMeta;Dx(s),s._parsed=[]}n&&Object.isExtensible(n)&&ztt(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const i=n._stacked;n._stacked=r$(n.vScale,n),n.stack!==r.stack&&(s=!0,Dx(n),n.stack=r.stack),this._resyncElements(e),(s||i!==n._stacked)&&(O6(this,n._parsed),n._stacked=r$(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:r,_data:s}=this,{iScale:i,_stacked:o}=r,a=i.axis;let l=e===0&&n===s.length?!0:r._sorted,u=e>0&&r._parsed[e-1],c,d,h;if(this._parsing===!1)r._parsed=s,r._sorted=!0,h=s;else{Ts(s[e])?h=this.parseArrayData(r,s,e,n):An(s[e])?h=this.parseObjectData(r,s,e,n):h=this.parsePrimitiveData(r,s,e,n);const f=()=>d[a]===null||u&&d[a]<u[a];for(c=0;c<n;++c)r._parsed[c+e]=d=h[c],l&&(f()&&(l=!1),u=d);r._sorted=l}o&&O6(this,h)}parsePrimitiveData(e,n,r,s){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,u=i.getLabels(),c=i===o,d=new Array(s);let h,f,m;for(h=0,f=s;h<f;++h)m=h+r,d[h]={[a]:c||i.parse(u[m],m),[l]:o.parse(n[m],m)};return d}parseArrayData(e,n,r,s){const{xScale:i,yScale:o}=e,a=new Array(s);let l,u,c,d;for(l=0,u=s;l<u;++l)c=l+r,d=n[c],a[l]={x:i.parse(d[0],c),y:o.parse(d[1],c)};return a}parseObjectData(e,n,r,s){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=new Array(s);let c,d,h,f;for(c=0,d=s;c<d;++c)h=c+r,f=n[h],u[c]={x:i.parse(sN(f,a),h),y:o.parse(sN(f,l),h)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){const s=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:Vte(s,!0),values:n._stacks[e.axis]._visualValues};return M6(a,o,i.index,{mode:r})}updateRangeFromParsed(e,n,r,s){const i=r[n.axis];let o=i===null?NaN:i;const a=s&&r._stacks[n.axis];s&&a&&(s.values=a,o=M6(s,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const r=this._cachedMeta,s=r._parsed,i=r._sorted&&e===r.iScale,o=s.length,a=this._getOtherScale(e),l=ort(n,r,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=nrt(a);let h,f;function m(){f=s[h];const g=f[a.axis];return!Oa(f[e.axis])||c>g||d<g}for(h=0;h<o&&!(!m()&&(this.updateRangeFromParsed(u,e,f,l),i));++h);if(i){for(h=o-1;h>=0;--h)if(!m()){this.updateRangeFromParsed(u,e,f,l);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,r=[];let s,i,o;for(s=0,i=n.length;s<i;++s)o=n[s][e.axis],Oa(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,r=n.iScale,s=n.vScale,i=this.getParsed(e);return{label:r?""+r.getLabelForValue(i[r.axis]):"",value:s?""+s.getLabelForValue(i[s.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=Jnt(vn(this.options.clip,Qnt(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,r=this._cachedMeta,s=r.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||s.length-a,u=this.options.drawActiveElementsOnTop;let c;for(r.dataset&&r.dataset.draw(e,i,a,l),c=a;c<a+l;++c){const d=s[c];d.hidden||(d.active&&u?o.push(d):d.draw(e,i))}for(c=0;c<o.length;++c)o[c].draw(e,i)}getStyle(e,n){const r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){const s=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=irt(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=s.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=srt(this.chart.getContext(),this.index)),i.dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=r,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){const s=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&iN(r);if(a)return P6(a,l);const u=this.chart.config,c=u.datasetElementScopeKeys(this._type,e),d=s?[`${e}Hover`,"hover",e,""]:[e,""],h=u.getOptionScopes(this.getDataset(),c),f=Object.keys(Ur.elements[e]),m=()=>this.getContext(r,s,n),g=u.resolveNamedOptions(h,f,m,d);return g.$shared&&(g.$shared=l,i[o]=Object.freeze(P6(g,l))),g}_resolveAnimations(e,n,r){const s=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(s.options.animation!==!1){const c=this.chart.config,d=c.datasetAnimationScopeKeys(this._type,n),h=c.getOptionScopes(this.getDataset(),d);l=c.createResolver(h,this.getContext(e,r,n))}const u=new Ute(s,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||i$(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const r=this.resolveDataElementOptions(e,n),s=this._sharedOptions,i=this.getSharedOptions(r),o=this.includeOptions(n,i)||i!==s;return this.updateSharedOptions(i,n,r),{sharedOptions:i,includeOptions:o}}updateElement(e,n,r,s){i$(s)?Object.assign(e,r):this._resolveAnimations(n,s).update(e,r)}updateSharedOptions(e,n,r){e&&!i$(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,s){e.active=s;const i=this.getStyle(n,s);this._resolveAnimations(n,r,s).update(e,{options:!s&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,r=this._cachedMeta.data;for(const[a,l,u]of this._syncList)this[a](l,u);this._syncList=[];const s=r.length,i=n.length,o=Math.min(i,s);o&&this.parse(0,o),i>s?this._insertElements(s,i-s,e):i<s&&this._removeElements(i,s-i)}_insertElements(e,n,r=!0){const s=this._cachedMeta,i=s.data,o=e+n;let a;const l=u=>{for(u.length+=n,a=u.length-1;a>=o;a--)u[a]=u[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(e,n),r&&this.updateElements(i,e,n,"reset")}updateElements(e,n,r,s){}_removeElements(e,n){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,n);r._stacked&&Dx(r,s)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,r,s]=e;this[n](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Vt(Fw,"defaults",{}),Vt(Fw,"datasetElementType",null),Vt(Fw,"dataElementType",null);class FC extends Fw{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:r,data:s=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=jtt(n,s,o);this._drawStart=a,this._drawCount=l,Wtt(n)&&(a=0,l=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!i._decimated,r.points=s;const u=this.resolveDatasetElementOptions(e);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:u},e),this.updateElements(s,a,l,e)}updateElements(e,n,r,s){const i=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:u}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(n,s),h=o.axis,f=a.axis,{spanGaps:m,segment:g}=this.options,x=v1(m)?m:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||i||s==="none",b=n+r,S=e.length;let C=n>0&&this.getParsed(n-1);for(let T=0;T<S;++T){const D=e[T],P=w?D:{};if(T<n||T>=b){P.skip=!0;continue}const I=this.getParsed(T),E=Jn(I[f]),M=P[h]=o.getPixelForValue(I[h],T),O=P[f]=i||E?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,I,l):I[f],T);P.skip=isNaN(M)||isNaN(O)||E,P.stop=T>0&&Math.abs(I[h]-C[h])>x,g&&(P.parsed=I,P.raw=u.data[T]),d&&(P.options=c||this.resolveDataElementOptions(T,D.active?"active":s)),w||this.updateElement(D,T,P,s),C=I}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,r=n.options&&n.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const i=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Vt(FC,"id","line"),Vt(FC,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Vt(FC,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function Sf(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class T4{constructor(e){Vt(this,"options");this.options=e||{}}static override(e){Object.assign(T4.prototype,e)}init(){}formats(){return Sf()}parse(){return Sf()}format(){return Sf()}add(){return Sf()}diff(){return Sf()}startOf(){return Sf()}endOf(){return Sf()}}var art={_date:T4};function lrt(t,e,n,r){const{controller:s,data:i,_sorted:o}=t,a=s._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const u=a._reversePixels?Ftt:Qf;if(r){if(s._sharedOptions){const c=i[0],d=typeof c.getRange=="function"&&c.getRange(e);if(d){const h=u(i,e,n-d),f=u(i,e,n+d);return{lo:h.lo,hi:f.hi}}}}else{const c=u(i,e,n);if(l){const{vScale:d}=s._cachedMeta,{_parsed:h}=t,f=h.slice(0,c.lo+1).reverse().findIndex(g=>!Jn(g[d.axis]));c.lo-=Math.max(0,f);const m=h.slice(c.hi).findIndex(g=>!Jn(g[d.axis]));c.hi+=Math.max(0,m)}return c}}return{lo:0,hi:i.length-1}}function lE(t,e,n,r,s){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:u,data:c}=i[a],{lo:d,hi:h}=lrt(i[a],e,o,s);for(let f=d;f<=h;++f){const m=c[f];m.skip||r(m,u,f)}}}function urt(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(r,s){const i=e?Math.abs(r.x-s.x):0,o=n?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function o$(t,e,n,r,s){const i=[];return!s&&!t.isPointInArea(e)||lE(t,n,e,function(a,l,u){!s&&!S1(a,t.chartArea,0)||a.inRange(e.x,e.y,r)&&i.push({element:a,datasetIndex:l,index:u})},!0),i}function crt(t,e,n,r){let s=[];function i(o,a,l){const{startAngle:u,endAngle:c}=o.getProps(["startAngle","endAngle"],r),{angle:d}=Dtt(o,{x:e.x,y:e.y});Nte(d,u,c)&&s.push({element:o,datasetIndex:a,index:l})}return lE(t,n,e,i),s}function drt(t,e,n,r,s,i){let o=[];const a=urt(n);let l=Number.POSITIVE_INFINITY;function u(c,d,h){const f=c.inRange(e.x,e.y,s);if(r&&!f)return;const m=c.getCenterPoint(s);if(!(!!i||t.isPointInArea(m))&&!f)return;const x=a(e,m);x<l?(o=[{element:c,datasetIndex:d,index:h}],l=x):x===l&&o.push({element:c,datasetIndex:d,index:h})}return lE(t,n,e,u),o}function a$(t,e,n,r,s,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!r?crt(t,e,n,s):drt(t,e,n,r,s,i)}function F6(t,e,n,r,s){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return lE(t,n,e,(l,u,c)=>{l[o]&&l[o](e[n],s)&&(i.push({element:l,datasetIndex:u,index:c}),a=a||l.inRange(e.x,e.y,s))}),r&&!a?[]:i}var hrt={modes:{index(t,e,n,r){const s=Df(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?o$(t,s,i,r,o):a$(t,s,i,!1,r,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const c=a[0].index,d=u.data[c];d&&!d.skip&&l.push({element:d,datasetIndex:u.index,index:c})}),l):[]},dataset(t,e,n,r){const s=Df(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?o$(t,s,i,r,o):a$(t,s,i,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,u=t.getDatasetMeta(l).data;a=[];for(let c=0;c<u.length;++c)a.push({element:u[c],datasetIndex:l,index:c})}return a},point(t,e,n,r){const s=Df(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return o$(t,s,i,r,o)},nearest(t,e,n,r){const s=Df(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return a$(t,s,i,n.intersect,r,o)},x(t,e,n,r){const s=Df(e,t);return F6(t,s,"x",n.intersect,r)},y(t,e,n,r){const s=Df(e,t);return F6(t,s,"y",n.intersect,r)}}};const jte=["left","top","right","bottom"];function Ox(t,e){return t.filter(n=>n.pos===e)}function L6(t,e){return t.filter(n=>jte.indexOf(n.pos)===-1&&n.box.axis===e)}function Px(t,e){return t.sort((n,r)=>{const s=e?r:n,i=e?n:r;return s.weight===i.weight?s.index-i.index:s.weight-i.weight})}function frt(t){const e=[];let n,r,s,i,o,a;for(n=0,r=(t||[]).length;n<r;++n)s=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=s,e.push({index:n,box:s,pos:i,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&i+o,stackWeight:a});return e}function prt(t){const e={};for(const n of t){const{stack:r,pos:s,stackWeight:i}=n;if(!r||!jte.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function mrt(t,e){const n=prt(t),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,u=n[a.stack],c=u&&a.stackWeight/u.weight;a.horizontal?(a.width=c?c*r:l&&e.availableWidth,a.height=s):(a.width=r,a.height=c?c*s:l&&e.availableHeight)}return n}function grt(t){const e=frt(t),n=Px(e.filter(u=>u.box.fullSize),!0),r=Px(Ox(e,"left"),!0),s=Px(Ox(e,"right")),i=Px(Ox(e,"top"),!0),o=Px(Ox(e,"bottom")),a=L6(e,"x"),l=L6(e,"y");return{fullSize:n,leftAndTop:r.concat(i),rightAndBottom:s.concat(l).concat(o).concat(a),chartArea:Ox(e,"chartArea"),vertical:r.concat(s).concat(l),horizontal:i.concat(o).concat(a)}}function z6(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function Wte(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function yrt(t,e,n,r){const{pos:s,box:i}=n,o=t.maxPadding;if(!An(s)){n.size&&(t[s]-=n.size);const d=r[n.stack]||{size:0,count:1};d.size=Math.max(d.size,n.horizontal?i.height:i.width),n.size=d.size/d.count,t[s]+=n.size}i.getPadding&&Wte(o,i.getPadding());const a=Math.max(0,e.outerWidth-z6(o,t,"left","right")),l=Math.max(0,e.outerHeight-z6(o,t,"top","bottom")),u=a!==t.w,c=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:u,other:c}:{same:c,other:u}}function xrt(t){const e=t.maxPadding;function n(r){const s=Math.max(e[r]-t[r],0);return t[r]+=s,s}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function wrt(t,e){const n=e.maxPadding;function r(s){const i={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return r(t?["left","right"]:["top","bottom"])}function hw(t,e,n,r){const s=[];let i,o,a,l,u,c;for(i=0,o=t.length,u=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,wrt(a.horizontal,e));const{same:d,other:h}=yrt(e,n,a,r);u|=d&&s.length,c=c||h,l.fullSize||s.push(a)}return u&&hw(s,e,n,r)||c}function vS(t,e,n,r,s){t.top=n,t.left=e,t.right=e+r,t.bottom=n+s,t.width=r,t.height=s}function B6(t,e,n,r){const s=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,u=r[a.stack]||{placed:0,weight:1},c=a.stackWeight/u.weight||1;if(a.horizontal){const d=e.w*c,h=u.size||l.height;iN(u.start)&&(o=u.start),l.fullSize?vS(l,s.left,o,n.outerWidth-s.right-s.left,h):vS(l,e.left+u.placed,o,d,h),u.start=o,u.placed+=d,o=l.bottom}else{const d=e.h*c,h=u.size||l.width;iN(u.start)&&(i=u.start),l.fullSize?vS(l,i,s.top,h,n.outerHeight-s.bottom-s.top):vS(l,i,e.top+u.placed,h,d),u.start=i,u.placed+=d,i=l.right}}e.x=i,e.y=o}var Ta={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const s=Pa(t.options.layout.padding),i=Math.max(e-s.width,0),o=Math.max(n-s.height,0),a=grt(t.boxes),l=a.vertical,u=a.horizontal;Dn(t.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const c=l.reduce((g,x)=>x.box.options&&x.box.options.display===!1?g:g+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:n,padding:s,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/c,hBoxMaxHeight:o/2}),h=Object.assign({},s);Wte(h,Pa(r));const f=Object.assign({maxPadding:h,w:i,h:o,x:s.left,y:s.top},s),m=mrt(l.concat(u),d);hw(a.fullSize,f,d,m),hw(l,f,d,m),hw(u,f,d,m)&&hw(l,f,d,m),xrt(f),B6(a.leftAndTop,f,d,m),f.x+=f.w,f.y+=f.h,B6(a.rightAndBottom,f,d,m),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Dn(a.chartArea,g=>{const x=g.box;Object.assign(x,t.chartArea),x.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class Gte{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,r){}removeEventListener(e,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,r,s){return n=Math.max(0,n||e.width),r=r||e.height,{width:n,height:Math.max(0,s?Math.floor(n/s):r)}}isAttached(e){return!0}updateConfig(e){}}class brt extends Gte{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const LC="$chartjs",vrt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},U6=t=>t===null||t==="";function Srt(t,e){const n=t.style,r=t.getAttribute("height"),s=t.getAttribute("width");if(t[LC]={initial:{height:r,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",U6(s)){const i=T6(t,"width");i!==void 0&&(t.width=i)}if(U6(r))if(t.style.height==="")t.height=t.width/(e||2);else{const i=T6(t,"height");i!==void 0&&(t.height=i)}return t}const Hte=Dnt?{passive:!0}:!1;function Crt(t,e,n){t&&t.addEventListener(e,n,Hte)}function Irt(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Hte)}function Nrt(t,e){const n=vrt[t.type]||t.type,{x:r,y:s}=Df(t,e);return{type:n,chart:e,native:t,x:r!==void 0?r:null,y:s!==void 0?s:null}}function lN(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function krt(t,e,n){const r=t.canvas,s=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||lN(a.addedNodes,r),o=o&&!lN(a.removedNodes,r);o&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}function Trt(t,e,n){const r=t.canvas,s=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||lN(a.removedNodes,r),o=o&&!lN(a.addedNodes,r);o&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}const I1=new Map;let V6=0;function Yte(){const t=window.devicePixelRatio;t!==V6&&(V6=t,I1.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function Ert(t,e){I1.size||window.addEventListener("resize",Yte),I1.set(t,e)}function _rt(t){I1.delete(t),I1.size||window.removeEventListener("resize",Yte)}function Art(t,e,n){const r=t.canvas,s=r&&k4(r);if(!s)return;const i=Ete((a,l)=>{const u=s.clientWidth;n(a,l),u<s.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],u=l.contentRect.width,c=l.contentRect.height;u===0&&c===0||i(u,c)});return o.observe(s),Ert(t,i),o}function l$(t,e,n){n&&n.disconnect(),e==="resize"&&_rt(t)}function $rt(t,e,n){const r=t.canvas,s=Ete(i=>{t.ctx!==null&&n(Nrt(i,t))},t);return Crt(r,e,s),s}class Rrt extends Gte{acquireContext(e,n){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(Srt(e,n),r):null}releaseContext(e){const n=e.canvas;if(!n[LC])return!1;const r=n[LC].initial;["height","width"].forEach(i=>{const o=r[i];Jn(o)?n.removeAttribute(i):n.setAttribute(i,o)});const s=r.style||{};return Object.keys(s).forEach(i=>{n.style[i]=s[i]}),n.width=n.width,delete n[LC],!0}addEventListener(e,n,r){this.removeEventListener(e,n);const s=e.$proxies||(e.$proxies={}),o={attach:krt,detach:Trt,resize:Art}[n]||$rt;s[n]=o(e,n,r)}removeEventListener(e,n){const r=e.$proxies||(e.$proxies={}),s=r[n];if(!s)return;({attach:l$,detach:l$,resize:l$}[n]||Irt)(e,n,s),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,r,s){return Mnt(e,n,r,s)}isAttached(e){const n=e&&k4(e);return!!(n&&n.isConnected)}}function Mrt(t){return!N4()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?brt:Rrt}var ES;let rm=(ES=class{constructor(){Vt(this,"x");Vt(this,"y");Vt(this,"active",!1);Vt(this,"options");Vt(this,"$animations")}tooltipPosition(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}hasValue(){return v1(this.x)&&v1(this.y)}getProps(e,n){const r=this.$animations;if(!n||!r)return this;const s={};return e.forEach(i=>{s[i]=r[i]&&r[i].active()?r[i]._to:this[i]}),s}},Vt(ES,"defaults",{}),Vt(ES,"defaultRoutes"),ES);function Drt(t,e){const n=t.options.ticks,r=Ort(t),s=Math.min(n.maxTicksLimit||r,r),i=n.major.enabled?Frt(e):[],o=i.length,a=i[0],l=i[o-1],u=[];if(o>s)return Lrt(e,u,i,o/s),u;const c=Prt(i,e,s);if(o>0){let d,h;const f=o>1?Math.round((l-a)/(o-1)):null;for(SS(e,u,c,Jn(f)?0:a-f,a),d=0,h=o-1;d<h;d++)SS(e,u,c,i[d],i[d+1]);return SS(e,u,c,l,Jn(f)?e.length:l+f),u}return SS(e,u,c),u}function Ort(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),s=t._maxLength/n;return Math.floor(Math.min(r,s))}function Prt(t,e,n){const r=zrt(t),s=e.length/n;if(!r)return Math.max(s,1);const i=_tt(r);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>s)return l}return Math.max(s,1)}function Frt(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function Lrt(t,e,n,r){let s=0,i=n[0],o;for(r=Math.ceil(r),o=0;o<t.length;o++)o===i&&(e.push(t[o]),s++,i=n[s*r])}function SS(t,e,n,r,s){const i=vn(r,0),o=Math.min(vn(s,t.length),t.length);let a=0,l,u,c;for(n=Math.ceil(n),s&&(l=s-r,n=l/Math.floor(l/n)),c=i;c<0;)a++,c=Math.round(i+a*n);for(u=Math.max(i,0);u<o;u++)u===c&&(e.push(t[u]),a++,c=Math.round(i+a*n))}function zrt(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}const Brt=t=>t==="left"?"right":t==="right"?"left":t,j6=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,W6=(t,e)=>Math.min(e||t,t);function G6(t,e){const n=[],r=t.length/e,s=t.length;let i=0;for(;i<s;i+=r)n.push(t[Math.floor(i)]);return n}function Urt(t,e,n){const r=t.ticks.length,s=Math.min(e,r-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(s),u;if(!(n&&(r===1?u=Math.max(l-i,o-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(s-1))/2,l+=s<e?u:-u,l<i-a||l>o+a)))return l}function Vrt(t,e){Dn(t,n=>{const r=n.gc,s=r.length/2;let i;if(s>e){for(i=0;i<s;++i)delete n.data[r[i]];r.splice(0,s)}})}function Fx(t){return t.drawTicks?t.tickLength:0}function H6(t,e){if(!t.display)return 0;const n=yi(t.font,e),r=Pa(t.padding);return(Ts(t.text)?t.text.length:1)*n.lineHeight+r.height}function jrt(t,e){return nm(t,{scale:e,type:"scale"})}function Wrt(t,e,n){return nm(t,{tick:n,index:e,type:"tick"})}function Grt(t,e,n){let r=x4(t);return(n&&e!=="right"||!n&&e==="right")&&(r=Brt(r)),r}function Hrt(t,e,n,r){const{top:s,left:i,bottom:o,right:a,chart:l}=t,{chartArea:u,scales:c}=l;let d=0,h,f,m;const g=o-s,x=a-i;if(t.isHorizontal()){if(f=ui(r,i,a),An(n)){const w=Object.keys(n)[0],b=n[w];m=c[w].getPixelForValue(b)+g-e}else n==="center"?m=(u.bottom+u.top)/2+g-e:m=j6(t,n,e);h=a-i}else{if(An(n)){const w=Object.keys(n)[0],b=n[w];f=c[w].getPixelForValue(b)-x+e}else n==="center"?f=(u.left+u.right)/2-x+e:f=j6(t,n,e);m=ui(r,o,s),d=n==="left"?-yl:yl}return{titleX:f,titleY:m,maxWidth:h,rotation:d}}class Dy extends rm{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:r,_suggestedMax:s}=this;return e=Xl(e,Number.POSITIVE_INFINITY),n=Xl(n,Number.NEGATIVE_INFINITY),r=Xl(r,Number.POSITIVE_INFINITY),s=Xl(s,Number.NEGATIVE_INFINITY),{min:Xl(e,r),max:Xl(n,s),minDefined:Oa(e),maxDefined:Oa(n)}}getMinMax(e){let{min:n,max:r,minDefined:s,maxDefined:i}=this.getUserBounds(),o;if(s&&i)return{min:n,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,u=a.length;l<u;++l)o=a[l].controller.getMinMax(this,e),s||(n=Math.min(n,o.min)),i||(r=Math.max(r,o.max));return n=i&&n>r?r:n,r=s&&n>r?n:r,{min:Xl(n,Xl(r,n)),max:Xl(r,Xl(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ir(this.options.beforeUpdate,[this])}update(e,n,r){const{beginAtZero:s,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=dnt(this,i,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?G6(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Drt(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,e=!e),this._startPixel=n,this._endPixel=r,this._reversePixels=e,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ir(this.options.afterUpdate,[this])}beforeSetDimensions(){ir(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ir(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),ir(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ir(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let r,s,i;for(r=0,s=e.length;r<s;r++)i=e[r],i.label=ir(n.callback,[i.value,r,e],this)}afterTickToLabelConversion(){ir(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ir(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,r=W6(this.ticks.length,e.ticks.maxTicksLimit),s=n.minRotation||0,i=n.maxRotation;let o=s,a,l,u;if(!this._isVisible()||!n.display||s>=i||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const c=this._getLabelSizes(),d=c.widest.width,h=c.highest.height,f=ka(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/r:f/(r-1),d+6>a&&(a=f/(r-(e.offset?.5:1)),l=this.maxHeight-Fx(e.grid)-n.padding-H6(e.title,this.chart.options.font),u=Math.sqrt(d*d+h*h),o=Mtt(Math.min(Math.asin(ka((c.highest.height+6)/a,-1,1)),Math.asin(ka(l/u,-1,1))-Math.asin(ka(h/u,-1,1)))),o=Math.max(s,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){ir(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ir(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:r,title:s,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=H6(s,n.options.font);if(a?(e.width=this.maxWidth,e.height=Fx(i)+l):(e.height=this.maxHeight,e.width=Fx(i)+l),r.display&&this.ticks.length){const{first:u,last:c,widest:d,highest:h}=this._getLabelSizes(),f=r.padding*2,m=Zf(this.labelRotation),g=Math.cos(m),x=Math.sin(m);if(a){const w=r.mirror?0:x*d.width+g*h.height;e.height=Math.min(this.maxHeight,e.height+w+f)}else{const w=r.mirror?0:g*d.width+x*h.height;e.width=Math.min(this.maxWidth,e.width+w+f)}this._calculatePadding(u,c,x,g)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,r,s){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,f=0;l?u?(h=s*e.width,f=r*n.height):(h=r*e.height,f=s*n.width):i==="start"?f=n.width:i==="end"?h=e.width:i!=="inner"&&(h=e.width/2,f=n.width/2),this.paddingLeft=Math.max((h-c+o)*this.width/(this.width-c),0),this.paddingRight=Math.max((f-d+o)*this.width/(this.width-d),0)}else{let c=n.height/2,d=e.height/2;i==="start"?(c=0,d=e.height):i==="end"&&(c=n.height,d=0),this.paddingTop=c+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ir(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,r;for(n=0,r=e.length;n<r;n++)Jn(e[n].label)&&(e.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=G6(r,n)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,r){const{ctx:s,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/W6(n,r));let u=0,c=0,d,h,f,m,g,x,w,b,S,C,T;for(d=0;d<n;d+=l){if(m=e[d].label,g=this._resolveTickFontOptions(d),s.font=x=g.string,w=i[x]=i[x]||{data:{},gc:[]},b=g.lineHeight,S=C=0,!Jn(m)&&!Ts(m))S=S6(s,w.data,w.gc,S,m),C=b;else if(Ts(m))for(h=0,f=m.length;h<f;++h)T=m[h],!Jn(T)&&!Ts(T)&&(S=S6(s,w.data,w.gc,S,T),C+=b);o.push(S),a.push(C),u=Math.max(S,u),c=Math.max(C,c)}Vrt(i,n);const D=o.indexOf(u),P=a.indexOf(c),I=E=>({width:o[E]||0,height:a[E]||0});return{first:I(0),last:I(n-1),widest:I(D),highest:I(P),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Ptt(this._alignToPixels?vf(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const r=n[e];return r.$context||(r.$context=Wrt(this.getContext(),e,r))}return this.$context||(this.$context=jrt(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Zf(this.labelRotation),r=Math.abs(Math.cos(n)),s=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*r>a*s?a/r:l/s:l*s<a*r?l/r:a/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,r=this.chart,s=this.options,{grid:i,position:o,border:a}=s,l=i.offset,u=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=Fx(i),f=[],m=a.setContext(this.getContext()),g=m.display?m.width:0,x=g/2,w=function(V){return vf(r,V,g)};let b,S,C,T,D,P,I,E,M,O,j,R;if(o==="top")b=w(this.bottom),P=this.bottom-h,E=b-x,O=w(e.top)+x,R=e.bottom;else if(o==="bottom")b=w(this.top),O=e.top,R=w(e.bottom)-x,P=b+x,E=this.top+h;else if(o==="left")b=w(this.right),D=this.right-h,I=b-x,M=w(e.left)+x,j=e.right;else if(o==="right")b=w(this.left),M=e.left,j=w(e.right)-x,D=b+x,I=this.left+h;else if(n==="x"){if(o==="center")b=w((e.top+e.bottom)/2+.5);else if(An(o)){const V=Object.keys(o)[0],H=o[V];b=w(this.chart.scales[V].getPixelForValue(H))}O=e.top,R=e.bottom,P=b+x,E=P+h}else if(n==="y"){if(o==="center")b=w((e.left+e.right)/2);else if(An(o)){const V=Object.keys(o)[0],H=o[V];b=w(this.chart.scales[V].getPixelForValue(H))}D=b-x,I=D-h,M=e.left,j=e.right}const z=vn(s.ticks.maxTicksLimit,d),B=Math.max(1,Math.ceil(d/z));for(S=0;S<d;S+=B){const V=this.getContext(S),H=i.setContext(V),K=a.setContext(V),ne=H.lineWidth,fe=H.color,ee=K.dash||[],de=K.dashOffset,ge=H.tickWidth,Z=H.tickColor,we=H.tickBorderDash||[],Ee=H.tickBorderDashOffset;C=Urt(this,S,l),C!==void 0&&(T=vf(r,C,ne),u?D=I=M=j=T:P=E=O=R=T,f.push({tx1:D,ty1:P,tx2:I,ty2:E,x1:M,y1:O,x2:j,y2:R,width:ne,color:fe,borderDash:ee,borderDashOffset:de,tickWidth:ge,tickColor:Z,tickBorderDash:we,tickBorderDashOffset:Ee}))}return this._ticksLength=d,this._borderValue=b,f}_computeLabelItems(e){const n=this.axis,r=this.options,{position:s,ticks:i}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:u,padding:c,mirror:d}=i,h=Fx(r.grid),f=h+c,m=d?-c:f,g=-Zf(this.labelRotation),x=[];let w,b,S,C,T,D,P,I,E,M,O,j,R="middle";if(s==="top")D=this.bottom-m,P=this._getXAxisLabelAlignment();else if(s==="bottom")D=this.top+m,P=this._getXAxisLabelAlignment();else if(s==="left"){const B=this._getYAxisLabelAlignment(h);P=B.textAlign,T=B.x}else if(s==="right"){const B=this._getYAxisLabelAlignment(h);P=B.textAlign,T=B.x}else if(n==="x"){if(s==="center")D=(e.top+e.bottom)/2+f;else if(An(s)){const B=Object.keys(s)[0],V=s[B];D=this.chart.scales[B].getPixelForValue(V)+f}P=this._getXAxisLabelAlignment()}else if(n==="y"){if(s==="center")T=(e.left+e.right)/2-f;else if(An(s)){const B=Object.keys(s)[0],V=s[B];T=this.chart.scales[B].getPixelForValue(V)}P=this._getYAxisLabelAlignment(h).textAlign}n==="y"&&(l==="start"?R="top":l==="end"&&(R="bottom"));const z=this._getLabelSizes();for(w=0,b=a.length;w<b;++w){S=a[w],C=S.label;const B=i.setContext(this.getContext(w));I=this.getPixelForTick(w)+i.labelOffset,E=this._resolveTickFontOptions(w),M=E.lineHeight,O=Ts(C)?C.length:1;const V=O/2,H=B.color,K=B.textStrokeColor,ne=B.textStrokeWidth;let fe=P;o?(T=I,P==="inner"&&(w===b-1?fe=this.options.reverse?"left":"right":w===0?fe=this.options.reverse?"right":"left":fe="center"),s==="top"?u==="near"||g!==0?j=-O*M+M/2:u==="center"?j=-z.highest.height/2-V*M+M:j=-z.highest.height+M/2:u==="near"||g!==0?j=M/2:u==="center"?j=z.highest.height/2-V*M:j=z.highest.height-O*M,d&&(j*=-1),g!==0&&!B.showLabelBackdrop&&(T+=M/2*Math.sin(g))):(D=I,j=(1-O)*M/2);let ee;if(B.showLabelBackdrop){const de=Pa(B.backdropPadding),ge=z.heights[w],Z=z.widths[w];let we=j-de.top,Ee=0-de.left;switch(R){case"middle":we-=ge/2;break;case"bottom":we-=ge;break}switch(P){case"center":Ee-=Z/2;break;case"right":Ee-=Z;break;case"inner":w===b-1?Ee-=Z:w>0&&(Ee-=Z/2);break}ee={left:Ee,top:we,width:Z+de.width,height:ge+de.height,color:B.backdropColor}}x.push({label:C,font:E,textOffset:j,options:{rotation:g,color:H,strokeColor:K,strokeWidth:ne,textAlign:fe,textBaseline:R,translation:[T,D],backdrop:ee}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Zf(this.labelRotation))return e==="top"?"left":"right";let s="center";return n.align==="start"?s="left":n.align==="end"?s="right":n.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:r,mirror:s,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let u,c;return n==="left"?s?(c=this.right+i,r==="near"?u="left":r==="center"?(u="center",c+=l/2):(u="right",c+=l)):(c=this.right-a,r==="near"?u="right":r==="center"?(u="center",c-=l/2):(u="left",c=this.left)):n==="right"?s?(c=this.left+i,r==="near"?u="right":r==="center"?(u="center",c-=l/2):(u="left",c-=l)):(c=this.left+a,r==="near"?u="left":r==="center"?(u="center",c+=l/2):(u="right",c=this.right)):u="right",{textAlign:u,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:r,top:s,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(r,s,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const s=this.ticks.findIndex(i=>i.value===e);return s>=0?n.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const n=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,u,c)=>{!c.width||!c.color||(r.save(),r.lineWidth=c.width,r.strokeStyle=c.color,r.setLineDash(c.borderDash||[]),r.lineDashOffset=c.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(u.x,u.y),r.stroke(),r.restore())};if(n.display)for(i=0,o=s.length;i<o;++i){const l=s[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:r,grid:s}}=this,i=r.setContext(this.getContext()),o=r.display?i.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,c,d,h;this.isHorizontal()?(u=vf(e,this.left,o)-o/2,c=vf(e,this.right,a)+a/2,d=h=l):(d=vf(e,this.top,o)-o/2,h=vf(e,this.bottom,a)+a/2,u=c=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,d),n.lineTo(c,h),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&b4(r,s);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,u=o.label,c=o.textOffset;C1(r,u,0,c,l,a)}s&&v4(r)}drawTitle(){const{ctx:e,options:{position:n,title:r,reverse:s}}=this;if(!r.display)return;const i=yi(r.font),o=Pa(r.padding),a=r.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||An(n)?(l+=o.bottom,Ts(r.text)&&(l+=i.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:u,titleY:c,maxWidth:d,rotation:h}=Hrt(this,l,n,a);C1(e,r.text,0,0,i,{color:r.color,maxWidth:d,rotation:h,textAlign:Grt(a,n,s),textBaseline:"middle",translation:[u,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,r=vn(e.grid&&e.grid.z,-1),s=vn(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Dy.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:r,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[r]===this.id&&(!e||a.type===e)&&s.push(a)}return s}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return yi(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class CS{constructor(e,n,r){this.type=e,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let r;qrt(n)&&(r=this.register(n));const s=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in s||(s[i]=e,Yrt(e,o,r),this.override&&Ur.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,r=e.id,s=this.scope;r in n&&delete n[r],s&&r in Ur[s]&&(delete Ur[s][r],this.override&&delete Rp[r])}}function Yrt(t,e,n){const r=b1(Object.create(null),[n?Ur.get(n):{},Ur.get(e),t.defaults]);Ur.set(e,r),t.defaultRoutes&&Krt(e,t.defaultRoutes),t.descriptors&&Ur.describe(e,t.descriptors)}function Krt(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),s=r.pop(),i=[t].concat(r).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Ur.route(i,s,l,a)})}function qrt(t){return"id"in t&&"defaults"in t}class Xrt{constructor(){this.controllers=new CS(Fw,"datasets",!0),this.elements=new CS(rm,"elements"),this.plugins=new CS(Object,"plugins"),this.scales=new CS(Dy,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,r){[...n].forEach(s=>{const i=r||this._getRegistryForType(s);r||i.isForType(s)||i===this.plugins&&s.id?this._exec(e,i,s):Dn(s,o=>{const a=r||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,r){const s=g4(e);ir(r["before"+s],[],r),n[e](r),ir(r["after"+s],[],r)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(e))return r}return this.plugins}_get(e,n,r){const s=n.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var nu=new Xrt;class Zrt{constructor(){this._init=[]}notify(e,n,r,s){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(i,e,n,r);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,n,r,s){s=s||{};for(const i of e){const o=i.plugin,a=o[r],l=[n,s,i.options];if(ir(a,l,o)===!1&&s.cancelable)return!1}return!0}invalidate(){Jn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const r=e&&e.config,s=vn(r.options&&r.options.plugins,{}),i=Qrt(r);return s===!1&&!n?[]:est(e,i,s,n)}_notifyStateChanges(e){const n=this._oldCache||[],r=this._cache,s=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(s(n,r),e,"stop"),this._notify(s(r,n),e,"start")}}function Qrt(t){const e={},n=[],r=Object.keys(nu.plugins.items);for(let i=0;i<r.length;i++)n.push(nu.getPlugin(r[i]));const s=t.plugins||[];for(let i=0;i<s.length;i++){const o=s[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function Jrt(t,e){return!e&&t===!1?null:t===!0?{}:t}function est(t,{plugins:e,localIds:n},r,s){const i=[],o=t.getContext();for(const a of e){const l=a.id,u=Jrt(r[l],s);u!==null&&i.push({plugin:a,options:tst(t.config,{plugin:a,local:n[l]},u,o)})}return i}function tst(t,{plugin:e,local:n},r,s){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(r,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function bM(t,e){const n=Ur.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function nst(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function rst(t,e){return t===e?"_index_":"_value_"}function Y6(t){if(t==="x"||t==="y"||t==="r")return t}function sst(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function vM(t,...e){if(Y6(t))return t;for(const n of e){const r=n.axis||sst(n.position)||t.length>1&&Y6(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function K6(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function ist(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(n.length)return K6(t,"x",n[0])||K6(t,"y",n[0])}return{}}function ost(t,e){const n=Rp[t.type]||{scales:{}},r=e.scales||{},s=bM(t.type,e),i=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!An(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=vM(o,a,ist(o,t),Ur.scales[a.type]),u=rst(l,s),c=n.scales||{};i[o]=Rw(Object.create(null),[{axis:l},a,c[l],c[u]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||bM(a,e),c=(Rp[a]||{}).scales||{};Object.keys(c).forEach(d=>{const h=nst(d,l),f=o[h+"AxisID"]||h;i[f]=i[f]||Object.create(null),Rw(i[f],[{axis:h},r[f],c[d]])})}),Object.keys(i).forEach(o=>{const a=i[o];Rw(a,[Ur.scales[a.type],Ur.scale])}),i}function Kte(t){const e=t.options||(t.options={});e.plugins=vn(e.plugins,{}),e.scales=ost(t,e)}function qte(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function ast(t){return t=t||{},t.data=qte(t.data),Kte(t),t}const q6=new Map,Xte=new Set;function IS(t,e){let n=q6.get(t);return n||(n=e(),q6.set(t,n),Xte.add(n)),n}const Lx=(t,e,n)=>{const r=sN(e,n);r!==void 0&&t.add(r)};class lst{constructor(e){this._config=ast(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=qte(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Kte(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return IS(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return IS(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return IS(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,r=this.type;return IS(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const r=this._scopeCache;let s=r.get(e);return(!s||n)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,n,r){const{options:s,type:i}=this,o=this._cachedScopes(e,r),a=o.get(n);if(a)return a;const l=new Set;n.forEach(c=>{e&&(l.add(e),c.forEach(d=>Lx(l,e,d))),c.forEach(d=>Lx(l,s,d)),c.forEach(d=>Lx(l,Rp[i]||{},d)),c.forEach(d=>Lx(l,Ur,d)),c.forEach(d=>Lx(l,yM,d))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),Xte.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,Rp[n]||{},Ur.datasets[n]||{},{type:n},Ur,yM]}resolveNamedOptions(e,n,r,s=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=X6(this._resolverCache,e,s);let l=o;if(cst(o,n)){i.$shared=!1,r=Ch(r)?r():r;const u=this.createResolver(e,r,a);l=a0(o,r,u)}for(const u of n)i[u]=l[u];return i}createResolver(e,n,r=[""],s){const{resolver:i}=X6(this._resolverCache,e,r);return An(n)?a0(i,n,void 0,s):i}}function X6(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const s=n.join();let i=r.get(s);return i||(i={resolver:S4(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},r.set(s,i)),i}const ust=t=>An(t)&&Object.getOwnPropertyNames(t).some(e=>Ch(t[e]));function cst(t,e){const{isScriptable:n,isIndexable:r}=Mte(t);for(const s of e){const i=n(s),o=r(s),a=(o||i)&&t[s];if(i&&(Ch(a)||ust(a))||o&&Ts(a))return!0}return!1}var dst="4.4.8";const hst=["top","bottom","left","right","chartArea"];function Z6(t,e){return t==="top"||t==="bottom"||hst.indexOf(t)===-1&&e==="x"}function Q6(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function J6(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),ir(n&&n.onComplete,[t],e)}function fst(t){const e=t.chart,n=e.options.animation;ir(n&&n.onProgress,[t],e)}function Zte(t){return N4()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const zC={},e8=t=>{const e=Zte(t);return Object.values(zC).filter(n=>n.canvas===e).pop()};function pst(t,e,n){const r=Object.keys(t);for(const s of r){const i=+s;if(i>=e){const o=t[s];delete t[s],(n>0||i>e)&&(t[i+n]=o)}}}function mst(t,e,n,r){return!n||t.type==="mouseout"?null:r?e:t}function NS(t,e,n){return t.options.clip?t[n]:e[n]}function gst(t,e){const{xScale:n,yScale:r}=t;return n&&r?{left:NS(n,e,"left"),right:NS(n,e,"right"),top:NS(r,e,"top"),bottom:NS(r,e,"bottom")}:e}var Id;let uE=(Id=class{static register(...e){nu.add(...e),t8()}static unregister(...e){nu.remove(...e),t8()}constructor(e,n){const r=this.config=new lst(n),s=Zte(e),i=e8(s);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Mrt(s)),this.platform.updateConfig(r);const a=this.platform.acquireContext(s,o.aspectRatio),l=a&&a.canvas,u=l&&l.height,c=l&&l.width;if(this.id=btt(),this.ctx=a,this.canvas=l,this.width=c,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Zrt,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Utt(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],zC[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}ic.listen(this,"complete",J6),ic.listen(this,"progress",fst),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:s,_aspectRatio:i}=this;return Jn(e)?n&&i?i:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return nu}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():k6(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return C6(this.canvas,this.ctx),this}stop(){return ic.stop(this),this}resize(e,n){ic.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const r=this.options,s=this.canvas,i=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,n,i),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,k6(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),ir(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Dn(n,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,n=e.scales,r=this.scales,s=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=vM(o,a),u=l==="r",c=l==="x";return{options:a,dposition:u?"chartArea":c?"bottom":"left",dtype:u?"radialLinear":c?"category":"linear"}}))),Dn(i,o=>{const a=o.options,l=a.id,u=vM(l,a),c=vn(a.type,o.dtype);(a.position===void 0||Z6(a.position,u)!==Z6(o.dposition))&&(a.position=o.dposition),s[l]=!0;let d=null;if(l in r&&r[l].type===c)d=r[l];else{const h=nu.getScale(c);d=new h({id:l,type:c,ctx:this.ctx,chart:this}),r[d.id]=d}d.init(a,e)}),Dn(s,(o,a)=>{o||delete r[a]}),Dn(r,o=>{Ta.configure(this,o,o.options),Ta.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((s,i)=>s.index-i.index),r>n){for(let s=n;s<r;++s)this._destroyDatasetMeta(s);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(Q6("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,s)=>{n.filter(i=>i===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=n.length;r<s;r++){const i=n[r];let o=this.getDatasetMeta(r);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=i.indexAxis||bM(a,this.options),o.order=i.order||0,o.index=r,o.label=""+i.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=nu.getController(a),{datasetElementType:u,dataElementType:c}=Ur.datasets[a];Object.assign(l,{dataElementType:nu.getElement(c),datasetElementType:u&&nu.getElement(u)}),o.controller=new l(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Dn(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,c=this.data.datasets.length;u<c;u++){const{controller:d}=this.getDatasetMeta(u),h=!s&&i.indexOf(d)===-1;d.buildOrUpdateElements(h),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||Dn(i,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Q6("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Dn(this.scales,e=>{Ta.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!f6(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:i}of n){const o=r==="_removeElements"?-i:i;pst(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),s=r(0);for(let i=1;i<n;i++)if(!f6(s,r(i)))return;return Array.from(s).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ta.update(this,this.width,this.height,e);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Dn(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,i)=>{s._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,Ch(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(n),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ic.has(this)?this.attached&&!ic.running(this)&&ic.start(this):(this.draw(),J6({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,r=[];let s,i;for(s=0,i=n.length;s<i;++s){const o=n[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,r=e._clip,s=!r.disabled,i=gst(e,this.chartArea),o={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(s&&b4(n,{left:r.left===!1?0:i.left-r.left,right:r.right===!1?this.width:i.right+r.right,top:r.top===!1?0:i.top-r.top,bottom:r.bottom===!1?this.height:i.bottom+r.bottom}),e.controller.draw(),s&&v4(n),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return S1(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,r,s){const i=hrt.modes[n];return typeof i=="function"?i(this,e,r,s):[]}getDatasetMeta(e){const n=this.data.datasets[e],r=this._metasets;let s=r.filter(i=>i&&i._dataset===n).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=nm(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){const r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){const s=r?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,s);iN(n)?(i.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(i,{visible:r}),this.update(a=>a.datasetIndex===e?s:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),ic.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),C6(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete zC[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,r=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},s=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};Dn(this.options.events,i=>r(i,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,r=(l,u)=>{n.addEventListener(this,l,u),e[l]=u},s=(l,u)=>{e[l]&&(n.removeEventListener(this,l,u),delete e[l])},i=(l,u)=>{this.canvas&&this.resize(l,u)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),r("resize",i),r("detach",o)};o=()=>{this.attached=!1,s("resize",i),this._stop(),this._resize(0,0),r("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){Dn(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Dn(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){const s=r?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+s+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],r=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!nN(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,r){const s=this.options.hover,i=(l,u)=>l.filter(c=>!u.some(d=>c.datasetIndex===d.datasetIndex&&c.index===d.index)),o=i(n,e),a=r?e:i(e,n);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(e,n){const r={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const i=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(i||r.changed)&&this.render(),this}_handleEvent(e,n,r){const{_active:s=[],options:i}=this,o=n,a=this._getActiveElements(e,s,r,o),l=ktt(e),u=mst(e,this._lastEvent,r,l);r&&(this._lastEvent=null,ir(i.onHover,[e,a,this],this),l&&ir(i.onClick,[e,a,this],this));const c=!nN(a,s);return(c||n)&&(this._active=a,this._updateHoverStyles(a,s,n)),this._lastEvent=u,c}_getActiveElements(e,n,r,s){if(e.type==="mouseout")return[];if(!r)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,s)}},Vt(Id,"defaults",Ur),Vt(Id,"instances",zC),Vt(Id,"overrides",Rp),Vt(Id,"registry",nu),Vt(Id,"version",dst),Vt(Id,"getChart",e8),Id);function t8(){return Dn(uE.instances,t=>t._plugins.invalidate())}function Qte(t,e,n=e){t.lineCap=vn(n.borderCapStyle,e.borderCapStyle),t.setLineDash(vn(n.borderDash,e.borderDash)),t.lineDashOffset=vn(n.borderDashOffset,e.borderDashOffset),t.lineJoin=vn(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=vn(n.borderWidth,e.borderWidth),t.strokeStyle=vn(n.borderColor,e.borderColor)}function yst(t,e,n){t.lineTo(n.x,n.y)}function xst(t){return t.stepped?tnt:t.tension||t.cubicInterpolationMode==="monotone"?nnt:yst}function Jte(t,e,n={}){const r=t.length,{start:s=0,end:i=r-1}=n,{start:o,end:a}=e,l=Math.max(s,o),u=Math.min(i,a),c=s<o&&i<o||s>a&&i>a;return{count:r,start:l,loop:e.loop,ilen:u<l&&!c?r+u-l:u-l}}function wst(t,e,n,r){const{points:s,options:i}=e,{count:o,start:a,loop:l,ilen:u}=Jte(s,n,r),c=xst(i);let{move:d=!0,reverse:h}=r||{},f,m,g;for(f=0;f<=u;++f)m=s[(a+(h?u-f:f))%o],!m.skip&&(d?(t.moveTo(m.x,m.y),d=!1):c(t,g,m,h,i.stepped),g=m);return l&&(m=s[(a+(h?u:0))%o],c(t,g,m,h,i.stepped)),!!l}function bst(t,e,n,r){const s=e.points,{count:i,start:o,ilen:a}=Jte(s,n,r),{move:l=!0,reverse:u}=r||{};let c=0,d=0,h,f,m,g,x,w;const b=C=>(o+(u?a-C:C))%i,S=()=>{g!==x&&(t.lineTo(c,x),t.lineTo(c,g),t.lineTo(c,w))};for(l&&(f=s[b(0)],t.moveTo(f.x,f.y)),h=0;h<=a;++h){if(f=s[b(h)],f.skip)continue;const C=f.x,T=f.y,D=C|0;D===m?(T<g?g=T:T>x&&(x=T),c=(d*c+C)/++d):(S(),t.lineTo(C,T),m=D,d=0,g=x=T),w=T}S()}function SM(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?bst:wst}function vst(t){return t.stepped?Ont:t.tension||t.cubicInterpolationMode==="monotone"?Pnt:Of}function Sst(t,e,n,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,n,r)&&s.closePath()),Qte(t,e.options),t.stroke(s)}function Cst(t,e,n,r){const{segments:s,options:i}=e,o=SM(e);for(const a of s)Qte(t,i,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}const Ist=typeof Path2D=="function";function Nst(t,e,n,r){Ist&&!e.options.segment?Sst(t,e,n,r):Cst(t,e,n,r)}class fw extends rm{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;Tnt(this._points,r,e,s,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Wnt(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,r=e.length;return r&&n[e[r-1].end]}interpolate(e,n){const r=this.options,s=e[n],i=this.points,o=Unt(this,{property:n,start:s,end:s});if(!o.length)return;const a=[],l=vst(r);let u,c;for(u=0,c=o.length;u<c;++u){const{start:d,end:h}=o[u],f=i[d],m=i[h];if(f===m){a.push(f);continue}const g=Math.abs((s-f[n])/(m[n]-f[n])),x=l(f,m,g,r.stepped);x[n]=e[n],a.push(x)}return a.length===1?a[0]:a}pathSegment(e,n,r){return SM(this)(e,this,n,r)}path(e,n,r){const s=this.segments,i=SM(this);let o=this._loop;n=n||0,r=r||this.points.length-n;for(const a of s)o&=i(e,this,a,{start:n,end:n+r-1});return!!o}draw(e,n,r,s){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),Nst(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Vt(fw,"id","line"),Vt(fw,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Vt(fw,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Vt(fw,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function n8(t,e,n,r){const s=t.options,{[n]:i}=t.getProps([n],r);return Math.abs(e-i)<s.radius+s.hitRadius}class BC extends rm{constructor(n){super();Vt(this,"parsed");Vt(this,"skip");Vt(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,r,s){const i=this.options,{x:o,y:a}=this.getProps(["x","y"],s);return Math.pow(n-o,2)+Math.pow(r-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(n,r){return n8(this,n,"x",r)}inYRange(n,r){return n8(this,n,"y",r)}getCenterPoint(n){const{x:r,y:s}=this.getProps(["x","y"],n);return{x:r,y:s}}size(n){n=n||this.options||{};let r=n.radius||0;r=Math.max(r,r&&n.hoverRadius||0);const s=r&&n.borderWidth||0;return(r+s)*2}draw(n,r){const s=this.options;this.skip||s.radius<.1||!S1(this,r,this.size(s)/2)||(n.strokeStyle=s.borderColor,n.lineWidth=s.borderWidth,n.fillStyle=s.backgroundColor,xM(n,s,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Vt(BC,"id","point"),Vt(BC,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Vt(BC,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const r8=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},kst=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class s8 extends rm{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,r){this.maxWidth=e,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=ir(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(r=>e.filter(r,this.chart.data))),e.sort&&(n=n.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=yi(r.font),i=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=r8(r,i);let u,c;n.font=s.string,this.isHorizontal()?(u=this.maxWidth,c=this._fitRows(o,i,a,l)+10):(c=this.maxHeight,u=this._fitCols(o,s,a,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,s){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],c=s+a;let d=e;i.textAlign="left",i.textBaseline="middle";let h=-1,f=-c;return this.legendItems.forEach((m,g)=>{const x=r+n/2+i.measureText(m.text).width;(g===0||u[u.length-1]+x+2*a>o)&&(d+=c,u[u.length-(g>0?0:1)]=0,f+=c,h++),l[g]={left:0,top:f,row:h,width:x,height:s},u[u.length-1]+=x+a}),d}_fitCols(e,n,r,s){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],c=o-e;let d=a,h=0,f=0,m=0,g=0;return this.legendItems.forEach((x,w)=>{const{itemWidth:b,itemHeight:S}=Tst(r,n,i,x,s);w>0&&f+S+2*a>c&&(d+=h+a,u.push({width:h,height:f}),m+=h+a,g++,h=f=0),l[w]={left:m,top:f,col:g,width:b,height:S},h=Math.max(h,b),f+=S+a}),d+=h,u.push({width:h,height:f}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:s},rtl:i}}=this,o=Fg(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=ui(r,this.left+s,this.right-this.lineWidths[a]);for(const u of n)a!==u.row&&(a=u.row,l=ui(r,this.left+s,this.right-this.lineWidths[a])),u.top+=this.top+e+s,u.left=o.leftForLtr(o.x(l),u.width),l+=u.width+s}else{let a=0,l=ui(r,this.top+e+s,this.bottom-this.columnSizes[a].height);for(const u of n)u.col!==a&&(a=u.col,l=ui(r,this.top+e+s,this.bottom-this.columnSizes[a].height)),u.top=l,u.left+=this.left+s,u.left=o.leftForLtr(o.x(u.left),u.width),l+=u.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;b4(e,this),this._draw(),v4(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:r,ctx:s}=this,{align:i,labels:o}=e,a=Ur.color,l=Fg(e.rtl,this.left,this.width),u=yi(o.font),{padding:c}=o,d=u.size,h=d/2;let f;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=u.string;const{boxWidth:m,boxHeight:g,itemHeight:x}=r8(o,d),w=function(D,P,I){if(isNaN(m)||m<=0||isNaN(g)||g<0)return;s.save();const E=vn(I.lineWidth,1);if(s.fillStyle=vn(I.fillStyle,a),s.lineCap=vn(I.lineCap,"butt"),s.lineDashOffset=vn(I.lineDashOffset,0),s.lineJoin=vn(I.lineJoin,"miter"),s.lineWidth=E,s.strokeStyle=vn(I.strokeStyle,a),s.setLineDash(vn(I.lineDash,[])),o.usePointStyle){const M={radius:g*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:E},O=l.xPlus(D,m/2),j=P+h;$te(s,M,O,j,o.pointStyleWidth&&m)}else{const M=P+Math.max((d-g)/2,0),O=l.leftForLtr(D,m),j=Pw(I.borderRadius);s.beginPath(),Object.values(j).some(R=>R!==0)?wM(s,{x:O,y:M,w:m,h:g,radius:j}):s.rect(O,M,m,g),s.fill(),E!==0&&s.stroke()}s.restore()},b=function(D,P,I){C1(s,I.text,D,P+x/2,u,{strikethrough:I.hidden,textAlign:l.textAlign(I.textAlign)})},S=this.isHorizontal(),C=this._computeTitleHeight();S?f={x:ui(i,this.left+c,this.right-r[0]),y:this.top+c+C,line:0}:f={x:this.left+c,y:ui(i,this.top+C+c,this.bottom-n[0].height),line:0},Lte(this.ctx,e.textDirection);const T=x+c;this.legendItems.forEach((D,P)=>{s.strokeStyle=D.fontColor,s.fillStyle=D.fontColor;const I=s.measureText(D.text).width,E=l.textAlign(D.textAlign||(D.textAlign=o.textAlign)),M=m+h+I;let O=f.x,j=f.y;l.setWidth(this.width),S?P>0&&O+M+c>this.right&&(j=f.y+=T,f.line++,O=f.x=ui(i,this.left+c,this.right-r[f.line])):P>0&&j+T>this.bottom&&(O=f.x=O+n[f.line].width+c,f.line++,j=f.y=ui(i,this.top+C+c,this.bottom-n[f.line].height));const R=l.x(O);if(w(R,j,D),O=Vtt(E,O+m+h,S?O+M:this.right,e.rtl),b(l.x(O),j,D),S)f.x+=M+c;else if(typeof D.text!="string"){const z=u.lineHeight;f.y+=ene(D,z)+c}else f.y+=T}),zte(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,r=yi(n.font),s=Pa(n.padding);if(!n.display)return;const i=Fg(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=r.size/2,u=s.top+l;let c,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),c=this.top+u,d=ui(e.align,d,this.right-h);else{const m=this.columnSizes.reduce((g,x)=>Math.max(g,x.height),0);c=u+ui(e.align,this.top,this.bottom-m-e.labels.padding-this._computeTitleHeight())}const f=ui(a,d,d+h);o.textAlign=i.textAlign(x4(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=r.string,C1(o,n.text,f,c,r)}_computeTitleHeight(){const e=this.options.title,n=yi(e.font),r=Pa(e.padding);return e.display?n.lineHeight+r.height:0}_getLegendItemAt(e,n){let r,s,i;if(dw(e,this.left,this.right)&&dw(n,this.top,this.bottom)){for(i=this.legendHitBoxes,r=0;r<i.length;++r)if(s=i[r],dw(e,s.left,s.left+s.width)&&dw(n,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const n=this.options;if(!Ast(e.type,n))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,i=kst(s,r);s&&!i&&ir(n.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!i&&ir(n.onHover,[e,r,this],this)}else r&&ir(n.onClick,[e,r,this],this)}}function Tst(t,e,n,r,s){const i=Est(r,t,e,n),o=_st(s,r,e.lineHeight);return{itemWidth:i,itemHeight:o}}function Est(t,e,n,r){let s=t.text;return s&&typeof s!="string"&&(s=s.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+r.measureText(s).width}function _st(t,e,n){let r=t;return typeof e.text!="string"&&(r=ene(e,n)),r}function ene(t,e){const n=t.text?t.text.length:0;return e*n}function Ast(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var $st={id:"legend",_element:s8,start(t,e,n){const r=t.legend=new s8({ctx:t.ctx,options:n,chart:t});Ta.configure(t,r,n),Ta.addBox(t,r)},stop(t){Ta.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;Ta.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,s=n.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:s,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(n?0:void 0),c=Pa(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:u.borderColor,pointStyle:r||u.pointStyle,rotation:u.rotation,textAlign:s||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class tne extends rm{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const s=Ts(r.text)?r.text.length:1;this._padding=Pa(r.padding);const i=s*yi(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:r,bottom:s,right:i,options:o}=this,a=o.align;let l=0,u,c,d;return this.isHorizontal()?(c=ui(a,r,i),d=n+e,u=i-r):(o.position==="left"?(c=r+e,d=ui(a,s,n),l=_s*-.5):(c=i-e,d=ui(a,n,s),l=_s*.5),u=s-n),{titleX:c,titleY:d,maxWidth:u,rotation:l}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const r=yi(n.font),i=r.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:u}=this._drawArgs(i);C1(e,n.text,0,0,r,{color:n.color,maxWidth:l,rotation:u,textAlign:x4(n.align),textBaseline:"middle",translation:[o,a]})}}function Rst(t,e){const n=new tne({ctx:t.ctx,options:e,chart:t});Ta.configure(t,n,e),Ta.addBox(t,n),t.titleBlock=n}var Mst={id:"title",_element:tne,start(t,e,n){Rst(t,n)},stop(t){const e=t.titleBlock;Ta.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const r=t.titleBlock;Ta.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const pw={average(t){if(!t.length)return!1;let e,n,r=new Set,s=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();r.add(l.x),s+=l.y,++i}}return i===0||r.size===0?!1:{x:[...r].reduce((a,l)=>a+l)/r.size,y:s/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,r=e.y,s=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),c=gM(e,u);c<s&&(s=c,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,r=l.y}return{x:n,y:r}}};function eu(t,e){return e&&(Ts(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function oc(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function Dst(t,e){const{element:n,datasetIndex:r,index:s}=e,i=t.getDatasetMeta(r).controller,{label:o,value:a}=i.getLabelAndValue(s);return{chart:t,label:o,parsed:i.getParsed(s),raw:t.data.datasets[r].data[s],formattedValue:a,dataset:i.getDataset(),dataIndex:s,datasetIndex:r,element:n}}function i8(t,e){const n=t.chart.ctx,{body:r,footer:s,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=yi(e.bodyFont),u=yi(e.titleFont),c=yi(e.footerFont),d=i.length,h=s.length,f=r.length,m=Pa(e.padding);let g=m.height,x=0,w=r.reduce((C,T)=>C+T.before.length+T.lines.length+T.after.length,0);if(w+=t.beforeBody.length+t.afterBody.length,d&&(g+=d*u.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),w){const C=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;g+=f*C+(w-f)*l.lineHeight+(w-1)*e.bodySpacing}h&&(g+=e.footerMarginTop+h*c.lineHeight+(h-1)*e.footerSpacing);let b=0;const S=function(C){x=Math.max(x,n.measureText(C).width+b)};return n.save(),n.font=u.string,Dn(t.title,S),n.font=l.string,Dn(t.beforeBody.concat(t.afterBody),S),b=e.displayColors?o+2+e.boxPadding:0,Dn(r,C=>{Dn(C.before,S),Dn(C.lines,S),Dn(C.after,S)}),b=0,n.font=c.string,Dn(t.footer,S),n.restore(),x+=m.width,{width:x,height:g}}function Ost(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function Pst(t,e,n,r){const{x:s,width:i}=r,o=n.caretSize+n.caretPadding;if(t==="left"&&s+i+o>e.width||t==="right"&&s-i-o<0)return!0}function Fst(t,e,n,r){const{x:s,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let u="center";return r==="center"?u=s<=(a+l)/2?"left":"right":s<=i/2?u="left":s>=o-i/2&&(u="right"),Pst(u,t,e,n)&&(u="center"),u}function o8(t,e,n){const r=n.yAlign||e.yAlign||Ost(t,n);return{xAlign:n.xAlign||e.xAlign||Fst(t,e,n,r),yAlign:r}}function Lst(t,e){let{x:n,width:r}=t;return e==="right"?n-=r:e==="center"&&(n-=r/2),n}function zst(t,e,n){let{y:r,height:s}=t;return e==="top"?r+=n:e==="bottom"?r-=s+n:r-=s/2,r}function a8(t,e,n,r){const{caretSize:s,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,u=s+i,{topLeft:c,topRight:d,bottomLeft:h,bottomRight:f}=Pw(o);let m=Lst(e,a);const g=zst(e,l,u);return l==="center"?a==="left"?m+=u:a==="right"&&(m-=u):a==="left"?m-=Math.max(c,h)+s:a==="right"&&(m+=Math.max(d,f)+s),{x:ka(m,0,r.width-e.width),y:ka(g,0,r.height-e.height)}}function kS(t,e,n){const r=Pa(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function l8(t){return eu([],oc(t))}function Bst(t,e,n){return nm(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function u8(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const nne={beforeTitle:rc,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:rc,beforeBody:rc,beforeLabel:rc,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Jn(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:rc,afterBody:rc,beforeFooter:rc,footer:rc,afterFooter:rc};function ro(t,e,n,r){const s=t[e].call(n,r);return typeof s>"u"?nne[e].call(n,r):s}class CM extends rm{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&n.options.animation&&r.animations,i=new Ute(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=Bst(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:r}=n,s=ro(r,"beforeTitle",this,e),i=ro(r,"title",this,e),o=ro(r,"afterTitle",this,e);let a=[];return a=eu(a,oc(s)),a=eu(a,oc(i)),a=eu(a,oc(o)),a}getBeforeBody(e,n){return l8(ro(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:r}=n,s=[];return Dn(e,i=>{const o={before:[],lines:[],after:[]},a=u8(r,i);eu(o.before,oc(ro(a,"beforeLabel",this,i))),eu(o.lines,ro(a,"label",this,i)),eu(o.after,oc(ro(a,"afterLabel",this,i))),s.push(o)}),s}getAfterBody(e,n){return l8(ro(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:r}=n,s=ro(r,"beforeFooter",this,e),i=ro(r,"footer",this,e),o=ro(r,"afterFooter",this,e);let a=[];return a=eu(a,oc(s)),a=eu(a,oc(i)),a=eu(a,oc(o)),a}_createItems(e){const n=this._active,r=this.chart.data,s=[],i=[],o=[];let a=[],l,u;for(l=0,u=n.length;l<u;++l)a.push(Dst(this.chart,n[l]));return e.filter&&(a=a.filter((c,d,h)=>e.filter(c,d,h,r))),e.itemSort&&(a=a.sort((c,d)=>e.itemSort(c,d,r))),Dn(a,c=>{const d=u8(e.callbacks,c);s.push(ro(d,"labelColor",this,c)),i.push(ro(d,"labelPointStyle",this,c)),o.push(ro(d,"labelTextColor",this,c))}),this.labelColors=s,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const r=this.options.setContext(this.getContext()),s=this._active;let i,o=[];if(!s.length)this.opacity!==0&&(i={opacity:0});else{const a=pw[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=i8(this,r),u=Object.assign({},a,l),c=o8(this.chart,r,u),d=a8(r,u,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,i={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,s){const i=this.getCaretPosition(e,r,s);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,r){const{xAlign:s,yAlign:i}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:u,bottomLeft:c,bottomRight:d}=Pw(a),{x:h,y:f}=e,{width:m,height:g}=n;let x,w,b,S,C,T;return i==="center"?(C=f+g/2,s==="left"?(x=h,w=x-o,S=C+o,T=C-o):(x=h+m,w=x+o,S=C-o,T=C+o),b=x):(s==="left"?w=h+Math.max(l,c)+o:s==="right"?w=h+m-Math.max(u,d)-o:w=this.caretX,i==="top"?(S=f,C=S-o,x=w-o,b=w+o):(S=f+g,C=S+o,x=w+o,b=w-o),T=S),{x1:x,x2:w,x3:b,y1:S,y2:C,y3:T}}drawTitle(e,n,r){const s=this.title,i=s.length;let o,a,l;if(i){const u=Fg(r.rtl,this.x,this.width);for(e.x=kS(this,r.titleAlign,r),n.textAlign=u.textAlign(r.titleAlign),n.textBaseline="middle",o=yi(r.titleFont),a=r.titleSpacing,n.fillStyle=r.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(s[l],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=r.titleMarginBottom-a)}}_drawColorBox(e,n,r,s,i){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:u}=i,c=yi(i.bodyFont),d=kS(this,"left",i),h=s.x(d),f=l<c.lineHeight?(c.lineHeight-l)/2:0,m=n.y+f;if(i.usePointStyle){const g={radius:Math.min(u,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},x=s.leftForLtr(h,u)+u/2,w=m+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,xM(e,g,x,w),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,xM(e,g,x,w)}else{e.lineWidth=An(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const g=s.leftForLtr(h,u),x=s.leftForLtr(s.xPlus(h,1),u-2),w=Pw(o.borderRadius);Object.values(w).some(b=>b!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,wM(e,{x:g,y:m,w:u,h:l,radius:w}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),wM(e,{x,y:m+1,w:u-2,h:l-2,radius:w}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(g,m,u,l),e.strokeRect(g,m,u,l),e.fillStyle=o.backgroundColor,e.fillRect(x,m+1,u-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){const{body:s}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:u,boxPadding:c}=r,d=yi(r.bodyFont);let h=d.lineHeight,f=0;const m=Fg(r.rtl,this.x,this.width),g=function(I){n.fillText(I,m.x(e.x+f),e.y+h/2),e.y+=h+i},x=m.textAlign(o);let w,b,S,C,T,D,P;for(n.textAlign=o,n.textBaseline="middle",n.font=d.string,e.x=kS(this,x,r),n.fillStyle=r.bodyColor,Dn(this.beforeBody,g),f=a&&x!=="right"?o==="center"?u/2+c:u+2+c:0,C=0,D=s.length;C<D;++C){for(w=s[C],b=this.labelTextColors[C],n.fillStyle=b,Dn(w.before,g),S=w.lines,a&&S.length&&(this._drawColorBox(n,e,C,m,r),h=Math.max(d.lineHeight,l)),T=0,P=S.length;T<P;++T)g(S[T]),h=d.lineHeight;Dn(w.after,g)}f=0,h=d.lineHeight,Dn(this.afterBody,g),e.y-=i}drawFooter(e,n,r){const s=this.footer,i=s.length;let o,a;if(i){const l=Fg(r.rtl,this.x,this.width);for(e.x=kS(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=l.textAlign(r.footerAlign),n.textBaseline="middle",o=yi(r.footerFont),n.fillStyle=r.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(s[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,n,r,s){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:u,height:c}=r,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:m}=Pw(s.cornerRadius);n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,n.lineWidth=s.borderWidth,n.beginPath(),n.moveTo(a+d,l),o==="top"&&this.drawCaret(e,n,r,s),n.lineTo(a+u-h,l),n.quadraticCurveTo(a+u,l,a+u,l+h),o==="center"&&i==="right"&&this.drawCaret(e,n,r,s),n.lineTo(a+u,l+c-m),n.quadraticCurveTo(a+u,l+c,a+u-m,l+c),o==="bottom"&&this.drawCaret(e,n,r,s),n.lineTo(a+f,l+c),n.quadraticCurveTo(a,l+c,a,l+c-f),o==="center"&&i==="left"&&this.drawCaret(e,n,r,s),n.lineTo(a,l+d),n.quadraticCurveTo(a,l,a+d,l),n.closePath(),n.fill(),s.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,r=this.$animations,s=r&&r.x,i=r&&r.y;if(s||i){const o=pw[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=i8(this,e),l=Object.assign({},o,this._size),u=o8(n,e,l),c=a8(e,l,u,n);(s._to!==c.x||i._to!==c.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,c))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const s={width:this.width,height:this.height},i={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=Pa(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=r,this.drawBackground(i,e,s,n),Lte(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),zte(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const r=this._active,s=e.map(({datasetIndex:a,index:l})=>{const u=this.chart.getDatasetMeta(a);if(!u)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:u.data[l],index:l}}),i=!nN(r,s),o=this._positionChanged(s,n);(i||o)&&(this._active=s,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,r),a=this._positionChanged(o,e),l=n||!nN(o,i)||a;return l&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,r,s){const i=this.options;if(e.type==="mouseout")return[];if(!s)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,r);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:r,caretY:s,options:i}=this,o=pw[i.position].call(this,e,n);return o!==!1&&(r!==o.x||s!==o.y)}}Vt(CM,"positioners",pw);var Ust={id:"tooltip",_element:CM,positioners:pw,afterInit(t,e,n){n&&(t.tooltip=new CM({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:nne},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Vst=(t,e,n,r)=>(typeof e=="string"?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function jst(t,e,n,r){const s=t.indexOf(e);if(s===-1)return Vst(t,e,n,r);const i=t.lastIndexOf(e);return s!==i?n:s}const Wst=(t,e)=>t===null?null:ka(Math.round(t),0,e);function c8(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class IM extends Dy{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:s,label:i}of n)r[s]===i&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Jn(e))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:jst(r,e,vn(n,e),this._addedLabels),Wst(n,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,n=this.max,r=this.options.offset,s=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=n;o++)s.push({value:o});return s}getLabelForValue(e){return c8.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Vt(IM,"id","category"),Vt(IM,"defaults",{ticks:{callback:c8}});function Gst(t,e){const n=[],{bounds:s,step:i,min:o,max:a,precision:l,count:u,maxTicks:c,maxDigits:d,includeBounds:h}=t,f=i||1,m=c-1,{min:g,max:x}=e,w=!Jn(o),b=!Jn(a),S=!Jn(u),C=(x-g)/(d+1);let T=m6((x-g)/m/f)*f,D,P,I,E;if(T<1e-14&&!w&&!b)return[{value:g},{value:x}];E=Math.ceil(x/T)-Math.floor(g/T),E>m&&(T=m6(E*T/m/f)*f),Jn(l)||(D=Math.pow(10,l),T=Math.ceil(T*D)/D),s==="ticks"?(P=Math.floor(g/T)*T,I=Math.ceil(x/T)*T):(P=g,I=x),w&&b&&i&&$tt((a-o)/i,T/1e3)?(E=Math.round(Math.min((a-o)/T,c)),T=(a-o)/E,P=o,I=a):S?(P=w?o:P,I=b?a:I,E=u-1,T=(I-P)/E):(E=(I-P)/T,Mw(E,Math.round(E),T/1e3)?E=Math.round(E):E=Math.ceil(E));const M=Math.max(g6(T),g6(P));D=Math.pow(10,Jn(l)?M:l),P=Math.round(P*D)/D,I=Math.round(I*D)/D;let O=0;for(w&&(h&&P!==o?(n.push({value:o}),P<o&&O++,Mw(Math.round((P+O*T)*D)/D,o,d8(o,C,t))&&O++):P<o&&O++);O<E;++O){const j=Math.round((P+O*T)*D)/D;if(b&&j>a)break;n.push({value:j})}return b&&h&&I!==a?n.length&&Mw(n[n.length-1].value,a,d8(a,C,t))?n[n.length-1].value=a:n.push({value:a}):(!b||I===a)&&n.push({value:I}),n}function d8(t,e,{horizontal:n,minRotation:r}){const s=Zf(r),i=(n?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class Hst extends Dy{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Jn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:s,max:i}=this;const o=l=>s=n?s:l,a=l=>i=r?i:l;if(e){const l=o0(s),u=o0(i);l<0&&u<0?a(0):l>0&&u>0&&o(0)}if(s===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(s-l)}this.min=s,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),n=n||11),n&&(s=Math.min(n,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=Gst(s,i);return e.bounds==="ticks"&&Rtt(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-n)/Math.max(e.length-1,1)/2;n-=s,r+=s}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(e){return _te(e,this.chart.options.locale,this.options.ticks.format)}}class NM extends Hst{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Oa(e)?e:0,this.max=Oa(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,r=Zf(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Vt(NM,"id","linear"),Vt(NM,"defaults",{ticks:{callback:Ate.formatters.numeric}});const cE={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},fo=Object.keys(cE);function h8(t,e){return t-e}function f8(t,e){if(Jn(e))return null;const n=t._adapter,{parser:r,round:s,isoWeekday:i}=t._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),Oa(o)||(o=typeof r=="string"?n.parse(o,r):n.parse(o)),o===null?null:(s&&(o=s==="week"&&(v1(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,s)),+o)}function p8(t,e,n,r){const s=fo.length;for(let i=fo.indexOf(t);i<s-1;++i){const o=cE[fo[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=r)return fo[i]}return fo[s-1]}function Yst(t,e,n,r,s){for(let i=fo.length-1;i>=fo.indexOf(n);i--){const o=fo[i];if(cE[o].common&&t._adapter.diff(s,r,o)>=e-1)return o}return fo[n?fo.indexOf(n):0]}function Kst(t){for(let e=fo.indexOf(t)+1,n=fo.length;e<n;++e)if(cE[fo[e]].common)return fo[e]}function m8(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:r,hi:s}=y4(n,e),i=n[r]>=e?n[r]:n[s];t[i]=!0}}function qst(t,e,n,r){const s=t._adapter,i=+s.startOf(e[0].value,r),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+s.add(a,1,r))l=n[a],l>=0&&(e[l].major=!0);return e}function g8(t,e,n){const r=[],s={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],s[a]=o,r.push({value:a,major:!1});return i===0||!n?r:qst(t,r,s,n)}class uN extends Dy{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const r=e.time||(e.time={}),s=this._adapter=new art._date(e.adapters.date);s.init(n),Rw(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:f8(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,r=e.time.unit||"day";let{min:s,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(u){!o&&!isNaN(u.min)&&(s=Math.min(s,u.min)),!a&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=Oa(s)&&!isNaN(s)?s:+n.startOf(Date.now(),r),i=Oa(i)&&!isNaN(i)?i:+n.endOf(Date.now(),r)+1,this.min=Math.min(s,i-1),this.max=Math.max(s+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){const e=this.options,n=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const i=this.min,o=this.max,a=Ltt(s,i,o);return this._unit=n.unit||(r.autoSkip?p8(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):Yst(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:Kst(this._unit),this.initOffsets(s),e.reverse&&a.reverse(),g8(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,r=0,s,i;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?n=1-s:n=(this.getDecimalForValue(e[1])-s)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?r=i:r=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=ka(n,0,o),r=ka(r,0,o),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,n=this.min,r=this.max,s=this.options,i=s.time,o=i.unit||p8(i.minUnit,n,r,this._getLabelCapacity(n)),a=vn(s.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,u=v1(l)||l===!0,c={};let d=n,h,f;if(u&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,u?"day":o),e.diff(r,n,o)>1e5*a)throw new Error(n+" and "+r+" are too far apart with stepSize of "+a+" "+o);const m=s.ticks.source==="data"&&this.getDataTimestamps();for(h=d,f=0;h<r;h=+e.add(h,a,o),f++)m8(c,h,m);return(h===r||s.bounds==="ticks"||f===1)&&m8(c,h,m),Object.keys(c).sort(h8).map(g=>+g)}getLabelForValue(e){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}format(e,n){const s=this.options.time.displayFormats,i=this._unit,o=n||s[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,r,s){const i=this.options,o=i.ticks.callback;if(o)return ir(o,[e,n,r],this);const a=i.time.displayFormats,l=this._unit,u=this._majorUnit,c=l&&a[l],d=u&&a[u],h=r[n],f=u&&d&&h&&h.major;return this._adapter.format(e,s||(f?d:c))}generateTickLabels(e){let n,r,s;for(n=0,r=e.length;n<r;++n)s=e[n],s.label=this._tickFormatFunction(s.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,r=this.ctx.measureText(e).width,s=Zf(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:r*i+a*o,h:r*o+a*i}}_getLabelCapacity(e){const n=this.options.time,r=n.displayFormats,s=r[n.unit]||r.millisecond,i=this._tickFormatFunction(e,0,g8(this,[e],this._majorUnit),s),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(n=0,r=s.length;n<r;++n)e=e.concat(s[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,r;if(e.length)return e;const s=this.getLabels();for(n=0,r=s.length;n<r;++n)e.push(f8(this,s[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Btt(e.sort(h8))}}Vt(uN,"id","time"),Vt(uN,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function TS(t,e,n){let r=0,s=t.length-1,i,o,a,l;n?(e>=t[r].pos&&e<=t[s].pos&&({lo:r,hi:s}=Qf(t,"pos",e)),{pos:i,time:a}=t[r],{pos:o,time:l}=t[s]):(e>=t[r].time&&e<=t[s].time&&({lo:r,hi:s}=Qf(t,"time",e)),{time:i,pos:a}=t[r],{time:o,pos:l}=t[s]);const u=o-i;return u?a+(l-a)*(e-i)/u:a}class y8 extends uN{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=TS(n,this.min),this._tableRange=TS(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:r}=this,s=[],i=[];let o,a,l,u,c;for(o=0,a=e.length;o<a;++o)u=e[o],u>=n&&u<=r&&s.push(u);if(s.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(o=0,a=s.length;o<a;++o)c=s[o+1],l=s[o-1],u=s[o],Math.round((c+l)/2)!==u&&i.push({time:u,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((s,i)=>s-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?e=this.normalize(n.concat(r)):e=n.length?n:r,e=this._cache.all=e,e}getDecimalForValue(e){return(TS(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return TS(this._table,r*this._tableRange+this._minPos,!0)}}Vt(y8,"id","timeseries"),Vt(y8,"defaults",uN.defaults);const rne="label";function x8(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Xst(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function sne(t,e){t.labels=e}function ine(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rne;const r=[];t.datasets=e.map(s=>{const i=t.datasets.find(o=>o[n]===s[n]);return!i||!s.data||r.includes(i)?{...s}:(r.push(i),Object.assign(i,s),i)})}function Zst(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rne;const n={labels:[],datasets:[]};return sne(n,t.labels),ine(n,t.datasets,e),n}function Qst(t,e){const{height:n=150,width:r=300,redraw:s=!1,datasetIdKey:i,type:o,data:a,options:l,plugins:u=[],fallbackContent:c,updateMode:d,...h}=t,f=W.useRef(null),m=W.useRef(null),g=()=>{f.current&&(m.current=new uE(f.current,{type:o,data:Zst(a,i),options:l&&{...l},plugins:u}),x8(e,m.current))},x=()=>{x8(e,null),m.current&&(m.current.destroy(),m.current=null)};return W.useEffect(()=>{!s&&m.current&&l&&Xst(m.current,l)},[s,l]),W.useEffect(()=>{!s&&m.current&&sne(m.current.config.data,a.labels)},[s,a.labels]),W.useEffect(()=>{!s&&m.current&&a.datasets&&ine(m.current.config.data,a.datasets,i)},[s,a.datasets]),W.useEffect(()=>{m.current&&(s?(x(),setTimeout(g)):m.current.update(d))},[s,l,a.labels,a.datasets,d]),W.useEffect(()=>{m.current&&(x(),setTimeout(g))},[o]),W.useEffect(()=>(g(),()=>x()),[]),En.createElement("canvas",{ref:f,role:"img",height:n,width:r,...h},c)}const Jst=W.forwardRef(Qst);function eit(t,e){return uE.register(e),W.forwardRef((n,r)=>En.createElement(Jst,{...n,ref:r,type:t}))}const tit=eit("line",FC);uE.register(IM,NM,BC,fw,Mst,Ust,$st);const nit=()=>{const t={labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Workout Duration",data:[30,45,60,45,75,60,90],borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.5)",tension:.4}]},e={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)"}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)"}}}},n=[{icon:z8,label:"Workouts",value:"12",unit:"this week"},{icon:qse,label:"Calories",value:"3,500",unit:"burned"},{icon:iie,label:"Achievements",value:"8",unit:"unlocked"},{icon:sie,label:"Progress",value:"85%",unit:"completed"}];return he.jsx("div",{className:"min-h-[calc(100vh-4rem)] p-6",children:he.jsxs("div",{className:"max-w-7xl mx-auto",children:[he.jsxs("div",{className:"mb-8",children:[he.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Welcome back, Alex!"}),he.jsx("p",{className:"text-gray-400",children:"Track your fitness journey and achievements"})]}),he.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:n.map((r,s)=>he.jsxs(xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"bg-gray-800/50 backdrop-blur-sm rounded-xl p-6",children:[he.jsxs("div",{className:"flex items-center justify-between mb-4",children:[he.jsx(r.icon,{className:"h-6 w-6 text-purple-500"}),he.jsx("span",{className:"text-sm text-gray-400",children:r.unit})]}),he.jsx("div",{className:"text-2xl font-bold mb-1",children:r.value}),he.jsx("div",{className:"text-gray-400 text-sm",children:r.label})]},r.label))}),he.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[he.jsxs(xi.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-gray-800/50 backdrop-blur-sm rounded-xl p-6",children:[he.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Weekly Progress"}),he.jsx(tit,{data:t,options:e})]}),he.jsxs(xi.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-gray-800/50 backdrop-blur-sm rounded-xl p-6",children:[he.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Recent Achievements"}),he.jsx("div",{className:"space-y-4",children:[{title:"Workout Streak",desc:"7 days in a row",date:"Today"},{title:"Perfect Form",desc:"10 perfect squats",date:"Yesterday"},{title:"New PR",desc:"Bench Press 180lbs",date:"2 days ago"}].map((r,s)=>he.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700/50 rounded-lg",children:[he.jsxs("div",{children:[he.jsx("div",{className:"font-medium",children:r.title}),he.jsx("div",{className:"text-sm text-gray-400",children:r.desc})]}),he.jsx("div",{className:"text-sm text-gray-400",children:r.date})]},s))})]})]})]})})},rit=()=>{const t=[{name:"Strength Training",count:12,image:"https://images.unsplash.com/photo-1534438327276-14e5300c3a48?auto=format&fit=crop&q=80&w=500"},{name:"Cardio",count:8,image:"https://images.unsplash.com/photo-1538805060514-97d9cc17730c?auto=format&fit=crop&q=80&w=500"},{name:"HIIT",count:10,image:"https://images.unsplash.com/photo-1601422407692-ec4eeec1d9b3?auto=format&fit=crop&q=80&w=500"},{name:"Yoga",count:6,image:"https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?auto=format&fit=crop&q=80&w=500"}],e=[{title:"Full Body Power",duration:"45 min",difficulty:"Intermediate",rating:4.8,image:"https://images.unsplash.com/photo-1549060279-7e168fcee0c2?auto=format&fit=crop&q=80&w=500"},{title:"Core Crusher",duration:"30 min",difficulty:"Advanced",rating:4.9,image:"https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?auto=format&fit=crop&q=80&w=500"},{title:"Cardio Blast",duration:"35 min",difficulty:"Beginner",rating:4.7,image:"https://images.unsplash.com/photo-1538805060514-97d9cc17730c?auto=format&fit=crop&q=80&w=500"}];return he.jsx("div",{className:"min-h-[calc(100vh-4rem)] p-6",children:he.jsxs("div",{className:"max-w-7xl mx-auto",children:[he.jsxs("div",{className:"mb-8",children:[he.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Workout Library"}),he.jsx("p",{className:"text-gray-400",children:"Choose from our collection of AI-powered workouts"})]}),he.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:t.map((n,r)=>he.jsxs(xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},className:"relative group cursor-pointer overflow-hidden rounded-xl",children:[he.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent z-10"}),he.jsx("img",{src:n.image,alt:n.name,className:"w-full h-48 object-cover group-hover:scale-110 transition-transform duration-300"}),he.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 z-20",children:[he.jsx("h3",{className:"text-lg font-semibold",children:n.name}),he.jsxs("p",{className:"text-sm text-gray-300",children:[n.count," workouts"]})]})]},n.name))}),he.jsxs("div",{className:"mb-8",children:[he.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Featured Workouts"}),he.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:e.map((n,r)=>he.jsxs(xi.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.1},className:"bg-gray-800/50 backdrop-blur-sm rounded-xl overflow-hidden group",children:[he.jsxs("div",{className:"relative",children:[he.jsx("img",{src:n.image,alt:n.title,className:"w-full h-48 object-cover group-hover:scale-110 transition-transform duration-300"}),he.jsx("button",{className:"absolute inset-0 flex items-center justify-center bg-purple-600/0 group-hover:bg-purple-600/80 transition-colors",children:he.jsx($M,{className:"h-12 w-12 opacity-0 group-hover:opacity-100 transition-opacity"})})]}),he.jsxs("div",{className:"p-4",children:[he.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.title}),he.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[he.jsxs("div",{className:"flex items-center space-x-4",children:[he.jsxs("span",{className:"flex items-center",children:[he.jsx(B8,{className:"h-4 w-4 mr-1"}),n.duration]}),he.jsxs("span",{className:"flex items-center",children:[he.jsx(Wse,{className:"h-4 w-4 mr-1"}),n.difficulty]})]}),he.jsxs("span",{className:"flex items-center",children:[he.jsx(rie,{className:"h-4 w-4 text-yellow-500 mr-1"}),n.rating]})]})]})]},n.title))})]})]})})};function sit(){return he.jsx(_se,{children:he.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black text-white",children:[he.jsx(B1e,{}),he.jsxs(ose,{children:[he.jsx(Cf,{path:"/",element:he.jsx(U1e,{})}),he.jsx(Cf,{path:"/auth",element:he.jsx(V1e,{})}),he.jsx(Cf,{path:"/ai-trainer",element:he.jsx(Xet,{})}),he.jsx(Cf,{path:"/wallet",element:he.jsx(Zet,{})}),he.jsx(Cf,{path:"/dashboard",element:he.jsx(nit,{})}),he.jsx(Cf,{path:"/workouts",element:he.jsx(rit,{})})]})]})})}var w8;(function(t){t.GLOBAL="GLOBAL",t.ANONYMOUS="ANONYMOUS"})(w8||(w8={}));const iit={DELEGATION:"DELEGATION"};var Mp;(function(t){t[t.NEW_TAB=0]="NEW_TAB",t[t.EXTENSION=1]="EXTENSION",t[t.INTERNET_IDENTITY=2]="INTERNET_IDENTITY",t[t.STOIC=3]="STOIC"})(Mp||(Mp={}));const oit={id:"NFIDW",description:"Quickly sign in or create an anonymous, self-sovereign wallet with your email address or passkey.",providerUrl:"https://nfid.one/rpc",transportType:Mp.NEW_TAB,label:"NFID Wallet",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTExLjc5NCAyLjQzM0ExLjE2MiAxLjE2MiAwIDAgMCAxMS41NDguMTJMOS4xNzQuMzc0Yy0xLjIxNi4xMy0yLjE5MS4yMzQtMi45ODMuMzc4LS44MTYuMTQ4LTEuNTE2LjM1LTIuMTY1LjcxNGE2LjY3NSA2LjY3NSAwIDAgMC0yLjUzIDIuNTA2Yy0uMzcuNjQ2LS41NzggMS4zNDMtLjczMiAyLjE1N0MuNjE0IDYuOTE5LjUgNy44OTMuMzYgOS4xMDZsLS4wMDYuMDUyLS4yMzMgMi4zMThhMS4xNjIgMS4xNjIgMCAxIDAgMi4zMTMuMjMybC4yMzEtMi4zYy4xNDYtMS4yNjQuMjQ5LTIuMTUuMzgxLTIuODQ1LjEzLS42ODIuMjc1LTEuMS40NjctMS40MzZhNC4zNSA0LjM1IDAgMCAxIDEuNjQ4LTEuNjMzYy4zMzgtLjE5Ljc2LS4zMzEgMS40NDMtLjQ1NS42OTktLjEyNyAxLjU5LS4yMjMgMi44Ni0uMzU4bDIuMzMtLjI0OFptMjIuNjEzLTEuMjhhMS4xNjIgMS4xNjIgMCAwIDAgMS4wMzMgMS4yOGwyLjMzLjI0OGMxLjI3LjEzNSAyLjE2LjIzMSAyLjg1OS4zNTguNjg0LjEyNCAxLjEwNS4yNjUgMS40NDMuNDU1YTQuMzUgNC4zNSAwIDAgMSAxLjY0OCAxLjYzM2MuMTkzLjMzNS4zMzcuNzU0LjQ2NyAxLjQzNi4xMzIuNjk1LjIzNSAxLjU4MS4zOCAyLjg0NGwuMjMyIDIuMzAyYTEuMTYyIDEuMTYyIDAgMSAwIDIuMzEzLS4yMzNsLS4yMzMtMi4zMTgtLjAwNi0uMDUyYy0uMTQtMS4yMTQtLjI1Mi0yLjE4Ny0uNDAyLTIuOTc3LS4xNTUtLjgxNC0uMzY0LTEuNTExLS43MzQtMi4xNTdhNi42NzUgNi42NzUgMCAwIDAtMi41MjktMi41MDZjLS42NS0uMzY0LTEuMzQ5LS41NjYtMi4xNjUtLjcxNC0uNzkyLS4xNDQtMS43NjctLjI0OC0yLjk4My0uMzc4TDM1LjY4Ni4xMjFhMS4xNjIgMS4xNjIgMCAwIDAtMS4yNzkgMS4wMzNabTAgNDQuOTIzYTEuMTYyIDEuMTYyIDAgMCAxIDEuMDMzLTEuMjhsMi4zMy0uMjQ4YzEuMjctLjEzNSAyLjE2LS4yMyAyLjg1OS0uMzU3LjY4NC0uMTI0IDEuMTA1LS4yNjYgMS40NDMtLjQ1NWE0LjM1IDQuMzUgMCAwIDAgMS42NDgtMS42MzNjLjE5My0uMzM2LjMzNy0uNzU1LjQ2Ny0xLjQzNy4xMzItLjY5NS4yMzUtMS41ODEuMzgtMi44NDRsLjIzMi0yLjMwMWExLjE2MiAxLjE2MiAwIDEgMSAyLjMxMy4yMzNsLS4yMzMgMi4zMTctLjAwNi4wNTNjLS4xNCAxLjIxMy0uMjUyIDIuMTg2LS40MDIgMi45NzYtLjE1NS44MTQtLjM2NCAxLjUxMi0uNzM0IDIuMTU4YTYuNjc1IDYuNjc1IDAgMCAxLTIuNTI5IDIuNTA2Yy0uNjUuMzY0LTEuMzQ5LjU2Ni0yLjE2NS43MTQtLjc5Mi4xNDMtMS43NjcuMjQ3LTIuOTgzLjM3N2wtMi4zNzQuMjUzYTEuMTYyIDEuMTYyIDAgMCAxLTEuMjc5LTEuMDMyWm0tMjEuNTggMGExLjE2MiAxLjE2MiAwIDAgMC0xLjAzMy0xLjI4bC0yLjMzLS4yNDhjLTEuMjctLjEzNS0yLjE2LS4yMy0yLjg1OS0uMzU3LS42ODQtLjEyNC0xLjEwNS0uMjY2LTEuNDQzLS40NTVhNC4zNSA0LjM1IDAgMCAxLTEuNjQ4LTEuNjMzYy0uMTkyLS4zMzYtLjMzNy0uNzU1LS40NjctMS40MzctLjEzMi0uNjk1LS4yMzUtMS41ODEtLjM4LTIuODQ0bC0uMjMyLTIuMzAxYTEuMTYyIDEuMTYyIDAgMCAwLTIuMzEzLjIzM2wuMjMzIDIuMzE3LjAwNi4wNTNjLjE0IDEuMjEzLjI1MiAyLjE4Ni40MDMgMi45NzYuMTU0LjgxNC4zNjMgMS41MTIuNzMzIDIuMTU4YTYuNjc0IDYuNjc0IDAgMCAwIDIuNTI5IDIuNTA2Yy42NS4zNjQgMS4zNDkuNTY2IDIuMTY1LjcxNC43OTIuMTQzIDEuNzY3LjI0NyAyLjk4My4zNzdsMi4zNzQuMjUzYTEuMTYyIDEuMTYyIDAgMCAwIDEuMjc5LTEuMDMyWm0tLjYzNi0zMS40MjJhMSAxIDAgMCAwLTEgMXYxNi4yNjRhMSAxIDAgMCAwIDEgMWgzLjE2NmExIDEgMCAwIDAgMS0xVjE1LjY1NGExIDEgMCAwIDAtMS0xaC0zLjE2NlptOC41NiAwYTEgMSAwIDAgMC0xIDF2MTYuMjY0YTEgMSAwIDAgMCAxIDFoNy42MzdjMiAwIDMuNzc0LS4zNzQgNS4zMjItMS4xMjIgMS41NDgtLjc0OCAyLjc0OS0xLjgwOSAzLjYwMS0zLjE4My44NTItMS4zNzQgMS4yNzktMi45ODMgMS4yNzktNC44MjcgMC0xLjg0NC0uNDI3LTMuNDUzLTEuMjc5LTQuODI3LS44NTItMS4zNzQtMi4wNTMtMi40MzUtMy42LTMuMTgzLTEuNTQ5LS43NDgtMy4zMjMtMS4xMjItNS4zMjMtMS4xMjJIMjAuNzVabTExLjE4NSAxMi44MTFjLS45NC44ODctMi4xOTIgMS4zMy0zLjc1NyAxLjMzaC0yLjk2MmEuMy4zIDAgMCAxLS4zLS4zdi05LjQxOWEuMy4zIDAgMCAxIC4zLS4zaDIuOTYyYzEuNTY1IDAgMi44MTguNDQ0IDMuNzU3IDEuMzMxLjk1Ny44ODcgMS40MzUgMi4xMTQgMS40MzUgMy42OCAwIDEuNTY1LS40NzggMi43OS0xLjQzNSAzLjY3OFoiIGZpbGw9InVybCgjYSkiIC8+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImEiIHgxPSIxMS40MTUiIHkxPSIxNS43NTYiIHgyPSIyNy41NDgiIHkyPSIzOS4yMDYiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iI0NDNUNEQyIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIuMjQ1IiBzdG9wLWNvbG9yPSIjN0I2NkZGIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9Ii41MjEiIHN0b3AtY29sb3I9IiMxRjhBRjAiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjc2IiBzdG9wLWNvbG9yPSIjMDBEMUZGIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMzREVERDciIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KPC9zdmc+Cg=="};Mp.NEW_TAB;const ait={id:"Plug",providerUrl:"",transportType:Mp.EXTENSION,label:"Plug",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjcwMSIgaGVpZ2h0PSIzOTI1IiB2aWV3Qm94PSIwIDAgMjcwMSAzOTI1IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMCAxMTIzLjc4QzAgMTAzNi42NCA3MC42NDIgOTY2IDE1Ny43ODMgOTY2SDI1NDIuMjhDMjYyOS40MyA5NjYgMjcwMC4wNyAxMDM2LjY0IDI3MDAuMDcgMTEyMy43OFYxOTA5Ljc0QzI3MDAuMDcgMjY1NS4zNCAyMDk1LjY0IDMyNTkuNzggMTM1MC4wMyAzMjU5Ljc4QzYwNC40MzEgMzI1OS43OCAwIDI2NTUuMzQgMCAxOTA5Ljc0VjExMjMuNzhaIiBmaWxsPSJ1cmwoI3BhaW50MF9saW5lYXIpIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjU5My4xNyAyNDM3LjNDMjM4Ny43NyAyOTIwLjgzIDE5MDguNSAzMjU5Ljk0IDEzNTAuMDMgMzI1OS45NEM2MDQuNDMxIDMyNTkuOTQgMCAyNjU1LjUxIDAgMTkwOS45VjEzNDIuMTZDMjU2LjQxNiAxMjAwLjU4IDU1MS4yMjMgMTEyMCA4NjQuODUgMTEyMEMxNjkwLjE3IDExMjAgMjM4NS4xNyAxNjc3Ljk5IDI1OTMuMTcgMjQzNy4zWiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyKSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyNzAuMzggMjg5OC41MkMyMDI5LjI0IDMxMjMuMyAxNzA1LjcgMzI2MC44NCAxMzUwLjAzIDMyNjAuODRDNjA0LjQzMSAzMjYwLjg0IDAgMjY1Ni40MSAwIDE5MTAuOFYxNzY2LjQ4QzIyOC40OTUgMTYyMy41OSA0OTguNTY4IDE1NDEgNzg3LjkzMSAxNTQxQzE1NjUuNzkgMTU0MSAyMjA0LjI1IDIxMzcuODIgMjI3MC4zOCAyODk4LjUyWiIgZmlsbD0idXJsKCNwYWludDJfbGluZWFyKSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MDQuMyAzMTg4LjcxQzE3NzYuMjIgMjU2NS41NiAxMjY0IDIwNjkgNjM2LjIyMiAyMDY5QzQxOC4wMzIgMjA2OSAyMTMuNzk5IDIxMjguOTggMzkgMjIzMy40MkMxNDcuNjg4IDI2NzguNzMgNDc1LjM0NCAzMDM3Ljc2IDkwMC44OTQgMzE4OC45OFYzMjY0LjQ0QzkwMC44OTQgMzM3My42OSA5NTkuNTkgMzQ2OS4xOCAxMDQ3LjA2IDM1MjAuODhWMzcyNi4zN0MxMDQ3LjA2IDM4MzUuODYgMTEzNS40OSAzOTI0LjYxIDEyNDQuNTcgMzkyNC42MUgxNDU5Ljg2QzE1NjguOTUgMzkyNC42MSAxNjU3LjM4IDM4MzUuODYgMTY1Ny4zOCAzNzI2LjM3VjM1MjAuODhDMTc0NC44NSAzNDY5LjE4IDE4MDMuNTQgMzM3My42OSAxODAzLjU0IDMyNjQuNDRWMzE4OC45OEMxODAzLjggMzE4OC44OSAxODA0LjA1IDMxODguOCAxODA0LjMgMzE4OC43MVoiIGZpbGw9InVybCgjcGFpbnQzX2xpbmVhcikiLz4KPHBhdGggZD0iTTUwNCA2MEM1MDQgMjYuODYyOSA1MzAuODYzIDAgNTY0IDBIODM4Qzg3MS4xMzcgMCA4OTggMjYuODYyOSA4OTggNjBWOTY2SDUwNFY2MFoiIGZpbGw9IiMwMzE1MTQiLz4KPHBhdGggZD0iTTE3OTIgNjBDMTc5MiAyNi44NjI5IDE4MTguODYgMCAxODUyIDBIMjEyNkMyMTU5LjE0IDAgMjE4NiAyNi44NjI5IDIxODYgNjBWOTY2SDE3OTJWNjBaIiBmaWxsPSIjMDMxNTE0Ii8+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2kpIj4KPHBhdGggZD0iTTY3Mi4xMzMgMjMzOS42QzY2NS43OTYgMjMzOC4zNiA2NTkuOTYgMjM0My4zOSA2NjAuMzY1IDIzNDkuODRDNjgwLjQyOCAyNjY5LjMxIDk4MS45ODcgMjkyMi45MyAxMzUxLjA1IDI5MjIuOTNDMTcxOS4yNyAyOTIyLjkzIDIwMjAuMjkgMjY3MC40OCAyMDQxLjYgMjM1Mi4wNUMyMDQyLjAzIDIzNDUuNiAyMDM2LjIxIDIzNDAuNTQgMjAyOS44NyAyMzQxLjc2QzE4MTUuMDkgMjM4My4xMiAxNTg0IDI0MjMuNDIgMTM1MS4wNSAyNDIzLjQyQzExMTQuMDIgMjQyMy40MiA4ODkuODcgMjM4Mi4zNCA2NzIuMTMzIDIzMzkuNloiIGZpbGw9InVybCgjcGFpbnQ0X2xpbmVhcikiLz4KPC9nPgo8cGF0aCBkPSJNNzAzLjEwOSAyMzkwLjQyQzcxNC45OTEgMjQ5MC43OSAxMDA3LjQyIDI2MTMuMjkgMTM1NS40OSAyNjEzLjI5QzE3MDIuNzcgMjYxMy4yOSAxOTg5Ljc4IDI0OTAuNDggMjAwMi44NSAyMzkwLjQyQzE3OTkuNjggMjQwMy40MyAxNzgyLjk0IDI0NjguMTQgMTM1NS40OSAyNDY4LjE0QzkwNi4yNTUgMjQ2OC4xNCA5MDkuNDA2IDI0MDMuODYgNzAzLjEwOSAyMzkwLjQyWiIgZmlsbD0idXJsKCNwYWludDVfbGluZWFyKSIvPgo8cGF0aCBkPSJNMTI5OSAxNzM0Ljk1QzExOTcuNDMgMTkyMS40MSAxMDM4LjY2IDIxMDkuODQgODU1LjIzNCAyMTA0LjkxQzY2Ny44OCAyMTA0LjkxIDUxNiAxOTM5LjI3IDUxNiAxNzM0Ljk1QzUxNiAxNTMwLjYzIDY2Ny44OCAxMzY1IDg1NS4yMzQgMTM2NUMxMDQyLjU5IDEzNjUgMTE4MC42NiAxNTI4Ljc3IDEyOTkgMTczNC45NVoiIGZpbGw9InVybCgjcGFpbnQ2X2xpbmVhcikiLz4KPHBhdGggZD0iTTEzOTkgMTczNS40OUMxNTAwLjU3IDE5MTguMjQgMTY1OS4zNCAyMTA5Ljc1IDE4NDIuNzcgMjEwNC45MUMyMDMwLjEyIDIxMDQuOTEgMjE4MiAxOTM1Ljc1IDIxODIgMTczNS40OUMyMTgyIDE1MzUuMjMgMjAzMS4xMSAxMzY1IDE4NDMuNzUgMTM2NUMxNjU2LjQgMTM2NSAxNTE3LjM0IDE1MzMuNCAxMzk5IDE3MzUuNDlaIiBmaWxsPSJ1cmwoI3BhaW50N19saW5lYXIpIi8+CjxjaXJjbGUgY3g9Ijk4Ny41NDIiIGN5PSIxNzk3LjE4IiByPSI4OS4xNzQzIiBmaWxsPSIjMDMxNTE0Ii8+CjxjaXJjbGUgY3g9IjEwMTguNyIgY3k9IjE4MzYuOTQiIHI9IjMwLjA4MjkiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE3MTEuMzciIGN5PSIxNzk3LjE4IiByPSI4OS4xNzQzIiBmaWxsPSIjMDMxNTE0Ii8+CjxjaXJjbGUgY3g9IjE3NDIuNTMiIGN5PSIxODM2Ljk0IiByPSIzMC4wODI5IiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTMwMC44NyAxNzM4LjU4TDUxNy45NzIgMTc3OUM1MTYuMjgzIDE3NjQuMjEgNTE1LjAyMSAxNzU3LjMxIDUxNS4wMTkgMTc0Ni40N0M1MTMuMDQ3IDE1MjguNjEgNjY1Ljg4MyAxMzYzIDg1OC4xNTUgMTM2M0MxMDUwLjQzIDEzNjMgMTIwMC4yOSAxNTUzLjI2IDEyOTguOSAxNzMzLjY1QzEyOTguMDcgMTczNS4xNyAxMzAxLjcxIDE3MzcuMDYgMTMwMC44NyAxNzM4LjU4WiIgZmlsbD0iIzAzMTUxNCIvPgo8cGF0aCBkPSJNMTM5Ny4xMyAxNzM4LjU4TDIxODAuODMgMTc3OUMyMTgyLjUyIDE3NjQuMjEgMjE4Mi43OCAxNzU3LjMxIDIxODIuNzggMTc0Ni40N0MyMTg5LjcxIDE1MzIuNTUgMjAzMS45NSAxMzYzIDE4MzkuNzMgMTM2M0MxNjQ3LjUxIDEzNjMgMTQ5Ny42OCAxNTUzLjI2IDEzOTkuMSAxNzMzLjY1QzEzOTkuOTMgMTczNS4xNyAxMzk2LjI5IDE3MzcuMDYgMTM5Ny4xMyAxNzM4LjU4WiIgZmlsbD0iIzAzMTUxNCIvPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMV9pKSI+CjxwYXRoIGQ9Ik0xODM4LjE3IDEyNzJDMTU5OS40OSAxMjcyIDE0MjUuNzYgMTUxMC4zMyAxMzUwIDE2MzcuNTJDMTI3NC4yNCAxNTEwLjMzIDExMDAuNTEgMTI3MiA4NjEuODMxIDEyNzJDNjIwLjkyNyAxMjcyIDQyNSAxNDc5LjQ5IDQyNSAxNzM0LjVDNDI1IDE5ODkuNTEgNjIwLjkyNyAyMTk3IDg2MS44MzEgMjE5N0MxMTAwLjQ4IDIxOTcgMTI3NC4yNCAxOTU4LjY3IDEzNTAgMTgzMS40NUMxNDI1Ljc2IDE5NTguNjcgMTU5OS40OSAyMTk3IDE4MzguMTcgMjE5N0MyMDc5LjA3IDIxOTcgMjI3NSAxOTg5LjUxIDIyNzUgMTczNC41QzIyNzUgMTQ3OS40OSAyMDc5LjA3IDEyNzIgMTgzOC4xNyAxMjcyWk04NjEuODMxIDIxMDQuNUM2NzEuOTc1IDIxMDQuNSA1MTcuNSAxOTM4LjUyIDUxNy41IDE3MzQuNUM1MTcuNSAxNTMwLjQ4IDY3MS45NzUgMTM2NC41IDg2MS44MzEgMTM2NC41QzEwODcuMzkgMTM2NC41IDEyNTYuMzEgMTY1NS4zMyAxMjk4LjE0IDE3MzQuNUMxMjU2LjMxIDE4MTMuNjcgMTA4Ny40MiAyMTA0LjUgODYxLjgzMSAyMTA0LjVaTTE4MzguMTcgMjEwNC41QzE2MTIuNjEgMjEwNC41IDE0NDMuNjkgMTgxMy42NyAxNDAxLjg2IDE3MzQuNUMxNDQzLjY5IDE2NTUuMzMgMTYxMi42MSAxMzY0LjUgMTgzOC4xNyAxMzY0LjVDMjAyOC4wMyAxMzY0LjUgMjE4Mi41IDE1MzAuNDggMjE4Mi41IDE3MzQuNUMyMTgyLjUgMTkzOC41MiAyMDI4LjAzIDIxMDQuNSAxODM4LjE3IDIxMDQuNVoiIGZpbGw9InVybCgjcGFpbnQ4X2xpbmVhcikiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9pIiB4PSI2NjAuMzQ1IiB5PSIyMzM5LjQxIiB3aWR0aD0iMTM4MS4yNyIgaGVpZ2h0PSI1ODMuNTIxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9InNoYXBlIi8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxNy41Ii8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9ImFyaXRobWV0aWMiIGsyPSItMSIgazM9IjEiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuNjQgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0ic2hhcGUiIHJlc3VsdD0iZWZmZWN0MV9pbm5lclNoYWRvdyIvPgo8L2ZpbHRlcj4KPGZpbHRlciBpZD0iZmlsdGVyMV9pIiB4PSI0MjUiIHk9IjEyNzIiIHdpZHRoPSIxODUwIiBoZWlnaHQ9IjkyNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJzaGFwZSIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTcuNSIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJhcml0aG1ldGljIiBrMj0iLTEiIGszPSIxIi8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjY0IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9InNoYXBlIiByZXN1bHQ9ImVmZmVjdDFfaW5uZXJTaGFkb3ciLz4KPC9maWx0ZXI+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQwX2xpbmVhciIgeDE9IjE4MDEuNjkiIHkxPSIxODE2LjA2IiB4Mj0iMjc3My4wNCIgeTI9Ijg0My43MTgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzQ2RkY0NyIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5Q0ZGOUQiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDFfbGluZWFyIiB4MT0iMTU2Ni45OSIgeTE9IjE3OTUuODEiIHgyPSIxODk2Ljc4IiB5Mj0iMTIyMy45IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiMxMEQ5RUQiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMTBEOUVEIiBzdG9wLW9wYWNpdHk9IjAuMyIvPgo8L2xpbmVhckdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50Ml9saW5lYXIiIHgxPSIxNDYwLjQ4IiB5MT0iMjAzOS41MiIgeDI9IjE2NDkuNzYiIHkyPSIxNTM1LjkxIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiNGQTUxRDMiLz4KPHN0b3Agb2Zmc2V0PSIwLjk1ODc3NCIgc3RvcC1jb2xvcj0iI0ZBNTFEMyIgc3RvcC1vcGFjaXR5PSIwIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQzX2xpbmVhciIgeDE9IjEwMDIuNSIgeTE9IjI4MjMiIHgyPSIxMzA2LjU0IiB5Mj0iMjAxMy4yNiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSIjRkZFNzAwIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI0ZGRTcwMCIgc3RvcC1vcGFjaXR5PSIwIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQ0X2xpbmVhciIgeDE9IjEzNTEuMDEiIHkxPSIyMzM3LjE2IiB4Mj0iMTM1MS4wMSIgeTI9IjI5MjIuOTMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3AvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3Atb3BhY2l0eT0iMC42NSIvPgo8L2xpbmVhckdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50NV9saW5lYXIiIHgxPSIxNTQwLjM1IiB5MT0iMjQyMS45NyIgeDI9IjE1NDAuMzUiIHkyPSIyNTc5Ljc2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIG9mZnNldD0iMC43NSIgc3RvcC1jb2xvcj0id2hpdGUiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjREVERURGIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQ2X2xpbmVhciIgeDE9IjEwMjAuMzgiIHkxPSIxNDY5Ljc4IiB4Mj0iMTAyMC4zNyIgeTI9IjE5OTMuNjciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjc1IiBzdG9wLWNvbG9yPSJ3aGl0ZSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNERURFREYiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDdfbGluZWFyIiB4MT0iMTY3Ny42MiIgeTE9IjE0NjkuNzgiIHgyPSIxNjc3LjYzIiB5Mj0iMTk5My42NyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBvZmZzZXQ9IjAuNzUiIHN0b3AtY29sb3I9IndoaXRlIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI0RFREVERiIvPgo8L2xpbmVhckdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50OF9saW5lYXIiIHgxPSIxMzUwIiB5MT0iMTI3MiIgeDI9IjEzNTAiIHkyPSIyMTk3IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9IjAuNjUiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4="},lit={id:"InternetIdentity",providerUrl:"",transportType:Mp.INTERNET_IDENTITY,label:"Internet Identity",icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI0LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAzNTguOCAxNzkuOCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzU4LjggMTc5Ljg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDp1cmwoI1NWR0lEXzFfKTt9Cgkuc3Qxe2ZpbGw6dXJsKCNTVkdJRF8yXyk7fQoJLnN0MntmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOiMyOUFCRTI7fQo8L3N0eWxlPgo8bGluZWFyR3JhZGllbnQgaWQ9IlNWR0lEXzFfIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjIyNC43ODUzIiB5MT0iMjU3Ljc1MzYiIHgyPSIzNDguMDY2MyIgeTI9IjEzMy40NTgxIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgMjcyKSI+Cgk8c3RvcCAgb2Zmc2V0PSIwLjIxIiBzdHlsZT0ic3RvcC1jb2xvcjojRjE1QTI0Ii8+Cgk8c3RvcCAgb2Zmc2V0PSIwLjY4NDEiIHN0eWxlPSJzdG9wLWNvbG9yOiNGQkIwM0IiLz4KPC9saW5lYXJHcmFkaWVudD4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI3MS42LDBjLTIwLDAtNDEuOSwxMC45LTY1LDMyLjRjLTEwLjksMTAuMS0yMC41LDIxLjEtMjcuNSwyOS44YzAsMCwxMS4yLDEyLjksMjMuNSwyNi44CgljNi43LTguNCwxNi4yLTE5LjgsMjcuMy0zMC4xYzIwLjUtMTkuMiwzMy45LTIzLjEsNDEuNi0yMy4xYzI4LjgsMCw1Mi4yLDI0LjIsNTIuMiw1NC4xYzAsMjkuNi0yMy40LDUzLjgtNTIuMiw1NC4xCgljLTEuNCwwLTMtMC4yLTUtMC42YzguNCwzLjksMTcuNSw2LjcsMjYsNi43YzUyLjgsMCw2My4yLTM2LjUsNjMuOC0zOS4xYzEuNS02LjcsMi40LTEzLjcsMi40LTIwLjlDMzU4LjYsNDAuNCwzMTkuNiwwLDI3MS42LDB6Ii8+CjxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMl8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTMzLjk0NjEiIHkxPSIxMDYuNDI2MiIgeDI9IjEwLjY2NTMiIHkyPSIyMzAuNzIxNSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDI3MikiPgoJPHN0b3AgIG9mZnNldD0iMC4yMSIgc3R5bGU9InN0b3AtY29sb3I6I0VEMUU3OSIvPgoJPHN0b3AgIG9mZnNldD0iMC44OTI5IiBzdHlsZT0ic3RvcC1jb2xvcjojNTIyNzg1Ii8+CjwvbGluZWFyR3JhZGllbnQ+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik04Ny4xLDE3OS44YzIwLDAsNDEuOS0xMC45LDY1LTMyLjRjMTAuOS0xMC4xLDIwLjUtMjEuMSwyNy41LTI5LjhjMCwwLTExLjItMTIuOS0yMy41LTI2LjgKCWMtNi43LDguNC0xNi4yLDE5LjgtMjcuMywzMC4xYy0yMC41LDE5LTM0LDIzLjEtNDEuNiwyMy4xYy0yOC44LDAtNTIuMi0yNC4yLTUyLjItNTQuMWMwLTI5LjYsMjMuNC01My44LDUyLjItNTQuMQoJYzEuNCwwLDMsMC4yLDUsMC42Yy04LjQtMy45LTE3LjUtNi43LTI2LTYuN0MxMy40LDI5LjYsMyw2Ni4xLDIuNCw2OC44QzAuOSw3NS41LDAsODIuNSwwLDg5LjdDMCwxMzkuNCwzOSwxNzkuOCw4Ny4xLDE3OS44eiIvPgo8cGF0aCBjbGFzcz0ic3QyIiBkPSJNMTI3LjMsNTkuN2MtNS44LTUuNi0zNC0yOC41LTYxLTI5LjNDMTguMSwyOS4yLDQsNjQuMiwyLjcsNjguN0MxMiwyOS41LDQ2LjQsMC4yLDg3LjIsMAoJYzMzLjMsMCw2NywzMi43LDkxLjksNjIuMmMwLDAsMC4xLTAuMSwwLjEtMC4xYzAsMCwxMS4yLDEyLjksMjMuNSwyNi44YzAsMCwxNCwxNi41LDI4LjgsMzFjNS44LDUuNiwzMy45LDI4LjIsNjAuOSwyOQoJYzQ5LjUsMS40LDYzLjItMzUuNiw2My45LTM4LjRjLTkuMSwzOS41LTQzLjYsNjguOS04NC42LDY5LjFjLTMzLjMsMC02Ny0zMi43LTkyLTYyLjJjMCwwLjEtMC4xLDAuMS0wLjEsMC4yCgljMCwwLTExLjItMTIuOS0yMy41LTI2LjhDMTU2LjIsOTAuOCwxNDIuMiw3NC4yLDEyNy4zLDU5Ljd6IE0yLjcsNjkuMWMwLTAuMSwwLTAuMiwwLjEtMC4zQzIuNyw2OC45LDIuNyw2OSwyLjcsNjkuMXoiLz4KPC9zdmc+Cg=="};Mp.STOIC;const uit=[oit,ait,lit],cit=void 0;mre.createRoot(document.getElementById("root")).render(he.jsxs(v1e,{signers:uit,theme:va.SYSTEM,authType:iit.DELEGATION,signerClientOptions:{targets:[cit],retryTimes:2},children:[he.jsx(En.StrictMode,{children:he.jsx(F1e,{children:he.jsx(sit,{})})}),","]}));
